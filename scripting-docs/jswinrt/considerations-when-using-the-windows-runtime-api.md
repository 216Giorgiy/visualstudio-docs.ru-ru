---
title: "Вопросы, связанные с использованием API среды выполнения Windows | Microsoft Docs"
ms.custom: ""
ms.date: "01/18/2017"
ms.prod: "windows-client-threshold"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "javascript"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "JavaScript, API среды выполнения Windows"
ms.assetid: 2f56d70c-c80d-4876-8e6a-8ae031d31c22
caps.latest.revision: 8
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
caps.handback.revision: 8
---
# Вопросы, связанные с использованием API среды выполнения Windows
В JavaScript можно использовать почти все элементы API среды выполнения Windows.  Однако на некоторые аспекты представления элементов среды выполнения Windows в JavaScript нужно обратить особое внимание.  
  
> [!IMPORTANT]
>  Дополнительные сведения о создании компонентов среды выполнения Windows в C\+\+, C\# или Visual Basic и их использовании в JavaScript см. в разделе [Создание компонентов среды выполнения Windows](http://msdn.microsoft.com/library/9a6b8f0a-7d5e-40a0-a9c5-a59b4908e133).  
  
## Особые случаи использования типов среды выполнения Windows в представлении JavaScript  
  
-   Строки: Неинициализированная строка передается методу среды выполнения Windows как "неопределенная", а строка, которой задано значение `null` — как строка "null". \(Это является истинным, если значение `null` или `undefined` приводится к строке\). Прежде чем передавать строку методу среды выполнения Windows необходимо инициализировать его как пустую строку \(""\).  
  
-   Интерфейсы: невозможно реализовать интерфейс среды выполнения Windows в JavaScript.  
  
-   Массивы: размер массивов среды выполнения Windows нельзя изменить, поэтому методы, изменяющие размер массивов в JavaScript, не работают с массивами среды выполнения Windows.  
  
-   Массивы: если передать значение массива JavaScript методу среды выполнения Windows, массив копируется.  Метод среды выполнения Windows не может изменить массив или его элементы и вернуть его в приложение JavaScript.  Однако можно использовать типизированные массивы \(например, [Объект Int32Array](../javascript/reference/int32array-object.md)\), которые не копируются.  
  
-   Структуры: структуры среды выполнения Windows являются объектами на языке JavaScript.  Если требуется передать структуру среды выполнения Windows методу среды выполнения Windows, не нужно создавать экземпляр структуры с ключевым словом `new`.  Вместо этого необходимо создать объект и добавить соответствующие элементы и их значение.  Имена членов должны быть представлены в стиле Camel: `SomeStruct.firstMember`.  
  
-   Объекты: объекты JavaScript не совпадают с объектами управляемого кода \(`System.Object`\).  Невозможно передать объект JavaScript методу среды выполнения Windows, который требует `System.Object`.  
  
-   Идентификатор объекта: в большинстве случаев объекты, передаваемые между средой выполнения Windows и JavaScript, не изменяются.  Обработчик JavaScript ведет карту известных объектов.  Когда объект возвращается из среды выполнения Windows, он сопоставляется этой карте, и если объекта не существует, создается новый объект.  Та же процедура используется для объектов, представляющих интерфейсы, которые возвращаются методами среды выполнения Windows.  Существует два типа исключений:  
  
    -   Объекты, возвращаемые из вызова среды выполнения Windows, к которым затем добавляют новые свойства \(expando\) не сохраняют новые свойства, когда передаются обратно в среду выполнения Windows..  Однако если они возвращены приложению JavaScript, возвращенный объект имеет свойства expando, поскольку эти свойства сопоставляются существующему объекту.  
  
    -   Структуры и делегаты в среде выполнения Windows не могут быть указаны как идентичные ранее используемым структурам или делегатам.  Каждый раз при возврате структуры или делегата он\(а\) получает новую ссылку.  
  
-   Конфликты имен: несколько интерфейсов среды выполнения Windows могут содержать члены с теми же именами.  Если они объединены в одном объекте JavaScript \(который может быть представлением класса среды выполнения или интерфейса\), то элементы представлены с полными именами.  Эти элементы можно вызвать с помощью следующего синтаксиса: `Class["MemberName"](parameter)`.  
  
     В следующем коде два интерфейса используют метод Draw, а класс среды выполнения реализует оба интерфейса.  
  
    ```cpp#  
    namespace CollisionExample {  
        interface InterfaceA  
        {  
            HRESULT Draw([in] Int32 a);  
        }  
        interface InterfaceB  
        {  
            HRESULT Draw([in] HString a);  
        }  
        runtimeclass ExampleObject {  
          interface InterfaceA  
          interface InterfaceB  
        }  
    }  
    ```  
  
     Ниже представлены способы вызова указанного выше кода в JavaScript.  
  
    ```javascript  
    var example = new ExampleObject();  
    example["CollisionExample.InterfaceA.draw"](12);  
    example["CollisionExample.InterfaceB.draw"]("hello");  
    ```  
  
-   Параметры `Out` : если метод среды выполнения Windows имеет несколько параметров `out`, то на языке JavaScript метод имеет объект JavaScript в качестве возвращаемого значения, а объект имеет свойства, которые соответствуют параметру `out`.  Например, рассмотрим следующую сигнатуру среды выполнения Windows в С\+\+.  
  
    ```cpp#  
    void ExampleMethod(  
      [OutAttribute] char^ first,   
      [OutAttribute] char^ second  
    )  
    ```  
  
     Версия JavaScript этой сигнатуры:  
  
    ```javascript  
    var returnValue = exampleMethod();  
  
    ```  
  
     В этом примере `returnValue` — это объект JavaScript с двумя полями: `first` и `second`.  
  
-   Статические члены: среда выполнения Windows определяет и статические члены, и члены экземпляров.  На языке JavaScript статические члены добавляются в объект, связанный с классом или интерфейсом среды выполнения Windows.  
  
    ```javascript  
    // Static method.   
    var accel = Windows.Devices.Sensors.Accelerometer.getDefault();   
    // Instance method.   
    var reading = accel.getCurrentReading();            
    ```  
  
 Дополнительные сведения о представлении базовых типов среды выполнения Windows в JavaScript см. в разделе [Представление типов среды выполнения Windows в JavaScript](../jswinrt/javascript-representation-of-windows-runtime-types.md).