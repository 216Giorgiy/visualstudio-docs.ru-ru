---
title: "IActiveScriptParse::AddScriptlet | Microsoft Docs"
ms.custom: ""
ms.date: "01/18/2017"
ms.prod: "windows-script-interfaces"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "reference"
apiname: IActiveScriptParse.AddScriptlet
apilocation: scrobj.dll
helpviewer_keywords: 
  - "IActiveScriptParse_AddScriptlet"
ms.assetid: 824929f4-4dd3-473a-92d9-0b96acea2f14
caps.latest.revision: 7
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
caps.handback.revision: 7
---
# IActiveScriptParse::AddScriptlet
Добавляет сценарий кода к скрипту.  Этот метод используется в тех средах, где постоянное состояние сценария intertwined с документом узла и основное приложение отвечает за получение скрипт, а не через интерфейс `IPersist*`.  Первичные примеры скриптовые языки HTML, позволяющие сценарии кода, внедренные в документе HTML, который требуется вложить к встроенным события \(например, ONCLICK\= " button1.text\='Exit"\).  
  
## Синтаксис  
  
```  
HRESULT AddScriptlet(  
    LPCOLESTR pstrDefaultName,       // address of default name of scriptlet  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    LPCOLESTR pstrSubItemName,       // address of subitem name  
    LPCOLESTR pstrEventName,         // address of event name  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // application-defined value for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    BSTR *pbstrName,                 // address of actual name of scriptlet  
    EXCEPINFO *pexcepinfo            // address of exception information  
);  
```  
  
#### Параметры  
 `pstrDefaultName`  
 \[in\] адрес имя по умолчанию, связанное со скриптом.  Если сценарий не содержит именование сведения \(например ONCLICK в примере выше\), то это имя будет использоваться для обозначения " сценарий ".  Если этот параметр `NULL`, то обработчик скриптов изготавливает уникальное имя, если требуемый.  
  
 `pstrCode`  
 \[in\] адрес текст сценария для добавления.  Интерпретация зависит от этой строки язык сценариев.  
  
 `pstrItemName`  
 \[in\] адрес буфера, содержащий имя элемента, связанного с этим сценарием.  Этот параметр, в дополнение к `pstrSubItemName`, указывающее объект, для которого скрипт обработчика событий.  
  
 `pstrSubItemName`  
 \[in\] адрес буфера, содержащий имя `subobject` именованного элемента, с которым связан этот сценарий; это имя необходимо найти в информации о типе именованного элемента.  Этот параметр имеет значение NULL, если скрипт должен быть связан с именованным элементом. вместо `subitem` Этот параметр, в дополнение к `pstrItemName`, определяет конкретный объект, для которого скрипт обработчика событий.  
  
 `pstrEventName`  
 \[in\] адрес буфера, содержащий имя события, для которого скрипт обработчика событий.  
  
 `pstrDelimiter`  
 \[in\] адрес разделителя элемент \-\- скрипта.  Если параметр `pstrCode` анализ из потока текста, основное приложение обычно использует разделитель, например 2 одинарных кавычки \("\), чтобы обнаружить конец сценария.  Этот параметр задает разделитель, используемый основным приложением, что обработчик скриптов, чтобы обеспечить какую\-либо условную предобработку примитивов \(например, заменящ одинарная кавычка \('\) с 2 одинарными кавычками для использования в качестве разделителя\).  То, как \(и, если\), то обработчик скриптов использует этот зависит от информации обработчика скриптов.  Установите этот параметр в значение null, если основное приложение не использует разделитель для обозначения конца скрипта.  
  
 `dwSourceContextCookie`  
 \[in\] Приложение\- указанное значение, которое используется для отладки.  
  
 `ulStartingLineNumber`  
 \[in\] Нул\- значение, указывающее на основе которой начинается на линии синтаксического анализа.  
  
 `dwFlags`  
 \[in\] флаги, связанные со скриптом.  Может быть сочетанием следующих значений:  
  
|Возвращаемое значение|Значение|  
|---------------------------|--------------|  
|SCRIPTTEXT\_ISVISIBLE|Указывает, что текст скрипта должно быть видимо \(и, следовательно, вызываемые именем\) как глобальный метод в пространстве имен скрипта.|  
|SCRIPTTEXT\_ISPERSISTENT|Указывает, что код, добавляемый во время данного вызова должен быть сохранен если сохранить обработчик скриптов \(например, через вызов `IPersist*::Save`\) или если обработчик скриптов сбросить до перехода обратно в инициализированному состояние.  Дополнительные сведения об этом состоянии см. в разделе состояния обработчика скриптов.|  
  
 `pbstrName` ,  
 \[out\] фактическое имя, используемое для идентификации " сценарий ".  Это быть в порядке предпочтения: имя явно заданное в тексте сценария по умолчанию имени `pstrDefaultName`, переданного в синтезированном или уникальному имени обработчика скриптов.  
  
 `pexcepinfo` ,  
 \[out\] адрес структуры, содержащей сведения об исключении.  Эта структура должна быть заполняемую если DISP\_E\_EXCEPTION возвращается.  
  
## Возвращаемое значение  
 Возвращать одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|---------------------------|--------------|  
|`S_OK`|Успех.|  
|`DISP_E_EXCEPTION`|Возникло исключение при анализе скрипта.  Параметр `pexcepinfo` содержащий информацию об исключении.|  
|`E_INVALIDARG`|Аргумент был недопустимым.|  
|`E_NOTIMPL`|Этот метод не поддерживается. обработчик скриптов не поддерживает добавление событие\- тонуть сценарии.|  
|`E_POINTER`|Недопустимый указатель был определен.|  
|`E_UNEXPECTED`|Вызов не ожидался \(например, обработчик скриптов еще не был загружен или не был инициализирован\) и поэтому не был сбой.|  
|`OLESCRIPT_E_INVALIDNAME`|Предоставленное имя по умолчанию недопустимо в данном языке сценариев.|  
|`OLESCRIPT_E_SYNTAX`|Произошла неопознанная синтаксическая ошибка в скрипте.|  
  
## См. также  
 [IActiveScriptParse](../../winscript/reference/iactivescriptparse.md)