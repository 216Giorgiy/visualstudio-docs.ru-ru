---
title: "IActiveScriptParse::AddScriptlet | Документы Microsoft"
ms.custom: 
ms.date: 01/18/2017
ms.prod: windows-script-interfaces
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: reference
apiname:
- IActiveScriptParse.AddScriptlet
apilocation:
- scrobj.dll
helpviewer_keywords:
- IActiveScriptParse_AddScriptlet
ms.assetid: 824929f4-4dd3-473a-92d9-0b96acea2f14
caps.latest.revision: 
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.openlocfilehash: e854ac71dc36263d805160f9336e049856076ce5
ms.sourcegitcommit: aadb9588877418b8b55a5612c1d3842d4520ca4c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/27/2017
---
# <a name="iactivescriptparseaddscriptlet"></a>IActiveScriptParse::AddScriptlet
Добавляет пользователи код скрипта. Этот метод используется в средах, где постоянное состояние скрипта, находящаяся между ведущего документа основное приложение отвечает за восстановление скрипта, а не через `IPersist*` интерфейса. Основной приведены языки сценариев HTML, которые Разрешить сценарии кода, внедренных в документе HTML для присоединения к внутренние события (для экземпляра ONCLICK="button1.text='Exit"»).  
  
## <a name="syntax"></a>Синтаксис  
  
```  
HRESULT AddScriptlet(  
    LPCOLESTR pstrDefaultName,       // address of default name of scriptlet  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    LPCOLESTR pstrSubItemName,       // address of subitem name  
    LPCOLESTR pstrEventName,         // address of event name  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // application-defined value for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    BSTR *pbstrName,                 // address of actual name of scriptlet  
    EXCEPINFO *pexcepinfo            // address of exception information  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 `pstrDefaultName`  
 [in] Адрес по умолчанию имя, связанное с помощью сценариев. Если сценарий не содержит информацию об именовании (как в приведенном выше примере ONCLICK), это имя будет использоваться для идентификации сценариев. Если этот параметр равен `NULL`, обработчик скриптов создает уникальное имя, при необходимости.  
  
 `pstrCode`  
 [in] Адрес сценариев текст для добавления. Интерпретация этой строки зависит от языка скриптов.  
  
 `pstrItemName`  
 [in] Адрес буфера, который содержит имя элемента, связанного с этот сценарий. Этот параметр, в дополнение к `pstrSubItemName`, идентифицирует объект, для которого обработчик сценариев.  
  
 `pstrSubItemName`  
 [in] Адрес буфера, который содержит имя `subobject` именованного элемента, с которым связан этот сценарий; это имя следует найти в сведений о типе именованного элемента. Этот параметр имеет значение NULL, если требуется связать с именованный элемент вместо сценариев `subitem`. Этот параметр, в дополнение к `pstrItemName`, идентифицирует объект, для которого сценариев является обработчиком событий.  
  
 `pstrEventName`  
 [in] Адрес буфера, который содержит имя события, для которого сценариев является обработчиком событий.  
  
 `pstrDelimiter`  
 [in] Адрес разделитель end из сценариев. Когда `pstrCode` анализ параметра из текстового потока, обычно узел использует разделители, такие как двумя одинарными кавычками («), чтобы определить конец сценариев. Этот параметр определяет разделитель, который используется узел, позволяя обработчик скриптов для предоставления некоторых условного примитивов предварительной обработки (например, замените одинарная кавычка ['] две одинарные кавычки для использования в качестве разделителя). Как именно (и если) сценария делает ядра, использование этих сведений зависит от обработчика скриптов. Установите этот параметр в значение NULL, если узел не использовали разделитель для обозначения конца сценариев.  
  
 `dwSourceContextCookie`  
 [in] Определяемые приложением значения, который используется в целях отладки.  
  
 `ulStartingLineNumber`  
 [in] Отсчитываемый от нуля значение, которое указывает строку, с которой начинается синтаксический анализ с.  
  
 `dwFlags`  
 [in] Флаги, связанные с помощью сценариев. Может быть сочетанием следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|SCRIPTTEXT_ISVISIBLE|Указывает, должен быть видимым текст сценария (и, следовательно, вызываемая по имени) как глобальный метод в пространстве имен скрипта.|  
|SCRIPTTEXT_ISPERSISTENT|Сохранены после кода, добавленного в процессе вызова при сохранении обработчик скриптов (например, путем вызова `IPersist*::Save`), или при сбросе посредством переход обратно в исходное состояние обработчика сценариев. Дополнительные сведения об этом состоянии увидеть скрипт обработчик состояния.|  
  
 `pbstrName` ,  
 [out] Фактическое имя, используемое для идентификации сценариев. Это должно быть в порядке приоритетности: имя указано явным образом в тексте сценариев, что по умолчанию имя указано `pstrDefaultName`, или уникальное имя, созданным обработчиком сценариев.  
  
 `pexcepinfo` ,  
 [out] Адрес на структуру, содержащую сведения об исключении. Эта структура должно быть заполнено при возвращении DISP_E_EXCEPTION.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Возвращает одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|`S_OK`|Выполнено.|  
|`DISP_E_EXCEPTION`|Произошло исключение при синтаксическом анализе сценариев. `pexcepinfo` Содержит сведения об исключении.|  
|`E_INVALIDARG`|Недопустимый аргумент.|  
|`E_NOTIMPL`|Этот метод не поддерживается; Обработчик скриптов не поддерживает добавление сценарии прием событий.|  
|`E_POINTER`|Указан недопустимый указатель.|  
|`E_UNEXPECTED`|Вызов не ожидалось (например, обработчик сценариев еще не загрузки или инициализации) и поэтому не удалось выполнить.|  
|`OLESCRIPT_E_INVALIDNAME`|Предоставленное имя по умолчанию является недопустимым в языке сценариев.|  
|`OLESCRIPT_E_SYNTAX`|Неизвестная синтаксическая ошибка в сценарий.|  
  
## <a name="see-also"></a>См. также  
 [IActiveScriptParse](../../winscript/reference/iactivescriptparse.md)