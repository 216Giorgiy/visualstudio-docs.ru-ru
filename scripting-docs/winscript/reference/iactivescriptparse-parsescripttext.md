---
title: "IActiveScriptParse::ParseScriptText | Документы Microsoft"
ms.custom: 
ms.date: 01/18/2017
ms.prod: windows-script-interfaces
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: reference
apiname:
- IActiveScriptParse.ParseScriptText
apilocation:
- scrobj.dll
helpviewer_keywords:
- IActiveScriptParse_ParseScriptText
ms.assetid: 2d237d6c-cc65-415b-8808-72791304a136
caps.latest.revision: 
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.openlocfilehash: 70d17807b47468f2238c0254cc39b339df616411
ms.sourcegitcommit: aadb9588877418b8b55a5612c1d3842d4520ca4c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/27/2017
---
# <a name="iactivescriptparseparsescripttext"></a>IActiveScriptParse::ParseScriptText
Выполняет синтаксический анализ сценариев данного кода, Добавление объявления в пространство имен и их оценка код соответствующим образом.  
  
## <a name="syntax"></a>Синтаксис  
  
```  
HRESULT ParseScriptText(  
    LPCOLESTR pstrCode,              // address of scriptlet text  
    LPCOLESTR pstrItemName,          // address of item name  
    IUnknown *punkContext,           // address of debugging context  
    LPCOLESTR pstrDelimiter,         // address of end-of-scriptlet delimiter  
    DWORD_PTR dwSourceContextCookie, // cookie for debugging  
    ULONG ulStartingLineNumber,      // starting line of the script  
    DWORD dwFlags,                   // scriptlet flags  
    VARIANT *pvarResult,             // address of buffer for results  
    EXCEPINFO *pexcepinfo            // address of buffer for error data  
);  
```  
  
#### <a name="parameters"></a>Параметры  
  
|||  
|-|-|  
|`pstrCode`|[in] Адрес текста сценариев для оценки. Интерпретация этой строки зависит от языка скриптов.|  
|`pstrItemName`|[in] Адрес, предоставляющий контекст, в котором пользователи вычисляемое имя элемента. Если этот параметр имеет значение NULL, код вычисляется в глобальном контексте обработчика скриптов.|  
|`punkContext`|[in] Адрес контекста объекта. Этот объект зарезервирован для использования в отладочной среде, где может быть указано контексте отладчиком для представления активный контекст во время выполнения. Если этот параметр имеет значение NULL, используемый подсистемой `pstrItemName` для определения контекста.|  
|`pstrDelimiter`|[in] Адрес разделитель end из сценариев. Когда `pstrCode` анализируется из текстового потока, узел обычно использует разделители, такие как двумя одинарными кавычками («), чтобы определить конец сценариев. Этот параметр определяет разделитель, который используется узел, позволяя обработчик скриптов для предоставления некоторых условного примитивов предварительной обработки (например, замените одинарная кавычка ['] две одинарные кавычки для использования в качестве разделителя). Как именно (и если) сценария делает ядра, использование этих сведений зависит от обработчика скриптов. Присвойте этому параметру значение `NULL` Если узел не использовали разделитель для обозначения конца сценариев.|  
|`dwSourceContextCookie`|[in] Файл cookie, используемый для целей отладки.|  
|`ulStartingLineNumber`|[in] Отсчитываемый от нуля значение, которое указывает строку, с которой начинается синтаксический анализ с.|  
|`dwFlags`|[in] Флаги, связанные с помощью сценариев. Может представлять собой сочетание этих значений:|  
  
|Значение|Значение|  
|-----------|-------------|  
|SCRIPTTEXT_ISEXPRESSION|Если различие между вычислительные выражения и инструкции важных, но синтаксически указан неоднозначно в язык скрипта, этот флаг указывает, что сценарий будет интерпретироваться как выражение, а не как оператор или список инструкций. По умолчанию инструкциях предполагается, что если с помощью синтаксиса текста сценариев можно определить правильный выбор.|  
|SCRIPTTEXT_ISPERSISTENT|Сохранены после кода, добавленного в процессе вызова при сохранении обработчик скриптов (например, путем вызова `IPersist*::Save`), или при сбросе посредством переход обратно в исходное состояние обработчика сценариев.|  
|SCRIPTTEXT_ISVISIBLE|Указывает, должен быть видимым текст сценария (и, следовательно, вызываемая по имени) как глобальный метод в пространстве имен скрипта.|  
  
|||  
|-|-|  
|`pvarResult`|[out] Адрес буфера, получающего результаты обработки сценариев или `NULL` Если вызывающий объект ожидает никакого результата (то есть SCRIPTTEXT_ISEXPRESSION значение не задано).|  
|`pexcepinfo`|[out] Адрес структуры, которая получает сведения об исключении. Эта структура заполняется в том случае, если `IActiveScriptParse::ParseScriptText` возвращает DISP_E_EXCEPTION.|  
  
## <a name="return-value"></a>Возвращаемое значение  
 Возвращает одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|------------------|-------------|  
|`S_OK`|Выполнено.|  
|`DISP_E_EXCEPTION`|Произошло исключение при обработке сценариев. `pexcepinfo` Содержит сведения об исключении.|  
|`E_INVALIDARG`|Недопустимый аргумент.|  
|`E_POINTER`|Указан недопустимый указатель.|  
|`E_NOTIMPL`|Этот метод не поддерживается. Обработчик скриптов не поддерживает вычисление выражений или инструкций во время выполнения.|  
|`E_UNEXPECTED`|Вызов не ожидалось (например, обработчик скриптов находится в состоянии неинициализированным или закрытых, или был установлен флаг SCRIPTTEXT_ISEXPRESSION и обработчик скриптов находится в инициализированном состоянии).|  
|`OLESCRIPT_E_SYNTAX`|Неизвестная синтаксическая ошибка в сценарий.|  
  
## <a name="remarks"></a>Примечания  
 Если обработчик скриптов находится в инициализированном состоянии, код не будет фактически вычисляются во время данного вызова; Вместо этого такой код в очередь и выполняются при переходе обработчик скриптов в (или через) состояние запуска. Поскольку выполнение не может быть в состоянии инициализации, это ошибка для вызова этого метода с флагом SCRIPTTEXT_ISEXPRESSION в исходное состояние.  
  
 Сценарий может быть выражения, список инструкций или любые объекты, допустимые в языке сценариев. Например, этот метод используется для вычисления HTML \<СКРИПТА > тег, который допускает использование инструкции для выполнения при создании HTML-страницы, а не просто компилировать их в скрипт состояния.  
  
 Код, переданный в этот метод должен быть допустимый полный часть кода. Например, в VBScript недопустимо для вызова этого метода один раз с Sub Function(x) и второй раз — с `End Sub`. Средство синтаксического анализа не должен ожидать для второго вызова для выполнения подпрограммы, но вместо этого необходимо создать ошибку синтаксического анализа, так как объявление подпрограммы был запущен, но не была завершена.  
  
 Дополнительные сведения о состояниях сценария см. разделе скрипт обработчик состояния [обработчики скриптов Windows](../../winscript/windows-script-engines.md).  
  
## <a name="see-also"></a>См. также  
 [IActiveScriptParse](../../winscript/reference/iactivescriptparse.md)