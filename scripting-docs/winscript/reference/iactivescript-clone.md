---
title: "IActiveScript::Clone | Microsoft Docs"
ms.custom: ""
ms.date: "01/18/2017"
ms.prod: "windows-script-interfaces"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "reference"
apiname: IActiveScript.Clone
apilocation: scrobj.dll
helpviewer_keywords: 
  - "IActiveScript_Clone"
ms.assetid: aa000b2a-7085-448d-a422-f7adac7851cb
caps.latest.revision: 8
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
caps.handback.revision: 8
---
# IActiveScript::Clone
Клонирует текущий обработчик скриптов \(минус любое текущее состояние выполнения\), возвращая загруженный обработчик скриптов, который не имеет сайт в текущем потоке.  Свойства нового обработчика скриптов, будут идентичны свойствам исходный обработчик скриптов был бы в если он был перешел в состояние, инициализированному.  
  
## Синтаксис  
  
```  
HRESULT Clone(  
    IActiveScript **ppscript  // receives pointer to IActiveScript  
);  
```  
  
#### Параметры  
 `ppscript`  
 \[out\] адрес переменной, которая получает указатель на интерфейс [IActiveScript](../../winscript/reference/iactivescript.md) клонированного обработчика скриптов.  Основное приложение должно создать сайт и вызывать метод [IActiveScript::SetScriptSite](../../winscript/reference/iactivescript-setscriptsite.md) на новом обработчике скриптов, прежде чем он находится в инициализированном состоянии и, следовательно, годный к использованию.  
  
## Возвращаемое значение  
 Возвращать одно из следующих значений:  
  
|Возвращаемое значение|Значение|  
|---------------------------|--------------|  
|`S_OK`|Успех.|  
|`E_NOTIMPL`|Этот метод не поддерживается.|  
|`E_POINTER`|Недопустимый указатель был определен.|  
|`E_UNEXPECTED`|Вызов не ожидался \(например, обработчик скриптов еще не был загружен или не был инициализирован\).|  
  
## Заметки  
 Метод `IActiveScript::Clone` оптимизация `IPersist*::Save`, `CoCreateInstance` и `IPersist*::Load`, поэтому состояние нового обработчика скриптов должно быть таким же, если состояние исходной обработчика скриптов был сохранитьо и загружена в новый обработчик скриптов.  Именованные элементы дублироватьы в клонированном обработчике скриптов, но специальные указатели объектов для каждого элемента забыты и получаются с помощью метода [IActiveScriptSite::GetItemInfo](../../winscript/reference/iactivescriptsite-getiteminfo.md).  Это позволяет идентичную объектная модель с точки входа в\- потока \(модель изоляции\).  
  
 Этот метод используется для простых многопоточных приложений сервера, которые могут выполняться несколькими экземплярами одного и того же скрипта.  Обработчик скриптов может возвращать `E_NOTIMPL` в этом случае основное приложение может достичь того же результата с дублирования постоянное состояние и создать новый экземпляр обработчика скриптов с интерфейсом `IPersist*`.  
  
 Этот метод может быть вызван из потоков, не относящихся к базовому без привести к появлению выноски отличные от причины для размещения объектов или к интерфейсу [IActiveScriptSite](../../winscript/reference/iactivescriptsite.md).  
  
## См. также  
 [IActiveScript](../../winscript/reference/iactivescript.md)