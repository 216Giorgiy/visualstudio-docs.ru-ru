---
title: "Интерфейсы скриптов Windows | Microsoft Docs"
ms.custom: ""
ms.date: "01/18/2017"
ms.prod: "windows-script-interfaces"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 4c750627-6797-4857-9f5e-e5f54371f83c
caps.latest.revision: 10
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
caps.handback.revision: 10
---
# Интерфейсы скриптов Windows
Интерфейсы скрипта Microsoft Windows предоставляют способ для приложения и добавление сценария ole\-автоматизации.  Сценарии узлы, которые используют скрипты Windows могут использовать обработчики скриптов из нескольких источников и поставщиков для управления сценарии между компонентами.  Реализация сам\- языка скриптов, синтаксиса, постоянного формата, модели выполнения, так и расположенного остается поставщику скрипта.  
  
 Документация скриптов Windows разделяется на следующие разделы.  
  
 [Серверы скриптов Windows](../winscript/windows-script-hosts.md)  
  
 [Обработчики скриптов Windows](../winscript/windows-script-engines.md)  
  
 [Обзор отладки активных скриптов](../winscript/active-script-debugging-overview.md)  
  
 [Обзор профилирования активных скриптов](../winscript/active-script-profiling-overview.md)  
  
 [Справочник по интерфейсам скриптов Windows](../winscript/reference/windows-script-interfaces-reference.md)  
  
## Фон скриптов Windows  
 Интерфейсы скриптов Windows 2 делятся на три категории: средства обработки сценариев Windows и обработчики скриптов Windows.  Основное приложение создает обработчик скриптов и вызывает обработчик для выполнения скриптов.  Примеры средств обработки сценариев Windows:  
  
-   Microsoft Internet Explorer  
  
-   Средства разработки Интернета  
  
-   Shell  
  
 Обработчики скриптов Windows можно разработать для любого языка или среды выполнения, включая:  
  
-   Microsoft Visual Basic Scripting edition \(VBScript\)  
  
-   Perl  
  
-   Lisp  
  
 Обеспечивает реализацию из узла, как можно гибкость, программа\-оболочка ole\-автоматизации для скриптов Windows предоставляются для.  Однако узел, который использует этот объект оболочки для создания обработчика сценариев не имеет объем контроля над времени выполнения пространством имен модели, сохранения и т д, что, если она использовала скрипт Windows напрямую.  
  
 Разработка скриптов Windows отделяет элементы интерфейса необходима только при создании среды в так, nonauthoring узлы \(например, браузеры и просмотр\) и обработчики скриптов \(например, VBScript\) можно сохранить упрощенным.  
  
## Базовая архитектура скриптов Windows  
 На следующем рисунке показано взаимодействие между средством обработки сценариев Windows и обработчиком скриптов Windows.  
  
 Действия, необходимых для взаимодействия между узлом и обработчиком встречающиеся в следующем списке.  
  
1.  Создайте проект.  Узел загружает проект или документ.  \(Этот шаг не определен в скрипт Windows включен, но здесь для полноты\).  
  
2.  Создайте обработчик скриптов Windows.  Узел вызывает метод `CoCreateInstance`, чтобы создать обработчик скриптов нового окна, указав идентификатор класса \(CLSID\) определенного обработчика скриптов для использования.  Например, html\-браузер Internet Explorer получает идентификатор класса обработчика скриптов через атрибут CLSID\= тегов HTML \<OBJECT\>.  
  
3.  Загрузите скрипт.  Если содержимое скрипта были сохраняются, то узел вызывает метод `IPersist*::Load` обработчика скриптов, чтобы предоставить ему хранилище, поток или контейнер свойств скрипта.  В противном случае узел использует `IPersist*::InitNew` или метод [IActiveScriptParse::InitNew](../winscript/reference/iactivescriptparse-initnew.md), чтобы создать скрипт NULL.  Узел, который поддерживает скрипт как текст может использовать [IActiveScriptParse::ParseScriptText](../winscript/reference/iactivescriptparse-parsescripttext.md), чтобы вставить обработчик скриптов текст скрипта, после вызова метода `IActiveScriptParse::InitNew`.  
  
4.  Добавление элементов с именем.  Для каждого именованного элемента высшего уровня \(например, формы и страницы\) в импортированного пространства имен обработчика скриптов, основное приложение вызывает метод [IActiveScript::AddNamedItem](../winscript/reference/iactivescript-addnameditem.md) для создания записи в пространстве имен обработчика.  Этот шаг не является обязательным, если высшего уровня именованные элементы уже частью постоянного состояния скрипта, загруженного в шаге 3.  Узел не использует `IActiveScript::AddNamedItem` для добавления элементов в двух подуровнем \(такие как элементы управления на странице HTML\); вместо этого обработчик косвенно получает элементы из подуровня высшего уровня элемента с помощью интерфейсов `ITypeInfo` и `IDispatch` узла.  
  
5.  Запустите скрипт.  Узел вызывает обработчик запуска скрипта, установив флажок SCRIPTSTATE\_CONNECTED в методе [IActiveScript::SetScriptState](../winscript/reference/iactivescript-setscriptstate.md).  Этот вызов может запускать как любой строительство обработчика скриптов, включая статическое связывание, до отсечение событий \(см. ниже\), и выполнить код в так же, написанной функции `main()`.  
  
6.  Получает данные элемента.  Каждый раз, когда обработчик скриптов необходимо связать символ с высшего уровня элемента, он вызывает метод [IActiveScriptSite::GetItemInfo](../winscript/reference/iactivescriptsite-getiteminfo.md), который возвращает сведения о заданного элемента.  
  
7.  Подключение событий.  Перед запуском фактический скрипт, обработчик скриптов подключиться к событиям всех соответствующих объектов с помощью интерфейса `IConnectionPoint`.  
  
8.  Вызов значения свойства и методы.  По мере того, как выполняются скрипты, обработчик скриптов осуществляет ссылки к методам и свойствам именованных объектов с помощью `IDispatch::Invoke` или другие стандартные механизмы привязки OLE.  
  
## Скрипт термин Windows  
 Этот список содержит определения scripting\- связанных терминов, используемых в этом документе.  
  
|Термин|Определение|  
|------------|-----------------|  
|Объект кода|Созданный экземпляр обработчиком скриптов, связанный с именованный элемент, такой как модуль за пределами формы в Visual Basic, или класс A.C, C\-\+\+, связанный с именованным элементом.  Предпочтительнее, это объект \(COM\) модели COM OLE, поддерживающий ole\-автоматизации, поэтому узел или другую сущность не скрипта может управлять объект кода.|  
|Именованный элемент|OLE COM\-объект \(предпочтительно \- это функция, которая поддерживает ole\-автоматизацией\), узел считает интересным в скрипт.  Примеры включают html\-страница и браузер в веб\-браузере, документ и диалоговые окна в Microsoft Word.|  
|Скрипт|Данные, которые составляют программу, обработчик скриптов выполняется.  Скрипт может быть всеми соседями и исполнительными данными, включая элементы текста, блоков `pcode`, или даже кодов компьютера, исполняемых;.  Узел загружает скрипт в обработчик сценариев через один из интерфейсов `IPersist*` или через интерфейс [IActiveScriptParse](../winscript/reference/iactivescriptparse.md).|  
|Обработчик скриптов|Объект OLE, скрипты процессов.  Обработчик скриптов реализует интерфейсы [IActiveScript](../winscript/reference/iactivescript.md) и, при необходимости, [IActiveScriptParse](../winscript/reference/iactivescriptparse.md).|  
|Сценарии узел|Приложение или программы с обработчик скриптов Windows.  Узел реализует интерфейсы [IActiveScriptSite](../winscript/reference/iactivescriptsite.md) и, при необходимости, [IActiveScriptSiteWindow](../winscript/reference/iactivescriptsitewindow.md).|  
|Сценарий|Часть скрипта, который получает подключенным к объекту через интерфейс [IActiveScriptParse](../winscript/reference/iactivescriptparse.md).  Статистическая коллекция сценариев скрипт.|  
|Язык скрипта|Язык, на котором написан скрипт \(например, VBScript\) и семантика этого языка.|  
  
## См. также  
 [Windows Script Interfaces](../winscript/windows-script-interfaces.md)