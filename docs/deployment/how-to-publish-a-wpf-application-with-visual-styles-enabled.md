---
title: 'Как: публикация приложения WPF с включенными визуальными стилями | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology: vs-ide-deployment
ms.topic: conceptual
ms.assetid: 73b22b02-fc75-42aa-82d3-51fdcaf8e5c8
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: 0111226fdd3de300265f69930b7e9e56f90876c8
ms.sourcegitcommit: 1b9c1e333c2f096d35cfc77e846116f8e5054557
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/06/2018
ms.locfileid: "34816020"
---
# <a name="how-to-publish-a-wpf-application-with-visual-styles-enabled"></a>Практическое руководство. Публикация приложения WPF с включенными визуальными стилями
Визуальные стили включить внешний стандартных элементов управления, изменяются в зависимости от выбранного пользователем темы. По умолчанию визуальные стили не включен для приложений Windows Presentation Foundation (WPF), поэтому их необходимо включить вручную. Тем не менее Включение визуальные стили для приложения WPF и затем Публикация решения приведет к ошибке. Описывается, как устранить эту ошибку и процесс для публикации приложения WPF с включенными визуальными стилями. Дополнительные сведения о стилях см. в разделе [наглядный обзор стили](http://msdn.microsoft.com/5b5d7bb6-684f-478d-bf5f-b8d18bbcff2e). Дополнительные сведения об этой ошибке см. в разделе [Устранение конкретных ошибок в развертываниях ClickOnce](../deployment/troubleshooting-specific-errors-in-clickonce-deployments.md).  
  
 Чтобы устранить эту ошибку и опубликовать решение, необходимо выполнить следующие задачи:  
  
-   [Публикация решения без включенными визуальными стилями](#BKMK_publishsolwovs).  
  
-   [Создать файл манифеста](#BKMK_CreateManifest).  
  
-   [Внедрять файл манифеста в исполняемый файл опубликованного решения](#BKMK_embedmanifest).  
  
-   [Подписывать манифесты приложения и развертывания](#BKMK_signappdeplyman).  
  
 Затем можно переместить опубликованных файлов в расположение, из которого требуется конечным пользователям для установки приложения.  
  
##  <a name="BKMK_publishsolwovs"></a> Публикация решения без включенными визуальными стилями  
  
1.  Убедитесь, что проект не имеет включенными визуальными стилями. Во-первых Проверьте файл манифеста проекта следующий XML-код. Затем при наличии XML заключите в тег комментария XML.  
  
     По умолчанию не включены визуальные стили.  
  
    ```xml  
    <dependency>    <dependentAssembly>      <assemblyIdentity          type="win32"          name="Microsoft.Windows.Common-Controls"          version="6.0.0.0"          processorArchitecture="*"          publicKeyToken="6595b64144ccf1df"          language="*"        />    </dependentAssembly>  </dependency>  
    ```  
  
     Следующие процедуры показывают, как открыть файл манифеста, связанный с проектом.  
  
    ###### <a name="to-open-the-manifest-file-in-a-visual-basic-project"></a>Чтобы открыть файл манифеста в проекте Visual Basic  
  
    1.  В строке меню выберите **проекта**, * имя_проекта ***свойства**, где *ProjectName* имя проекта WPF.  
  
         Отображаются страницы свойств для проекта WPF.  
  
    2.  На **приложения** выберите **параметры представления Windows**.  
  
         Открывает файл app.manifest в **редактор кода**.  
  
    ###### <a name="to-open-the-manifest-file-in-a-c-project"></a>Чтобы открыть файл манифеста в проектах C#  
  
    1.  В строке меню выберите **проекта**, * имя_проекта ***свойства**, где *ProjectName* имя проекта WPF.  
  
         Отображаются страницы свойств для проекта WPF.  
  
    2.  На **приложения** вкладки, запомните имя, которое отображается в поле манифеста. Это имя манифеста, связанный с проектом.  
  
        > [!NOTE]
        >  Если **внедрить манифест с настройками по умолчанию** или **создать приложение без манифеста** отображаются в поле манифеста не включены визуальные стили. Если имя файла манифеста, отображается в поле манифеста, перейдите к следующему шагу в этой процедуре.  
  
    3.  В **обозревателе решений**, выберите **Показать все файлы** ().  
  
         Эта кнопка показывает все элементы проекта, включая те, которые были исключены и те, которые обычно скрыты. Файл манифеста представляется как элемент проекта.  
  
2.  Постройте и публикации решения. Дополнительные сведения о том, как опубликовать решение см. в разделе [как: публикация приложения ClickOnce с использованием мастера публикации](../deployment/how-to-publish-a-clickonce-application-using-the-publish-wizard.md).  
  
##  <a name="BKMK_CreateManifest"></a> Создать файл манифеста  
  
1.  Вставьте следующий XML-код в файл блокнота.  
  
     Этот XML-документ описывает сборку, содержащую элементы управления, поддерживающие визуальных стилей.  
  
    ```xml  
    <?xml version="1.0" encoding="utf-8"?><asmv1:assembly manifestVersion="1.0"                xmlns="urn:schemas-microsoft-com:asm.v1"                xmlns:asmv1="urn:schemas-microsoft-com:asm.v1"                xmlns:asmv2="urn:schemas-microsoft-com:asm.v2"                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">  <dependency>    <dependentAssembly>      <assemblyIdentity        type="win32"        name="Microsoft.Windows.Common-Controls"        version="6.0.0.0"        processorArchitecture="*"        publicKeyToken="6595b64144ccf1df"        language="*"        />    </dependentAssembly>  </dependency></asmv1:assembly>  
    ```  
  
2.  В «блокноте» щелкните **файл**, а затем нажмите кнопку **Сохранить как**.  
  
3.  В **Сохранить как** диалогового **тип** раскрывающемся списке выберите **все файлы**.  
  
4.  В **имя файла** введите имя файла и добавления **.manifest** в конец имени файла. Например: **themes.manifest**.  
  
5.  Выберите **Обзор папок** , выберите любую папку и нажмите кнопку **Сохранить**.  
  
    > [!NOTE]
    >  Остальных процедур предполагается, что этот файл имеет имя **themes.manifest** и что файл сохраняется в каталоге C:\temp на компьютере.  
  
##  <a name="BKMK_embedmanifest"></a> Внедрять файл манифеста в исполняемый файл опубликованного решения  
  
1.  Откройте **командную строку Visual Studio**.  
  
     Дополнительные сведения о том, как открыть **командной строки Visual Studio**, в разделе [командные строки](/dotnet/framework/tools/developer-command-prompt-for-vs).  
  
    > [!NOTE]
    >  Оставшиеся шаги сделать следующие решения:  
    >   
    >  -   Имя решения — **MyWPFProject**.  
    > -   Решение находится в следующем каталоге: `%UserProfile%\Documents\Visual Studio 2010\Projects\`.  
    >   
    >      Решение публикуется в следующий каталог: `%UserProfile%\Documents\Visual Studio 2010\Projects\publish`.  
    > -   Самую последнюю версию файлов опубликованное приложение находится в следующем каталоге: `%UserProfile%\Documents\Visual Studio 2010\Projects\publish\Application Files\WPFApp_1_0_0_0`  
    >   
    >  Необходимо использовать имя или расположение каталогов, описанных выше. Имя и расположение, описанных выше, используются только для иллюстрации шагов, необходимых для публикации решения.  
  
2.  В командной строке измените путь в каталог, содержащий последнюю версию файлов опубликованного приложения. В следующем примере показано здесь.  
  
    ```  
cd "%UserProfile%\Documents\Visual Studio 2010\Projects\MyWPFProject\publish\Application Files\WPFApp_1_0_0_0"  
    ```  
  
3.  В командной строке выполните следующую команду для внедрения в файл манифеста в исполняемый файл приложения.  
  
    ```
    mt -manifest c:\temp\themes.manifest -outputresource:MyWPFApp.exe.deploy  
    ```  
  
##  <a name="BKMK_signappdeplyman"></a> Подписывать манифесты приложения и развертывания  
  
1.  В командной строке выполните следующую команду для удаления `.deploy` расширения из исполняемого файла в текущем каталоге.  
  
    ```  
    ren MyWPFApp.exe.deploy MyWPFApp.exe  
    ```  
  
    > [!NOTE]
    >  В этом примере предполагается, что только один файл имеет `.deploy` расширение имени файла. Убедитесь, что переименования все файлы в этом каталоге, имеющих `.deploy` расширение имени файла.  
  
2.  В командной строке выполните следующую команду для подписания манифеста приложения.  
  
    ```  
    mage -u MyWPFApp.exe.manifest -cf ..\..\..\MyWPFApp_TemporaryKey.pfx  
    ```  
  
    > [!NOTE]
    >  В этом примере предполагается, что подписи манифеста с помощью `.pfx` файла проекта. Если не являются подписи манифеста, можно опустить `-cf` параметр, используемый в этом примере. Если подписи манифеста с помощью сертификата, для которого требуется пароль, укажите `-password` параметр (`For example: mage -u MyWPFApp.exe.manifest -cf ..\..\..\MyWPFApp_TemporaryKey.pfx - password Password`).  
  
3.  В командной строке выполните следующую команду для добавления `.deploy` расширение имени файла, который был переименован в предыдущем шаге этой процедуры.  
  
    ```  
    ren MyWPFApp.exe MyWPFApp.exe.deploy  
    ```  
  
    > [!NOTE]
    >  В этом примере предполагается, что только один файл имел `.deploy` расширение имени файла. Убедитесь, что переименования все файлы в этом каталоге, который ранее был `.deploy` расширение имени файла.  
  
4.  В командной строке выполните следующую команду для подписания манифеста развертывания.  
  
    ```  
    mage -u ..\..\MyWPFApp.application -appm MyWPFApp.exe.manifest -cf ..\..\..\MyWPFApp_TemporaryKey.pfx  
    ```  
  
    > [!NOTE]
    >  В этом примере предполагается, что подписи манифеста с помощью `.pfx` файла проекта. Если не являются подписи манифеста, можно опустить `-cf` параметр, используемый в этом примере. Если подписи манифеста с помощью сертификата, для которого требуется пароль, укажите `-password` параметра, как показано в примере:`For example: mage -u MyWPFApp.exe.manifest -cf ..\..\..\MyWPFApp_TemporaryKey.pfx - password Password`.  
  
 После выполнения этих шагов опубликованных файлов можно переместить в расположение, из которого требуется конечным пользователям для установки приложения. Если вы собираетесь обновить решение часто, можно переместить эти команды в сценарий и запустите скрипт при каждой публикации новой версии.  
  
## <a name="see-also"></a>См. также  
 [Устранение неполадок определенным ошибкам в развертываниях ClickOnce](../deployment/troubleshooting-specific-errors-in-clickonce-deployments.md)   
 [Общие сведения о визуальных стилей](http://msdn.microsoft.com/5b5d7bb6-684f-478d-bf5f-b8d18bbcff2e)   
 [Включение визуальных стилей](https://msdn.microsoft.com/library/bb773175.aspx)   
 [Командные строки](/dotnet/framework/tools/developer-command-prompt-for-vs)