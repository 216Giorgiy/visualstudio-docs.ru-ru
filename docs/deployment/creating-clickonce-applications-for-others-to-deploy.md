---
title: Создание приложений ClickOnce для других пользователей для развертывания | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology: vs-ide-deployment
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
helpviewer_keywords:
- preserved branding information
- useManifestForTrust element
- customer deployments [ClickOnce]
- multiple ClickOnce deployment and branding
- ClickOnce applications, previous .NET Framework versions
- application manifests [ClickOnce]
- <useManifestForTrust> element
- manifests [ClickOnce]
- trust applications, ClickOnce
- ClickOnce applications, deployed by others
- ClickOnce applications, previous .NET Framework
ms.assetid: d20766c7-4ef3-45ab-8aa0-3f15b61eccaa
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: cd6808ac38a67146e53438e5b8f6dc0e07fd0bc5
ms.sourcegitcommit: 046a9adc5fa6d6d05157204f5fd1a291d89760b7
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/11/2018
ms.locfileid: "34065082"
---
# <a name="creating-clickonce-applications-for-others-to-deploy"></a>Создание приложений ClickOnce для развертывания другими
Не все разработчики, создающие развертывания ClickOnce планируется развертывать приложения сами. Многие из них просто упаковывают свое приложение с помощью ClickOnce и затем передают файлы клиенту, например большой корпорации. Клиент становится ответственным за размещение приложения в своей сети. В этом разделе рассматриваются некоторые из проблем, возникающих в этих развертываниях в версиях .NET Framework, предшествующих версии 3.5. Затем он описывает новое решение, предоставляемое с помощью новой функции «использовать манифест для доверия» в .NET Framework 3.5. В заключение приводятся рекомендуемые стратегии создания развертываний ClickOnce для клиентов, которые по-прежнему использовать старые версии платформы .NET Framework.  
  
## <a name="issues-involved-in-creating-deployments-for-customers"></a>Вопросы, связанные с созданием развертываний для клиентов  
 При планировании поставки развертывания клиенту возникает несколько вопросов. Первый вопрос касается подписания кода. Для развертывания по сети, манифест развертывания и манифест приложения для развертывания ClickOnce должны оба быть подписаны цифровым сертификатом. В связи с этим возникает вопрос, следует ли использовать сертификат разработчика или сертификат клиента при подписании манифестов.  
  
 На вопрос: какой использовать сертификат является обязательным, как приложение ClickOnce основано на цифровой подписи манифеста развертывания. Если разработчик подписывает манифест развертывания, он может привести к конфликту, если клиента большой компании, и в нескольких подразделениях компании развертывается настроенную версию приложения.  
  
 Например предположим, что Adventure Works имеет финансовый отдел и отдел кадров. Оба отдела лицензируют приложение ClickOnce от корпорации Майкрософт, которое создает отчеты из данных, хранящихся в базе данных SQL. Корпорация Майкрософт предоставляет каждый отдел версию приложения, настроенные для своих данных. Если приложения подписаны с помощью сертификата Authenticode, пользователь, который пытается использовать оба приложения столкнется с ошибкой, как ClickOnce будет считать второе приложение идентична первой. В этом случае клиент может снизиться непредсказуемыми и нежелательные побочные эффекты, которые включают потерю данные, хранящиеся локально в приложении.  
  
 Дополнительную проблему, связанную с подписанием кода — `deploymentProvider` элемента в манифесте развертывания, который сообщает ClickOnce, где искать обновления приложения. Этот элемент должен быть добавлен в манифест развертывания до его подписания. Если этот элемент будет добавлен позже, необходимо заново подписать манифест развертывания.  
  
### <a name="requiring-the-customer-to-sign-the-deployment-manifest"></a>Требование для подписания манифеста развертывания клиента  
 Единственное решение этой проблемы неуникальных развертываний — разработчик подписывал манифест приложения, а клиент подписать манифест развертывания. Хотя этот подход работает, он вводит других проблем. Так как сертификат Authenticode должен оставаться защищенным активом, клиент не может просто дать сертификат разработчику для подписания развертывания. Хотя клиент может подписать манифест развертывания самостоятельно с помощью бесплатных средств с .NET Framework SDK, это может потребовать больше технических знаний, чем пойти или может предоставить клиенту. В таких случаях разработчик обычно создает приложение, веб-сайт или другой механизм, через который клиент может передать свою версию приложения для подписания.  
  
### <a name="the-impact-of-customer-signing-on-clickonce-application-security"></a>Влияние подписания клиентом на безопасность приложения ClickOnce  
 Даже если разработчик и клиент согласны, что клиент должен подписывать манифест приложения, это вызывает другие вопросы, которые касаются удостоверения приложения, особенно в том случае, если он применяется для развертывания надежных приложений. (Дополнительные сведения об этой функции см. в разделе [Trusted Application Deployment Overview](../deployment/trusted-application-deployment-overview.md).) Предположим, что Adventure Works хочет настроить свои клиентские компьютеры, чтобы любое приложение, предоставляемое корпорацией Майкрософт выполняется с полным доверием. Если Adventure Works подписывает манифест развертывания, ClickOnce будет использовать подпись безопасности рабочих Adventure определить уровень доверия приложения.  
  
## <a name="creating-customer-deployments-by-using-application-manifest-for-trust"></a>Создание клиентских развертываний с помощью манифеста приложения для доверия  
 Технология ClickOnce в .NET Framework 3.5 содержит новый компонент, который предоставляет разработчикам и клиентам новое решение для сценария как манифесты должны быть подписаны. Манифест приложения ClickOnce поддерживает новый элемент с именем `<useManifestForTrust>` , позволяющий разработчику Показать, что цифровая подпись манифеста приложения является то, что следует использовать для принятия решений о доверии. Разработчик использует средства упаковки ClickOnce — например Mage.exe, MageUI.exe и Visual Studio — для включения этого элемента в манифесте приложения, а также для внедрения в манифест имени издатели и имя приложения.  
  
 При использовании `<useManifestForTrust>`, манифест развертывания не должен быть подписан с помощью сертификата Authenticode, выданный центром сертификации. Вместо этого он может быть подписан как самозаверяющий сертификат. Самозаверяющий сертификат создается клиентом или разработчиком с помощью стандартных средств .NET Framework SDK и затем применяется к манифесту развертывания с помощью стандартных средств развертывания ClickOnce. Дополнительные сведения см. в разделе [MakeCert](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx).  
  
 С помощью самозаверяющего сертификата для манифеста развертывания представляет несколько преимуществ. Устраняя необходимость для клиента, чтобы получить или создать свой собственный сертификат Authenticode `<useManifestForTrust>` упрощает развертывание для клиента, при этом разрешая разработчику сохранять свой фирменный в приложении. Результат — это набор подписанных развертываний, которые являются более безопасными и имеют уникальные удостоверения приложений. Это устраняет потенциальный конфликт, который может возникнуть при развертывании одного приложения для нескольких клиентов.  
  
 Пошаговые инструкции о способах создания развертывания ClickOnce с `<useManifestForTrust>` включен, в разделе [Пошаговое руководство: развертывание вручную приложения ClickOnce, Does не требуют Re-Signing и что сохраняет сведения об](../deployment/walkthrough-manually-deploying-a-clickonce-app-no-re-signing-required.md).  
  
### <a name="how-application-manifest-for-trust-works-at-runtime"></a>Манифеста приложения для доверия работает во время выполнения  
 Чтобы получить лучшее представление о принципах работы с помощью манифеста приложения для доверия во время выполнения, рассмотрим следующий пример. Приложения ClickOnce, ориентированном на .NET Framework 3.5 создается корпорацией Майкрософт. Манифест приложения использует `<useManifestForTrust>` элемент и подписываемых Microsoft. Adventure Works подписывает манифест развертывания, используя самозаверяющий сертификат. Adventure Works, настроенные на доверие любому приложению, подписанные Майкрософт.  
  
 Когда пользователь щелкает ссылку на манифест развертывания, ClickOnce устанавливает приложение на компьютере пользователя. Сведения о сертификатах и развертывания определить однозначно приложения ClickOnce на клиентском компьютере. Если пользователь пытается установить то же приложение еще раз из другого места, ClickOnce можно использовать это удостоверение для определения того, что приложение уже существует на стороне клиента.  
  
 Далее ClickOnce проверяет сертификат Authenticode, используемого для подписания манифеста приложения, который определяет уровень доверия, предоставляемый службой ClickOnce. Поскольку клиенты на доверие любому приложению, подписанные Майкрософт сконфигурированы Adventure Works, это приложение ClickOnce предоставляется полное доверие. Для получения дополнительной информации см. [Trusted Application Deployment Overview](../deployment/trusted-application-deployment-overview.md).  
  
## <a name="creating-customer-deployments-for-earlier-versions"></a>Создание клиентских развертываний для более ранних версий  
 Что делать, если разработчик выполняет развертывание приложения ClickOnce для заказчиков, использующих более старых версий .NET Framework? В следующих разделах приведены рекомендуемые решения, а также преимущества и недостатки каждого.  
  
### <a name="sign-deployments-on-behalf-of-customer"></a>Подписание развертываний от имени клиента  
 Одна возможная стратегия развертывания предназначена для разработчиков для создания механизма подписания развертываний от лица своих клиентов с помощью клиента собственный закрытый ключ. Это предотвращает разработчика от необходимости управление закрытыми ключами или несколькими пакетами развертывания. Разработчик просто предоставляет же развертывания для каждого клиента. Именно клиента для его настройки с помощью службы подписей для своей среды.  
  
 Недостатком этого метода является время и затраты, необходимые для его реализации. Хотя такая служба может быть собран с помощью средств, предоставляемых в .NET Framework SDK, он добавляет больше времени разработки для жизненного цикла продукта.  
  
 Как отмечалось ранее в этом разделе, другим недостатком является то, что версия приложения для каждого клиента одинаковое удостоверение приложения, может привести к конфликтам. Если это критично, разработчик может изменить имя поля, используемый при создании манифеста развертывания для Задайте уникальное имя для каждого приложения. Будет создан отдельный идентификатор для каждой версии приложения и исключить любые потенциальные конфликты идентичности. В этом поле соответствует `-Name` аргумент для Mage.exe, а также **имя** на **имя** вкладку в MageUI.exe.  
  
 Например предположим, что разработчик создал приложение с именем Application1. Вместо создания одного развертывания с полем имени, значение Application1, разработчик может создать несколько развертываний с вариантом заказчика это имя, например Application1-CustomerA Application1-КлиентБ и так далее.  
  
### <a name="deploy-using-a-setup-package"></a>Развертывание с помощью пакета установки  
 Вторая возможная стратегия развертывания является создание проекта установки Microsoft для выполнения начального развертывания приложения ClickOnce. Это могут быть предоставлены в одном из нескольких разных форматов: как MSI-развертывание, как исполняемый файл установки (. (EXE), или в виде CAB-файла вместе с пакетной.  
  
 При использовании этого метода разработчик предоставляет клиенту развертывание, которое содержит файлы приложения, манифест приложения и манифест развертывания, который служит в качестве шаблона. Клиент будет запустите программу установки, которая запрашивает URL-адрес развертывания (сервера или общего файлового ресурса расположение, откуда пользователи будут устанавливать приложение ClickOnce), а также цифровой сертификат. Программа установки также может запрашивать дополнительные параметры конфигурации ClickOnce, например интервал проверки обновлений. После этого данные собираются, программа установки создать реальный манифест развертывания, подписать его и публикация приложения ClickOnce в указанное местоположение на сервере.  
  
 Существует три способа, что клиент может подписать манифест развертывания в этой ситуации:  
  
1.  Клиент может использовать действительный сертификат, выпущенный центром сертификации (ЦС).  
  
2.  В качестве варианта этого подхода клиент может выбрать подписание своего манифеста развертывания самозаверяющий сертификат. Это недостаток заключается в это вызовет приложения для отображения слова «Неизвестный издатель», когда пользователь должен указать, следует ли устанавливать его. Однако преимущество заключается в предотвращении небольших клиентов от необходимости тратить время и деньги на сертификат, выданный центром сертификации.  
  
3.  Наконец разработчик может включить свой собственный самозаверяющий сертификат в пакет установки. При этом возникнет потенциальных проблем с удостоверением приложения, рассмотренных ранее в этом разделе.  
  
 Недостаток при использовании метода установки развертывания проекта — время, а также затраты, необходимые для построения настраиваемого приложения развертывания.  
  
### <a name="have-customer-generate-deployment-manifest"></a>У клиента создание манифеста развертывания  
 Третья возможная стратегия развертывания отключено отдать только файлы приложения и манифест приложения для клиента. В этом сценарии клиент несет ответственность за использование .NET Framework SDK для создания и подписания манифеста развертывания.  
  
 Недостаток этого метода является необходимость клиента необходимо установить средства .NET Framework SDK и иметь разработчик или системный администратор, квалифицированный на их использование. Некоторые клиенты могут запросить решение, которое требует почти никаких технических усилий с их стороны.  
  
## <a name="see-also"></a>См. также  
 [Развертывание приложений ClickOnce для тестирования и рабочих серверов без повторного подписывания](../deployment/deploying-clickonce-applications-for-testing-and-production-without-resigning.md)   
 [Пошаговое руководство. Развертывание вручную приложения ClickOnce](../deployment/walkthrough-manually-deploying-a-clickonce-application.md)   
 [Пошаговое руководство. Развертывание вручную приложения ClickOnce, которое не нуждается в повторном подписывании и сохраняет фирменную символику](../deployment/walkthrough-manually-deploying-a-clickonce-app-no-re-signing-required.md)