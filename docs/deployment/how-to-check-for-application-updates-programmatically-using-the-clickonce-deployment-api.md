---
title: "Практическое руководство. Проверка обновлений для приложения программным способом с помощью функций API развертывания технологии ClickOnce | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-deployment"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
helpviewer_keywords: 
  - "обновления приложений"
  - "развертывание ClickOnce, обновления"
ms.assetid: 1a886310-67c8-44e5-a382-c2f0454f887d
caps.latest.revision: 9
caps.handback.revision: 9
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# Практическое руководство. Проверка обновлений для приложения программным способом с помощью функций API развертывания технологии ClickOnce
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Технология ClickOnce предоставляет два способа обновления приложения после его развертывания.  В первом способе можно настроить развертывание технологии ClickOnce для автоматической проверки обновлений через определенные периоды времени.  Во втором способе можно написать программный код, который использует класс <xref:System.Deployment.Application.ApplicationDeployment> для проверки обновлений на основе события, такого как запрос пользователя.  
  
 В следующих процедурах показан код для выполнения программного обновления, а также описывается настройка развертывания ClickOnce для обеспечения проверок программных обновлений.  
  
 Чтобы обновлять приложение ClickOnce программно, следует задать местоположение для обновлений.  Эта процедура иногда упоминается как поставщик развертывания.  Дополнительные сведения о задании этого свойства см. в разделе [Выбор стратегии обновления ClickOnce](../deployment/choosing-a-clickonce-update-strategy.md).  
  
> [!NOTE]
>  Для развертывания приложения из одного места и обновления его из другого места можно также использовать метод, описываемый ниже.  Дополнительные сведения см. в разделе [Практическое руководство. Задание альтернативного местоположения для обновлений развертывания](../deployment/how-to-specify-an-alternate-location-for-deployment-updates.md).  
  
### Проверка наличия обновлений программным способом  
  
1.  Создайте новое приложение Windows Forms с помощью командной строки или предпочитаемых визуальных средств.  
  
2.  Создайте на свой выбор кнопку, пункт меню или любой другой элемент пользовательского интерфейса, с помощью которого пользователи будут выбирать проверку обновлений.  Чтобы проверить и установить обновления, из обработчика событий для этого элемента вызовите следующий метод.  
  
     [!CODE [ClickOnceAPI#6](../CodeSnippet/VS_Snippets_Winforms/ClickOnceAPI#6)]  
  
3.  Скомпилируйте используемое приложение.  
  
### Использование программы Mage.exe для развертывания приложения, которое программно проверяет наличие обновлений  
  
-   Следуйте инструкциям по развертыванию приложения с помощью программы Mage.exe в соответствии с их описанием в разделе [Разбор примера: развертывание вручную приложения ClickOnce](../deployment/walkthrough-manually-deploying-a-clickonce-application.md).  При вызове программы Mage.exe для создания манифеста развертывания следует использовать параметр `providerUrl` командной строки и необходимо указать URL\-адрес, где приложение ClickOnce должно проверять наличие обновлений.  Например, если приложение будет обновляться с веб\-узла [http:\/\/www.microsoft.com\/ru\/ru\/default.aspx](http://www.microsoft.com/ru/ru/default.aspx), вызов для создания манифеста развертывания мог бы выглядеть следующим образом:  
  
    ```  
    mage -New Deployment -ToFile WindowsFormsApp1.application -Name "My App 1.0" -Version 1.0.0.0 -AppManifest 1.0.0.0\MyApp.manifest -providerUrl http://www.adatum.com/MyApp/MyApp.application  
    ```  
  
### Использование MageUI.exe для развертывания приложения, которое проверяет наличие обновлений программным способом  
  
-   Следуйте инструкциям по развертыванию приложения с помощью программы Mage.exe в соответствии с их описанием в разделе [Разбор примера: развертывание вручную приложения ClickOnce](../deployment/walkthrough-manually-deploying-a-clickonce-application.md).  На вкладке **Параметры развертывания** установите значение поля **Начальное местоположение** равным манифесту приложения, который должен проверяться с помощью ClickOnce на наличие обновлений.  На вкладке **Параметры обновления** снимите флажок **Приложение должно проверять обновления**.  
  
## Безопасность платформы .NET Framework  
 Для использования программного обновления приложение должно иметь разрешения полного доверия.  
  
## См. также  
 [Практическое руководство. Задание альтернативного местоположения для обновлений развертывания](../deployment/how-to-specify-an-alternate-location-for-deployment-updates.md)   
 [Выбор стратегии обновления ClickOnce](../deployment/choosing-a-clickonce-update-strategy.md)   
 [Публикация ClickOnce\-приложений](../deployment/publishing-clickonce-applications.md)