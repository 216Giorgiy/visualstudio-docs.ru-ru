---
title: 'Разбор примера: Развертывание вручную приложения ClickOnce, которая не требует повторного подписывания и которое сохраняет фирменную символику | Документы Microsoft'
ms.custom: ''
ms.date: 11/04/2016
ms.technology: vs-ide-deployment
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- C++
helpviewer_keywords:
- branding
- preserved branding information
- ClickOnce deployment, manually
- multiple ClickOnce deployment and branding
- ClickOnce deployment, SDK tools
- customer deployments
- manual ClickOnce deployments
- manifests [ClickOnce]
- ClickOnce applications, deployed by others
ms.assetid: c21822fb-d4ee-42e4-b72d-41ee9786efe5
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: cb4838e44549f762e609913c92d677832d897edb
ms.sourcegitcommit: 42ea834b446ac65c679fa1043f853bea5f1c9c95
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/19/2018
---
# <a name="walkthrough-manually-deploying-a-clickonce-application-that-does-not-require-re-signing-and-that-preserves-branding-information"></a>Пошаговое руководство. Развертывание вручную приложения ClickOnce, которое не нуждается в повторном подписывании и которое сохраняет фирменную символику
При создании [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложения и последующей передачи его клиенту для публикации и развертывания, клиент традиционно должен был обновить манифест развертывания и подписать его заново. Хотя это по-прежнему предпочтительный метод в большинстве случаев, .NET Framework 3.5 позволяет создавать [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] развертывания, которые могут развертываться клиентами без необходимости повторного создания нового манифеста развертывания. Дополнительные сведения см. в разделе [развертывание ClickOnce приложения для тестирования и рабочих серверов без Resigning](../deployment/deploying-clickonce-applications-for-testing-and-production-servers-without-resigning.md).  
  
 При создании [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложения и последующей передачи его клиенту для публикации и развертывания, приложение может использовать торговую марку клиента или сохранять свою фирменную. Например если приложение является одиночным фирменным приложением, можно сохранять стиль компании. Если приложение высокой настроек для каждого клиента, может потребоваться использовать торговую марку клиента. .NET Framework 3.5 позволяет сохранять стиль компании, сведения об издателе и подпись безопасности при передаче приложения для развертывания в организации. Дополнительные сведения см. в разделе [создание приложений ClickOnce для других пользователей к развертыванию](../deployment/creating-clickonce-applications-for-others-to-deploy.md).  
  
> [!NOTE]
>  В этом пошаговом руководстве создается развертывания вручную с помощью средства командной строки Mage.exe или графического средства MageUI.exe. Дополнительные сведения о развертывания вручную см. в разделе [Пошаговое руководство: развертывание вручную приложения ClickOnce](../deployment/walkthrough-manually-deploying-a-clickonce-application.md).  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения шагов в этом пошаговом руководстве необходимо следующее:  
  
-   Приложение Windows Forms, вы готовы к развертыванию. Это приложение будет называться WindowsFormsApp1.  
  
-   Visual Studio или Windows SDK.  
  
### <a name="to-deploy-a-clickonce-application-with-multiple-deployment-and-branding-support-using-mageexe"></a>Развертывание ClickOnce-приложения с поддержкой фирменной символики, с помощью Mage.exe нескольких развертываний и  
  
1.  Откройте командную строку Visual Studio или [!INCLUDE[winsdkshort](../debugger/debug-interface-access/includes/winsdkshort_md.md)] командную строку и перейдите в каталог, в котором будут храниться вашей [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] файлов.  
  
2.  Создайте каталог с именем текущей версии развертывания. Если это первый раз, которое выполняется развертывание приложения, скорее всего будет выбрана **1.0.0.0**.  
  
    > [!NOTE]
    >  Версия развертывания может отличаться от версии файлов приложения.  
  
3.  Создайте подкаталог **bin** и скопируйте все файлы приложения, включая исполняемые файлы, сборки, ресурсы и файлы данных.  
  
4.  Создайте манифест приложения с помощью вызова Mage.exe.  
  
    ```  
    mage -New Application -ToFile 1.0.0.0\WindowsFormsApp1.exe.manifest -Name "Windows Forms App 1" -Version 1.0.0.0 -FromDirectory 1.0.0.0\bin -UseManifestForTrust true -Publisher "A. Datum Corporation"  
    ```  
  
5.  Подпишите манифест приложения с помощью цифрового сертификата.  
  
    ```  
    mage -Sign WindowsFormsApp1.exe.manifest -CertFile mycert.pfx  
    ```  
  
6.  Создайте манифест развертывания с помощью вызова Mage.exe. По умолчанию будут отмечены как Mage.exe вашей [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] развертывания как установленное приложение, так что он может выполняться как в интерактивном и в автономном режиме. Чтобы сделать приложение доступным только в том случае, если пользователь находится в оперативном режиме, используйте `-i` аргумент со значением `f`. Так как это приложение будет использовать средства развертывания нескольких, исключить `-providerUrl` аргумент Mage.exe. (В версиях .NET Framework, предшествующих версии 3.5, за исключением `-providerUrl` для автономного приложения приводит к ошибке.)  
  
    ```  
    mage -New Deployment -ToFile WindowsFormsApp1.application -Name "Windows Forms App 1" -Version 1.0.0.0 -AppManifest 1.0.0.0\WindowsFormsApp1.manifest   
    ```  
  
7.  Не подписания манифеста развертывания.  
  
8.  Предоставьте все файлы клиенту, который будет развернуть приложение в своей сети.  
  
9. На этом этапе клиент должен подписать манифест развертывания с его собственному самостоятельно сформированный сертификат. Например если клиент работает компания Adventure Works, он может создавать самозаверяющий сертификат, с помощью средства MakeCert.exe. После этого можно используйте средство Pvk2pfx.exe объединить файлы, созданные средством MakeCert.exe, в PFX-файл, который может быть передан в Mage.exe.  
  
    ```  
    makecert -r -pe -n "CN=Adventure Works" -sv MyCert.pvk MyCert.cer  
    pvk2pfx.exe -pvk MyCert.pvk -spc MyCert.cer -pfx MyCert.pfx  
    ```  
  
10. Затем клиент использует этот сертификат для подписания манифеста развертывания.  
  
    ```  
    mage -Sign WindowsFormsApp1.application -CertFile MyCert.pfx  
    ```  
  
11. Клиент развертывает приложение для своих пользователей.  
  
### <a name="to-deploy-a-clickonce-application-with-multiple-deployment-and-branding-support-using-mageuiexe"></a>Развертывание ClickOnce-приложения с поддержкой фирменной символики, с помощью MageUI.exe нескольких развертываний и  
  
1.  Откройте командную строку Visual Studio или [!INCLUDE[winsdkshort](../debugger/debug-interface-access/includes/winsdkshort_md.md)] командную строку и перейдите в каталог, в котором будут храниться вашей [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] файлов.  
  
2.  Создайте подкаталог **bin** и скопируйте все файлы приложения, включая исполняемые файлы, сборки, ресурсы и файлы данных.  
  
3.  Создайте подкаталог с именем текущей версии развертывания. Если это первый раз, которое выполняется развертывание приложения, скорее всего будет выбрана **1.0.0.0**.  
  
    > [!NOTE]
    >  Версия развертывания может отличаться от версии файлов приложения.  
  
4.  Переместить \\ **bin** каталога в каталог, созданный на шаге 2.  
  
5.  Запустите графического средства MageUI.exe.  
  
    ```  
    MageUI.exe  
    ```  
  
6.  Создать новый манифест приложения, выбрав **файл**, **New**, **манифест приложения** в меню.  
  
7.  По умолчанию **имя** , введите имя и номер версии данного развертывания. Также укажите значение для **издатель**, который будет использоваться как имя папки для ссылки на ярлык приложения в меню "Пуск" при его развертывании.  
  
8.  Выберите **параметры приложения** и нажмите кнопку **использовать манифест приложения для доверенных сведений**. Это позволит сторонних фирменной символики для этого [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] приложения.  
  
9. Выберите **файлы** и нажмите кнопку **Обзор** кнопку рядом с текстовым полем каталога приложения.  
  
10. Выберите каталог, содержащий файлы приложения, созданные на предыдущем шаге и нажмите кнопку **ОК** в диалоговом окне выбора папки.  
  
11. Нажмите кнопку **заполнить** кнопку, чтобы добавить файлы приложения в список файлов. Если приложение содержит более одного исполняемого файла, пометьте главный исполняемый файл для этого развертывания в качестве запускаемого приложения, выбрав **точки входа** из **тип файла** раскрывающегося списка. (Если приложение содержит только один исполняемый файл, MageUI.exe пометит его автоматически.)  
  
12. Выберите **разрешения, необходимые** и выберите уровень доверия, необходимые приложению. Значение по умолчанию — **полного доверия**, который может быть подходит для большинства приложений.  
  
13. Выберите **файл**, **Сохранить** из меню и сохранить манифест приложения. Вам будет предложено подписи манифеста приложения при его сохранении.  
  
14. При наличии сертификата, хранящегося в виде файла в файловой системе, используйте **подписать как файл сертификата** и выбрать сертификат из файловой системы, кнопку с многоточием (**...** ) кнопки.  
  
     - или -  
  
     Если сертификат хранится в хранилище сертификатов, доступную с компьютера, выберите **подписывать с сохраненным сертификатом параметр**и выберите сертификат из списка.  
  
15. Выберите **файл**, **New**, **манифест развертывания** меню, чтобы создать манифест развертывания, а затем на **имя** вкладки, укажите имя и номер версии (**1.0.0.0** в этом примере).  
  
16. Переключитесь в **обновление** и укажите частоту обновления приложения. Если приложение использует [!INCLUDE[ndptecclick](../deployment/includes/ndptecclick_md.md)] API развертывания для проверки наличия обновлений, снимите флажок **это приложение должно проверять наличие обновлений**.  
  
17. Переключитесь в **ссылка приложения** вкладки. Можно предварительно заполнить все значения на этой вкладке, нажав кнопку **выбрать манифест** кнопки и при выборе манифеста приложения, созданный на предыдущих шагах.  
  
18. Выберите **Сохранить** и сохраните манифест развертывания на диск. Вам будет предложено подписи манифеста приложения при его сохранении. Нажмите кнопку **отменить** сохранить манифест без его подписания.  
  
19. Предоставьте все файлы приложения для клиента.  
  
20. На этом этапе клиент должен подписать манифест развертывания с его собственному самостоятельно сформированный сертификат. Например если клиент работает компания Adventure Works, он может создавать самозаверяющий сертификат, с помощью средства MakeCert.exe. После этого можно используйте средство Pvk2pfx.exe объединить файлы, созданные средством MakeCert.exe, в PFX-файл, который может быть передан в MageUI.exe.  
  
    ```  
    makecert -r -pe -n "CN=Adventure Works" -sv MyCert.pvk MyCert.cer  
    pvk2pfx.exe -pvk MyCert.pvk -spc MyCert.cer -pfx MyCert.pfx  
    ```  
  
21. Созданный сертификат клиент теперь подписывает манифест развертывания, открыв манифест развертывания в MageUI.exe и сохранить его. Когда появится диалоговое окно подписания, клиент выбирает **подписать как файл сертификата** , а затем выбирает PFX-файл, сохраненный на диске.  
  
22. Клиент развертывает приложение для своих пользователей.  
  
## <a name="next-steps"></a>Следующие шаги  
  
## <a name="see-also"></a>См. также  
 [Mage.exe (средство создания и редактирования манифеста)](/dotnet/framework/tools/mage-exe-manifest-generation-and-editing-tool)   
 [MageUI.exe (средство создания и редактирования манифестов, графический клиент)](/dotnet/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client)   
 [MakeCert](https://msdn.microsoft.com/library/windows/desktop/aa386968.aspx)