---
title: "Сбор данных о выделении памяти для объектов .NET и времени их жизни | Microsoft Docs"
ms.custom: ""
ms.date: "12/16/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-debug"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "метод профилирования памяти .NET"
  - "средства профилирования, метод памяти .NET"
ms.assetid: 62a6dd5f-db66-4456-9d57-f8913dbfe4d5
caps.latest.revision: 18
caps.handback.revision: 18
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
---
# Сбор данных о выделении памяти для объектов .NET и времени их жизни
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Средства профилирования [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] поддерживают возможность сбора данных о выделении памяти для объектов .NET и времени их жизни, что облегчает выявление проблем производительности приложения, связанных с памятью.  
  
-   Данные о выделении памяти .NET включают сведения о размере и количестве выделенных объектов памяти .NET Framework.  
  
-   Данные о времени жизни объектов включают сведения о размере и числе объектов памяти .NET Framework, которые были удалены в трех поколениях сборки мусора.  
  
 **Требования**  
  
-   [!INCLUDE[vsUltLong](../code-quality/includes/vsultlong_md.md)], [!INCLUDE[vsPreLong](../code-quality/includes/vsprelong_md.md)], [!INCLUDE[vsPro](../code-quality/includes/vspro_md.md)]  
  
> [!NOTE]
>  Функции усиленной безопасности в Windows 8 и Windows Server 2012 требуют значительных изменений в способе сбора данных профилировщиком Visual Studio на этих платформах.  Для Приложений Магазина Windows также требуются новые методы сбора.  См. раздел [Профилирование приложений для Windows 8 и Windows Server 2012](../profiling/performance-tools-on-windows-8-and-windows-server-2012-applications.md).  
  
 Можно собрать данные с использованием метода выборки или метода профилирования с инструментированием.  
  
-   При использовании метода выборки профилировщик отслеживает все операции выделения памяти .NET и объекты, которые были созданы запущенным процессом или процессом, к которому он присоединен.  
  
-   При использовании метода инструментирования профилировщик отслеживает только те объекты и операции выделения памяти .NET, которые создаются инструментированными модулями.  
  
> [!IMPORTANT]
>  При сборе данных о памяти .NET \(операции выделения, время жизни объектов или все вместе\) с помощью метода выборки, все заданные пользователем события выборки игнорируются, и для сбора данных используются соответствующие события выделения памяти.  
  
 Если включается профилирование операций выделения памяти .NET, также следует включить представление "Выделение".  Если включается профилирование данных о времени жизни .NET, также следует включить представление "Время жизни объектов".  Дополнительные сведения см. в разделах [Представление выделения](../profiling/dotnet-memory-allocations-view.md) и [Представление "Время существования объектов"](../profiling/object-lifetime-view.md).  
  
 Сведения о порядке сбора данных памяти .NET с использованием программ командной строки средств профилирования [Использование методов профилирования из командной строки](../profiling/using-profiling-methods-to-collect-performance-data-from-the-command-line.md) см. в разделе "Использование метода анализа использования памяти .NET для сбора данных о выделении памяти и сроках существования объектов" раздела.  
  
### Сбор данных памяти .NET  
  
1.  В **обозревателе производительности** щелкните правой кнопкой мыши сеанс анализа производительности и выберите команду **Свойства**.  
  
2.  В диалоговом окне **Страницы свойств**  *Performance Session* перейдите на вкладку **Общие** и установите флажок **Собирать сведения о выделении объектов .NET**.  
  
3.  Для сбора данных о продолжительности жизни объектов .NET установите флажок **Также собирать сведения о времени жизни объектов .NET**.  
  
## Общие задачи  
 Дополнительные параметры можно указать в диалоговом окне сеанса анализа производительности **Страницы свойств** *Performance Session* Чтобы открыть это диалоговое окно, выполните следующие действия.  
  
-   В **обозревателе производительности** щелкните правой кнопкой мыши имя сеанса анализа производительности и выберите команду **Свойства**.  
  
 Задачи в следующей таблице описывают параметры, которые можно задать в диалоговом окне **Страницы свойств** *Performance Session* при выполнении сбора данных памяти .NET.  
  
|Задача|Связанное содержимое|  
|------------|--------------------------|  
|На странице **Общие** задайте сведения об имени создаваемого файла данных профилирования \(.vsp\).|-   [Collecting .NET Memory Allocation and Lifetime Data](../profiling/collecting-dotnet-memory-allocation-and-lifetime-data.md)<br />-   [Практическое руководство. Настройка параметров имени файла данных профилирования](../profiling/how-to-set-performance-data-file-name-options.md)|  
|На странице **Запуск** выберите приложение для запуска, если в решении с кодом содержится несколько проектов исполняемых файлов \(EXE\).|-   [Сбор данных взаимодействия уровней](../profiling/collecting-tier-interaction-data.md)|  
|На странице **Взаимодействия уровня** добавьте данные вызова ADO.NET в сеанс профилировщика.|-   [Сбор данных взаимодействия уровней](../profiling/collecting-tier-interaction-data.md)|  
|На странице **События Windows** задайте одно или несколько событий трассировки Windows для сбора, воспользовавшись данными выборки.|-   [Практическое руководство. Сбор данных трассировки событий Windows](../Topic/How%20to:%20Collect%20Event%20Tracing%20for%20Windows%20\(ETW\)%20Data.md)|  
|На странице **Счетчики Windows** выберите один или несколько счетчиков производительности операционной системы, значения которых будут добавляться в данные профилирования в качестве меток.|-   [Практическое руководство. Сбор данных счетчиков производительности Windows](../profiling/how-to-collect-windows-counter-data.md)|  
|На странице **Дополнительно** задайте для профилирования версию среды выполнения .NET Framework, если модули приложения используют несколько версий.  По умолчанию профилируется первая загруженная версия.|-   [Практическое руководство. Определение среды выполнения .NET Framework для профилирования в смежных сценариях](../Topic/How%20to:%20Specify%20the%20.NET%20Framework%20Runtime.md)|  
  
## Задачи инструментирования  
 Задачи в следующей таблице представляют собой параметры диалогового окна **Страницы свойств**, характерные для профилирования с использованием метода инструментирования.  
  
|Задача|Связанное содержимое|  
|------------|--------------------------|  
|На странице **Двоичные файлы** задайте расположение для инструментированных копий модулей.  По умолчанию исходные двоичные файлы перемещаются в папку для резервного копирования.|-   [Практическое руководство. Перемещение инструментированных двоичных файлов](../profiling/how-to-relocate-instrumented-binaries.md)|  
|На странице **Инструментирование** исключите профилирование небольших функций, чтобы уменьшить количество служебных данных профилирования, выполните профилирование кода JavaScript на веб\-страницах ASP.NET и задайте команды для запуска в командной строке перед началом процесса инструментирования и по его завершении.|-   [Практическое руководство. Исключение и включение малых функций при инструментировании](../Topic/How%20to:%20Exclude%20or%20Include%20Short%20Functions%20from%20Instrumentation.md)<br />-   [Практическое руководство. Профилирование кода JavaScript \(ECMA\) в веб\-страницах](../Topic/How%20to:%20Profile%20JavaScript%20Code%20in%20Web%20Pages.md)<br />-   [Практическое руководство. Указание команд, предваряющих инструментирование, и команд после инструментирования](../Topic/How%20to:%20Specify%20Pre-%20and%20Post-Instrument%20Commands.md)|  
|На странице **Счетчики ЦП** выберите один или несколько счетчиков производительности процессора, значения которых будут добавляться в данные профилирования.|-   [Практическое руководство. Сбор данных счетчиков производительности ЦП](../profiling/how-to-collect-cpu-counter-data.md)|  
|На странице **Дополнительно** задайте дополнительные необходимые параметры VSInstr.exe, например параметры для включения или исключения определенных функций.  Дополнительные сведения о параметрах VSInstr см. в разделе [VSInstr](../profiling/vsinstr.md).|-   [Практическое руководство. Указание дополнительных параметров инструментирования](../Topic/How%20to:%20Specify%20Additional%20Instrumentation%20Options.md)<br />-   [Практическое руководство. Ограничение инструментирования указанными функциями](../profiling/how-to-limit-instrumentation-to-specific-functions.md)|  
  
## См. также  
 [Настройка сеансов анализа производительности](../profiling/configuring-performance-sessions.md)   
 [Практическое руководство. Выбор методов сбора данных](../profiling/how-to-choose-collection-methods.md)   
 [Свойства сеанса анализа производительности](../profiling/performance-session-properties.md)