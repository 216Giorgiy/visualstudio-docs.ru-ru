---
title: "Практическое руководство. Присоединение профилировщика к веб-приложению ASP.NET для сбора данных параллелизма при помощи командной строки | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-debug"
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: 0e215fdd-55f8-43ef-9534-06542eefe223
caps.latest.revision: 29
caps.handback.revision: 29
author: "mikejo5000"
ms.author: "mikejo"
manager: "ghogen"
---
# Практическое руководство. Присоединение профилировщика к веб-приложению ASP.NET для сбора данных параллелизма при помощи командной строки
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

В этом разделе описан порядок использования программ командной строки средств профилирования [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] для присоединения профилировщика к веб\-приложению ASP.NET и сбора данных параллелизма потока и процесса с помощью метода выборки.  
  
 Программы командной строки средств профилирования расположены в подкаталоге \\Team Tools\\Performance Tools каталога установки Visual Studio.  На 64\-разрядных компьютерах доступны 64\-разрядные и 32\-разрядные версии средств.  Для использования профилировщика из командной строки необходимо добавить путь к этим программам в переменную среды PATH окна **Командная строка** или указать этот путь при вызове самой команды.  Для получения дополнительной информации см. [Указание пути к средствам командной строки](../profiling/specifying-the-path-to-profiling-tools-command-line-tools.md).  
  
 Для сбора данных о параллелизме необходимо присоединить профилировщик к рабочему процессу ASP.NET, в котором размещается веб\-сайт.  Пока профилировщик присоединен к приложению, сбор данных можно приостанавливать и возобновлять.  Чтобы завершить сеанс профилирования, необходимо отсоединить профилировщик от приложения и явным образом завершить его работу.  В большинстве случаев рекомендуется удалять в конце сеанса значения переменных среды, используемые для профилирования.  
  
## Присоединение профилировщика  
  
#### Присоединение профилировщика к приложению ASP.NET  
  
1.  Чтобы запустить профилировщик, введите в командной строке следующую команду:  
  
     [VSPerfCmd](../profiling/vsperfcmd.md) **\/start:concurrency \/output:**`OutputFile` \[`Options`\]  
  
    -   Параметр [\/start](../profiling/start.md) инициализирует профилировщик для сбора данных о конфликтах ресурсов.  
  
    -   Параметр [\/output](../profiling/output.md)**:**`OutputFile` является обязательным при использовании параметра **\/start**.  Параметр `OutputFile` задает имя и расположение файла с данными профилирования \(VSP\-файла\).  
  
     С параметром **\/start** можно использовать любые из параметров, представленных в следующей таблице.  
  
    |Команда|Описание|  
    |-------------|--------------|  
    |[\/user](../profiling/user-vsperfcmd.md) **:**\[`Domain\`\]`UserName`|Задает необязательные домен и имя пользователя учетной записи, которой требуется предоставить доступ к профилировщику.|  
    |[\/crosssession](../profiling/crosssession.md)|Включает профилирование процессов в других сеансах входа в систему.|  
    |[\/wincounter](../profiling/wincounter.md) **:** `WinCounterPath`|Задает счетчик производительности Windows, данные которого следует собирать в процессе профилирования.|  
    |[\/automark](../profiling/automark.md) **:** `Interval`|Используйте только с **\/wincounter**.  Задает интервал времени \(в миллисекундах\) между событиями сбора данных счетчика производительности Windows.  Значение по умолчанию — 500.|  
    |[\/events](../profiling/events-vsperfcmd.md) **:** `Config`|Задает событие трассировки событий Windows, данные которого следует собирать в процессе профилирования.  События трассировки событий Windows собираются в отдельный ETL\-файл.|  
  
2.  Запустите веб\-приложение ASP.NET обычным образом.  
  
3.  Прикрепите профилировщик к рабочему процессу ASP.NET, используя следующую команду:**VSPerfCmd \/attach:**`PID` \[**\/targetclr:**`Version`\]  
  
    -   Параметр `PID` задает идентификатор или имя рабочего процесса ASP.NET.  Диспетчер задач Windows позволяет просмотреть идентификаторы всех запущенных процессов.  
  
    -   Параметр [\/targetclr](../profiling/targetclr.md)**:**`Version` задает версию среды CLR для профилирования, если в приложении загружено несколько версий среды выполнения.  Этот параметр является необязательным.  
  
## Управление сбором данных  
 Пока выполняется приложение, можно управлять сбором данных путем запуска и остановки записи данных в файл с помощью параметров VSPerfCmd.exe.  Управление сбором данных позволяет собирать данные на различных этапах выполнения программы, например, при запуске или завершении работы приложения.  
  
#### Запуск и остановка сбора данных  
  
-   Пары параметров VSPerfCmd в следующей таблице используются для запуска и остановки сбора данных.  Задайте каждый параметр в отдельной строке командной строки.  Запуск и приостановка сбора данных могут выполняться неоднократно.  
  
    |Команда|Описание|  
    |-------------|--------------|  
    |[\/globalon \/globaloff](../profiling/globalon-and-globaloff.md)|Запускает \(**\/globalon**\) или останавливает \(**\/globaloff**\) сбор данных для всех процессов.|  
    |[\/processon](../profiling/processon-and-processoff.md) **:** `PID`  [processoff](../profiling/processon-and-processoff.md) **:** `PID`|Запускает \(**\/processon**\) или останавливает \(**\/processoff**\) сбор данных для процесса с указанным идентификатором процесса \(`PID`\).|  
    |[\/attach](../profiling/attach.md) **:**{`PID`&#124;`ProcName`} [\/detach](../profiling/detach.md)\[**:**{`PID`&#124;`ProcName`}\]|**\/attach** запускает сбор данных для процесса, определяемого по идентификатору \(`PID`\) или имени \(*ProcName*\).  **\/detach** останавливает сбор данных для указанного процесса или, если он не задан, для всех процессов.|  
  
## Завершение сеанса профилирования  
 При завершении сеанса профилирования профилировщик не должен собирать данные.  Чтобы остановить процесс сбора данных от приложения, для которого выполняется профилирование методом параллелизма, можно остановить рабочий процесс ASP.NET или воспользоваться параметром **VSPerfCmd \/detach**.  Затем для завершения работы профилировщика и закрытия файла с данными профилирования используется параметр **VSPerfCmd \/shutdown**.  Команда **VSPerfClrEnv \/globaloff** удаляет переменные среды, используемые для профилирования, но конфигурация системы не изменяется до перезагрузки компьютера.  
  
#### Завершение сеанса профилирования  
  
1.  Отсоедините профилировщик от целевого приложения путем закрытия приложения или ввода в командную строку следующей команды:  
  
     **VSPerfCmd \/detach**  
  
2.  Завершите работу профилировщика с помощью следующей команды командной строки:  
  
     **VSPerfCmd**  [\/shutdown](../profiling/shutdown.md)  
  
## См. также  
 [Профилирование веб\-приложений ASP.NET](../profiling/command-line-profiling-of-aspnet-web-applications.md)   
 [Быстрое профилирование веб\-сайтов с помощью средства VSPerfASPNETCmd](../profiling/rapid-web-site-profiling-with-vsperfaspnetcmd.md)