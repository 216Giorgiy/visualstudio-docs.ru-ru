---
title: 'Как: локализация кода | Документы Microsoft'
ms.custom: ''
ms.date: 02/02/2017
ms.technology:
- office-development
ms.topic: conceptual
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- localizing code [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, localizing
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: 07c9347bbfb42e3c2e20a1b4ecf6d852c567edbf
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="how-to-localize-code"></a>Практическое руководство. Локализация кода
  Не локализованный код использует жестко запрограммированные значения строк. Для локализации строк кода, замените их вызовы <xref:System.Web.HttpContext.GetGlobalResourceObject%2A>, — метод, который ссылается на локализованные ресурсы.  
  
## <a name="localizing-code"></a>Локализация кода  
  
#### <a name="to-localize-code"></a>Локализация кода  
  
1.  В **обозревателе решений**, откройте контекстное меню для элемента проекта и нажмите кнопку **добавить**, **модуль**.  
  
     Выберите **файл ресурсов** шаблона.  
  
    > [!NOTE]  
    >  Не забудьте добавить файл ресурсов в элемент проекта SharePoint, чтобы свойство типа развертывания. Это свойство требуется далее в этой процедуре.  
  
2.  Присвойте имя по своему усмотрению с расширением RESX, например MyAppResources.resx файла ресурсов для языка по умолчанию.  
  
3.  Повторите шаги 1 и 2, чтобы добавить отдельные файлы ресурсов в элемент проекта SharePoint: по одному для каждого языка локализации.  
  
     Используйте же базовое имя для каждого локализованного файла ресурсов, но добавить идентификатор языка и региональных параметров. Например имя немецком MyAppResources.de-DE.resx локализованный ресурс.  
  
4.  Откройте каждый файл ресурсов и добавьте локализованные строки. Используйте в каждом файле одинаковые идентификаторы строки.  
  
5.  Измените значение **тип развертывания** свойство для каждого файла ресурсов для **AppGlobalResource** чтобы каждый файл для развертывания в папке сервера App_GlobalResources.  
  
6.  Оставьте значение параметра **действие при построении** для каждого файла, как **внедренный ресурс**.  
  
     Внедренные ресурсы компилируются в DLL проекта.  
  
7.  Выполните построение проекта для создания ресурса вспомогательные библиотеки DLL.  
  
8.  В **конструктора пакетов**, выберите **Дополнительно** вкладку, а затем добавьте вспомогательную сборку.  
  
9. В **расположение** поле, в начале вставьте идентификатор папки языка и региональных параметров пути, например de-DE\\*имя элемента проекта*. resources.dll.  
  
10. Если решение не ссылается на сборку System.Web, добавьте ссылку на него и в коде добавьте директиву <xref:System.Web>.  
  
11. Найдите все жестко заданные строки в коде, отображаемые пользователям, например, текст пользовательского интерфейса, ошибок и текст сообщений. Замените их вызовом метода <xref:System.Web.HttpContext.GetGlobalResourceObject%2A>, используя следующий синтаксис:  
  
    ```  
    HttpContext.GetGlobalResourceObject("Resource File Name", "String ID")  
    ```  
  
12. Нажмите клавишу F5, чтобы выполнить сборку и запуск приложения.  
  
13. В SharePoint необходимо измените язык по умолчанию.  
  
     Локализованные строки отображаются в приложении. Для отображения локализованных ресурсов, сервере SharePoint необходимо установить языковой пакет, соответствующий файл ресурсов языка и региональных параметров.  
  
## <a name="see-also"></a>См. также  
 [Локализация решений SharePoint](../sharepoint/localizing-sharepoint-solutions.md)   
 [Как: Локализация компонента](../sharepoint/how-to-localize-a-feature.md)   
 [Как: Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md)   
 [Практическое руководство. Добавление файла ресурсов](../sharepoint/how-to-add-a-resource-file.md)  
  
  