---
title: "Практическое руководство. Локализация кода | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "локализация кода [разработка приложений SharePoint в Visual Studio]"
  - "разработка приложений SharePoint в Visual Studio, локализация"
ms.assetid: 0e852052-5ad4-4517-81cf-8865ec304441
caps.latest.revision: 17
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 16
---
# Практическое руководство. Локализация кода
  Не локализованный код использует жестко запрограммированные значения строк.  Чтобы локализовать строки кода, замените их обращением к <xref:System.Web.HttpContext.GetGlobalResourceObject%2A> — методом, который ссылается на локализованные ресурсы.  
  
## Локализация кода  
  
#### Локализация кода  
  
1.  В области **Обозреватель решений** откройте контекстное меню для элемента проекта и выберите **Добавить**, **Модуль**.  
  
     Выберите шаблон **Файл ресурсов**.  
  
    > [!NOTE]  
    >  Убедитесь, что файл ресурсов добавлен в элемент проекта SharePoint и доступно свойство "Тип развертывания".  Данное свойство потребуется далее в этой процедуре.  
  
2.  Языковому файлу ресурсов по умолчанию присвойте любое имя с расширением .resx, например, MyAppResources.resx.  
  
3.  Повторите шаги 1 и 2, чтобы добавить отдельные файлы ресурсов в элемент проекта SharePoint: по одному для каждого языка локализации.  
  
     Используйте одинаковое базовое имя для каждого локализованного файла ресурсов с добавлением идентификатора языка и региональных параметров.  Например, локализованный ресурс для немецкого языка назовите MyAppResources.de\-DE.resx.  
  
4.  Откройте каждый файл ресурсов и добавьте локализованные строки.  Используйте в каждом файле одинаковые идентификаторы строки.  
  
5.  Измените значение свойства **Тип развертывания** для каждого файла ресурсов на **AppGlobalResource**, чтобы каждый файл развертывался в папке сервера App\_GlobalResources.  
  
6.  Для каждого файла оставьте свойство **Действие при построении** в значении **Внедренный ресурс**.  
  
     Внедренные ресурсы компилируются в DLL проекта.  
  
7.  Постройте проект, чтобы создать вспомогательный ресурс DLLs.  
  
8.  В **Конструкторе пакетов** выберите вкладку **Дополнительно** и добавьте вспомогательную сборку.  
  
9. В поле **Расположение** в начале пути вставьте идентификатор папки языка и региональных параметров, например, de\-DE\\*Project Item Name*.resources.dll.  
  
10. Если решение еще не ссылается на сборку System.Web, добавьте такую ссылку, а затем в код добавьте директиву на <xref:System.Web>.  
  
11. Найдите все жестко запрограммированные строки в коде, отображаемые для пользователей, например, текст пользовательского интерфейса, ошибок и текст сообщения.  Замените их вызовом метода <xref:System.Web.HttpContext.GetGlobalResourceObject%2A> с помощью следующего синтаксиса:  
  
    ```  
    HttpContext.GetGlobalResourceObject("Resource File Name", "String ID")  
    ```  
  
12. Нажмите клавишу F5, чтобы собрать и запустить приложение.  
  
13. Измените в SharePoint заданный по умолчанию язык отображения.  
  
     В приложении появятся локализованные строки.  Для отображения локализованных ресурсов на сервере SharePoint должен быть установлен языковой пакет, соответствующий языку и региональным параметрам файла ресурсов.  
  
## См. также  
 [Локализация решений SharePoint](../sharepoint/localizing-sharepoint-solutions.md)   
 [Практическое руководство. Локализация компонента](../sharepoint/how-to-localize-a-feature.md)   
 [Практическое руководство. Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md)   
 [Практическое руководство. Добавление файла ресурсов](../sharepoint/how-to-add-a-resource-file.md)  
  
  