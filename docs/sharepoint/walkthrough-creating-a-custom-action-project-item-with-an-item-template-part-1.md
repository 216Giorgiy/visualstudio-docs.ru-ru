---
title: "Walkthrough: Creating a Custom Action Project Item with an Item Template, Part 1"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "SharePoint project items, creating custom templates"
  - "SharePoint project items, defining your own types"
  - "project items [SharePoint development in Visual Studio], defining your own types"
  - "SharePoint development in Visual Studio, defining new project item types"
ms.assetid: 41ed9c1c-4239-4d80-934b-975fde744288
caps.latest.revision: 152
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 151
---
# Walkthrough: Creating a Custom Action Project Item with an Item Template, Part 1
  Можно расширить систему проектов SharePoint в Visual Studio путем создания собственных типов элементов проектов.  В данном пошаговом руководстве будет создан элемент проекта, который можно добавить в проект SharePoint для создания настраиваемого действия на сайте SharePoint.  Это настраиваемое действие добавляет пункт к меню **Действия сайта** на сайте SharePoint.  
  
 В этом пошаговом руководстве показано выполнение следующих задач.  
  
-   Создание расширения Visual Studio, в котором определяется новый тип элемента проекта SharePoint для настраиваемого действия.  В новом типе элемента проекта реализовано несколько настраиваемых возможностей:  
  
    -   контекстное меню для запуска дополнительных задач, связанных с элементом проекта, например для отображения конструктора настраиваемых действий в Visual Studio;  
  
    -   код, выполняемый при изменении разработчиком определенных свойств элемента проекта, содержащегося в проекте;  
  
    -   настраиваемый значок, отображаемый рядом с элементом проекта в **обозревателе решений**.  
  
-   Создание шаблона элемента Visual Studio для данного элемента проекта.  
  
-   Построение пакета расширения Visual Studio \(VSIX\) для развертывания шаблона элемента проекта и сборки расширения.  
  
-   Отладка и тестирование элемента проекта.  
  
 Это пошаговое руководство является отдельным.  По завершении данного пошагового руководства вы сможете усовершенствовать элемент проекта, добавив мастер в его шаблон.  Для получения дополнительной информации см. [Walkthrough: Creating a Custom Action Project Item with an Item Template, Part 2](../sharepoint/walkthrough-creating-a-custom-action-project-item-with-an-item-template-part-2.md).  
  
> [!NOTE]  
>  Можно загрузить пример, который содержит проекты завершена, код и другие файлы для этого пошагового руководства из следующего расположения:  [http:\/\/go.microsoft.com\/fwlink\/?LinkId\=191369](http://go.microsoft.com/fwlink/?LinkId=191369).  
  
## Обязательные компоненты  
 Для выполнения данного пошагового руководства на компьютере разработчика должны быть установлены следующие компоненты:  
  
-   поддерживаемые выпуски Microsoft Windows, SharePoint и Visual Studio.  Для получения дополнительной информации см. [Требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vssdk_current_long](../sharepoint/includes/vssdk-current-long-md.md)].  В этом пошаговом руководстве шаблон **Проект VSIX** из пакета SDK используется для создания пакета VSIX, который служит для развертывания элемента проекта.  Для получения дополнительной информации см. [Extending the SharePoint Tools in Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md).  
  
 Знание следующих подходов может оказаться полезным, но не требуется для выполнения пошагового руководства.  
  
-   настраиваемые действия в SharePoint.  Дополнительные сведения см. в [Настраиваемого действия](http://go.microsoft.com/fwlink/?LinkId=177800).  
  
-   Шаблоны элементов в Visual Studio.  Для получения дополнительной информации см. [Создание пользовательских шаблонов проектов и элементов в Visual Studio](../ide/creating-project-and-item-templates.md).  
  
## Создание проектов  
 Чтобы выполнить это пошаговое руководство, необходимо создать три проекта:  
  
-   Проект VSIX.  Проект создает пакет VSIX для развертывания элемента проекта SharePoint.  
  
-   Проект шаблона элемента.  Этот проект создает шаблон элемента, который может быть использован для добавления элемента проекта SharePoint в проект SharePoint.  
  
-   Проект библиотеки классов.  Проект реализует расширение Visual Studio, определяющее поведение элемента проекта SharePoint.  
  
 Начните выполнение пошагового руководства с создания проектов.  
  
#### Создание проекта VSIX  
  
1.  Запустите [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
2.  В меню **Файл** выберите **Создать**, **Проект**.  
  
3.  В списке **Создание проекта** в верхней части диалогового окна, убедитесь, что выбрано **.NET Framework 4.5**.  
  
4.  В диалоговом окне **Создание проекта** разверните узел **Visual C\#** или **Visual Basic**, а затем выберите узел **Расширение среды**.  
  
    > [!NOTE]  
    >  Узел **Расширение среды** доступен только в том случае, если необходимо установить пакет SDK для Visual Studio.  Дополнительные сведения см. в параграфе предварительных требований ранее в этом разделе.  
  
5.  Выберите шаблон **Проект VSIX**.  
  
6.  В поле **Имя** введите **CustomActionProjectItem**, а затем нажмите кнопку **ОК**.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] добавит в **Обозреватель решений** проект **CustomActionProjectItem**.  
  
#### Добавление проекта шаблона элемента  
  
1.  В **Обозреватель решений** откройте контекстное меню для узла решения, выберите **Добавить**, а затем выберите **Создание проекта**.  
  
    > [!NOTE]  
    >  В проектах Visual Basic узел решения отображается в **обозревателе решений**, только если в диалоговом окне ["Общие", страница "Проекты и решения", диалоговое окно "Параметры"](http://msdn.microsoft.com/ru-ru/8f8e37e8-b28d-4b13-bfeb-ea4d3312aeca) установлен флажок **Всегда показывать решение**.  
  
2.  В списке **Создание проекта** в верхней части диалогового окна, убедитесь, что выбрано **.NET Framework 4.5**.  
  
3.  В диалоговом окне **Создание проекта** разверните узел **Visual C\#** или **Visual Basic**, а затем выберите узел **Расширение среды**.  
  
4.  В списке шаблонов проектов выберите шаблон **Шаблон элемента C** или **Шаблон элемента Visual Basic**.  
  
5.  В поле **Имя** введите **ItemTemplate**, а затем нажмите кнопку **ОК**.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] добавит в решение проект **ItemTemplate**.  
  
#### Создание проекта расширения  
  
1.  В **Обозреватель решений** откройте контекстное меню для узла решения, выберите **Добавить**, а затем выберите **Создание проекта**.  
  
2.  В списке **Создание проекта** в верхней части диалогового окна, убедитесь, что выбрано **.NET Framework 4.5**.  
  
3.  В диалоговом окне **Создание проекта** разверните узел **Visual C\#** или узел **Visual Basic**, выберите **Окна**, а затем выберите шаблон проекта **Библиотека классов**.  
  
4.  В поле **Имя** введите **ProjectItemDefinition**, а затем нажмите кнопку **ОК**.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] добавляет проект **ProjectItemDefinition** в решение и открывает заданный по умолчанию файл с кодом Class1.  
  
5.  Удалите из проекта файл c кодом Class1.  
  
## Настройка проекта расширения  
 Перед написанием кода, определяющего тип элемента проекта SharePoint, необходимо добавить в проект расширения ссылки на сборки и файлы с кодом.  
  
#### Настройка проекта  
  
1.  В **Обозреватель решений** откройте контекстное меню для проекта **ProjectItemDefinition**, выберите **Добавить**, затем выберите **Создать элемент**.  
  
2.  В списке элементов проекта выберите **Файл с текстом программы**.  
  
3.  В поле **Имя** введите имя **CustomAction** с соответствующим расширение имени файла, а затем нажмите кнопку **Добавить**.  
  
4.  В **Обозреватель решений** откройте контекстное меню для проекта **ProjectItemDefinition** и выберите пункт **Добавить ссылку**.  
  
5.  В диалоговом окне **Диспетчер ссылок — ProjectItemDefinition** выберите узел **Сборки** и выберите узел **основа**.  
  
6.  Выберите флажок рядом с каждой из следующих сборок:  
  
    -   System.ComponentModel.Composition  
  
    -   System.Windows.Forms  
  
7.  Выберите узел **Расширения** выберите флажок рядом с сборкой Microsoft.VisualStudio.Sharepoint, а затем нажмите кнопку **ОК**.  
  
## Определение нового типа элемента проекта SharePoint  
 Создайте класс, реализующий интерфейс <xref:Microsoft.VisualStudio.SharePoint.ISharePointProjectItemTypeProvider>, чтобы определить поведение нового типа элемента проекта.  Этот интерфейс следует реализовывать всякий раз, когда требуется определить новый тип элемента проекта.  
  
#### Определение нового типа элемента проекта SharePoint  
  
1.  В проекте ProjectItemDefinition откройте файл с кодом CustomAction.  
  
2.  Замените код в этом файле следующим кодом.  
  
     [!code-csharp[SPExtensibility.ProjectItem.CustomAction#1](../snippets/csharp/VS_Snippets_OfficeSP/spextensibility.projectitem.customaction/cs/projectitemtypedefinition/customaction.cs#1)]
     [!code-vb[SPExtensibility.ProjectItem.CustomAction#1](../snippets/visualbasic/VS_Snippets_OfficeSP/spextensibility.projectitem.customaction/vb/projectitemdefinition/customaction.vb#1)]  
  
## Создание значка для элемента проекта в обозревателе решений  
 При создании пользовательского элемента проекта SharePoint с этим элементом проекта можно связать изображение \(значок или растровое изображение\).  Это изображение отображается рядом с элементом проекта в **обозревателе решений**.  
  
 В следующей процедуре создается значок для элемента проекта; кроме того, этот значок внедряется в сборку расширения.  Ссылка на эту сборку указывается в атрибуте <xref:Microsoft.VisualStudio.SharePoint.SharePointProjectItemIconAttribute> созданного перед этим класса `CustomActionProjectItemTypeProvider`.  
  
#### Создание пользовательского значка для элемента проекта  
  
1.  В **Обозреватель решений** откройте контекстное меню для проекта **ProjectItemDefinition**, выберите **Добавить**, затем выберите **Новый элемент…**.  
  
2.  В списке элементов проекта выберите элемент **Файл значка**.  
  
    > [!NOTE]  
    >  В проектах Visual Basic, необходимо выбрать узел **Общие** для отображения элемента **Файл значка**.  
  
3.  В поле **Имя** введите **CustomAction\_SolutionExplorer.ico**, а затем нажмите кнопку **Добавить**.  
  
     Новый значок будет отрыт в **Редакторе изображений**.  
  
4.  Измените версию файла значка размером 16x16, чтобы его можно было отличить от других значков, и сохраните файл значка.  
  
5.  В списке **Обозреватель решений** выберите **CustomAction\_SolutionExplorer.ico**.  
  
6.  В поле **Свойства** выберите стрелку рядом с свойством **Действие при построении**.  
  
7.  Отображается в списке, выберите пункт **Внедренный ресурс**.  
  
## Контрольная точка  
 Теперь проект содержит весь код, необходимый для реализации элемента проекта, который рассматривается в данном пошаговом руководстве.  Выполните построение проекта, чтобы проверить, что он будет компилироваться без ошибок.  
  
#### Построение проекта  
  
1.  Открыть контекстное меню для проекта **ProjectItemDefinition** и выберите команду **Построение**.  
  
## Создание шаблона элемента Visual Studio  
 Чтобы другие разработчики также могли использовать новый элемент проекта, необходимо создать шаблон проекта или шаблон элемента проекта.  Разработчики используют в Visual Studio шаблоны для создания экземпляра элемента проекта путем создания нового проекта или путем добавления элемента в имеющийся проект.  Для этого пошагового руководства воспользуйтесь проектом ItemTemplate для настройки элемента проекта.  
  
#### Создание шаблона элемента  
  
1.  Удалите из проекта ItemTemplate файл с кодом Class1.  
  
2.  Откройте файл ItemTemplate.vstemplate в проекте ItemTemplate.  
  
3.  Замените содержимое файла следующим XML\-кодом, затем сохраните и закройте файл.  
  
    > [!NOTE]  
    >  Следующий XML\-код предназначен для шаблона элемента на языке Visual C\#.  Если шаблон элемента создается на языке Visual Basic, замените значение элемента `ProjectType` на `VisualBasic`.  
  
    ```  
  
    <VSTemplate Version="2.0.0" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" Type="Item">  
      <TemplateData>  
        <DefaultName>CustomAction</DefaultName>  
        <Name>Custom Action</Name>  
        <Description>SharePoint Custom Action by Contoso</Description>  
        <ProjectType>CSharp</ProjectType>  
        <SortOrder>1000</SortOrder>  
        <Icon>ItemTemplate.ico</Icon>  
        <ProvideDefaultName>true</ProvideDefaultName>  
      </TemplateData>  
      <TemplateContent>  
        <ProjectItem ReplaceParameters="true" TargetFileName="$fileinputname$\Elements.xml">Elements.xml</ProjectItem>  
        <ProjectItem ReplaceParameters="true" TargetFileName="$fileinputname$\SharePointProjectItem.spdata">CustomAction.spdata</ProjectItem>  
      </TemplateContent>  
    </VSTemplate>  
    ```  
  
     Этот файл определяет содержимое и поведение шаблона элемента.  Дополнительные сведения о содержимом этого файла см. в разделе [Справочник по схеме шаблонов Visual Studio](../extensibility/visual-studio-template-schema-reference.md).  
  
4.  В **Обозреватель решений** откройте контекстное меню для проекта **ItemTemplate**, выберите **Добавить**, затем выберите **Создать элемент**.  
  
5.  В диалоговом окне **Добавить новый элемент** выберите шаблон **Текстовый файл**.  
  
6.  В поле **Имя** введите **CustomAction.spdata**, а затем нажмите кнопку **Добавить**.  
  
7.  Добавьте в файл CustomAction.spdata следующий XML\-код, а затем сохраните и закройте файл.  
  
    ```  
  
    <ProjectItem Type="Contoso.CustomAction" DefaultFile="Elements.xml"   
     xmlns="http://schemas.microsoft.com/VisualStudio/2010/SharePointTools/SharePointProjectItemModel">  
      <Files>  
        <ProjectItemFile Source="Elements.xml" Target="$fileinputname$\" Type="ElementManifest" />  
      </Files>  
    </ProjectItem>  
    ```  
  
     Этот файл содержит сведения о файлах, входящих в другие элементы проекта.  Атрибут `Type` элемента `ProjectItem` должен равняться строке, переданной атрибуту <xref:Microsoft.VisualStudio.SharePoint.SharePointProjectItemTypeAttribute> определения элемента проекта \(см. ранее созданный в этом пошаговом руководстве класс `CustomActionProjectItemTypeProvider`\).  Дополнительные сведения о содержимом SPDATA\-файлов см. в разделе [SharePoint Project Item Schema Reference](../sharepoint/sharepoint-project-item-schema-reference.md).  
  
8.  В **Обозреватель решений** откройте контекстное меню для проекта **ItemTemplate**, выберите **Добавить**, затем выберите **Создать элемент**.  
  
9. В диалоговом окне **Добавить новый элемент** выберите шаблон **XML\-файл**.  
  
10. В поле **Имя** введите **Elements.xml**, а затем нажмите кнопку **Добавить**.  
  
11. Замените содержимое файла Elements.xml следующим XML\-кодом, затем сохраните и закройте файл.  
  
    ```  
  
    <Elements Id="$guid8$" xmlns="http://schemas.microsoft.com/sharepoint/">  
      <CustomAction Id="Replace this with a GUID or some other unique string"  
                    GroupId="SiteActions"  
                    Location="Microsoft.SharePoint.StandardMenu"  
                    Sequence="1000"  
                    Title="Replace this with your title"  
                    Description="Replace this with your description" >  
        <UrlAction Url="~site/Lists/Tasks/AllItems.aspx"/>  
      </CustomAction>  
    </Elements>  
    ```  
  
     Этот файл определяет настраиваемое действие по умолчанию и создает пункт в меню **Действия сайта** для сайта SharePoint.  Когда пользователь выбирает пункт меню, URL\-адрес, указанным в элементе `UrlAction` будет открыт в веб\-браузере.  Дополнительные сведения о XML можно использовать для определения пользовательского действия см. в разделе [Определения настраиваемого действия](http://go.microsoft.com/fwlink/?LinkId=177801).  
  
12. Дополнительно можно открыть файл ItemTemplate.ico и изменить его для лучшего узнавания.  Значок будет отображаться рядом с элементом проекта в диалоговом окне **Добавление нового элемента**.  
  
13. В **Обозреватель решений** откройте контекстное меню для проекта **ItemTemplate** и выберите пункт **Выгрузить проект**.  
  
14. Раскрывайте контекстное меню для проекта **ItemTemplate** еще раз, после чего нажать кнопку **Правка ItemTemplate.csproj** или **Правка ItemTemplate.vbproj**.  
  
15. Найдите следующий элемент `VSTemplate` в файле проекта.  
  
    ```  
    <VSTemplate Include="ItemTemplate.vstemplate">  
    ```  
  
16. Замените элемент `VSTemplate` на следующий XML\-код, а затем сохраните файл и закройте.  
  
    ```  
    <VSTemplate Include="ItemTemplate.vstemplate">  
      <OutputSubPath>SharePoint\SharePoint14</OutputSubPath>  
    </VSTemplate>  
    ```  
  
     Элемент `OutputSubPath` задает путь к дополнительным папкам, в которых при построении проекта создается шаблон элемента.  Заданные здесь папки обеспечивают доступность шаблона элемента только клиенты при открытии диалогового окна **Добавить новый элемент**, разверните узел **SharePoint**, а затем выбрать узел **2010**.  
  
17. В **Обозреватель решений** откройте контекстное меню для проекта **ItemTemplate** и выберите пункт **Перезагрузить проект**.  
  
## Создание пакета VSIX для развертывания элемента проекта  
 Для развертывания расширения воспользуйтесь проектом VSIX в своем решении для создания пакета VSIX.  Сначала настройте пакет VSIX, изменив содержимое файла source.extension.vsixmanifest, входящего в состав проекта VSIX.  Затем создайте пакет VSIX, выполнив построение решения.  
  
#### Настройка и создание пакета VSIX  
  
1.  В **Обозреватель решений** откройте контекстное меню **source.extension.vsixmanifest** для файла в проект CustomActionProjectItem, а затем выберите **Открыть**.  
  
     Файл будет открыт Visual Studio в редакторе манифестов.  Файл source.extension.vsixmanifest является основой для файла extension.vsixmanifest которого все пакеты VSIX требуют.  Дополнительные сведения об этом файле см. в разделе [Справочник по схеме расширения VSIX](http://msdn.microsoft.com/ru-ru/76e410ec-b1fb-4652-ac98-4a4c52e09a2b).  
  
2.  В поле **Название продукта** введите **Элемент проекта настраиваемого действия**.  
  
3.  В поле **Автор** введите **Contoso**.  
  
4.  В поле **Описание** введите **Элемент проекта SharePoint, представляющего настраиваемое действие**.  
  
5.  На вкладке **Активы**, нажмите кнопку **Создать**.  
  
     Откроется диалоговое окно **Добавить новый актив**.  
  
6.  В списке **Тип** выберите **Microsoft.VisualStudio.ItemTemplate**.  
  
    > [!NOTE]  
    >  Это значение соответствует элементу `ItemTemplate`, описанному в файле extension.vsixmanifest.  Этот элемент определяет вложенную папку в пакете VSIX, содержащую шаблон элемента проекта.  Для получения дополнительной информации см. [NIB: ItemTemplate Element \(VSX Schema\)](http://msdn.microsoft.com/ru-ru/1d489e54-c1c5-4f96-a510-6c2640867ff0).  
  
7.  В списке **Источник** выберите **Проект в текущем решении**.  
  
8.  В списке **Проект** выберите **ItemTemplate**, а затем нажмите кнопку **ОК**.  
  
9. На вкладке **Активы**, выберите кнопку **Создать** еще раз.  
  
     Откроется диалоговое окно **Добавить новый актив**.  
  
10. В списке **Тип** выберите **Microsoft.VisualStudio.MefComponent**.  
  
    > [!NOTE]  
    >  Это значение соответствует элементу `MefComponent`, описанному в файле extension.vsixmanifest.  Этот элемент задает имя сборки расширения в пакете VSIX.  Для получения дополнительной информации см. [NIB: MEFComponent Element \(VSX Schema\)](http://msdn.microsoft.com/ru-ru/8a813141-8b73-44c9-b80b-ca85bbac9551).  
  
11. В списке **Источник** выберите **Проект в текущем решении**.  
  
12. В списке **Проект** выберите **ProjectItemDefinition**.  
  
13. Нажмите кнопку **ОК**.  
  
14. В строке меню выберите **Построение**, **Построить решение**, а затем убедитесь, что проект компилируется без ошибок.  
  
15. Убедитесь, что в выходную папку построения для проекта CustomActionProjectItem содержит файл CustomActionProjectItem.vsix.  
  
     По умолчанию выходной папкой построения является папка. \\bin\\Debug папку в папке, содержащей проект CustomActionProjectItem.  
  
## Тестирование элемента проекта  
 Элемент проекта готов к тестированию.  Начните отладку решения CustomActionProjectItem в экспериментальном экземпляре Visual Studio.  Затем протестируйте элемент проекта **Настраиваемое действие** проекта SharePoint в экспериментальном экземпляре Visual Studio.  И наконец, выполните построение и запустите проект SharePoint, чтобы проверить, что настраиваемое действие работает ожидаемым образом.  
  
#### Начало отладки решения  
  
1.  Перезапустите Visual Studio с правами администратора, и открыть решения CustomActionProjectItem.  
  
2.  Откройте файл кода CustomAction, а затем добавьте точку останова в первой строке кода в методе `InitializeType`.  
  
3.  Выберите ключ **F5**, чтобы начать отладку.  
  
     Visual Studio установит расширение в папку %UserProfile%\\AppData\\Local\\Microsoft\\VisualStudio\\10.0Exp\\Extensions\\Contoso\\Custom Action Project Item\\1.0 и запустит экспериментальный экземпляр Visual Studio.  При выполнении элемента проекта в этом экземпляре Visual Studio.  
  
#### Тестирование элемента проекта в Visual Studio  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **Файл**, **Создать**, **Проект**.  
  
2.  Разверните узел **Visual C\#** или **Visual Basic** \(в зависимости от языка и региональных параметров, шаблон элемента\), разверните узел **SharePoint**, затем выберите узел **2010**.  
  
3.  В списке шаблонов проектов выберите **Проект SharePoint 2010**.  
  
4.  В поле **Имя** введите **CustomActionTest**, а затем нажмите кнопку **ОК**.  
  
5.  В поле **Мастер настройки SharePoint** введите URL\-адрес сайта, который требуется использовать для отладки, и затем нажмите кнопку **Готово**.  
  
6.  В **Обозреватель решений** откройте контекстное меню для узла проекта, выберите команду **Добавить**, а затем выберите **Создать элемент**.  
  
7.  В диалоговом окне **Добавить новый элемент** выберите узел **2010** в узле **SharePoint**.  
  
     Убедитесь, что элемент **Настраиваемое действие** отображается в списке элементов проекта.  
  
8.  Выберите элемент **Настраиваемое действие**, а затем нажмите кнопку **Добавить**.  
  
     Visual Studio добавит файл с именем элемента **CustomAction1** в проект и открывается файл Elements.xml в редакторе.  
  
9. Убедитесь, что выполнение кода в другом экземпляре Visual Studio прерывается на точке останова, заданной ранее в методе `InitializeType`.  
  
10. Выберите ключ **F5**, чтобы продолжить отладку проекта.  
  
11. В экспериментальном экземпляре Visual Studio в **Обозреватель решений**, чтобы открыть контекстное меню для узла **CustomAction1**, а затем выберите **Конструктор представлений настраиваемого действия**.  
  
12. Убедитесь, что окно сообщения, а затем нажмите кнопку **ОК**.  
  
     С помощью этого контекстного меню можно реализовать дополнительные параметры и команды для разработчиков, например отображение конструктора для настраиваемого действия.  
  
13. В строке меню выберите **Представление**, **Вывод**.  
  
     Откроется окно **Выходные данные**.  
  
14. В **Обозреватель решений** откройте контекстное меню для элемента **CustomAction1** и измените ее имя на **MyCustomAction**.  
  
     В поле **Вывод**, откроется диалоговое окно подтверждения.  Это сообщение записывается обработчиком событий <xref:Microsoft.VisualStudio.SharePoint.ISharePointProjectItemEvents.ProjectItemNameChanged>, определенном в классе `CustomActionProjectItemTypeProvider`.  С помощью обработчиков для этого и других событий элемента проекта можно реализовать настраиваемое поведение, которое может изменять разработчик, настраивая элемент проекта.  
  
#### Тестирование настраиваемого действия в SharePoint  
  
1.  В экспериментальном экземпляре Visual Studio, откройте файл Elements.xml, который является дочерним элементом элемента проекта **MyCustomAction**.  
  
2.  Внесите следующие изменения в файл Elements.xml, и сохраните файл.  
  
    -   В элементе `CustomAction` задайте атрибут `Id` значение GUID или любую другую уникальную строку, как показано в следующем примере:  
  
        ```  
        Id="cd85f6a7-af2e-44ab-885a-0c795b52121a"  
        ```  
  
    -   В элементе `CustomAction` задайте атрибут `Title`, как показано в следующем примере:  
  
        ```  
        Title="SharePoint Developer Center"  
        ```  
  
    -   В элементе `CustomAction` задайте атрибут `Description`, как показано в следующем примере:  
  
        ```  
        Description="Opens the SharePoint Developer Center Web site."  
        ```  
  
    -   В элементе `UrlAction` задайте атрибут `URL`, как показано в следующем примере:  
  
        ```  
        Url="http://msdn.microsoft.com/sharepoint/default.aspx"  
        ```  
  
3.  Нажмите клавишу F5.  
  
     Настраиваемому действию поставляется и развертывается на сайт SharePoint, который задан в свойстве **URL\-адрес сайта** проекта.  В веб\-браузере будет открыта страница по умолчанию для этого сайта.  
  
    > [!NOTE]  
    >  Если появится диалоговое окно **Отладка скриптов отключена**, нажмите кнопку **Да**, чтобы продолжить отладку проекта.  
  
4.  В меню **Действия сайта** выберите команду **Центр разработчиков для SharePoint**, убедитесь, что браузер открывает веб\-сайт http:\/\/msdn.microsoft.com\/sharepoint\/default.aspx, а затем закройте веб\-браузера.  
  
## Очистка компьютера разработчика  
 После завершения тестирования элемента проекта удалите шаблон элемента проекта из экспериментального экземпляра Visual Studio.  
  
#### Очистка компьютера разработчика  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **Сервис**, **Расширения и обновления**.  
  
     Появится диалоговое окно **Расширения и обновления**.  
  
2.  В списке расширений выберите **Элемент проекта настраиваемого действия**, а затем нажмите кнопку **Удалить**.  
  
3.  В диалоговом окне, появившемся на экране, нажмите кнопку **Да**, чтобы подтвердить удаление расширения.  
  
4.  Нажмите кнопку **Перезагрузить сейчас** для завершения процесса удаления.  
  
5.  Закройте и экспериментальный экземпляр Visual Studio и экземпляр, в котором решения CustomActionProjectItem открыто.  
  
## Следующие действия  
 По завершении данного пошагового руководства вы можете добавить мастер к шаблону элемента.  При добавлении пользователем элемента проекта настраиваемого действия в проект SharePoint мастер собирает информацию о действии \(например, его расположение и URL\-адрес, на который происходит переход по, когда действие выбрано\) и добавляет эту информацию в файл Elements.xml нового элемента проекта.  Для получения дополнительной информации см. [Walkthrough: Creating a Custom Action Project Item with an Item Template, Part 2](../sharepoint/walkthrough-creating-a-custom-action-project-item-with-an-item-template-part-2.md).  
  
## См. также  
 [Walkthrough: Creating a Custom Action Project Item with an Item Template, Part 2](../sharepoint/walkthrough-creating-a-custom-action-project-item-with-an-item-template-part-2.md)   
 [Defining Custom SharePoint Project Item Types](../sharepoint/defining-custom-sharepoint-project-item-types.md)   
 [Creating Item Templates and Project Templates for SharePoint Project Items](../sharepoint/creating-item-templates-and-project-templates-for-sharepoint-project-items.md)   
 [Using the SharePoint Project Service](../sharepoint/using-the-sharepoint-project-service.md)   
 [Справочник по схеме шаблонов Visual Studio](../extensibility/visual-studio-template-schema-reference.md)   
 [Image Editor for Icons](/visual-cpp/windows/image-editor-for-icons)   
 [Creating an Icon or Other Image &#40;Image Editor for Icons&#41;](/visual-cpp/windows/creating-an-icon-or-other-image-image-editor-for-icons)  
  
  