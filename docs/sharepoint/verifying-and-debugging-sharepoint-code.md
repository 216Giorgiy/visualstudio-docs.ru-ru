---
title: "Проверка и отладка кода SharePoint"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "модульное тестирование [разработка приложений SharePoint в Visual Studio]"
  - "IntelliTrace [разработка приложений SharePoint в Visual Studio]"
  - "разработка приложений SharePoint в Visual Studio, IntelliTrace"
  - "разработка приложений SharePoint в Visual Studio, модульное тестирование"
ms.assetid: b5f3bce2-6a51-41b1-a292-9e384bae420c
caps.latest.revision: 18
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 17
---
# Проверка и отладка кода SharePoint
  С помощью IntelliTrace и модульного тестирования гораздо легче отлаживать свои приложения SharePoint и проверять, что каждый метод в приложении работает правильно.  Можно использовать эти функции для проектов SharePoint в [!INCLUDE[vs_dev11_long](../sharepoint/includes/vs-dev11-long-md.md)] так же, как и в проектах других типов.  
  
## IntelliTrace  
 С помощью IntelliTrace можно не только определять текущее состояние своего решения SharePoint, но также отслеживать прошедшие события и контекст, в котором эти события произошли.  В своей программе можно переходить назад и вперед к различным моментам во времени решения SharePoint, в которых произошли события, и просматривать состояния и значения переменных в каждый момент времени.  С помощью динамических переходов можно более быстро и легко отлаживать решения SharePoint без установки нескольких точек останова.  Также можно сохранить сеанс отладки в файл журнала IntelliTrace \(.iTrace\), открыть его позже в Visual Studio Ultimate и выполнить отладку после аварийного завершения.  .iTrace\-файл содержит подробные сведения о том, когда и где случились определенные ошибки SharePoint, поэтому легче выяснить, что приводит к ошибке.  Сведения в .iTrace\-файле это подмножество всего журнала ошибок, который создается унифицированной системой ведения журнала \(ULS\) в SharePoint.  Эти сведения включают события, относящихся к SharePoint, например при открытии или закрытии профиля пользователя и при загрузке свойств в проекте SharePoint, из чтении или изменении.  Можно настроить записываемые события IntelliTrace.  Дополнительные сведения см. в разделах [Использование сохраненных данных IntelliTrace](../debugger/using-saved-intellitrace-data.md) и [Настройка IntelliTrace для сбора данных об отладке](http://msdn.microsoft.com/ru-ru/7657ecab-e07e-4b1b-872d-f05d966be37e).  
  
 При возникновении ошибки в SharePoint, диалоговое окно ошибки указывает идентификатор «идентификатор корреляции» для этой конкретной ошибки.  Можно также получить идентификаторы корреляции из событий, перечисленных в .iTrace\-файле.  Для отображения списка всех событий, которые выполнялись с заданным идентификатором корреляции, можно ввести идентификатор в разделе **Анализ** страницы со сводкой IntelliTrace.  В этом разделе, можно выбрать, следует ли показывать только имена произошедших событий или имена их вместе со сведениями о вызовах, например имя функции, точки выход и точки входа, параметры и возвращаемые значения.  
  
 Можно получить события Visual Studio в IntelliTrace, нажав клавишу **F5**.  Получение событий, относящихся к SharePoint, однако необходимо собирать данные IntelliTrace в решениях SharePoint с помощью Microsoft Monitoring Agent.  Этот инструмента собирает данные IntelliTrace и создает .iTrace\-файлы для приложений, которые развертываются вне Visual Studio.  Дополнительные сведения см. в разделах [Функции IntelliTrace](../debugger/intellitrace-features.md) и [Использование автономного сборщика данных IntelliTrace](../debugger/using-the-intellitrace-stand-alone-collector.md).  
  
## Модульное тестирование  
 Модульное тестирование, при котором вы пишете и выполняете тестовый код внутри методов теста, облегчает поиск ошибок в вашем коде.  Эти методы содержат пустые переменные и оператор Assert, которые можно использовать для проверки логики и функциональности своего проекта, основанного на объектной модели SharePoint.  Дополнительные сведения см. в разделе [Модульное тестирование кода](../test/unit-test-your-code.md).  
  
### Поддержка Microsoft Fakes Framework  
 Проекты SharePoint поддерживают Microsoft Fakes, платформа изоляции, в которой можно создать тестовые заглушки на основе делегатов, в приложениях на основе платформы .NET Framework.  С помощью платформы Fakes можно создать, поддерживают и встраивать заглушки в модульные тесты.  Эти заглушки и оболочки изолируют модульные тесты от среды.  Можно создать заглушки для тестирования кода, который использует интерфейсы или не изолированные классы с переопределяемыми методами.  Можно создать оболочки для перенаправления жестко запрограммированных вызовов к изолированным классам с статическими методами или не переопределяемыми методами альтернативной реализации оболочки.  Возможно использовать делегаты с заглушками и обертками для динамического изменения поведения членов заглушки.  Для получения дополнительной информации см. [Изоляция тестируемого кода с помощью Microsoft Fakes](../test/isolating-code-under-test-with-microsoft-fakes.md).  
  
## Связанные разделы  
  
|Название|Описание|  
|--------------|--------------|  
|[Использование IntelliTrace](../debugger/intellitrace.md)|Описаны более простые способы отладки решения Visual Studio с помощью IntelliTrace.|  
|[Пошаговое руководство. Отладка приложения SharePoint при помощи IntelliTrace](../sharepoint/walkthrough-debugging-a-sharepoint-application-by-using-intellitrace.md)|Описывает, как использовать IntelliTrace для поиска ошибок кода в проекте SharePoint.|  
|[Модульное тестирование кода](../test/unit-test-your-code.md)|Описывает, как находить логические ошибки в коде с помощью модульных тестов.|  
  
## См. также  
 [Улучшение качества кода](../test/improve-code-quality.md)  
  
  