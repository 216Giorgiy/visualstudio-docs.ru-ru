---
title: "Пошаговое руководство. Создание внешнего списка в SharePoint с помощью бизнес-данных | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "служба подключения к бизнес-данным [разработка приложений SharePoint в Visual Studio], бизнес-данные в веб-части"
  - "подключение к бизнес-данным [разработка приложений SharePoint в Visual Studio], внешний список"
  - "служба подключения к бизнес-данным [разработка приложений SharePoint в Visual Studio], бизнес-данные в списке SharePoint"
  - "подключение к бизнес-данным [разработка приложений SharePoint в Visual Studio], бизнес-данные в списке SharePoint"
  - "подключение к бизнес-данным [разработка приложений SharePoint в Visual Studio], бизнес-данные в веб-части"
  - "подключение к бизнес-данным [разработка приложений SharePoint в Visual Studio], список, связанный с сущностями"
  - "служба подключения к бизнес-данным [разработка приложений SharePoint в Visual Studio], список, связанный с сущностями"
  - "служба подключения к бизнес-данным [разработка приложений SharePoint в Visual Studio], внешний список"
ms.assetid: 046cf234-705a-4a6f-91f8-c5c569ae0dd0
caps.latest.revision: 38
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 37
---
# Пошаговое руководство. Создание внешнего списка в SharePoint с помощью бизнес-данных
  Служба подключения к бизнес\-данным позволяет отображать в SharePoint бизнес\-данные серверных приложений, веб\-служб и баз данных.  
  
 В этом пошаговом руководстве описана процедура создания модели для службы BDC, возвращающая сведения о контактах в примере базы данных.  Затем с использованием этой модели можно будет создавать внешний список в SharePoint.  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Создание проекта.  
  
-   Добавление сущности в модель.  
  
-   Добавление метода поиска.  
  
-   Добавление конкретного метода поиска.  
  
-   Проверка проекта.  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые версии Windows и SharePoint.  Для получения дополнительной информации см. [Требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vsPro](../sharepoint/includes/vspro-md.md)], [!INCLUDE[vsUltLong](../sharepoint/includes/vsultlong-md.md)] или [!INCLUDE[vsPreLong](../sharepoint/includes/vsprelong-md.md)].  
  
-   Доступ к примеру базы данных AdventureWorks.  Сведения по установке базы данных AdventureWorks см. в разделе [SQL Server Sample Databases](http://go.microsoft.com/fwlink/?LinkID=117483).  
  
## Создание проекта, содержащего модель подключения к бизнес\-данным  
  
#### Создание проекта, содержащего модель подключения к бизнес\-данным  
  
1.  В Visual Studio в строке меню выберите **Файл**, **Создать**, **Проект**.  
  
     Откроется диалоговое окно **Новый проект**.  
  
2.  В области **Visual C\#** или **Visual Basic** разверните узел **SharePoint** и выберите элемент **2010**.  
  
3.  В панели **Шаблоны** выберите **Проект SharePoint 2010**, назовите проект AdventureWorksTest, а затем нажмите кнопку **ОК**.  
  
     Появится окно **Мастер настройки SharePoint**.  Этот мастер позволяет указать сайт, который будет использоваться для отладки проекта, и установить уровень доверия решения.  
  
4.  Выберите переключатель **Развернуть как решение фермы**, чтобы задать уровень доверия.  
  
5.  Нажмите кнопку **Готово**, чтобы принять предлагаемый по умолчанию локальный сайт SharePoint.  
  
6.  В области **Обозреватель решений** выберите узел проекта SharePoint.  
  
7.  В строке меню выберите **Проект**, **Добавить новый элемент**.  
  
     Откроется диалоговое окно **Добавление нового элемента**.  
  
8.  В панели **Шаблоны** выберите **Модель подключения к бизнес\-данным \(только для решения фермы\)**, назовите проект AdventureWorksContacts и затем нажмите кнопку **Добавить**.  
  
## Добавление классов доступа к данным в проект  
  
#### Добавление классов доступа к данным в проект  
  
1.  В строке меню выберите **Сервис**, **Подключиться к базе данных**.  
  
     Откроется диалоговое окно **Добавление подключения**.  
  
2.  Добавьте подключение в пример базы данных SQL Server AdventureWorks.  
  
     Для получения дополнительной информации см. [Add\/Modify Connection \(Microsoft SQL Server\)](http://msdn.microsoft.com/ru-ru/fa400910-26c3-4df7-b9d1-115e688b4ea3).  
  
3.  В области **Обозреватель решений** выберите узел проекта.  
  
4.  В строке меню выберите **Проект**, **Добавить новый элемент**.  
  
5.  В области **Установленные шаблоны** выберите узел **Данные**.  
  
6.  В панели **Шаблоны** выберите **Классы преобразования языка LINQ в язык SQL**.  
  
7.  В поле **Имя** укажите AdventureWorks и нажмите кнопку **Добавить**.  
  
     В проект добавится файл .dbml, и откроется реляционный конструктор объектов.  
  
8.  В строке меню выберите **Вид**, **Обозреватель серверов**.  
  
9. В **обозревателе серверов** последовательно разверните узел, представляющий пример базы данных AdventureWorks, и узел **Таблицы**.  
  
10. Добавьте таблицу **Контакты** в реляционный конструктор объектов.  
  
     Создается класс сущностей и появляется в области конструктора.  Класс сущностей имеет свойства, которые сопоставляются столбцам в таблице "Контакты".  
  
## Удаление сущности по умолчанию из модели BDC  
 Проект **Модель подключения к бизнес\-данным** добавляет в модель сущность по умолчанию с именем Entity1.  Удалите эту сущность.  Позже нужно будет добавить новую сущность.  Для выполнения данного пошагового руководства потребуется выполнить меньше действий, если начать работу с пустой модели.  
  
#### Удаление сущности по умолчанию из модели  
  
1.  В **обозревателе решений** разверните узел **BdcModel1** и откройте файл BdcModel1.bdcm.  
  
2.  Файл модели подключения к бизнес\-данным откроется в конструкторе BDC.  
  
3.  В конструкторе откройте контекстное меню для **Entity1** и выберите **Удалить**.  
  
4.  В **Обозревателе решений** откройте контекстное меню для Entity1.vb \(в Visual Basic\) или Entity1.cs \(в C\#\), а затем выберите **Удалить**.  
  
5.  Откройте контекстное меню для Entity1Service.vb \(в Visual Basic\) или Entity1Service.cs \(в C\#\), а затем выберите **Удалить**.  
  
## Добавление сущности в модель  
 Добавьте сущность в модель.  Можно добавлять сущности с **панели элементов** Visual Studio в конструктор BDC.  
  
#### Добавление сущности в модель  
  
1.  В меню **Вид** выберите **Область элементов**.  
  
2.  На **панели элементов** на вкладке **Подключение к бизнес\-данным** добавьте **Сущность** в конструктор BDC.  
  
     В конструкторе откроется новая сущность.  Visual Studio добавит файл в проект с именем EntityService.vb \(в Visual Basic\) или EntityService.cs \(в C\#\).  
  
3.  В строке меню выберите **Вид**, **Свойства**, **Окно**.  
  
4.  В окне **Свойства** задайте для свойства **Name** значение "Контакты"  
  
5.  В конструкторе откройте контекстное меню сущности, выберите **Добавить**, а затем **Идентификатор**.  
  
     В сущности отобразится новый идентификатор.  
  
6.  В окне **Свойства** измените имя идентификатора на ContactID.  
  
7.  В списке **Имя типа** выберите **System.Int32**.  
  
## Добавление конкретного метода поиска  
 Чтобы включить отображение конкретных контактов в службе BDC, необходимо добавить конкретный метод поиска.  Служба BDC вызывает конкретный метод поиска, когда пользователь выбирает элемент в списке и нажимает кнопку **Просмотреть элемент** на ленте.  
  
 Добавьте конкретный метод поиска в сущность "Контакты", воспользовавшись окном **Подробности метода BDC**.  Чтобы возвратить конкретную сущность, добавьте код в метод.  
  
#### Добавление конкретного метода поиска  
  
1.  В конструкторе BDC выберите сущность **Контакты**.  
  
2.  В строке меню выберите **Вид**, **Другие окна**, **Подробности метода BDC**.  
  
     Откроется окно Подробности метода BDC.  
  
3.  В списке **Добавить метод** выберите **Создать конкретный метод поиска**.  
  
     Visual Studio добавит в модель следующие элементы.  Следующие элементы отображаются в окне **Подробности метода BDC**.  
  
    -   Метод с именем ReadItem.  
  
    -   Входной параметр для метода.  
  
    -   Возвращаемый параметр для метода.  
  
    -   Дескриптор типа для каждого параметра.  
  
    -   Экземпляр метода для метода.  
  
4.  В окне **Подробности метода BDC** откройте список, отображаемый для дескриптора типа **Контакты**, и щелкните **Изменить**.  
  
     **Обозреватель BDC** открывает и предоставляет иерархическое представление модели.  
  
5.  В окне **Свойства** откройте список рядом со свойством **TypeName** перейдите на вкладку **Текущий проект**, а затем выберите свойство **Контакты**.  
  
6.  В **Обозреватель BDC** откройте контекстное меню **Контакты** и выберите пункт **Добавить дескриптор типа**.  
  
     В **обозревателе BDC** отобразится дескриптор типа с именем **TypeDescriptor1**.  
  
7.  В окне **Свойства** задайте для свойства **Имя** значение **ContactID**.  
  
8.  Откройте список рядом со свойством **TypeName** и выберите пункт **Int32**.  
  
9. Откройте список рядом со свойством **Идентификатор** и затем выберите **ContactID**.  
  
10. Повторите шаг 6, чтобы создать дескриптор типа для каждого из следующих полей.  
  
    |Имя|Имя типа|  
    |---------|--------------|  
    |FirstName|System.String|  
    |LastName|System.String|  
    |Phone|System.String|  
    |EmailAddress|System.String|  
    |EmailPromotion|System.Int32|  
    |NameStyle|System.Boolean|  
    |PasswordHash|System.String|  
    |PasswordSalt|System.String|  
  
11. В конструкторе BDC в сущности **Контакты** откройте метод **ReadItem**.  
  
     В редакторе кода открывается файл кода службы контактов.  
  
12. Замените метод `ReadItem` в классе `ContactService` на следующий код.  Этот код выполняет следующие задачи:  
  
    -   Извлечение записи из таблицы "Контакты" базы данных AdventureWorks.  
  
    -   Возвращение сущности "Контакты" в службу BDC.  
  
    > [!NOTE]  
    >  Замените значение поля `ServerName` на имя сервера.  
  
     [!code-csharp[SP_BDC#3](../snippets/csharp/VS_Snippets_OfficeSP/sp_bdc/CS/bdcmodel1/contactservice.cs#3)]
     [!code-vb[SP_BDC#3](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_bdc/VB/bdcmodel1/contactservice.vb#3)]  
  
## Добавление метода поиска  
 Чтобы включить отображение контактов списком в службе BDC, необходимо добавить метод поиска.  Добавьте метод поиска в сущность "Контакты", воспользовавшись окном **Подробности метода BDC**.  Чтобы возвратить коллекцию сущностей в службу BDC, добавьте код в метод.  
  
#### Добавление метода поиска  
  
1.  В конструкторе BDC выберите сущность **Контакты**.  
  
2.  В окне **Подробности метода BDC** сверните узел **ReadItem**.  
  
3.  В списке **Добавить метод** под методом **ReadList** выберите **Создать метод поиска**.  
  
     Visual Studio добавляет метод, возвращаемый параметр и дескриптор типа.  
  
4.  В конструкторе BDC в сущности **Контакты** откройте метод **ReadList**.  
  
     В редакторе кода открывается файл кода службы контактов.  
  
5.  Замените метод `ReadList` в классе `ContactService` на следующий код.  Этот код выполняет следующие задачи:  
  
    -   Извлечение данных из таблицы "Контакты" базы данных AdventureWorks.  
  
    -   Возвращение списка сущностей "Контакты" в службу BDC.  
  
    > [!NOTE]  
    >  Замените значение поля `ServerName` на имя сервера.  
  
     [!code-csharp[SP_BDC#2](../snippets/csharp/VS_Snippets_OfficeSP/sp_bdc/CS/bdcmodel1/contactservice.cs#2)]
     [!code-vb[SP_BDC#2](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_bdc/VB/bdcmodel1/contactservice.vb#2)]  
  
## Проверка проекта  
 При запуске проекта открывается сайт SharePoint, и Visual Studio добавляет модель в службу подключения к бизнес\-данным.  Создайте в SharePoint внешний список, который ссылается на сущность "Контакты".  В списке отобразятся данные по контактам в базе данных AdventureWorks.  
  
> [!NOTE]  
>  Возможно, для отладки решения потребуется изменить параметры безопасности в SharePoint.  Для получения дополнительной информации см. [Проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md).  
  
#### Тестирование проекта  
  
1.  Нажмите клавишу **F5**.  
  
     Откроется сайт SharePoint.  
  
2.  В меню **Действия сайта** выберите команду **Дополнительные параметры**.  
  
3.  На странице **Создать** выберите шаблон **Внешний список**, а затем нажмите кнопку **Создать**.  
  
4.  Присвойте пользовательскому списку имя Contacts.  
  
5.  Выберите кнопку обзора рядом с полем **Внешний тип контента**.  
  
6.  В диалоговом окне **Средство выбора внешнего типа контента** выберите элемент **AdventureWorksContacts.BdcModel1.Contact** и нажмите кнопку **Создать**.  
  
     SharePoint создает внешний список, содержащий контакты из базы данных AdventureWorks.  
  
7.  Чтобы протестировать конкретный метод поиска, выберите контакт в списке.  
  
8.  На ленте выберите вкладку **Элементы**, а затем выберите команду **Просмотр элементов**.  
  
     В форме отобразятся подробности выбранного контакта.  
  
## Следующие действия  
 Дополнительные сведения о разработке моделей для службы BDC в SharePoint см. в следующих разделах.  
  
-   [Практическое руководство. Добавление метода Creator](../sharepoint/how-to-add-a-creator-method.md).  
  
-   [Практическое руководство. Добавление метода Updater](../sharepoint/how-to-add-an-updater-method.md).  
  
-   [Практическое руководство. Добавление метода Deleter](../sharepoint/how-to-add-a-deleter-method.md).  
  
## См. также  
 [Проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md)   
 [Создание модели подключения к бизнес-данным](../sharepoint/creating-a-business-data-connectivity-model.md)   
 [Общие сведения о средствах разработки моделей подключения к бизнес-данным](../sharepoint/bdc-model-design-tools-overview.md)   
 [Интеграция бизнес-данных в SharePoint](../sharepoint/integrating-business-data-into-sharepoint.md)  
  
  