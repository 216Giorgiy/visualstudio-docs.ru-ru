---
title: "Пошаговое руководство. Импорт элементов из существующего сайта SharePoint"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "импорт элементов [разработка приложений SharePoint в Visual Studio]"
  - "разработка приложений SharePoint в Visual Studio, импорт элементов"
ms.assetid: faac3309-88d7-4fb2-8392-feda07fc00e5
caps.latest.revision: 21
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 20
---
# Пошаговое руководство. Импорт элементов из существующего сайта SharePoint
  В этом пошаговом руководстве показано, как импортировать элементы из существующего сайта SharePoint в проект [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] SharePoint.  
  
 В этом пошаговом руководстве показано выполнение следующих задач.  
  
-   Настройка сайта SharePoint путем добавления пользовательского столбца \(называемого *полем*\).  
  
-   Экспорт сайта SharePoint в WSP\-файл.  
  
-   Импорт WSP\-файла в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] SharePoint с помощью проекта импорта WSP\-файла.  
  
 [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые выпуски [!INCLUDE[TLA#tla_win](../sharepoint/includes/tlasharptla-win-md.md)] и SharePoint.  Для получения дополнительной информации см. [Требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   Visual Studio.  
  
## Настройка сайта SharePoint  
 В этом примере демонстрируется создание и настройка дочернего сайта SharePoint путем добавления нового столбца и создания нового дочернего сайта для использования в дальнейшем.  На более позднем этапе нам предстоит экспортировать дочерний сайт в WSP\-файл и импортировать пользовательский столбец сайта в дочерний сайт с помощью проекта импорта WSP\-файла.  
  
#### Создание и настройка сайта SharePoint  
  
1.  Откройте в веб\-браузере сайт SharePoint, например http:\/\/*system name*\/SitePages\/Home.aspx.  
  
2.  Создайте дочерний сайт главного сайта SharePoint, открыв меню **Действия сайта**, а затем выбрав **Создать сайт**.  
  
3.  В диалоговом окне сайта **Создать** выберите тип **Пустой сайт**.  
  
4.  В поле **Название** введите Site Column Test 1, в поле **URL\-имя** — columntest1, для остальных параметров примите значения по умолчанию и нажмите кнопку **Создать**.  
  
5.  После создания сайта перейдите в браузере на главный сайт \(http:\/\/*system name*\/SitePages\/Home.aspx\).  
  
6.  Снова создайте пустой дочерний сайт главного сайта SharePoint, открыв меню **Действия сайта**, выбрав ссылку **Создать сайт**, а затем выбрав пункт **Пустой сайт**.  
  
7.  В поле **Название** введите Site Column Test 2, в поле **URL\-имя** — columntest2, для остальных параметров примите значения по умолчанию и нажмите кнопку **Создать**.  
  
8.  Вернитесь к первому дочернему сайту, http:\/\/*SystemName*\/columntest1\/default.aspx.  
  
9. Щелкните элемент **Параметры сайта** в меню **Действия сайта**, чтобы вывести страницу параметров сайта.  
  
10. В разделе **Коллекции** выберите ссылку **Столбцы сайта**.  
  
11. В верхней части страницы **Коллекция столбцов сайтов** нажмите кнопку **Создать**.  
  
12. В поле **Имя столбца** введите Test Column, сохраните другие значения по умолчанию, а затем нажмите кнопку **ОК**.  
  
13. Столбец с именем **Test Column** появится под заголовком "Настраиваемые столбцы" в "Коллекции столбцов сайта".  
  
## Экспорт сайта SharePoint  
 Теперь необходимо получить WSP\-файл SharePoint, содержащий элементы SharePoint и элементы, которые требуется импортировать в проект [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] SharePoint.  Если такой WSP\-файл отсутствует, необходимо создать его из существующего сайта SharePoint.  В этом примере мы экспортируем сайт SharePoint по умолчанию в WSP\-файл.  
  
> [!IMPORTANT]  
>  Если в ходе этой процедуры возникает ошибка среды выполнения, необходимо выполнить ее в системе с доступом к сайту SharePoint.  
  
#### Экспорт существующего сайта SharePoint  
  
1.  На сайте SharePoint выберите **Параметры сайта** на вкладке **Действия сайта**, чтобы вывести страницу параметров сайта.  
  
2.  В разделе **Действия сайта** на странице параметров сайта выберите ссылку **Сохранение сайта в качестве шаблона**.  
  
3.  В поле **Имя файла** введите ExampleSite, а в поле **Имя шаблона** — Example Site.  
  
4.  В этом примере не устанавливайте флажок **Включение содержимого**.  
  
     Если установить этот флажок, [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] сохранит в WSP\-файле все списки и библиотеки документов вместе с их содержимым.  В некоторых случаях эта возможность полезна, но она не требуется в данном примере.  
  
5.  После успешного выполнения этой операции воспользуйтесь ссылкой **коллекция решений**, чтобы просмотреть .wsp\-файл.  
  
     В дальнейшем можно просмотреть страницу коллекции решений. Для этого откройте меню **Действия сайта**, выберите **Параметры сайта**, выберите ссылку **Переход к параметрам сайта верхнего уровня** в разделе **Администрирование семейства сайтов** и щелкните ссылку **Решения** в разделе **Коллекции**.  
  
6.  В коллекции решений выберите ссылку **ExampleSite**.  
  
7.  В диалоговом окне **Загрузка файла** нажмите кнопку **Сохранить**, чтобы сохранить файл в локальной системе, по умолчанию, в папке загрузок.  
  
## Импорт WSP\-файла  
 Теперь у нас имеется WSP\-файл, элемент которого требуется использовать повторно \(настраиваемый столбец сайта с именем "Тестовый столбец"\). Чтобы воспользоваться этим элементом, импортируйте WSP\-файл.  
  
#### Импорт WSP\-файла  
  
1.  In [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], в строке меню последовательно выберите пункты **Файл**, **Создать**, **Проект**, чтобы увидеть диалоговое окно **Новый проект**.  Если интерфейс IDE настроен для использования параметров разработки Visual Basic, в меню выберите **Файл**, **Создать проект**.  
  
2.  Разверните узел **SharePoint**, расположенный в области **Visual C\#** или **Visual Basic**, и выберите узел **2010**.  
  
3.  Выберите шаблон **Импорт пакета решения SharePoint** в области **Шаблоны**, оставьте имя проекта WspImportProject1 без изменений и нажмите кнопку **ОК**.  
  
     Появится окно **Мастер настройки SharePoint**.  
  
4.  На странице **Укажите сайт и уровень безопасности для отладки** введите [!INCLUDE[TLA2#tla_url](../sharepoint/includes/tla2sharptla-url-md.md)] второго дочернего сайта SharePoint, созданного ранее.  Необходимо добавить новое пользовательское поле, http:\/\/*system name*\/columntest2, в этот дочерний сайт.  
  
5.  В разделе **Какой уровень доверия для данного решения SharePoint** оставьте значение **Развернуть как изолированное решение** без изменений.  
  
6.  На странице **Укажите новый исходный файл проекта** перейдите в расположение в системе, где сохранен .wsp\-файл, и нажмите кнопку **Далее**.  
  
    > [!NOTE]  
    >  При нажатии кнопки **Готово** на этой странице, будут импортированы все доступные в .wsp\-файле элементы.  
  
7.  В поле **Укажите элементы, которые требуется импортировать** снимите флажки для всех элементов списка, за исключением **Тестовый столбец**, и нажмите кнопку **Готово**.  
  
     Поскольку список содержит множество элементов, нажмите клавиши CTRL \+ A, чтобы выбрать все элементы в списке, нажмите пробел, чтобы снять все флажки, а затем выделите только флажок рядом с элементом **Test Column**.  
  
     После завершения операции импорта создается проект **WspImportProject1**, содержащий папку **Fields**.  В этой папке содержится настраиваемый столбец сайта **Тестовый столбец** и его файл определения Elements.xml.  
  
## Развертывание проекта  
 Разверните проект **WspImportProject1**на втором дочернем сайте SharePoint, созданном ранее, чтобы отобразить настраиваемый столбец.  
  
#### Развертывание проекта  
  
1.  Нажмите клавишу F5 в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], чтобы развернуть и запустить проект импорта .wsp\-файла.  
  
2.  На сайте SharePoint откройте меню **Действия сайта** и выберите пункт **Параметры сайта**, чтобы вывести страницу Параметров сайта.  
  
3.  В разделе **Коллекции** выберите ссылку **Столбцы сайта**.  
  
4.  Перейдите вниз к разделу **Настраиваемые столбцы**.  
  
     Обратите внимание, что в списке появился настраиваемый столбец, импортированный из первого сайта SharePoint.  
  
## См. также  
 [Импорт элементов из существующего сайта SharePoint](../sharepoint/importing-items-from-an-existing-sharepoint-site.md)   
 [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)   
 [Создание многократно используемых пользовательских элементов управления для веб-частей или страниц приложений](../sharepoint/creating-reusable-controls-for-web-parts-or-application-pages.md)  
  
  