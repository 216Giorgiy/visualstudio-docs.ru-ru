---
title: "Практическое руководство. Локализация разметки ASPX"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "локализация XML [разработка приложений SharePoint в Visual Studio]"
  - "разработка приложений SharePoint в Visual Studio, локализация"
ms.assetid: 9559a1d1-6558-4c24-a51e-c6ee79432778
caps.latest.revision: 16
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 15
---
# Практическое руководство. Локализация разметки ASPX
  [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] \(.aspx\) страницы обычно используют жестко запрограммированные значения строк.  Для локализации таких строк замените их выражениями, ссылающимися на локализованные ресурсы.  
  
## Локализация разметки ASPX  
  
#### Локализация разметки ASPX  
  
1.  Добавьте отдельные файлы ресурсов: один для языка по умолчанию и по одному для каждого языка локализации.  
  
     При локализации одной разметки, без кода, добавьте глобальный файл ресурсов элемента проекта.  При локализации кода и разметки добавьте файл ресурсов элемента проекта.  
  
    1.  Чтобы добавить глобальный файл ресурсов, в **обозревателе решений** откройте контекстное меню для элемента проекта SharePoint и выберите **Добавить**, **Новый элемент**.  В узле SharePoint **2010** выберите шаблон **Глобальный файл ресурсов**.  
  
    2.  Чтобы добавить файл ресурсов, в **обозревателе решений** откройте контекстное меню для элемента проекта SharePoint и выберите **Добавить**, **Новый элемент**.  В узле **Visual Basic** или **Visual C \#** выберите шаблон **Файл ресурсов**.  
  
    > [!NOTE]  
    >  Убедитесь, что файлы ресурсов добавлены в элемент проекта SharePoint и свойство "Тип развертывания" доступно.  Данное свойство потребуется далее в этой процедуре.  Если в решении отсутствует элемент проекта SharePoint, можно добавить пустой проект SharePoint и удалить его файл Elements.xml по умолчанию.  
  
2.  Языковому файлу ресурсов по умолчанию присвойте любое имя с расширением .resx, например, MyAppResources.resx.  Используйте одинаковое базовое имя для каждого локализованного файла ресурсов с добавлением идентификатора языка и региональных параметров [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)].  Например, локализованный ресурс для немецкого языка назовите MyAppResources.de\-DE.resx.  
  
3.  Измените значение свойства **Тип развертывания** для каждого файла ресурсов на **AppGlobalResource**, чтобы каждый файл развертывался в папке сервера App\_GlobalResources.  
  
4.  При использовании ресурсов для локализации кода вместе с разметкой ASPX, оставьте свойство **Действие при построении** для каждого файла в значении **Внедренный ресурс**.  При использовании файлов ресурсов только для локализации разметки можно дополнительно изменить значение свойства файлов на **Содержимое**.  Для получения дополнительной информации см. [Локализация решений SharePoint](../sharepoint/localizing-sharepoint-solutions.md).  
  
5.  Откройте каждый файл ресурсов и добавьте локализованные строки, используя одинаковый идентификатор строк для каждого файла.  
  
6.  В разметке [!INCLUDE[TLA2#tla_xml](../sharepoint/includes/tla2sharptla-xml-md.md)] для страницы ASPX или элемента управления замените жестко запрограммированные строки значениями в следующем формате:  
  
    ```  
    <%$Resources:Resource File Name, String ID%>  
    ```  
  
     Например, для локализации текса для элемента управления метка на странице приложения следует изменить:  
  
    ```  
    <asp:Content ID="Main" ContentPlaceHolderID="PlaceHolderMain" runat="server">  
    <asp:Label ID="lbl" runat="server" Text="Label text"></asp:Label>  
    </asp:Content>  
    ```  
  
     в  
  
    ```  
    <asp:Content ID="Main" ContentPlaceHolderID="PlaceHolderMain" runat="server">  
    <asp:Label ID="lbl" runat="server" Text="<%$Resources:MyAppResources,String1%>"></asp:Label>  
    </asp:Content>  
    ```  
  
7.  Нажмите клавишу F5, чтобы собрать и запустить приложение.  
  
8.  Измените в SharePoint заданный по умолчанию язык отображения.  
  
     В приложении появятся локализованные строки.  Для отображения локализованных ресурсов на сервере SharePoint должен быть установлен языковой пакет, соответствующий языку и региональным параметрам файла ресурсов.  
  
## См. также  
 [Локализация решений SharePoint](../sharepoint/localizing-sharepoint-solutions.md)   
 [Практическое руководство. Локализация компонента](../sharepoint/how-to-localize-a-feature.md)   
 [Практическое руководство. Добавление файла ресурсов](../sharepoint/how-to-add-a-resource-file.md)   
 [Практическое руководство. Локализация кода](../sharepoint/how-to-localize-code.md)  
  
  