---
title: "Создание многократно используемых элементов управления для веб-частей или страниц приложений | Документы Microsoft"
ms.custom: 
ms.date: 02/02/2017
ms.reviewer: 
ms.suite: 
ms.technology: office-development
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- user controls [SharePoint development in Visual Studio], creating
- SharePoint development in Visual Studio, user controls
ms.assetid: 8fcafd98-c002-47f1-b4a9-cbb500232616
caps.latest.revision: "19"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.workload: office
ms.openlocfilehash: 02847ae640f969d3c330b5eb573f36c74ef07a2f
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="creating-reusable-controls-for-web-parts-or-application-pages"></a>Создание многократно используемых пользовательских элементов управления для веб-частей или страниц приложений
  Visual Studio позволяет создавать пользовательские элементы управления с возможностью повторного использования, которые можно размещать на страницах приложений и в веб-частях, используемых в SharePoint. Эти элементы управления называются пользовательскими элементами управления. Пользовательский элемент управления представляет собой составной элемент управления, который работает почти как веб-страницу ASP.NET, можно добавить существующий элемент управления и разметки в пользовательский элемент управления и определить свойства и методы для элемента управления. Затем их можно внедрять в веб-страницах ASP.NET, где они будут действовать как единое целое.  
  
## <a name="creating-a-user-control"></a>Создание пользовательского элемента управления  
 Чтобы создать пользовательский элемент управления, добавьте **пользовательский элемент управления** для **пустой проект SharePoint**. Дополнительные сведения см. в разделе [как: создать пользовательский элемент управления для страницы приложения SharePoint или веб-часть](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md).  
  
 При добавлении **пользовательский элемент управления** товар, Visual Studio создает папку в проекте и добавляет в нее несколько файлов. В следующей таблице описаны каждого файла.  
  
|Файл|Описание:|  
|----------|-----------------|  
|Файл пользовательского элемента управления|Определяет пользовательский элемент управления. Разработка пользовательского элемента управления путем добавления элементов управления и разметки в этот файл.|  
|Файл кода|Содержит код программной части пользовательского элемента управления. Добавьте код для обработки событий в этот файл.|  
|Файл кода конструктора|Содержит код, созданный с помощью конструктора и не следует изменять непосредственно.|  
  
## <a name="designing-the-user-control"></a>Проектирование пользовательского элемента управления  
 Разработка пользовательского элемента управления с помощью конструктора Visual Web Developer в Visual Studio. Этот конструктор появляется при открытии файла пользовательского элемента управления в проекте и выберите **разработки** вкладки.  

## <a name="consuming-the-user-control"></a>Использование пользовательского элемента управления  
 Пользовательские элементы управления не отображаются в SharePoint пока вы включите их в страницу приложения или веб-части.  
  
 Чтобы включить пользовательский элемент управления в страницу приложения, откройте веб-страницы, к которому требуется добавить пользовательский элемент управления ASP.NET. Переключитесь в представление конструктора, а затем в обозревателе решений выберите файл пользовательского элемента управления и перетащите его на страницу. Пользовательский элемент управления ASP.NET будет добавлен на страницу, и конструктор создает директиву @ Register, которая требуется для распознавания в пользовательский элемент управления страницей. Теперь можно работать с открытым свойствам и методам элемента управления.  
  
 Чтобы включить пользовательский элемент управления в веб-часть, добавьте пользовательский элемент управления веб-части <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> коллекции в файле кода веб-части. В следующем примере добавляется элемент управления пользователя <xref:System.Web.UI.WebControls.WebParts.Part.Controls%2A> коллекции веб-части.  
  
 [!code-vb[SP_VisualWebPart#5](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1.vb#5)]
 [!code-csharp[SP_VisualWebPart#5](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1.cs#5)]  
  
## <a name="debugging-a-user-control"></a>Отладка пользовательского элемента управления  
 Для отладки пользовательского элемента управления, убедитесь, что пользовательский элемент управления находится в страницу приложения или веб-части в проекте SharePoint. Затем можно отлаживать код в пользовательский элемент управления так же, как отладка кода в любом проекте Visual Studio.  
  
 При запуске отладчика Visual Studio, Visual Studio откроется сайт SharePoint.  
  
 В SharePoint откройте страницу приложения, которая также пользовательский элемент управления. Если пользовательский элемент управления включен в веб-части, добавьте веб-части на страницу веб-частей в SharePoint.  
  
 Дополнительные сведения об отладке проектов SharePoint см. в разделе [Устранение неполадок решений SharePoint](../sharepoint/troubleshooting-sharepoint-solutions.md).  
  
## <a name="related-topics"></a>См. также  
  
|Заголовок|Описание:|  
|-----------|-----------------|  
|[Практическое руководство. Создание пользовательского элемента управления для страницы приложения или веб-части SharePoint](../sharepoint/how-to-create-a-user-control-for-a-sharepoint-application-page-or-web-part.md)|Демонстрируется создание пользовательских, многократно используемых элементов управления, которые можно размещать на страницах приложений и веб-частях, используемых в SharePoint.|  
  
  