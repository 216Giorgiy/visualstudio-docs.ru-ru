---
title: "Практическое руководство. Импорт главной страницы или темы"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "импорт элементов [разработка приложений SharePoint в Visual Studio]"
  - "разработка приложений SharePoint в Visual Studio, импорт элементов"
ms.assetid: 8b446cca-2adb-457b-bbfd-891209290e80
caps.latest.revision: 18
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 14
---
# Практическое руководство. Импорт главной страницы или темы
  Создание и использование главных страниц и тем позволяет обеспечить единый внешний вид страниц сайта SharePoint.  [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] не предоставляет шаблоны для этих элементов, но их можно создать в SharePoint Designer, а затем импортировать в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  Дополнительные сведения см. в разделе [Стандартный блок: страницы и пользовательский интерфейс](http://go.microsoft.com/fwlink/?LinkID=182095) веб\-сайта Майкрософт.  
  
### Импорт главной страницы или темы  
  
1.  Создайте или откройте проект SharePoint в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
     Сведения о создании проекта SharePoint см. в разделе [Шаблоны проектов и элементов проектов SharePoint](../sharepoint/sharepoint-project-and-project-item-templates.md).  
  
2.  В строке меню выберите **Проект**, **Добавить новый элемент**.  
  
3.  В диалоговом окне **Добавление нового элемента** разверните узел **SharePoint** и выберите узел **2010**.  
  
4.  В списке шаблонов SharePoint выберите шаблон **Модуль** и укажите имя модуля.  
  
     Модуль содержит файлы \(такие как главная страница или файлы тем\) для развертывания в указанное в SharePoint расположение.  
  
5.  В модуле удалите файл по умолчанию, который называется Sample.txt.  
  
6.  Выберите узел модуля.  
  
7.  В строке меню выберите **Проект**, **Добавление существующего элемента**, а затем выберите главную страницу или файл темы.  
  
     Файлы главной страницы имеют расширение MASTER, а файлы темы — расширение THMX.  
  
8.  После добавления главной страницы в свойствах модуля измените значение ее параметра **Устранение конфликта развертывания** на **Автоматически**.  
  
    > [!NOTE]  
    >  Если имя главной страницы совпадает с именем существующей главной страницы, помеченной как главная страница по умолчанию или как главная страница пользователя, возникнет ошибка.  Дополнительные сведения о решении этой проблемы см. в разделе [Пошаговое руководство. Импорт пользовательской главной страницы и страницы сайта с изображением](../sharepoint/walkthrough-import-a-custom-master-page-and-site-page-with-an-image.md).  
  
9. В модуле откройте Elements.xml.  
  
     Следует обновить файл Elements.xml, чтобы в нем содержались ссылки на добавленную главную страницу или тему.  
  
10. Для главной страницы замените существующую разметку модуля на следующую.  
  
    ```  
    <Module Name="[Module Name]" Url="_catalogs/masterpage">  
        <File Path="[Module Name]\[Master Page Name].master"   
          Url="[Master Page Name].master" Type="GhostableInLibrary" />  
    </Module>  
    ```  
  
     Для темы замените существующую разметку модуля на следующую.  
  
    ```  
    <Module Name="[Module Name]" Url="_catalogs/theme"   
        <File Path="[Module Name]\[Theme Name].thmx" Url="[Theme     
          Name].thmx" Type="GhostableInLibrary" />  
    </Module>  
    ```  
  
     Обязательно замените значения заполнителей на реальные имена модулей и главных страниц или тем.  
  
     Атрибут `Type="GhostableInLibrary"` указывает, что элемент добавлен в базу данных контента, а атрибут `Url` модуля указывает, где хранить файл в базе данных содержимого в SharePoint.  
  
11. Для изменения области развертывания главной страницы в **обозревателе решений** откройте файл компонента в конструкторе компонентов, а затем выберите новую область развертывания из списка **Область**.  
  
     Значение **Веб** означает, что главная страница применима только для веб\-сайта, который в настоящий момент определен в проекте.  Значение **Сайт** означает, что главная страница применима к текущему семейству веб\-сайтов, включая все дочерние сайты и корневой веб\-сайт.  Остальные значение не применимы.  
  
    > [!NOTE]  
    >  Поскольку темы применяются только на уровне семейства веб\-сайтов, рекомендуется установить значение области темы, отличное от **Сайт**.  Если тема используется на дочернем сайте, может возникнуть ошибка.  
  
12. В строке меню последовательно выберите **Сборка** и **Развернуть решение**.  
  
13. Чтобы проверить, что файлы развернуты правильно, откройте сайт SharePoint, выберите меню **Действия сайта**, выберите команду **Параметры сайта**, а затем выберите либо ссылку **Главные страницы**, либо ссылку **Темы**.  
  
     В открывшемся списке главных страниц или тем содержится импортированная главная страница или тема.  
  
## См. также  
 [Главные страницы](http://go.microsoft.com/fwlink/?LinkId=184955)   
 [Импорт элементов из существующего сайта SharePoint](../sharepoint/importing-items-from-an-existing-sharepoint-site.md)   
 [Создание страниц для SharePoint](../sharepoint/creating-pages-for-sharepoint.md)   
 [Использование модулей для включения файлов в решение](../sharepoint/using-modules-to-include-files-in-the-solution.md)  
  
  