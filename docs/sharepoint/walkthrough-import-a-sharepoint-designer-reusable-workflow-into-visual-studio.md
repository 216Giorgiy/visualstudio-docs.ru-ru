---
title: 'Пошаговое руководство: Импорт рабочего процесса SharePoint Designer для повторного использования в Visual Studio | Документы Microsoft'
ms.custom: ''
ms.date: 02/02/2017
ms.technology:
- office-development
ms.topic: conceptual
f1_keywords:
- VS.SharePointTools.WSPImport.ImportWF
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, importing reusable workflows
- reusable workflows [SharePoint development in Visual Studio]
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: 443502fdb6b018772e4dde833c5d53d27a68dbe8
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="walkthrough-import-a-sharepoint-designer-reusable-workflow-into-visual-studio"></a>Пошаговое руководство. Импорт рабочего процесса SharePoint Designer с возможностью повторного использования в Visual Studio
  В этом пошаговом руководстве показано, как импортировать повторно используемый рабочий процесс, созданный в SharePoint Designer 2010, в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] проекта рабочего процесса SharePoint.  
  
 Рабочие процессы, созданные в SharePoint Designer или *декларативных рабочих процессов*, состоят из [!INCLUDE[TLA2#tla_xml](../sharepoint/includes/tla2sharptla-xml-md.md)] инструкции вместо кода. SharePoint Designer 2010 добавлена поддержка *многократно используемых рабочих процессов*, которые являются портативных декларативных рабочих процессов, которые можно использовать в различных списках на сайтах SharePoint.  
  
 Рабочие процессы, созданные в [!INCLUDE[vs_dev11_long](../sharepoint/includes/vs-dev11-long-md.md)], например автомата и последовательные рабочие процессы, называются *кода рабочих процессов*. Рабочие процессы с кодом состоят из XML-файлы и модули кода, в которых пользователи могут настраивать поведение рабочих процессов.  
  
 Visual Studio позволяет импортировать рабочие процессы с возможностью повторного использования, созданные в SharePoint Designer 2010, и преобразовывать их в рабочие процессы с кодом, используемые на сайтах SharePoint.  
  
 В этом пошаговом руководстве описаны следующие задачи.  
  
-   Создание простой и повторного использования рабочего процесса в SharePoint Designer.  
  
-   Экспорт рабочего процесса SharePoint Designer для повторного использования в WSP-файл и в SharePoint.  
  
-   Импорт WSP-файла в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью проекта импорта рабочего процесса для повторного использования.  
  
-   Изменение рабочего процесса путем добавления кода.  
  
-   С помощью импортируемого рабочего процесса на сайте SharePoint.  
  
 [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]  
  
## <a name="prerequisites"></a>Предварительные требования  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые выпуски [!INCLUDE[TLA#tla_win](../sharepoint/includes/tlasharptla-win-md.md)] и SharePoint. Дополнительные сведения см. в разделе [требования к разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   Visual Studio.  
  
-   Microsoft [!INCLUDE[TLA2#tla_office](../sharepoint/includes/tla2sharptla-office-md.md)] SharePoint Designer 2010.  
  
## <a name="create-target-sharepoint-subsites"></a>Создание дочерних узлов целевой SharePoint  
 Сначала создайте два дочерних сайта SharePoint: один для размещения рабочих процессов для повторного использования в SharePoint Designer, другой для размещения преобразованных рабочих процессов.  
  
#### <a name="to-create-sharepoint-subsites"></a>Создание дочерних сайтов SharePoint  
  
1.  В SharePoint Designer 2010, в строке меню выберите **файл**, **пустой веб-узел**.  
  
2.  В **пустой веб-сайт** диалоговое окно, перейдите на сайт SharePoint, где требуется создать рабочий процесс или использовать значение http://*имя_системы*/ и выберите **ОК** кнопка.  
  
     Домашняя страница отображается.  
  
3.  В **дочерние узлы** выберите **New** кнопки.  
  
4.  В **New** диалогового окна выберите **шаблоны SharePoint** в списке в левой панели и выберите **узла группы** из списка в правой области.  
  
5.  В **укажите расположение веб-сайта** замените слово **дочерний узел** в URL-адрес с **SPD1**и нажмите кнопку **ОК** кнопки.  
  
     Откроется новый дочерний узел в SharePoint Designer. Закройте этот экземпляр SharePoint Designer и вернитесь к первому экземпляру (сайт верхнего уровня).  
  
6.  Повторите шаги 3 – 5, чтобы создать второй дочерний сайт, на этот раз замените слово **дочерний узел** в [!INCLUDE[TLA2#tla_url](../sharepoint/includes/tla2sharptla-url-md.md)] с **SPD2**.  
  
## <a name="create-a-sharepoint-designer-reusable-workflow"></a>Создание рабочего процесса SharePoint Designer для повторного использования  
 Так как SharePoint не поддерживает все рабочие процессы, которые можно использовать для этого примера, вы создадите одну. В простой рабочий процесс когда пользователь вводит новую задачу в списке задач, с определенным названием задача назначается этому пользователю.  
  
#### <a name="to-create-a-sharepoint-designer-reusable-workflow"></a>Создание рабочего процесса SharePoint Designer для повторного использования  
  
1.  В **дочерние узлы** выберите **SPD1** сайта, чтобы изменить его.  
  
2.  На ленте выберите **рабочего процесса для повторного использования** кнопки.  
  
     Откроется мастер создания рабочего процесса для повторного использования.  
  
3.  В **имя** введите **SPD Task Workflow**.  
  
4.  В **тип содержимого** выберите **задачи**, а затем выберите **ОК** кнопки.  
  
     Рабочий процесс откроется в конструкторе рабочих процессов SharePoint Designer.  
  
5.  В конструкторе рабочих процессов, выберите шаг 1 и выберите на ленте **условие** кнопки.  
  
6.  В списке условий выберите **при текущем элементе поле = значение**.  
  
     На этом шаге добавляется условие, которое называется **Если поле = значение**.  
  
7.  В **Если поле = значение** условия, выберите **поле** ссылку.  
  
8.  В списке значений выберите **заголовка**.  
  
9. В **Если поле = значение** условия, выберите **значение** ссылку.  
  
10. В диалоговом окне введите **новая задача**.  
  
     Теперь оператор условия выглядит **следующим образом: если текущее название: элемента = новая задача**.  
  
11. Выберите линию под оператор условия, а затем на ленте выберите **действия** кнопки.  
  
12. В списке действий выберите **поля набора в текущем элементе**.  
  
13. В **набор полю значение** действия, выберите **поле** ссылку и выберите в списке **назначен**.  
  
14. В **набор полю значение** действия, выберите **значение** ссылку и выберите в списке существующих пользователей и групп, **пользователя, создавшего элемент**.  
  
15. Выберите **добавить** , а затем кнопку **ОК** кнопки.  
  
     Теперь оператор действия выглядит **задать назначено для текущего элемента: Кем создано**.  
  
## <a name="save-and-deploy-the-reusable-workflow"></a>Сохранение и развертывание рабочего процесса для повторного использования  
 Поскольку [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] можно импортировать только WSP-файлов, необходимо сохранить рабочего процесса для повторного использования в виде WSP-файла и развернуть его в SharePoint перед импортом в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
> [!IMPORTANT]  
>  Если появляется ошибка времени выполнения, выполнив следующую процедуру, необходимо выполнить процедуры в системе, которая имеет доступ к сайту SharePoint.  
  
#### <a name="to-save-and-deploy-the-reusable-workflow"></a>Сохранение и развертывание рабочего процесса для повторного использования  
  
1.  В верхней части SharePoint Designer, выберите **Сохранить** кнопку, чтобы сохранить изменения, а затем выберите **публикации** кнопку, чтобы развернуть рабочий процесс для **SPD1** сайта SharePoint .  
  
2.  В области навигации выберите **рабочих процессов** объекта.  
  
3.  В разделе **рабочего процесса для повторного использования**, выберите **SPD Task Workflow**.  
  
4.  На ленте выберите **Сохранить как шаблон** кнопку, чтобы сохранить рабочий процесс в виде WSP-файла.  
  
5.  Откройте **SPD1** сайт SharePoint в браузере, чтобы просмотреть WSP-файл в SharePoint.  
  
6.  На панели быстрого запуска выберите **библиотеки** ссылку.  
  
7.  В **библиотеки документов** выберите **ресурсы сайта** ссылку.  
  
     **SPD Task Workflow** файл в списке с другими ресурсами узла.  
  
8.  В списке файлов выберите имя этого файла  
  
9. В **Загрузка файла** диалогового окна выберите **Сохранить** сохранить WSP-файл в локальной системе.  
  
## <a name="import-the-wsp-file-into-visual-studio"></a>Импорт WSP-файл в Visual Studio  
 Импорт WSP-файла в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью проекта импорта рабочего процесса для повторного использования. Этот проект преобразует рабочий процесс с возможностью повторного использования декларативного рабочего процесса в рабочий процесс с кодом. После преобразования рабочего процесса будет использоваться код для изменения его поведения.  
  
#### <a name="to-import-a-workflow-from-a-wsp-file-and-modify-it"></a>Импорт рабочего процесса в WSP-файл и изменить его  
  
1.  В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], в строке меню выберите **файл**, **New**, **проекта**.  
  
2.  В **новый проект** диалогового окна разверните **SharePoint** узел в рамках одного **Visual C#** или **Visual Basic**, а затем выберите **2010** узла.  
  
3.  В **шаблоны** области, выберите **Импорт рабочего процесса SharePoint 2010 для повторного использования** шаблона, оставьте имя проекта в качестве **WorkflowImportProject1**и нажмите кнопку **ОК** кнопки.  
  
     Появится мастер настройки SharePoint.  
  
4.  На **Укажите сайт и уровень безопасности для отладки** введите [!INCLUDE[TLA2#tla_url](../sharepoint/includes/tla2sharptla-url-md.md)] второго дочернего сайта SharePoint, созданного ранее: http://*системное имя*  /SPD2.  
  
5.  В **Какова степень доверия для этого решения SharePoint?** выберите **развернуть как решение фермы** переключатель, а затем выберите **Далее** кнопки.  
  
     Дополнительные сведения об изолированных и решений фермы см [замечания об изолированных решениях](../sharepoint/sandboxed-solution-considerations.md).  
  
6.  В **укажите новый источник проекта** страницы, перейдите в расположение в системе, где сохранен WSP-файл, откройте файл и нажмите кнопку **Далее** кнопки.  
  
    > [!NOTE]  
    >  Выберите **Готово** кнопку, чтобы импортировать все доступные элементы в WSP-файл.  
  
     Откроется список доступных для импорта многократно используемых рабочих процессов.  
  
7.  В **выберите элементы для импорта** выберите **SPD Task Workflow** рабочего процесса, а затем выберите **Готово** кнопки.  
  
     После завершения операции импорта проект с именем **WorkflowImportProject1** создается, содержащего рабочий процесс с именем **SPD_Workflow_TestFT**. В этой папке содержится файл определения рабочего процесса Elements.xml и файл конструктора рабочих процессов (XOML-файл). Конструктор содержит два файла: файл правил (с расширением RULES) и файл кода (.cs или .vb в зависимости от языка программирования проекта).  
  
8.  В **обозревателе решений**, удалить **Прочие импортированные файлы** папки.  
  
9. В файле Elements.xml удалите `InstantiationURL="_layouts/IniErkflIP.sspx"`.  
  
10. В **обозревателе решений**, выберите **WorkflowImportProject1**, а затем в строке меню выберите **проекта**, **Назначить запускаемым проектом** для задать **WorkflowImportProject1** автозапускаемым элементом.  
  
     Откроется список немедленно при отладке проекта.  
  
11. Поскольку **Импорт повторно используемого рабочего процесса SharePoint 2010** шаблона не импортирует связанные значения свойств импортируемого рабочего процесса, необходимо ввести их. Для этого выполните следующие действия.  
  
    1.  В **обозревателе решений**, выберите **SPD_Workflow_TestFT** узла.  
  
    2.  Нажмите кнопку с многоточием (![эллипс конструктора ASP.NET Mobile](../sharepoint/media/mwellipsis.gif "эллипс конструктора ASP.NET Mobile")) рядом с одним из списка свойств, таких как **список целевых** свойство.  
  
    3.  Заполните недостающие значения в мастере настройки SharePoint, а затем выберите **Готово** кнопки.  
  
12. Выберите XOML-файл, а затем в строке меню выберите **представление**, **конструктор** просмотреть импортированный рабочий процесс в конструкторе рабочих процессов.  
  
13. В **Windows Workflow v3.0** узел **элементов**, выполните одно из следующих действий:  
  
    -   Откройте контекстное меню для **кода** действия, а затем выберите **копирования**. В конструкторе рабочих процессов откройте контекстное меню для строки в группе **SequenceActivity1** действия, а затем выберите **вставить**.  
  
    -   Перетащите **кода** действия из **элементов** в конструктор рабочих процессов и подключите его к строке под **SequenceActivity1** действия.  
  
     Это добавляет действие в конструкторе рабочих процессов с именем **CodeActivity1**. В этой операции вы добавите код действие, которое создает объявление в списке объявлений, когда пользователь запускает рабочий процесс.  
  
14. Выполните одно из следующих действий.  
  
    -   Дважды щелкните **CodeActivity1** создать обработчик событий и просмотреть код.  
  
    -   В **свойства** окна для **CodeActivity1**, установите для параметра **ExecuteCode** свойства **codeActivity_ExecuteCode**.  
  
15. Добавьте следующий код под существующие **с помощью** или **Imports** инструкции:  
  
     [!code-csharp[SP_SPDWFImport#1](../sharepoint/codesnippet/CSharp/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.cs#1)]
     [!code-vb[SP_SPDWFImport#1](../sharepoint/codesnippet/VisualBasic/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.vb#1)]  
  
16. Замените `codeActivity1_ExecuteCode` на следующее:  
  
     [!code-csharp[SP_SPDWFImport#2](../sharepoint/codesnippet/CSharp/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.cs#2)]
     [!code-vb[SP_SPDWFImport#2](../sharepoint/codesnippet/VisualBasic/workflowimportproject1/workflows/spd_task_workflowft/spd task workflow.xoml.vb#2)]  
  
## <a name="deploy-the-project-and-associate-the-workflow"></a>Развертывание проекта и связывание рабочего процесса  
 Затем запустите WorkflowImportProject1 развернуть ее на сайте SharePoint и свяжите его со списком задач, чтобы просмотреть и проверить изменения, преобразованный рабочий процесс.  
  
#### <a name="to-deploy-the-project-and-associate-the-workflow"></a>Для развертывания проекта и связывать рабочий процесс  
  
1.  Нажмите клавишу F5 в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], чтобы запустить и развернуть проект преобразованного рабочего процесса.  
  
2.  На панели быстрого запуска выберите **задачи** ссылку, чтобы вывести список задач.  
  
3.  На **Инструменты списка** выберите **элементы** , а затем кнопку **новый элемент** кнопки.  
  
     **Задачи: новый элемент** откроется диалоговое окно.  
  
4.  В **заголовок** введите **новая задача**и нажмите кнопку **Сохранить** кнопки.  
  
5.  На **Инструменты списка** выберите **списка** , а затем кнопку **параметры списка** кнопки.  
  
     **Параметры списка** появится страница.  
  
6.  В **разрешения и управление** выберите **параметры рабочего процесса** ссылку.  
  
     **Параметры рабочего процесса** появится страница.  
  
7.  Выберите **Добавление рабочего процесса** ссылку.  
  
8.  В **рабочего процесса** выберите **WorkflowImportProject1 — SPD Workflow Test**.  
  
9. В **имя** введите **SPD Workflow Test**, а затем выберите **ОК** кнопки.  
  
10. На панели быстрого запуска выберите **задачи** списка.  
  
11. Нажмите стрелку рядом с **новую задачу**, а затем в списке выберите **рабочих процессов**.  
  
12. В **запустить новый рабочий процесс** выберите ссылку для **SPD Workflow Test**и нажмите кнопку **запустить** кнопку, чтобы запустить рабочий процесс.  
  
    > [!NOTE]  
    >  Кроме того вы можно автоматически связать рабочий процесс со списком, запустив мастер параметров рабочего процесса и задав автоматическое связывание рабочего процесса.  
  
     Обратите внимание, что рабочий процесс выполняет два действия: ваше имя отображается в рамках задачи **назначено** столбца и объявление отображается в **объявления** списка.  
  
## <a name="see-also"></a>См. также  
 [Импорт элементов из существующего сайта SharePoint](../sharepoint/importing-items-from-an-existing-sharepoint-site.md)   
 [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)   
 [Создание повторно используемых элементов управления для веб-частей или страниц приложений](../sharepoint/creating-reusable-controls-for-web-parts-or-application-pages.md)  
  
  