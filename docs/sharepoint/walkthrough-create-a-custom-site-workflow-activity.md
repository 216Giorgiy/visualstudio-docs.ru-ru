---
title: "Пошаговое руководство: Создание пользовательского узла действия рабочего процесса | Документы Microsoft"
ms.custom: 
ms.date: 02/02/2017
ms.reviewer: 
ms.suite: 
ms.technology: office-development
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- custom workflow activities [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, custom workflow activities
- site workflows [SharePoint development in Visual Studio]
- workflow activities [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, site workflows
author: TerryGLee
ms.author: tglee
manager: ghogen
ms.workload: office
ms.openlocfilehash: b723635b1baecfec4bddb2339414d57803c76d5d
ms.sourcegitcommit: f9fbf1f55f9ac14e4e5c6ae58c30dc1800ca6cda
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/10/2018
---
# <a name="walkthrough-create-a-custom-site-workflow-activity"></a>Пошаговое руководство. Создание пользовательского действия рабочего процесса сайта
  В этом пошаговом руководстве демонстрируется создание настраиваемого действия рабочего процесса на уровне сайта с помощью [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. (Рабочие процессы на уровне сайта применяются для всего сайта, а не только список на сайте). Пользовательское действие создает резервную копию списка извещений и копирует в него содержимое списка извещений.  
  
 В этом пошаговом руководстве описаны следующие задачи.  
  
-   Создание рабочего процесса на уровне сайта.  
  
-   Создание пользовательского действия рабочего процесса.  
  
-   Создание и удаление списка SharePoint.  
  
-   Копирование элементов из одного списка в другой.  
  
-   Отображение списка на панели быстрого запуска.  
  
 [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]  
  
## <a name="prerequisites"></a>Предварительные требования  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые выпуски [!INCLUDE[TLA#tla_win](../sharepoint/includes/tlasharptla-win-md.md)] и SharePoint. Дополнительные сведения см. в разделе [требования к разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   Visual Studio.  
  
## <a name="creating-a-site-workflow-custom-activity-project"></a>Создание проекта пользовательского действия рабочего процесса сайта  
 Во-первых создайте проект для хранения и тестирования пользовательского действия рабочего процесса.  
  
#### <a name="to-create-a-site-workflow-custom-activity-project"></a>Создание проекта пользовательского действия рабочего процесса сайта  
  
1.  В строке меню выберите **файл**, **New**, **проекта** для отображения **новый проект** диалоговое окно.  
  
2.  Разверните **SharePoint** узел в рамках одного **Visual C#** или **Visual Basic**, а затем выберите **2010** узла.  
  
3.  В **шаблоны** области, выберите **проект SharePoint 2010** шаблона.  
  
4.  В **имя** введите **AnnouncementBackup**, а затем выберите **ОК** кнопки.  
  
     **Мастер настройки SharePoint** отображается.  
  
5.  На **Укажите сайт и уровень безопасности для отладки** выберите **развернуть как решение фермы** переключатель, а затем выберите **Готово** кнопку, чтобы принять уровень доверия и по умолчанию сайт.  
  
     Этот шаг задается уровень доверия для решения фермы, единственно возможный вариант для проектов рабочего процесса.  
  
6.  В **обозревателе решений**, выберите узел проекта и затем в строке меню выберите **проекта**, **Добавление нового элемента**.  
  
7.  В рамках одного **Visual C#** или **Visual Basic**, разверните **SharePoint** узла, а затем выберите **2010** узла.  
  
8.  В **шаблоны** области, выберите **последовательный рабочий процесс (только для решения фермы)** шаблона и выберите **добавить** кнопки.  
  
     **Мастер настройки SharePoint** отображается.  
  
9. На **укажите имя рабочего процесса для отладки** примите имя по умолчанию (AnnouncementBackup - Workflow1). Измените тип шаблона рабочего процесса для **рабочий процесс сайта**и нажмите кнопку **Далее** кнопки.  
  
10. Выберите **Готово** кнопку, чтобы Примите остальные значения по умолчанию.  
  
## <a name="adding-a-custom-workflow-activity-class"></a>Добавление класса пользовательского рабочего процесса действия  
 Добавьте класс в проект, чтобы он содержал код для пользовательского действия рабочего процесса.  
  
#### <a name="to-add-a-custom-workflow-activity-class"></a>Добавление класса пользовательского рабочего процесса действия  
  
1.  В строке меню выберите **проекта**, **Добавление нового элемента** для отображения **Добавление нового элемента** диалоговое окно.  
  
2.  В **установленные шаблоны** представление в виде дерева, выберите **кода** узел и выберите **класса** шаблон в списке шаблонов элементов проекта. Используйте имя по умолчанию Class1. Нажмите кнопку **Добавить** .  
  
3.  Замените весь код в класс Class1 следующим кодом:  
  
     [!code-csharp[SP_AnnBackup#1](../sharepoint/codesnippet/CSharp/announcementbackup/class1.cs#1)]
     [!code-vb[SP_AnnBackup#1](../sharepoint/codesnippet/VisualBasic/announcementbackupvb/class1.vb#1)]  
  
4.  Сохраните проект и затем в строке меню выберите **построения**, **построить решение**.  
  
     Class1 отображается как пользовательское действие в **элементов** на **AnnouncementBackup компоненты** вкладки.  
  
## <a name="adding-the-custom-activity-to-the-site-workflow"></a>Добавление пользовательского действия в рабочий процесс сайта  
 Добавьте действие в рабочий процесс, содержащий пользовательский код.  
  
#### <a name="to-add-a-custom-activity-to-the-site-workflow"></a>Добавление пользовательского действия в рабочий процесс сайта  
  
1.  Откройте Workflow1 в конструкторе рабочих процессов в режиме конструктора.  
  
2.  Перетащите Class1 из **элементов** , чтобы он отображался в списке `onWorkflowActivated1` действия или откройте контекстное меню для Class1, выберите **копирования**, откройте контекстное меню для строки в группе `onWorkflowActivated1` действия, а затем выберите **вставить**.  
  
3.  Сохраните проект.  
  
## <a name="testing-the-site-workflow-custom-activity"></a>Тестирование пользовательского действия рабочего процесса сайта  
 Затем запустите проект и запуск рабочего процесса сайта. Пользовательское действие создает резервный список объявлений и копирует в него содержимое из текущего списка извещений. Код проверяет, существует ли уже резервный список перед созданием. Если резервная копия уже существует, она удаляется. Код также добавляет ссылку на новый список на панели быстрого запуска сайта SharePoint.  
  
#### <a name="to-test-the-site-workflow-custom-activity"></a>Тестирование пользовательского действия рабочего процесса сайта  
  
1.  Нажмите клавишу F5 для запуска проекта и его развертывания в SharePoint.  
  
2.  На панели быстрого запуска выберите **перечислены** ссылку, чтобы отобразить все списки, доступные на сайте SharePoint. Обратите внимание, что только один список объявлений с именем **объявления**.  
  
3.  В верхней части веб-страницы SharePoint, выберите **рабочие процессы сайта** ссылку.  
  
4.  В меню Пуск раздел нового рабочего процесса, выберите **AnnouncementBackup - Workflow1** ссылку. При этом запускается рабочий процесс сайта и выполняет код этого пользовательского действия.  
  
5.  На панели быстрого запуска выберите **резервного копирования объявления** ссылку. Обратите внимание, что все объявления, содержащиеся в **объявления** списка были скопированы в этот список.  
  
## <a name="see-also"></a>См. также  
 [Как: Создание приемника событий](../sharepoint/how-to-create-an-event-receiver.md)   
 [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)  
  
  