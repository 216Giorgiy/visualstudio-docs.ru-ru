---
title: "Пошаговое руководство. Создание веб-части для SharePoint с помощью конструктора | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "веб-части [разработка приложений SharePoint в Visual Studio], создание"
  - "веб-части [разработка приложений SharePoint в Visual Studio], конструктор"
  - "веб-части [разработка приложений SharePoint в Visual Studio], разработка"
ms.assetid: 3dd62654-ada2-468f-b7da-eb5704a2ff7a
caps.latest.revision: 34
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 33
---
# Пошаговое руководство. Создание веб-части для SharePoint с помощью конструктора
  Создание веб\-частей для сайта SharePoint site позволяет пользователям непосредственно изменять содержимое, внешний вид и поведение страниц на этом сайте с помощью браузера.  В этом пошаговом руководстве показано визуальное создание веб\-части с использованием шаблона проекта SharePoint **Визуальная веб\-часть** в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
 Веб\-часть, которую вам предстоит создать, отображает представление месячного календаря и флажок для каждого списка календаря на сайте.  Пользователи могут указывать, какие списки календаря включить в представление месячного календаря, устанавливая нужные флажки.  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Создание веб\-части с помощью шаблона проекта **Визуальная веб\-часть**.  
  
-   Разработка веб\-части с использованием конструктора Visual Web Developer в Visual Studio.  
  
-   Добавление кода для обработки событий элементов управления в веб\-части.  
  
-   Тестирование веб\-части в SharePoint.  
  
    > [!NOTE]  
    >  Имена и расположения некоторых элементов пользовательского интерфейса Visual Studio на вашем компьютере могут отличающиеся от указанных в следующих инструкциях.  Эти элементы определяются используемой версией Visual Studio и ее параметрами.  См. раздел [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые версии Windows и SharePoint.  См. раздел [Требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vsPro](../sharepoint/includes/vspro-md.md)] или выше.  
  
## Создание проекта веб\-части  
 Сначала создайте проект веб\-части с использованием шаблона проекта **Визуальная веб\-часть**.  
  
#### Создание проекта визуальной веб\-части  
  
1.  Запустите [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], используя параметр **Запуск от имени администратора**.  
  
2.  В строке меню **Файл** выберите пункты **Создать**, **Проект**.  
  
     Откроется диалоговое окно **Создание проекта**.  
  
3.  В диалоговом окне **Создать проект** в разделе **Visual C\#** или **Visual Basic** разверните **Office\/SharePoint** и выберите категорию **Решения SharePoint**.  
  
4.  В списке шаблонов выберите шаблон **SharePoint 2013 — визуальная веб\-часть**, а затем нажмите кнопку **ОК**.  
  
     Появится окно **Мастер настройки SharePoint**.  Этот мастер позволяет указать сайт, который будет использоваться для отладки проекта, и уровень доверия решения.  
  
5.  В разделе **Какова степень доверия для этого решения SharePoint?** выберите **Развернуть как решение фермы**.  
  
6.  Нажмите кнопку **Готово**, чтобы принять предлагаемый по умолчанию локальный сайт SharePoint.  
  
## Разработка веб\-части  
 Сконструируйте веб\-часть, добавив элементы управления из **области элементов** на поверхность конструктора Visual Web Developer.  
  
#### Разработка структуры веб\-части  
  
1.  В конструкторе Visual Web Developer выберите вкладку **Конструктор**, чтобы перейти в представление кода.  
  
2.  В меню **Вид** выберите **Область элементов**.  
  
3.  В узле **СтандартнаяПанель элементов** выберите элемент управления **CheckBoxList**, а затем выполните одно из следующих действий.  
  
    -   Откройте контекстное меню для элемента **CheckBoxList** выберите **Копировать**, чтобы открыть контекстное меню для первой линии в конструкторе и выберите пункт **Вставить**.  
  
    -   Перетащите элемент управления **CheckBoxList** из **Панели элементов** и соедините элемент управления с первой линией в конструкторе.  
  
4.  Повторяющийся предыдущий шаг, но перемещайте кнопку в следующей линии конструктора.  
  
5.  В конструкторе дважды щелкните кнопку **Button1**.  
  
6.  В меню **Вид** выберите **Окно свойств**.  
  
     Будет открыто окно **Свойства**.  
  
7.  В свойстве **Текст** введите кнопки обновления.  
  
## Обработка событий элементов управления в веб\-части  
 Добавьте код, который позволяет пользователю добавлять календари в представление главного календаря.  
  
#### Обработка событий элементов управления в веб\-части  
  
1.  Выполните одно из следующих действий.  
  
    -   В конструкторе дважды щелкните кнопку **Update**.  
  
    -   В окне **Свойства** для кнопки **Обновить**, нажмите кнопку **События**.  В свойстве **Щелчок** введите **Button1\_Click**, а затем нажмите клавишу "Ввод".  
  
     В редакторе кода откроется файл кода пользовательского элемента управления и появится обработчик событий `Button1_Click`.  Позже в этот обработчик событий нужно будет добавить код.  
  
2.  Добавьте следующие операторы в верхнюю часть файла кода пользовательского элемента управления.  
  
     [!code-csharp[SP_VisualWebPart#1](../snippets/csharp/VS_Snippets_OfficeSP/sp_visualwebpart/cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#1)]
     [!code-vb[SP_VisualWebPart#1](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_visualwebpart/vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#1)]  
  
3.  Добавьте следующую строку кода в класс `VisualWebPart1`.  Этот код объявляет элемент управления представлением месячного календаря.  
  
     [!code-csharp[SP_VisualWebPart#2](../snippets/csharp/VS_Snippets_OfficeSP/sp_visualwebpart/cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#2)]
     [!code-vb[SP_VisualWebPart#2](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_visualwebpart/vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#2)]  
  
4.  Замените метод `Page_Load` класса `VisualWebPart1` на следующий код.  Этот код выполняет следующие задачи:  
  
    -   Добавляет представление месячного календаря в пользовательский элемент управления.  
  
    -   Добавляет флажок для каждого списка календаря на сайте.  
  
    -   Задает шаблон для каждого типа элемента, отображающегося в представлении календаря.  
  
     [!code-csharp[SP_VisualWebPart#3](../snippets/csharp/VS_Snippets_OfficeSP/sp_visualwebpart/cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#3)]
     [!code-vb[SP_VisualWebPart#3](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_visualwebpart/vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#3)]  
  
5.  Замените метод `Button1_Click` класса `VisualWebPart1` на следующий код.  Этот код добавляет элементы из каждого выбранного календаря в представление главного календаря.  
  
     [!code-csharp[SP_VisualWebPart#4](../snippets/csharp/VS_Snippets_OfficeSP/sp_visualwebpart/cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#4)]
     [!code-vb[SP_VisualWebPart#4](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_visualwebpart/vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#4)]  
  
## Тестирование веб\-части  
 При запуске проекта открывается сайт SharePoint.  Веб\-часть автоматически добавляется в коллекцию веб\-частей в SharePoint.  Чтобы протестировать этот проект, нужно выполнить следующие действия.  
  
-   Добавьте событие в каждый из двух отдельных списков календарей.  
  
-   Добавьте веб\-часть на страницу веб\-части.  
  
-   Укажите списки для включения в представление месячного календаря.  
  
#### Добавление событий в списки календарей на сайте  
  
1.  В Visual Studio нажмите клавишу F5.  
  
     Открывается сайт SharePoint, и на странице отображается панель быстрого запуска [!INCLUDE[wss_14_long](../sharepoint/includes/wss-14-long-md.md)].  
  
2.  На панели быстрого запуска в разделе **Списки** щелкните ссылку **Календарь**.  
  
     Отобразится страница **Календарь**.  
  
     Если связь календаря не отображается на панели быстрого запуска, выберите ссылку **Содержимое сайта**.  Если на странице содержимого сайта не показан элемент **Календарь**, создайте его.  
  
3.  На странице "Календарь" выберите день, а затем выберите ссылку **Добавить** в выбранном дне, чтобы добавить событие.  
  
4.  В поле **Название** введите "Event" в календаре по умолчанию и нажмите **Сохранить**.  
  
5.  Выберите ссылку **Содержимое сайта** и затем выберите плитку **Добавить приложение**.  
  
6.  На странице **Создать** выберите тип **Календарь**, назовите календарь, а затем нажмите кнопку **Создать**.  
  
7.  Добавьте событие в новый календарь, назовите событие в пользовательском календаре Event и нажмите кнопку **Сохранить**.  
  
#### Добавление веб\-части на страницу веб\-части  
  
1.  На странице **Содержимое сайта** откройте папку **Страницы сайта**.  
  
2.  На ленте выберите вкладку **Файлы**, откройте меню **Новый документ** и выберите команду **Страница веб\-частей**.  
  
3.  На странице **Новая страница веб\-части** назовите страницу **SampleWebPartPage.aspx** и нажмите кнопку **Создать**.  
  
     Отобразится страница веб\-части.  
  
4.  В верхней части страницы веб\-части выберите вкладку **Вставить**, а затем нажмите кнопку **Веб\-часть**.  
  
5.  Выберите папку **Пользовательские**, щелкните веб\-часть **VisualWebPart1** и нажмите кнопку **Добавить**.  
  
     Веб\-часть отобразится на странице.  В веб\-части отображаются следующие элементы управления.  
  
    -   Представление месячного календаря.  
  
    -   Кнопка **Обновить**.  
  
    -   Флажок **Календарь**.  
  
    -   Флажок **Пользовательский календарь**.  
  
#### Задание списков для включения в представление месячного календаря  
  
1.  В веб\-части выберите календари, которые необходимо включить в представление месячного календаря и нажмите кнопку **Обновить**.  
  
     События из всех указанных календарей отображаются в представлении месячного календаря.  
  
## См. также  
 [Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md)   
 [Практическое руководство. Создание веб-части SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md)   
 [Практическое руководство. Создание веб-части SharePoint с помощью конструктора](../sharepoint/how-to-create-a-sharepoint-web-part-by-using-a-designer.md)   
 [Пошаговое руководство. Создание веб-части для SharePoint](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint.md)  
  
  