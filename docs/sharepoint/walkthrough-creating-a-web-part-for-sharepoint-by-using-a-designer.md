---
title: "Пошаговое руководство: Создание веб-части для SharePoint с помощью конструктора | Документы Microsoft"
ms.custom: 
ms.date: 02/02/2017
ms.reviewer: 
ms.suite: 
ms.technology: office-development
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- Web Parts [SharePoint development in Visual Studio], designer
- Web Parts [SharePoint development in Visual Studio], creating
- Web Parts [SharePoint development in Visual Studio], designing
ms.assetid: 3dd62654-ada2-468f-b7da-eb5704a2ff7a
caps.latest.revision: "34"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.workload: office
ms.openlocfilehash: 602515daedec99bbcfa3efd58469de5d8ba3df7b
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="walkthrough-creating-a-web-part-for-sharepoint-by-using-a-designer"></a>Пошаговое руководство. Создание веб-части для SharePoint с помощью конструктора
  При создании веб-частей для сайта SharePoint, пользователям можно непосредственно изменить содержимое, внешний вид и поведение страниц сайта с помощью браузера. В этом пошаговом руководстве показано, как для визуального создания веб-части с помощью SharePoint **визуальной веб-части** шаблона проекта в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
 Веб-части, который вы создадите отображает представление месячного календаря и флажок для каждого списка календаря на сайте. Пользователи могут указать, какие списки календаря включить в представление месячного календаря, установив флажки.  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Создание веб-части с помощью **визуальной веб-части** шаблона проекта.  
  
-   Разработка веб-части с помощью конструктора Visual Web Developer в Visual Studio.  
  
-   Добавление кода для обработки событий элементов управления на веб-части.  
  
-   Тестирование веб-части в SharePoint.  
  
    > [!NOTE]  
    >  На компьютере могут отображаться другие имена или расположения некоторых элементов пользовательского интерфейса для Visual Studio в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. См. статью [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).  
  
## <a name="prerequisites"></a>Предварительные требования  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые выпуски Windows и SharePoint. В разделе [требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vsPro](../sharepoint/includes/vspro-md.md)]или более поздней.  
  
## <a name="creating-a-web-part-project"></a>Создание проекта веб-части  
 Сначала создайте проект веб-части с помощью **визуальной веб-части** шаблона проекта.  
  
#### <a name="to-create-a-visual-web-part-project"></a>Чтобы создать проект визуальной веб-части  
  
1.  Запуск [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью **Запуск от имени администратора** параметр.  
  
2.  В строке меню выберите **Файл**, **Создать**, **Проект**.  
  
     Откроется диалоговое окно **Новый проект** .  
  
3.  В **новый проект** в поле либо **Visual C#** или **Visual Basic**, разверните **Office/SharePoint**и нажмите кнопку  **Решений SharePoint** категории.  
  
4.  В списке шаблонов выберите **SharePoint 2013 — Визуальная веб-часть** шаблона, а затем выберите **ОК** кнопки.  
  
     **Мастер настройки SharePoint** отображается. С помощью этого мастера, можно указать сайт, который будет использоваться для отладки проекта и уровень доверия решения.  
  
5.  В **Какова степень доверия для этого решения SharePoint?** выберите **развернуть как решение фермы** переключатель.  
  
6.  Выберите **Готово** кнопку, чтобы принять локальный сайт SharePoint по умолчанию.  
  
## <a name="designing-the-web-part"></a>Разработка веб-части  
 Разработка веб-части путем добавления элементов управления из **элементов** в область конструктора Visual Web Developer.  
  
#### <a name="to-design-the-layout-of-the-web-part"></a>Создание макета веб-части  
  
1.  В конструкторе Visual Web Developer выберите **разработки** вкладку, чтобы переключиться в представление конструирования.  
  
2.  В строке меню выберите **Вид**, **Панель элементов**.  
  
3.  В **Стандартная** узел **элементов**, выберите **CheckBoxList** управления, а затем выполните одно из следующих действий:  
  
    -   Откройте контекстное меню для **CheckBoxList** управления, выберите **копирования**, откройте контекстное меню для первой строки в конструкторе и выберите **вставить**.  
  
    -   Перетащите **CheckBoxList** управления из **элементов**и подключения к первой строке в конструкторе элемента управления.  
  
4.  Повторите предыдущий шаг, но переместить кнопку на следующую строку в конструкторе.  
  
5.  В конструкторе выберите **Button1** кнопки.  
  
6.  В строке меню выберите **представление**, **окно свойств**.  
  
     **Свойства** открывается окно.  
  
7.  В **текст** свойства кнопки, введите **обновление**.  
  
## <a name="handling-the-events-of-controls-on-the-web-part"></a>Обработка событий элементов управления на веб-части  
 Добавьте код, который позволяет пользователю добавлять календари в представление главного календаря.  
  
#### <a name="to-handle-events-of-controls-on-the-web-part"></a>Обработка событий элементов управления на веб-части  
  
1.  Выполните одно из следующих действий.  
  
    -   В конструкторе, дважды щелкните **обновление** кнопки.  
  
    -   В **свойства** окна для **обновление** , выберите **события** кнопки. В **щелкните** свойство, введите **Button1_Click**, а затем нажмите клавишу ВВОД.  
  
     В редакторе кода откроется файл кода пользовательского элемента управления и `Button1_Click` появляется обработчик событий. Позже вы добавите код в этот обработчик событий.  
  
2.  Добавьте следующие инструкции в начало файл кода пользовательского элемента управления.  
  
     [!code-vb[SP_VisualWebPart#1](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#1)]
     [!code-csharp[SP_VisualWebPart#1](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#1)]  
  
3.  Добавьте следующую строку кода, чтобы `VisualWebPart1` класса. Этот код объявляет управления представлением месячного календаря.  
  
     [!code-vb[SP_VisualWebPart#2](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#2)]
     [!code-csharp[SP_VisualWebPart#2](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#2)]  
  
4.  Замените `Page_Load` метод `VisualWebPart1` класса следующим кодом. Этот код выполняет следующие задачи:  
  
    -   Добавляет представление месячного календаря в пользовательский элемент управления.  
  
    -   Добавляет флажок для каждого списка календаря на сайте.  
  
    -   Указывает шаблон для каждого типа элемента, который отображается в представлении «Календарь».  
  
     [!code-vb[SP_VisualWebPart#3](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#3)]
     [!code-csharp[SP_VisualWebPart#3](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#3)]  
  
5.  Замените `Button1_Click` метод `VisualWebPart1` класса следующим кодом. Этот код добавляет элементы из каждого выбранного календаря в представление главного календаря.  
  
     [!code-vb[SP_VisualWebPart#4](../sharepoint/codesnippet/VisualBasic/sp_visualwebpart.vb/visualwebpart1/visualwebpart1usercontrol.ascx.vb#4)]
     [!code-csharp[SP_VisualWebPart#4](../sharepoint/codesnippet/CSharp/sp_visualwebpart.cs/visualwebpart1/visualwebpart1usercontrol.ascx.cs#4)]  
  
## <a name="testing-the-web-part"></a>Тестирование веб-части  
 При запуске проекта открывается сайт SharePoint. Веб-части автоматически добавляется в коллекцию веб-частей в SharePoint. Чтобы протестировать этот проект, выполните следующие задачи:  
  
-   Добавьте событие в каждой из двух отдельных списков календарей.  
  
-   Добавление веб-части на страницу веб-частей.  
  
-   Укажите списки для включения в представление месячного календаря.  
  
#### <a name="to-add-events-to-calendar-lists-on-the-site"></a>Чтобы добавить события календаря списки на сайте  
  
1.  В Visual Studio нажмите клавишу F5.  
  
     Откроется сайт SharePoint и [!INCLUDE[wss_14_long](../sharepoint/includes/wss-14-long-md.md)] на странице отображается панель быстрого запуска.  
  
2.  На панели быстрого запуска под **перечислены**, выберите **календаря** ссылку.  
  
     **Календаря** появится страница.  
  
     Если вы не Календарь появляется ссылка на панели быстрого запуска, выбрать **содержимое сайта** ссылку. Если не показывать страницу «содержимое сайта» **календаря** товара, создайте его.  
  
3.  На странице «календарь», выберите день и выберите **добавить** ссылку в выбранный день, чтобы добавить событие.  
  
4.  В **заголовок** введите **события в календаре по умолчанию**и нажмите кнопку **Сохранить** кнопки.  
  
5.  Выберите **содержимое сайта** связь, а затем выберите **добавить приложение** плитки.  
  
6.  На **создать** выберите **календаря** введите имя календаря и выберите **создать** кнопки.  
  
7.  Добавить новый календарь события, имя события **событий в пользовательский календарь**и нажмите кнопку **Сохранить** кнопки.  
  
#### <a name="to-add-the-web-part-to-a-web-part-page"></a>Добавление веб-части на страницу веб-частей  
  
1.  На **содержимое сайта** откройте **страниц сайта** папки.  
  
2.  На ленте выберите **файлы** вкладку, откройте **новый документ** меню и выберите **страницы веб-частей** команды.  
  
3.  На **новой страницы веб-частей** назовите страницу **SampleWebPartPage.aspx**и нажмите кнопку **создать** кнопки.  
  
     Появится меню веб-части.  
  
4.  В зоне верхней части веб-страницы, выберите **вставить** , а затем выберите **веб-часть** кнопки.  
  
5.  Выберите **настраиваемый** папку, выберите **VisualWebPart1** веб-части, а затем выберите **добавить** кнопки.  
  
     Веб-части отображается на странице. Следующие элементы управления отображаются в веб-части:  
  
    -   Представление месячного календаря.  
  
    -   **Обновление** кнопки.  
  
    -   Объект **календаря** флажок.  
  
    -   Объект **пользовательский календарь** флажок.  
  
#### <a name="to-specify-lists-to-include-in-the-monthly-calendar-view"></a>Чтобы указать списки для включения в представление месячного календаря  
  
1.  В веб-части, укажите календарей, которые необходимо включить в представление месячного календаря, а затем выберите **обновление** кнопки.  
  
     События из всех календарей, заданные вами отображаются в представление месячного календаря.  
  
## <a name="see-also"></a>См. также  
 [Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md)   
 [Как: Создание веб-части SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md)   
 [Как: Создание веб-части SharePoint с помощью конструктора](../sharepoint/how-to-create-a-sharepoint-web-part-by-using-a-designer.md)   
 [Пошаговое руководство. Создание веб-части для SharePoint](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint.md)  
  
  