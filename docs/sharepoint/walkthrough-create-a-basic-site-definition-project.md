---
title: "Пошаговое руководство. Создание базового проекта определения сайта | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "Разработка приложений SharePoint в Visual Studio, определения сайтов"
  - "определения сайтов [разработка приложений SharePoint в Visual Studio]"
ms.assetid: b0df5b0e-5fa0-43d8-a339-6d92f1276764
caps.latest.revision: 35
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 34
---
# Пошаговое руководство. Создание базового проекта определения сайта
  В этом пошаговом руководстве демонстрируется создание простейшего определения сайта, содержащего визуальную веб\-часть с некоторыми элементами управления.  Для простоты примера создаваемая визуальная веб\-часть содержит лишь несколько элементов управления.  Впрочем, можно создавать более сложные определения сайтов SharePoint с обширными функциональными возможностями.  
  
 В этом пошаговом руководстве показано выполнение следующих задач.  
  
-   Создание определения сайта с помощью шаблона проекта [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
-   Создание сайта SharePoint с помощью определения сайта в SharePoint.  
  
-   Добавление визуальной веб\-части в решение.  
  
-   Настройка страницы сайта default.aspx за счет добавления визуальной веб\-части.  
  
 [!INCLUDE[note_settings_general](../sharepoint/includes/note-settings-general-md.md)]  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые выпуски Microsoft Windows и SharePoint.  Дополнительные сведения см. в разделе "Требования к разработке решений SharePoint".  
  
-   Visual Studio.  
  
## Создание решения определения сайта  
 Сначала необходимо создать проект определения сайта в среде [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
#### Создание проекта определения сайта  
  
1.  В строке меню **Файл** выберите пункты **Создать**, **Проект**.  Если интерфейс IDE настроен для использования параметров разработки Visual Basic, в меню выберите **Файл**, **Создать проект**.  
  
     Откроется диалоговое окно **Создание проекта**.  
  
2.  Разверните узел **Visual C \#** или узел **Visual Basic**, разверните узел **SharePoint**, затем выберите узел **2010**.  
  
3.  В списке **Шаблоны** выберите шаблон **Проект SharePoint 2010**.  
  
4.  В поле **Имя** введите TestSiteDef и нажмите кнопку **ОК**.  
  
     Появится окно **Мастер настройки SharePoint**.  
  
5.  На странице **Укажите сайт и уровень безопасности для отладки** введите URL\-адрес сайта сервера SharePoint, на котором будет выполняться отладка определения сайта, или примите значение по умолчанию \(http:\/\/*System Name*\/\).  
  
6.  В разделе **Какова степень доверия для этого решения SharePoint?** выберите **Развернуть как решение фермы**.  
  
     Все проекты определений сайтов необходимо развертывать как решения фермы.  Дополнительные сведения о сравнительных особенностях обезвреженных решений и решений фермы см. в разделе [Замечания об обезвреженных решениях](../sharepoint/sandboxed-solution-considerations.md).  
  
7.  Нажмите кнопку **Готово**.  
  
     Проект откроется в **обозревателе решений**.  
  
8.  В области **Обозреватель Решений** выберите узел проекта, затем в меню **Проект** выберите **Добавить новый элемент**.  
  
9. Разверните узел **SharePoint**, расположенный в области **Visual C\#** или **Visual Basic**, и выберите узел **2010**.  
  
10. В области **Шаблоны** выберите шаблон **Определение сайта** оставьте **Имя** как **SiteDefinition1**, а затем нажмите кнопку **Добавить**.  
  
## Создайте визуальную веб\-часть  
 Теперь необходимо создать визуальную веб\-часть, отображаемую на главной странице определения сайта.  
  
#### Создание визуальной веб\-части  
  
1.  В **Обозревателе Решений** нажмите кнопку **Показать все файлы**.  
  
2.  Выберите узел проекта **SiteDefinition1** и затем в строке меню выберите **Проект**, **Добавить новый элемент**.  
  
     Откроется диалоговое окно **Добавление нового элемента**.  
  
3.  Разверните узел **Visual C \#** или узел **Visual Basic**, разверните узел **SharePoint**, затем выберите узел **2010**.  
  
4.  В списке шаблонов выберите шаблон **Визуальная веб\-часть**, сохраните имя по умолчанию \(VisualWebPart1\), а затем нажмите кнопку **Добавить**.  
  
     Файл будет открыт VisualWebPart1.ascx.  
  
5.  В конце файла VisualWebPart1.ascx добавьте следующую разметку, чтобы добавить в форму три элемента управления: текстовое поле, кнопку и метку:  
  
    ```  
    <table>  
      <tr>  
        <td>  
          <asp:TextBox runat="server" ID="tbName"></asp:TextBox>  
        </td>  
        <td>  
          <asp:Button runat="server" ID="btnSubmit" Text = "Change Label Text" OnClick="btnSubmit_Click"></asp:Button>  
        </td>  
        <td>  
          <asp:Label runat="server" ID="lblName"></asp:Label>  
        </td>  
      </tr>  
    </table>  
    ```  
  
6.  Под файл VisualWebPart1.ascx откройте VisualWebPart1.ascx.cs \(для [!INCLUDE[csprcs](../sharepoint/includes/csprcs-md.md)]\) или VisualWebPart1.ascx.vb \(для [!INCLUDE[vbprvb](../sharepoint/includes/vbprvb-md.md)]\) и добавьте следующий код:  
  
     [!code-csharp[SP_SimpleSiteDef#1](../snippets/csharp/VS_Snippets_OfficeSP/sp_simplesitedef/cs/testsitedef/sitedefinition/visualwebpart1/visualwebpart1usercontrol.ascx.cs#1)]
     [!code-vb[SP_SimpleSiteDef#1](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_simplesitedef/vb/testsitedefvb/sitedefinition/visualwebpart1/visualwebpart1usercontrol.ascx.vb#1)]  
  
     Этот код добавляет функцию нажатия кнопки веб\-части.  
  
## Добавьте визуальную веб\-часть на страницу default.aspx.  
 Теперь необходимо добавить визуальную веб\-часть на страницу определения сайта default.aspx.  
  
#### Добавление визуальной веб\-части на страницу default.aspx.  
  
1.  Откройте страницу default.aspx и добавьте следующую строку после тега `WebPartPages`:  
  
    ```  
    <%@ Register Tagprefix="MyWebPartControls" Namespace="TestSiteDef.VisualWebPart1" Assembly="$SharePoint.Project.AssemblyFullName$" %>  
    ```  
  
     Эта строка связывает имя MyWebPartControls с веб\-частью и ее кодом.  Параметр *Namespace* соответствует пространству имен, которое используется в файле кода VisualWebPart1.ascx.  
  
2.  После элемента `</asp:Content>` замените весь раздел `ContentPlaceHolderId="PlaceHolderMain"` и его содержимое следующей разметкой:  
  
    ```  
    <asp:Content ID="Content1" ContentPlaceHolderId="PlaceHolderMain" runat="server">  
        <MyWebPartControls:VisualWebPart1 runat="server" />      
    </asp:Content>  
    ```  
  
     Этот код создает ссылку на визуальную веб\-часть, созданную ранее.  
  
3.  В области **Обозреватель решений** откройте контекстное меню для узла **SiteDefinition1** и выберите команду **Назначить автозапускаемым элементом**.  
  
## Развертывание и запуск решения определения сайта  
 Далее, разверните проекта в SharePoint, а затем снова запустите проект.  
  
#### Развертывание и запуск определения сайта  
  
-   В строке меню последовательно выберите пункты **Сборка** и **Развертывание TestSiteDef**.  
  
-   Нажмите клавишу F5.  
  
     Visual Studio скомпилирует код, добавит его компоненты, поместит все его файлы в WSP\-файл пакета и развернет этот WSP\-файл на сервере SharePoint.  Затем SharePoint установит файлы и активирует компоненты.  
  
## Создайте сайт на основе определения сайта  
 Теперь создайте сайт, используя новое определение сайта.  
  
#### Создание сайта с помощью определения сайта  
  
1.  На сайте SharePoint отобразится страница нового сайта SharePoint.  
  
2.  В разделе **Название и описание** укажите My New Site в поле названия и введите описание сайта.  
  
3.  В разделе **Адрес веб\-сайта** введите mynewsite в поле **URL\-имя**.  
  
4.  В разделе **Шаблон** перейдите на вкладку **Пользовательские разработки SharePoint**.  
  
5.  В списке **Выбрать шаблон** выберите **SiteDefinition1**.  
  
6.  Для остальных параметров оставьте значения по умолчанию и нажмите кнопку **Создать**.  
  
     Появится новый сайт.  
  
## Протестируйте созданный сайт  
 Теперь необходимо протестировать работу созданного сайта.  
  
#### Тестирование созданного сайта  
  
-   В текстовом поле на странице default.aspx введите любой текст и нажмите кнопку **Измените текст надписи** рядом с текстовым полем.  
  
     Текст отобразится на метке справа от кнопки.  
  
## См. также  
 [Практическое руководство. Создание приемника событий](../sharepoint/how-to-create-an-event-receiver.md)   
 [Разработка решений SharePoint](../sharepoint/developing-sharepoint-solutions.md)  
  
  