---
title: Локализация решений SharePoint | Документы Microsoft
ms.custom: ''
ms.date: 02/02/2017
ms.technology:
- office-development
ms.topic: conceptual
f1_keywords:
- VS.SharePointTools.Project.GlobalAndFeatureResource
- VS.SharePoint.Project.AddResourceDialog
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- globalizing [SharePoint development in Visual Studio]
- localizing [SharePoint development in Visual Studio]
- SharePoint development in Visual Studio, localizing
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: 86ffb2795d5e2a9b9583360146c4bb1d2556b9a1
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="localizing-sharepoint-solutions"></a>Локализация решений SharePoint
  Процесс подготовки приложений, чтобы можно было использовать во всем мире называется локализации. Локализация — перевод ресурсы для конкретного языка и региональных параметров. Дополнительные сведения см. в разделе [Globalizing и локализация приложений](/visualstudio/ide/globalizing-and-localizing-applications). В этом разделе Общие сведения о локализации решения SharePoint.  
  
 Для локализации решения, удалите из кода жестко запрограммированные строки и перенести их в файлы ресурсов. Файл ресурсов — [!INCLUDE[TLA2#tla_xml](../sharepoint/includes/tla2sharptla-xml-md.md)]-файл с расширением RESX. Файл ресурсов содержит переведенные версии строк, используемых в решении. Дополнительные сведения см. в разделе [ресурсы в приложениях](http://go.microsoft.com/fwlink/?LinkID=155844).  
  
> [!NOTE]  
>  Добавьте файл ресурсов решения SharePoint только строковые ресурсы. Несмотря на то, что редактор ресурсов позволяет добавлять не строковые ресурсы, такие ресурсы не развертываются для SharePoint.  
  
## <a name="resource-files"></a>Файлы ресурсов  
 Существует три типа файлов ресурсов: по умолчанию, не зависящий от языка и языка.  
  
|Тип файла ресурсов|Описание|  
|------------------------|-----------------|  
|Значение по умолчанию|Также известен как резервный ресурс, файл ресурсов по умолчанию содержит строки, локализованные для культуры по умолчанию, например «английский». Они используются, если не локализованных файлов ресурсов для указанного языка не найден. Ресурсы по умолчанию имеют отдельные файлы, они хранятся в основную сборку приложения.|  
|Зависящий от языка|Файл ресурсов, содержащий строки, локализованные для языка, но не является определенной культурой. Например, «fr» для французского языка.|  
|Зависящие от языка|Файл ресурсов, содержащий строки, локализованные для языка и региональных параметров. Например, «fr-CA» для французский (Канада).|  
  
 Дополнительные сведения см. в разделе [иерархическая организация ресурсов, для локализации](http://go.microsoft.com/fwlink/?LinkId=178360).  
  
 Чтобы указать файл ресурсов по умолчанию в проектах SharePoint, которые можно разрабатывать в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], выберите **универсальный язык (Универсальная страна)** в списке язык и региональные параметры **добавить ресурс** диалоговым окном, когда вы Добавьте файл ресурсов.  
  
## <a name="localizing-visual-studio-sharepoint-solutions"></a>Локализация решений SharePoint в Visual Studio  
 При локализации решения следует выделить всю текстовую информацию, отображаемую решением для пользователей. Информационные сообщения, сообщения об ошибках и [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] строки должны быть переведены, а перевод помещен в файлы ресурсов.  
  
 Каждая строка в файле ресурсов имеет уникальный идентификатор. Используйте тот же идентификатор для переведенных строк в каждом файле ресурсов. Например если «String1» — это идентификатор первой строки в файле ресурса по умолчанию, используйте тот же идентификатор для первой строки в файлах ресурсов для конкретного языка.  
  
 Существует три области, обычно локализации в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] приложения SharePoint: компоненты, разметка страницы ASPX и код. Для наглядности следующих разделах предполагается, что у вас есть решение SharePoint, которое нужно локализовать на немецкий и японский. Язык по умолчанию используется английский.  
  
### <a name="localizing-features"></a>Локализация компонентов  
 Для локализации компонентов необходимо заменить жестко запрограммированное название и описание функции с выражением, ссылающимся на переведенный заголовок и строки в файле локализованные ресурсы. Внести это изменение в **конструкторе компонентов** в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. Дополнительные сведения см. в разделе [как: Локализация компонента](../sharepoint/how-to-localize-a-feature.md).  
  
 Для локализации компонентов с английского языка на немецкий и японский, три элемента проекта файла ресурсов добавьте в проект: одному английский, немецкий и японский. Файлы ресурсов компонентов не может использоваться Локализация разметки ASPX или кода. для них требуются отдельные файлы ресурсов.  
  
 После создания компонента файлы ресурсов, добавьте переведенных строк к ним. Доступ к локализованных строк с помощью выражения в следующем формате:  
  
```  
$Resources:String ID  
```  
  
 Ресурсы компонента в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] именуются ресурсы. Если выбран язык, отличный от универсального языка выберите язык и региональные параметры [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)] добавляется к имени файла ресурсов. Например при добавлении файла ресурсов компонента инвариантного языка (по умолчанию), он называется Resources.resx. При добавлении ресурсов компонента конкретного языка, выбрав язык и региональные параметры японский (Япония), файл будет назван получает имя Resources.ja-JP.resx. Имена файла ресурсов компонента назначаются автоматически и не может быть изменено.  
  
 Область ресурсов компонента является локальной для компонента, который они добавляются. Чтобы создать ресурсы, которые могут использоваться любым файлом компонента или элемента решения, добавьте **глобальный файл ресурсов** элемент проекта вместо файла ресурсов компонента. **Глобальный файл ресурсов** элемент проекта находится в **2010** папку **SharePoint** в **Добавление нового элемента** диалоговое окно. Глобальные ресурсы файлы развертывания в папке \Resources корневой папки SharePoint.  
  
### <a name="localizing-aspx-page-markup"></a>Локализация разметки ASPX-страницы  
 Для локализации [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] страницы, добавьте три элемента проекта файла ресурсов в проект: одному английский, немецкий и японский. Если у вас для локализации кода вместе с разметкой, вместо этого можно добавить глобальные файлы ресурсов.  
  
 Введите имя для файла ресурсов для языка по умолчанию. Назначить локализованных файлов ресурсов, то же имя, дополненная культуры языка [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)]. Например, MyAppResources.de-DE.resx для немецкого языка и MyAppResources.ja-JP.resx для японского языка.  
  
 Задать **тип развертывания** свойство для каждого файла ресурсов для **AppGlobalResource**. В результате файлы ресурсов для развертывания в папке App_GlobalResources, где они доступны для всех страниц ASPX и элементов управления в решении. Папке App_GlobalResources находится в C:\inetpub\wwwroot\wss\VirtualDirectories\\< номер порта\>\App_GlobalResources.  
  
> [!NOTE]  
>  При использовании не глобальных файлов ресурсов, переместите их в папке элемента проекта, чтобы включить свойство типа развертывания и другие свойства, относящиеся к SharePoint.  
  
 Файлы ресурсов разметки ASPX может также использоваться для локализации кода. При использовании ресурсов для локализации кода вместе с разметкой ASPX, оставьте действие при построении значение свойства каждого файла в качестве внедренного ресурса ресурс для компиляции во вспомогательную сборку. Однако при использовании файлов ресурсов только для локализации разметки, можно при необходимости изменить действие при построении содержимого для предотвращения файл компилируется в основную сборку приложения.  
  
 Замените все жестко запрограммированные свойства строки в разметке страницы и элементы управления ASPX выражение в следующем формате:  
  
```  
<asp:<class> runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />  
```  
  
 Пример:  
  
```  
<asp:Button ID="btn1" runat="server" onclick="btn1_Click" Text="<%$Resources:Resource1,String7%>"></asp:Button>  
```  
  
 Для ASPX как текст необходимо используйте выражение в следующем формате:  
  
```  
<asp:literal ID="<ID>" runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />  
```  
  
 Пример:  
  
```  
<asp:literal ID="Literal1" runat="server" Text="<%$Resources:Resource1, String9%>" />  
```  
  
 Дополнительные сведения см. в разделе [как: Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md).  
  
### <a name="localizing-code"></a>Локализация кода  
 В дополнение к локализации строк компонента и [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] разметки, также необходимо локализовать строки сообщений и строки сообщений об ошибках, которые появляются в коде решения. Локализованные информационные сообщения и сообщения об ошибках содержащихся в вспомогательных сборок. Вспомогательные сборки содержат строки, которые отображаются для пользователей, таких как [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] текст и выходные сообщения, такие как исключения.  
  
 [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] использует стандартную модель звезда .NET Framework. Концентратор, или основная сборка программы, содержит языковые ресурсы по умолчанию. Спицы, или вспомогательные сборки содержат языковых ресурсов. Дополнительные сведения см. в статье [Упаковка и развертывание ресурсов](http://go.microsoft.com/fwlink/?LinkId=179280). Вспомогательные сборки компилируются из файлов ресурсов (RESX). При добавлении файлов ресурсов для определенных языков в проект и пакет решения, [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] компилирует файлы ресурсов во вспомогательные сборки с именем *имя проекта*. resources.dll.  
  
 Как и в случае с разметкой ASPX, локализация кода приложения SharePoint путем добавления отдельных элементов проекта файл ресурсов в проект; один для языка по умолчанию и по одному для каждого языка локализации. Тем не менее как было сказано, если у вас уже есть файлы ресурсов для локализации разметки ASPX, их можно было использовать для локализации кода. Если необходимо создать файлы ресурсов, имя файла ресурсов для языка по умолчанию по своему усмотрению с расширением RESX. Называть локализованным файлам ресурсов так же добавляются с культурой, зависящие от языка [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)]. Свойства Действие при построении каждого файла ресурсов для внедренных ресурсов, чтобы разрешить создание вспомогательных сборок ресурсов.  
  
 Создание вспомогательных сборок, постройте проект и затем добавьте файлы в качестве дополнительных сборок через **Дополнительно** вкладке **конструктора пакетов**. При добавлении сборок, добавить язык и региональные параметры [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)] папку пути, например de-DE\\*имя элемента проекта*. resources.dll. Это позволяет пакет, содержащий файлы, которые имеют одинаковое имя.  
  
 В коде, замените жестко запрограммированные строки вызовы <xref:System.Web.HttpContext.GetGlobalResourceObject%2A> метода, используя следующий синтаксис:  
  
```  
HttpContext.GetGlobalResourceObject("<Resource File Name>", "<String ID>")  
```  
  
 Дополнительные сведения см. в разделе [как: локализация кода](../sharepoint/how-to-localize-code.md).  
  
#### <a name="web-part-code-localization"></a>Локализация кода часть Web  
 Веб-части включают функцию редактора пользовательских свойств, которая включает атрибуты кода, использующие жестко запрограммированные строки, такие как WebDisplayName, категория и WebDescription. Чтобы заменить строковые значения для этих атрибутов, создайте отдельный класс, производный от класса атрибута. В этих классах задайте свойства атрибута. Свойство атрибута зависит от базового класса. Например свойство атрибута WebDisplayName DisplayNameValue, а свойство атрибута WebDescription — DescriptionValue.  
  
 В производном классе ссылка на идентификатор строки из файла ресурсов и объекта ResourceManager локализованное значение для идентификатора строки. Возвращают это значение в атрибут редактора свойств.  
  
## <a name="see-also"></a>См. также  
 [Как: Локализация компонента](../sharepoint/how-to-localize-a-feature.md)   
 [Как: Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md)   
 [Как: локализация кода](../sharepoint/how-to-localize-code.md)   
 [Способ: добавьте файл ресурсов](../sharepoint/how-to-add-a-resource-file.md)   
 [Практическое руководство. Использование файла ресурсов для задания локализованных имен, свойств и разрешений](../sharepoint/how-to-use-a-resource-file-to-specify-localized-names-properties-and-permissions.md)  
  
  