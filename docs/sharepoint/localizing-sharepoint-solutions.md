---
title: "Локализация решений SharePoint"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "VS.SharePointTools.Project.GlobalAndFeatureResource"
  - "VS.SharePoint.Project.AddResourceDialog"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "глобализация [разработка приложений SharePoint в Visual Studio]"
  - "локализация [разработка приложений SharePoint в Visual Studio]"
  - "разработка приложений SharePoint в Visual Studio, локализация"
ms.assetid: 0d4cfa2b-8b48-45c7-bbee-ece9b0baffaf
caps.latest.revision: 18
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 17
---
# Локализация решений SharePoint
  Процесс подготовки приложений для их использования по всему миру называется локализацией.  Локализация представляет собой адаптацию ресурсов к условиям определенного языка и региональных параметров.  Для получения дополнительной информации см. [Глобализация и локализация приложений](../ide/globalizing-and-localizing-applications.md).  В данном разделе представлен обзор процесса локализации решения SharePoint.  
  
 Для локализации решения необходимо удалить из кода жестко запрограммированные строки и перенести их в файлы ресурсов.  Файл ресурсов представляет собой [!INCLUDE[TLA2#tla_xml](../sharepoint/includes/tla2sharptla-xml-md.md)] файл c расширением .resx.  Файл ресурсов содержит переведенные версии строк, используемых в решении.  Дополнительные сведения см. в разделе [Ресурсы в приложениях](http://go.microsoft.com/fwlink/?LinkID=155844).  
  
> [!NOTE]  
>  Добавляйте только строковые ресурсы в файл ресурсов решения SharePoint.  Хотя редактор ресурсов позволяет добавлять не строковые ресурсы, такие ресурсы не развертываются в SharePoint.  
  
## Файлы ресурсов  
 Существует три типа файлов ресурсов: по умолчанию, не зависящий от языка и языковой.  
  
|Тип файла ресурсов|Описание|  
|------------------------|--------------|  
|По умолчанию|Также известен как резервный ресурс, файл ресурсов по умолчанию содержит строки, локализованные для языка и региональных параметров, установленных по умолчанию, например, английский.  Они используются в случае, когда файл ресурсов для определенного языка не найден.  Ресурсы по умолчанию не имеют отдельных файлов; они хранятся в основной сборке приложения.|  
|Не зависящий от языка|Файл ресурсов, содержащий строки, локализованные под определенный язык, но не региональные параметры.  Например, "fr" для французского языка.|  
|Языковой|Файл ресурсов, содержащий строки, локализованные под определенный язык и региональные параметры.  Например, "fr\-CA" для французского языка, используемого в Канаде.|  
  
 Дополнительные сведения см. в разделе [Иерархическая организация ресурсов для локализации](http://go.microsoft.com/fwlink/?LinkId=178360).  
  
 Чтобы указать файл ресурсов по умолчанию в проектах SharePoint, разрабатываемых в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], при добавлении файла ресурсов выберите **Универсальный язык \(Универсальная страна\)** из списка языков и региональных параметров в диалоговом окне **Добавление ресурса**.  
  
## Локализация решений Visual Studio SharePoint  
 При локализации решения следует выделить всю текстовую информацию, отображаемую решением для пользователя.  Информационные сообщения, сообщения об ошибках и строки [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] должны быть переведены, а перевод помещен в файлы ресурсов.  
  
 Каждая строка файла ресурсов имеет уникальный идентификатор.  В каждом файле ресурсов используйте одинаковые идентификаторы для переведенных строк.  Например, если "String1" является идентификатором первой строки файла ресурсов по умолчанию, используйте такой же идентификатор для первой строки языковых файлов ресурсов.  
  
 Обычно, в приложениях [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] SharePoint локализации подлежат три области: компоненты, разметка страницы ASPX и код.  Для наглядности, в следующих разделах приведено решение SharePoint, локализуемое на немецкий и японский языки.  По умолчанию используется английский язык.  
  
### Локализация компонентов  
 Для локализации компонентов необходимо заменить жестко запрограммированное название и описание возможности выражением, которое ссылается на переведенное название и строку в локализованном файле ресурсов.  Такая замена выполняется в **Конструкторе компонентов** в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  Для получения дополнительной информации см. [Практическое руководство. Локализация компонента](../sharepoint/how-to-localize-a-feature.md).  
  
 Для локализации компонентов с английского языка на немецкий и японский, следует добавить в проект три элемента проекта файла ресурсов: по одному для английского, немецкого и японского языков.  Файлы ресурсов для компонентов нельзя использовать для локализации разметки ASPX или кода. Для них необходимо создать отдельные файлы ресурсов.  
  
 После создания файлов ресурсов для компонента, добавьте в них переведенные строки.  Обратитесь к локализованным строкам с помощью выражения в следующем формате:  
  
```  
$Resources:String ID  
```  
  
 Ресурсы компонента в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] всегда называются "Ресурсы".  Если вы выбираете проект язык, отличный от инвариантного языка, язык [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)] добавляется к имени файла ресурсов.  Например, при добавлении инвариантного файла ресурсов функции языка \(по умолчанию\) он называется Resources.resx.  При добавлении языкового ресурса компонента с помощью языка и региональных параметров "Японский" \(Япония\), файл получает имя Resources.ja\-JP.resx.  Имена файла ресурсов компонента присваиваются автоматически и не могут быть изменены.  
  
 Область ресурсов компонента является локальной для компонента, к которому они добавляются.  Чтобы создать ресурсы, которые могут быть использованы любым файлом компонента или элемента решения, вместо файла ресурсов компонента добавьте элемент проекта **Глобальные файлы ресурсов**.  Элемент проекта **Глобальные файлы ресурсов** находится в папке **2010** под именем **SharePoint** в диалоговом окне **Добавление нового элемента**.  Глобальные файлы ресурсов развертываются в папке \\Resources корневой папки SharePoint.  
  
### Локализация разметки страницы ASPX  
 Для локализации страниц [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)] добавьте три элемента проекта файла ресурсов в проект: по одному для английского, немецкого и японского языков.  Если локализовать код вместе с разметкой не нужно, можно использовать вместо этого глобальные файлы ресурсов.  
  
 Введите имя для файла ресурсов языка по умолчанию.  Локализованным файлам ресурсов присвойте тоже имя с добавлением определенного языка и региональных параметров [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)].  Например, MyAppResources.de\-DE.resx для немецкого языка и MyAppResources.ja\-JP.resx для японского.  
  
 Для каждого файла ресурсов задайте свойству **Тип развертывания** значение **AppGlobalResource**.  В таком случае файлы ресурсов развертываются в папке App\_GlobalResources, где они становятся доступными для всех страниц ASPX и элементов управления решения.  Папка App\_GlobalResources находится по адресу C:\\inetpub\\wwwroot\\wss\\VirtualDirectories\\\<номер порта\>\\App\_GlobalResources.  
  
> [!NOTE]  
>  При использовании не глобальных файлов ресурсов, переместите их в папку элементов проекта, чтобы активировать свойство "Тип развертывания" и другие свойства, относящиеся к SharePoint.  
  
 Файлы ресурсов разметки ASPX также могут быть использованы для локализации кода.  При использовании ресурсов для локализации кода вместе с разметкой ASPX, оставьте установке свойства "Действие при построении" каждого файла значение "Внедренный ресурс", чтобы скомпилировать ресурс во вспомогательную сборку.  Однако при использовании файлов ресурсов для локализации разметки, можно изменить "Действие при построении" на "Содержимое" для предотвращения компиляции файла в основную сборку приложения.  
  
 Замените все жестко запрограммированные строки свойства разметки страниц ASPX и элементов управления на выражение в следующем формате:  
  
```  
<asp:<class> runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />  
```  
  
 Примеры.  
  
```  
<asp:Button ID="btn1" runat="server" onclick="btn1_Click" Text="<%$Resources:Resource1,String7%>"></asp:Button>  
```  
  
 Для ASPX, в качестве текста используйте выражение в следующем формате:  
  
```  
<asp:literal ID="<ID>" runat="server" Text="<%$Resources:<Resource File Name>, <String ID>%>" />  
```  
  
 Примеры.  
  
```  
<asp:literal ID="Literal1" runat="server" Text="<%$Resources:Resource1, String9%>" />  
```  
  
 Для получения дополнительной информации см. [Практическое руководство. Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md).  
  
### Локализация кода  
 В дополнение к локализации строк компонента и разметки [!INCLUDE[vstecasp](../sharepoint/includes/vstecasp-md.md)], также необходимо локализовать строки сообщений и ошибок, которые появляются в коде решения.  Локализованные информационные сообщения и сообщения об ошибках могут содержаться во вспомогательных сборках.  Вспомогательные сборки содержат строки, отображаемые для пользователей, например, текст [!INCLUDE[TLA2#tla_ui](../sharepoint/includes/tla2sharptla-ui-md.md)] и выходные сообщения, такие как исключения.  
  
 [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] использует стандартную модель "звезда" платформы .NET Framework.  Концентратор, или основная сборка программы, содержит языковые ресурсы по умолчанию.  Спицы, или вспомогательные сборки, содержат языковые ресурсы.  Дополнительные сведения см. в разделе [Упаковка и развертывание ресурсов](http://go.microsoft.com/fwlink/?LinkId=179280).  Вспомогательные сборки компилируются из файлов ресурсов \(.resx\).  При добавлении в проект и пакет решения языковых файлов ресурсов, [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] компилирует файлы ресурсов во вспомогательные сборки с именем *Project Name*.resources.dll.  
  
 Как и в случае с разметкой ASPX, локализация кода приложения SharePoint происходит посредством добавления в проект отдельных элементов проекта файла ресурсов: одного для языка по умолчанию и по одному для каждого локализованного языка.  Однако как упоминалось ранее, уже существующие файлы ресурсов для локализации разметки ASPX можно использовать и для локализации кода.  Чтобы создать файлы ресурсов, языковому файлу ресурсов по умолчанию присвойте любое имя с расширением .resx.  Локализованным файлам ресурсов присвойте тоже имя с добавлением определенного языка и региональных параметров [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)].  Для каждого файла ресурсов свойству "Действие при построении" присвойте значение "Внедренный ресурс", чтобы начать создание вспомогательных сборок ресурсов.  
  
 Чтобы создать вспомогательные сборки, постройте проект и на вкладке **Дополнительно** в **Конструкторе проектов** добавьте файлы, в качестве дополнительных сборок.  При добавлении сборок в начале пути вставьте папку языка и региональных параметров [!INCLUDE[TLA2#tla_id](../sharepoint/includes/tla2sharptla-id-md.md)], например: de\-DE\\*Project Item Name*.resources.dll.  Это допускает содержание в пакете файлов, с одинаковыми именами.  
  
 В коде, замените жестко запрограммированные строки на обращения к методу <xref:System.Web.HttpContext.GetGlobalResourceObject%2A>, используя следующий синтаксис:  
  
```  
HttpContext.GetGlobalResourceObject("<Resource File Name>", "<String ID>")  
```  
  
 Для получения дополнительной информации см. [Практическое руководство. Локализация кода](../sharepoint/how-to-localize-code.md).  
  
#### Локализация кода веб\-части  
 Веб\-части содержат пользовательскую функцию редактора свойств, которая включает атрибуты кода, использующие жестко запрограммированные строки, такие как WebDisplayName, категория и WebDescription.  Чтобы заменить значения строк для данных атрибутов, создайте отдельный класс, наследуемый из класса атрибута.  В этих классах задайте свойство атрибута.  Свойство атрибута зависит от базового класса.  Например, свойством атрибута WebDisplayName является DisplayNameValue, а свойством атрибута WebDescription — DescriptionValue.  
  
 Чтобы получить локализованное значение для идентификатора строки, в производном классе, сошлитесь на идентификатор строки из файла ресурсов и объекта ResourceManager.  Верните это значение в атрибут редактора свойств.  
  
## См. также  
 [Практическое руководство. Локализация компонента](../sharepoint/how-to-localize-a-feature.md)   
 [Практическое руководство. Локализация разметки ASPX](../sharepoint/how-to-localize-aspx-markup.md)   
 [Практическое руководство. Локализация кода](../sharepoint/how-to-localize-code.md)   
 [Практическое руководство. Добавление файла ресурсов](../sharepoint/how-to-add-a-resource-file.md)   
 [Практическое руководство. Использование файла ресурсов для задания локализованных имен, свойств и разрешений](../sharepoint/how-to-use-a-resource-file-to-specify-localized-names-properties-and-permissions.md)  
  
  