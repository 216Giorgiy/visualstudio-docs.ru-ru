---
title: Отладка расширений для средств SharePoint в Visual Studio | Документы Microsoft
ms.custom: ''
ms.date: 02/02/2017
ms.technology:
- office-development
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- SharePoint development in Visual Studio, debugging extensions
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: 7f976db455fc0cd847c648eb586b95fb81f6d5fd
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="debugging-extensions-for-the-sharepoint-tools-in-visual-studio"></a>Отладка расширений для средств SharePoint в Visual Studio
  Можно выполнить отладку расширения инструментов SharePoint в экспериментальном экземпляре или обычном экземпляре Visual Studio. Если требуется для устранения неполадок поведения расширения, можно также изменить значения реестра для отображения дополнительных сведений об ошибке и настройки выполнением команд SharePoint в Visual Studio.  
  
## <a name="debugging-extensions-in-the-experimental-instance-of-visual-studio"></a>Отладка расширений в экспериментальном экземпляре Visual Studio  
 Для защиты среды разработки Visual Studio от случайного повреждения недоверенными расширениями, пакет SDK для Visual Studio предоставляет альтернативный экземпляр Visual Studio, называемый *экспериментальный экземпляр*, который можно использовать Установка и тестирование расширения. Новые расширения разрабатываются с помощью обычного экземпляра Visual Studio, но отлаживать и запускать их в экспериментальном экземпляре. Дополнительные сведения см. в разделе [экспериментальный экземпляр](/visualstudio/extensibility/the-experimental-instance).  
  
 Если использование проекта VSIX для развертывания расширения проекта VSIX является запускаемым проектом в решении, Visual Studio автоматически устанавливает и запускает расширения в экспериментальном экземпляре при отладке решения. Запускаемым проектом является проект, который запускается при отладке решения, содержащего несколько проектов. Дополнительные сведения об использовании проекта VSIX для развертывания расширения см. в разделе [развертывание расширений для средств SharePoint в Visual Studio](../sharepoint/deploying-extensions-for-the-sharepoint-tools-in-visual-studio.md).  

 Примеры, демонстрирующие способы отладки различных типов расширений в экспериментальном экземпляре Visual Studio см. в следующих пошаговых руководствах:  
  
-   [Пошаговое руководство. Расширение типа элемента проекта SharePoint](../sharepoint/walkthrough-extending-a-sharepoint-project-item-type.md)  
  
-   [Пошаговое руководство. Создание элемента проекта настраиваемого действия с помощью шаблона элемента, часть 1](../sharepoint/walkthrough-creating-a-custom-action-project-item-with-an-item-template-part-1.md)  
  
-   [Пошаговое руководство. Создание пользовательского этапа развертывания для проектов SharePoint](../sharepoint/walkthrough-creating-a-custom-deployment-step-for-sharepoint-projects.md)  
  
-   [Пошаговое руководство. Расширение обозревателя сервера, так чтобы в нем отображались веб-части](../sharepoint/walkthrough-extending-server-explorer-to-display-web-parts.md)  
  
-   [Пошаговое руководство. Вызов клиентской объектной модели SharePoint в расширении обозревателя серверов](../sharepoint/walkthrough-calling-into-the-sharepoint-client-object-model-in-a-server-explorer-extension.md)  
  
## <a name="debugging-extensions-in-the-regular-instance-of-visual-studio"></a>Отладка расширений в обычном экземпляре Visual Studio  
 Если необходимо выполнить отладку проекта расширения в обычном экземпляре Visual Studio, сначала установите расширение в обычном экземпляре. Затем присоедините отладчик к второй процесс Visual Studio. После завершения работы, расширение можно удалить, чтобы он больше не загружает на компьютере разработчика.  
  
#### <a name="to-install-the-extension"></a>Установка расширения  
  
1.  Закройте все экземпляры Visual Studio.  
  
2.  В выходную папку построения для проекта расширения, откройте VSIX-файл, дважды щелкнув его или открыв его контекстное меню и выбрав **откройте**:  
  
3.  В **установщик расширений Visual Studio** диалогового окна выберите выпуск Visual Studio, к которому вы хотите установить расширение, а затем выберите **установить** кнопки.  
  
     Visual Studio устанавливает файлы расширения %UserProfile%\AppData\Local\Microsoft\VisualStudio\11.0\Extensions\\*имя автора*\\*имя расширения* \\ *версии*. Последние три папки по этому пути формируются на основе `Author`, `Name`, и `Version` элементы в файл extension.vsixmanifest для расширения.  
  
4.  После установки расширения Visual Studio выберите **закрыть** кнопки.  
  
#### <a name="to-debug-the-extension"></a>Чтобы выполнить отладку расширения  
  
1.  Запустите Visual Studio с правами администратора и откройте проект расширения. Следующие действия ссылаются на этот экземпляр Visual Studio как *сначала экземпляров*.  
  
2.  Запустите другой экземпляр Visual Studio с правами администратора. Следующие действия ссылаются на этот экземпляр Visual Studio как *второй экземпляр*.  
  
3.  Перейдите к первому экземпляру Visual Studio.  
  
4.  В строке меню выберите **отладки**, **присоединиться к процессу**.  
  
5.  В **доступные процессы** выберите devenv.exe. Эта запись относится ко второму экземпляру Visual Studio; Это экземпляр, необходимо выполнить отладку проекта расширения в.  
  
6.  Выберите **присоединение** кнопки.  
  
     Visual Studio запускает проект расширения в режиме отладки.  
  
7.  Перейдите ко второму экземпляру Visual Studio.  
  
8.  Создайте новый проект SharePoint, который загружает расширение. Например, при отладке расширения для элементов проекта определения списка создать **определение списка** проекта.  
  
9. Выполните действия, необходимые для тестирования кода расширения.  
  
10. По окончании отладки расширения закройте второй экземпляр Visual Studio.  
  
#### <a name="to-remove-the-extension"></a>Удаление расширения  
  
1.  В Visual Studio в строке меню выберите **средства**, **расширения и обновления**.  
  
     Появится диалоговое окно **Расширения и обновления**.  
  
2.  Выберите имя расширения в список расширений и нажмите кнопку **удаления** кнопки.  
  
3.  В появившемся диалоговом окне, выберите **Да** кнопку, чтобы убедиться, что вы хотите удалить расширение.  
  
4.  Выберите **Перезагрузить сейчас** кнопку, чтобы завершить удаление.  
  
## <a name="debugging-sharepoint-commands"></a>Отладка команды SharePoint  
 Если требуется отладить команда SharePoint, который является частью расширения инструментов SharePoint, необходимо подключить отладчик к процессу vssphost4.exe. Это 64-разрядный процесс, который выполняет команды SharePoint. Дополнительные сведения о командах SharePoint и vssphost4.exe см. в разделе [вызова объектной модели SharePoint](../sharepoint/calling-into-the-sharepoint-object-models.md).  
  
#### <a name="to-attach-the-debugger-to-the-vssphost4exe-process"></a>Чтобы подключить отладчик к процессу vssphost4.exe  
  
1.  Начните отладку расширения в экспериментальном экземпляре Visual Studio или в обычном экземпляре Visual Studio, следуя приведенным выше инструкциям.  
  
2.  В экземпляре Visual Studio, в котором выполняется отладчик, в строке меню, выберите **отладки**, **присоединиться к процессу**.  
  
3.  В **доступные процессы** выберите vssphost.exe.  
  
    > [!NOTE]  
    >  Если vssphost.exe не отображается в списке, необходимо запустить процесс vssphost4.exe в экземпляре Visual Studio, в котором выполняется расширение. Как правило это делается путем выполнения действие, вызывающее Visual Studio для подключения к сайту SharePoint на компьютере разработчика. Например, Visual Studio запускает vssphost4.exe при разворачивании узла подключения к (узел, отображающий URL-адрес сайта) в разделе **подключения SharePoint** узел в **обозревателя серверов** окна, или если вы Добавьте определенные элементы проекта SharePoint, такие как **экземпляра списка** или **приемника событий** элементов в проект SharePoint.  
  
4.  Выберите **присоединение** кнопки.  
  
5.  В экземпляре Visual Studio, в котором выполняется отладка выполните действия, необходимые для выполнения команды.  
  
## <a name="modifying-registry-values-to-help-debug-sharepoint-tools-extensions"></a>Изменение значений реестра для облегчения отладки SharePoint средств расширения  
 При отладке расширения средств SharePoint в Visual Studio, можно изменить значения в реестре для устранения неполадок расширения. В разделе HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\11.0\SharePointTools существует значения. Эти значения по умолчанию не существует.  
  
 Для устранения каких-либо расширений инструментов SharePoint можно создать и установить значение EnableDiagnostics. В следующей таблице описаны это значение.  
  
|Значение|Описание|  
|-----------|-----------------|  
|EnableDiagnostics|REG_DWORD указывает, отображаются ли диагностические сообщения в **вывода** окна.<br /><br /> Чтобы отобразить диагностическую информацию, это значение равно 1. Чтобы отключить отображение сообщений, это значение равно 0 или удалите это значение.<br /><br /> Для записи сообщений в **вывода** расширения средств SharePoint в окне, используйте службы проектов SharePoint. Дополнительные сведения см. в разделе [использование службы проектов SharePoint](../sharepoint/using-the-sharepoint-project-service.md).|  
  
 Если расширение содержит команду SharePoint, можно создать и установить дополнительные значения для облегчения устранения неполадок в команде. В следующей таблице описаны эти значения.  
  
|Значение|Описание|  
|-----------|-----------------|  
|AttachDebuggerToHostProcess|REG_DWORD указывает, следует ли отображать диалоговое окно позволяет подключить отладчик к vssphost4.exe при запуске. Это полезно, если команда, необходимо выполнить отладку выполняется vssphost.exe сразу после ее запуска, а не достаточно времени, чтобы вручную присоединить отладчик перед выполнением команды. Чтобы отобразить диалоговое окно, вызывает vssphost4.exe <xref:System.Diagnostics.Debugger.Break%2A> метод при запуске.<br /><br /> Чтобы включить это поведение, это значение равно 1. Чтобы отключить это поведение, это значение равно 0 или удалите это значение.<br /><br /> Если это значение равно 1, можно также увеличить значение HostProcessStartupTimeout самостоятельно достаточно времени, чтобы присоединить отладчик Visual Studio ожидает vssphost4.exe сигнала успешно запущена.|  
|ChannelOperationTimeout|REG_DWORD указывает время в секундах, Visual Studio для выполнения команды SharePoint. Если команда не будет выполнена вовремя, <xref:Microsoft.VisualStudio.SharePoint.SharePointConnectionException> возникает исключение.<br /><br /> Значение по умолчанию — 120 секунд.|  
|HostProcessStartupTimeout|REG_DWORD указывает время в секундах, которое Visual Studio ожидает vssphost4.exe сигнала, он успешно запущена. Если vssphost4.exe не сообщает об успешном запуске вовремя, <xref:Microsoft.VisualStudio.SharePoint.SharePointConnectionException> возникает исключение.<br /><br /> Значение по умолчанию — 60 секунд.|  
|MaxReceivedMessageSize|REG_DWORD указывает максимально допустимый размер в байтах сообщения WCF, которые передаются между Visual Studio и vssphost4.exe.<br /><br /> Значение по умолчанию — 1 048 576 байт (1 МБ).|  
|MaxStringContentLength|REG_DWORD указывает максимально допустимый размер в байтах строки, передаваемые между Visual Studio и vssphost4.exe.<br /><br /> Значение по умолчанию — 1 048 576 байт (1 МБ).|  
  
## <a name="see-also"></a>См. также  
 [Расширение инструментов SharePoint в Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md)   
 [Развертывание расширений для инструментов SharePoint в Visual Studio](../sharepoint/deploying-extensions-for-the-sharepoint-tools-in-visual-studio.md)  
  
  