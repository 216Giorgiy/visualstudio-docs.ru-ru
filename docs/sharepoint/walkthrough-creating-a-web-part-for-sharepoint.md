---
title: "Пошаговое руководство: Создание веб-части для SharePoint | Документы Microsoft"
ms.custom: 
ms.date: 02/02/2017
ms.reviewer: 
ms.suite: 
ms.technology: office-development
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
- CSharp
- VB
- CSharp
helpviewer_keywords:
- Web Parts [SharePoint development in Visual Studio], developing
- Web Parts [SharePoint development in Visual Studio], creating
- Web Parts [SharePoint development in Visual Studio], designing
ms.assetid: 51fb5bdd-b99c-4716-83bc-e66a5da15169
caps.latest.revision: "34"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.openlocfilehash: 3293382ffc0c36fb78bb115d0f38c311278a7151
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="walkthrough-creating-a-web-part-for-sharepoint"></a>Пошаговое руководство. Создание веб-части для SharePoint
  Веб-части позволяют пользователям напрямую изменять содержимое, внешний вид и поведение страниц сайта SharePoint с помощью браузера. В этом пошаговом руководстве показано, как создать веб-части с помощью **веб-часть** шаблона элемента в Visual Studio 2010.  
  
 Веб-части отображаются сотрудники, в сетке данных. Пользователь указывает расположение файла, содержащего данные о сотрудниках. Пользователь также может фильтровать сетка данных, для отображения в списке только сотрудников, которые являются менеджерами компании.  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Создание веб-части с помощью Visual Studio **веб-часть** шаблона элемента.  
  
-   Создание свойства, которое может устанавливаться пользователем веб-части. Это свойство указывает расположение файла данных сотрудников.  
  
-   Отображение содержимого в веб-части путем добавления элементов управления в веб-часть в коллекцию элементов управления.  
  
-   Создание нового пункта меню, называется *команды* , которая отображается в меню команд отображаемой веб-части. Команды позволяют пользователю изменять данные, отображаемые в веб-части.  
  
-   Тестирование веб-части в SharePoint.  
  
    > [!NOTE]  
    >  Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях. Это зависит от имеющегося выпуска Visual Studio и используемых параметров. Дополнительные сведения см. в разделе [Персонализация интегрированной среды разработки Visual Studio](../ide/personalizing-the-visual-studio-ide.md).  
  
## <a name="prerequisites"></a>Предварительные требования  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые редакции Microsoft Windows и SharePoint. Дополнительные сведения см. в разделе [требования к разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vs_pro_current_short](../sharepoint/includes/vs-pro-current-short-md.md)]или выпуск из Visual Studio Application Lifecycle Management (ALM).  
  
## <a name="creating-an-empty-sharepoint-project"></a>Создавая пустой проект SharePoint  
 Сначала создайте пустой проект SharePoint. Позже вы добавите веб-части в проект с помощью **веб-часть** шаблона элемента.  
  
#### <a name="to-create-an-empty-sharepoint-project"></a>Чтобы создать пустой проект SharePoint  
  
1.  Запуск [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] с помощью **Запуск от имени администратора** параметр.  
  
2.  В строке меню выберите **файл**, **New**, **проекта**.  
  
3.  В **новый проект** диалогового окна разверните **SharePoint** узле язык, который вы хотите использовать, а затем выберите **2010** узла.  
  
4.  В **шаблоны** области, выберите **проект SharePoint 2010**и нажмите кнопку **ОК** кнопки.  
  
     **Мастер настройки SharePoint** отображается. Этот мастер позволяет выбрать сайт, который будет использоваться для отладки проекта и уровень доверия решения.  
  
5.  Выберите **развернуть как решение фермы** переключатель, а затем выберите **Готово** кнопку, чтобы принять локальный сайт SharePoint по умолчанию.  
  
## <a name="adding-a-web-part-to-the-project"></a>Добавление веб-части в проект  
 Добавить **веб-часть** элемента в проект. **Веб-часть** элемента Добавление файла кода веб-части. Позже добавите код в файл кода веб-части для отображения содержимого веб-части.  
  
#### <a name="to-add-a-web-part-to-the-project"></a>Чтобы добавить веб-части в проект  
  
1.  В строке меню выберите **проекта**, **Добавление нового элемента**.  
  
2.  В **Добавление нового элемента** в диалоговом **установленные шаблоны** области, разверните **SharePoint** узел и выберите **2010** узла.  
  
3.  В списке шаблонов SharePoint выберите **веб-часть** шаблона, а затем выберите **добавить** кнопки.  
  
     **Веб-часть** элемент появляется в **обозревателе решений**.  
  
## <a name="rendering-content-in-the-web-part"></a>Отображение содержимого в веб-части  
 Можно указать, какие элементы управления, будет отображаться в веб-части путем добавления их в коллекцию элементов управления веб-части класса.  
  
#### <a name="to-render-content-in-the-web-part"></a>Для отображения содержимого веб-части  
  
1.  В **обозревателе решений**, откройте WebPart1.vb (в Visual Basic) или WebPart1.cs (в C#).  
  
     В редакторе кода откроется файл кода веб-части.  
  
2.  Добавьте следующие инструкции в начало файла кода веб-части.  
  
     [!code-csharp[SP_WebPart#1](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#1)]
     [!code-vb[SP_WebPart#1](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#1)]  
  
3.  Добавьте следующий код в класс `WebPart1`. Этот код объявляет следующие поля:  
  
    -   Сетка данных для отображения сотрудников в веб-части.  
  
    -   Текст, отображаемый на элементе управления, который используется для фильтрации сетки данных.  
  
    -   Метка, выводится сообщение об ошибке, если сетка данных не удалось отобразить данные.  
  
    -   Строка, содержащая путь к файлу данных сотрудников.  
  
     [!code-csharp[SP_WebPart#2](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#2)]
     [!code-vb[SP_WebPart#2](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#2)]  
  
4.  Добавьте следующий код в класс `WebPart1`. Этот код добавляет пользовательское свойство с именем `DataFilePath` веб-части. Пользовательское свойство является свойством, которое можно задать в SharePoint для пользователя. Это свойство возвращает и задает расположение файла данных XML, используемый для заполнения сетки данных.  
  
     [!code-csharp[SP_WebPart#3](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#3)]
     [!code-vb[SP_WebPart#3](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#3)]  
  
5.  Замените метод `CreateChildControls` следующим кодом. Этот код выполняет следующие задачи:  
  
    -   Добавляет сетку данных и метку, объявленные в предыдущем шаге.  
  
    -   Привязывает сетку данных в XML-файл, содержащий данные о сотрудниках.  
  
     [!code-csharp[SP_WebPart#4](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#4)]
     [!code-vb[SP_WebPart#4](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#4)]  
  
6.  Добавьте следующий метод в класс `WebPart1`. Этот код выполняет следующие задачи:  
  
    -   Создает команду, которая отображается в меню команд веб-части, готовый для просмотра веб-части.  
  
    -   Обрабатывает событие, возникающее при выборе пользователем команды в меню команд. Этот код фильтрует список сотрудников, который отображается в сетке данных.  
  
     [!code-csharp[SP_WebPart#5](../sharepoint/codesnippet/CSharp/spext_webpart/webpart1/webpart1.cs#5)]
     [!code-vb[SP_WebPart#5](../sharepoint/codesnippet/VisualBasic/spext_webpart/webpart1/webpart1.vb#5)]  
  
## <a name="testing-the-web-part"></a>Тестирование веб-части  
 При запуске проекта открывается сайт SharePoint. Веб-части автоматически добавляется в коллекцию веб-частей в SharePoint. Веб-часть можно добавить на любую страницу веб-части.  
  
#### <a name="to-test-the-web-part"></a>Для тестирования веб-части  
  
1.  Вставьте следующий XML-код в файл блокнота. Этот XML-файл содержит образцы данных, которое будет отображаться в веб-части.  
  
    ```  
    <?xml version="1.0" encoding="utf-8" ?>  
        <employees xmlns="http://schemas.microsoft.com/vsto/samples">  
           <employee>  
               <name>David Hamilton</name>  
               <hireDate>2001-05-11</hireDate>  
               <title>Sales Associate</title>  
           </employee>  
           <employee>  
               <name>Karina Leal</name>  
               <hireDate>1999-04-01</hireDate>  
               <title>Manager</title>  
           </employee>  
           <employee>  
               <name>Nancy Davolio</name>  
               <hireDate>1992-05-01</hireDate>  
               <title>Sales Associate</title>  
           </employee>  
           <employee>  
               <name>Steven Buchanan</name>  
               <hireDate>1955-03-04</hireDate>  
               <title>Manager</title>  
           </employee>  
           <employee>  
               <name>Suyama Michael</name>  
               <hireDate>1963-07-02</hireDate>  
               <title>Sales Associate</title>  
           </employee>  
        </employees>  
    ```  
  
2.  В «блокноте» в строке меню выберите **файл**, **Сохранить как**.  
  
3.  В **Сохранить как** диалогового **тип** выберите **все файлы**.  
  
4.  В **имя файла** введите **data.xml**.  
  
5.  Выберите любую папку с помощью **Обзор папок** , а затем кнопку **Сохранить** кнопки.  
  
6.  В Visual Studio выберите **F5** ключа.  
  
     Откроется сайт SharePoint.  
  
7.  На **действия сайта** меню, выберите **Дополнительно**.  
  
8.  В **создать** выберите **страницы веб-частей** введите, а затем выберите **создать** кнопки.  
  
9. В **новой страницы веб-частей** назовите страницу **SampleWebPartPage.aspx**и нажмите кнопку **создать** кнопки.  
  
     Откроется страница веб-части.  
  
10. Выберите все области на странице веб-части.  
  
11. В верхней части страницы, выберите **вставить** , а затем выберите **веб-часть** кнопки.  
  
12. В **категории** области выберите **настраиваемый** папку, выберите **WebPart1** веб-части и выберите **добавить** кнопки.  
  
     Веб-части отображается на странице.  
  
## <a name="testing-the-custom-property"></a>Тестирование пользовательского свойства  
 Чтобы заполнить сетке данных, которая отображается в веб-части, укажите путь к XML-файл, который содержит данные обо всех сотрудниках.  
  
#### <a name="to-test-the-custom-property"></a>Для проверки пользовательского свойства  
  
1.  Выберите стрелку, отображающуюся в правой части веб-части, а затем выберите **изменить веб-часть** из появившегося меню.  
  
     Область, содержащую свойства веб-части отображается в правой части страницы.  
  
2.  В области, разверните **Разное** узла, введите путь к XML-файла, созданного ранее, выберите **применить** , а затем кнопку **ОК** кнопки.  
  
     Убедитесь, что список сотрудников отображается в веб-части.  
  
## <a name="testing-the-web-part-verb"></a>Тестирование команды веб-части  
 Отобразить или скрыть сотрудников, которые не являются менеджерами, щелкнув элемент, который отображается в меню команд веб-части.  
  
#### <a name="to-test-the-web-part-verb"></a>Для тестирования команды веб-части  
  
1.  Выберите стрелку, отображающуюся в правой части веб-части, а затем выберите **Показывать только менеджеров** из появившегося меню.  
  
     В веб-части отображаются только тех сотрудников, которые являются менеджерами компании.  
  
2.  Щелкните стрелку еще раз, а затем выберите **Показывать всех сотрудников** из появившегося меню.  
  
     Обо всех сотрудниках отображаются в веб-части.  
  
## <a name="see-also"></a>См. также  
 [Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md)   
 [Как: Создание веб-части SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md)   
 [Как: Создание веб-части SharePoint с помощью конструктора](../sharepoint/how-to-create-a-sharepoint-web-part-by-using-a-designer.md)   
 [Пошаговое руководство. Создание веб-части для SharePoint с помощью конструктора](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint-by-using-a-designer.md)  
  
  