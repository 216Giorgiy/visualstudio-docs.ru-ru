---
title: "Пошаговое руководство. Создание веб-части для SharePoint | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "веб-части [разработка приложений SharePoint в Visual Studio], создание"
  - "веб-части [разработка приложений SharePoint в Visual Studio], разработка"
  - "веб-части [разработка приложений SharePoint в Visual Studio], разработка"
ms.assetid: 51fb5bdd-b99c-4716-83bc-e66a5da15169
caps.latest.revision: 34
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 33
---
# Пошаговое руководство. Создание веб-части для SharePoint
  Веб\-части позволяют непосредственно изменять содержимое, внешний вид и поведение страниц сайта SharePoint с помощью браузера.  В этом пошаговом руководстве показано создание веб\-части с использованием шаблона элемента **Веб\-часть** в Visual Studio 2010.  
  
 Веб\-часть позволяет отобразить сведения о сотрудниках в сетке данных.  Пользователь задает расположение файла, в котором содержатся данные о сотрудниках.  Пользователь также может фильтровать данные, отображаемые в сетке, чтобы, например, в список включались только сотрудники, являющиеся менеджерами.  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Создание веб\-части с помощью шаблона элемента Visual Studio **Веб\-часть**.  
  
-   Создание свойства, которое может быть задано пользователем веб\-части.  Это свойство задает расположение файла с данными о сотрудниках.  
  
-   Отрисовка содержимого в веб\-части путем добавления элементов управления в коллекцию элементов управления веб\-части.  
  
-   Создание нового пункта меню, который называется *команда* и содержится в меню команд отображаемой веб\-части.  Команды позволяют пользователю изменять данные, отображаемые в веб\-части.  
  
-   Тестирование веб\-части в SharePoint.  
  
    > [!NOTE]  
    >  Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях.  Эти элементы определяются используемой версией Visual Studio и ее параметрами.  Дополнительные сведения см. в разделе [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   Поддерживаемые выпуски Microsoft Windows и SharePoint.  Для получения дополнительной информации см. [Требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vs_pro_current_short](../sharepoint/includes/vs-pro-current-short-md.md)] или выпуск Visual Studio Application Lifecycle Management \(ALM\).  
  
## Создание пустого проекта SharePoint  
 Создайте пустой проект SharePoint.  Впоследствии в этот проект нужно будет добавить веб\-часть с помощью шаблона элемента **Веб\-часть**.  
  
#### Создание пустого проекта SharePoint  
  
1.  Запустите [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)], используя параметр **Запуск от имени администратора**.  
  
2.  В строке меню выберите пункты **Файл**, **Создать**, **Проект**.  
  
3.  В диалоговом окне **Новый проект** разверните узел **SharePoint**, относящийся к необходимому языку, и выберите узел **2010**.  
  
4.  В панели **Шаблоны** выберите **Проект SharePoint 2010**, а затем нажмите кнопку **ОК**.  
  
     Появится окно **Мастер настройки SharePoint**.  Этот мастер позволяет выбрать сайт для отладки проекта и уровень доверия решения.  
  
5.  Выберите переключатель **Развернуть как решение фермы** и нажмите кнопку **Готово**, чтобы принять локальный сайт SharePoint по умолчанию.  
  
## Добавление веб\-части в проект  
 Добавьте в проект элемент **Веб\-часть**.  Элемент **Веб\-часть** добавляет файл кода веб\-части.  Впоследствии в файл кода веб\-части необходимо будет добавить код, чтобы отобразить содержимое веб\-части.  
  
#### Добавление веб\-части в проект  
  
1.  В строке меню выберите **Проект**, **Добавить новый элемент**.  
  
2.  В диалоговом окне **Добавление нового элемента** в области **Установленные шаблоны** разверните узел **SharePoint** и щелкните **2010**.  
  
3.  В списке шаблонов SharePoint выберите шаблон **Веб\-часть**, а затем нажмите кнопку **Добавить**.  
  
     **Веб\-часть** отобразится в **обозревателе решений**.  
  
## Отрисовка содержимого в веб\-части  
 Чтобы задать, какие элементы управления должны отображаться в веб\-части, нужно добавить их в коллекцию элементов управления класса веб\-части.  
  
#### Отображение содержимого в веб\-части  
  
1.  В **обозревателе решений** откройте WebPart1.vb \(в Visual Basic\) или WebPart1.cs \(в C\#\).  
  
     В редакторе кода откроется файл кода веб\-части.  
  
2.  Добавьте следующие операторы в верхнюю часть файла кода веб\-части.  
  
     [!code-csharp[SP_WebPart#1](../snippets/csharp/VS_Snippets_OfficeSP/sp_webpart/cs/webpart1/webpart1.cs#1)]
     [!code-vb[SP_WebPart#1](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_webpart/vb/webpart1/webpart1.vb#1)]  
  
3.  Добавьте следующий код в класс `WebPart1`.  В этом коде объявляются следующие поля.  
  
    -   Сетка данных для отображения сведений о сотрудниках в веб\-части.  
  
    -   Текст, который отображается в элементе управления, используемого для фильтрации сетки данных.  
  
    -   Метка, отображающая ошибку, если не удается отобразить данные в сетке данных.  
  
    -   Строка, которая содержит путь к файлу данных о сотрудниках.  
  
     [!code-csharp[SP_WebPart#2](../snippets/csharp/VS_Snippets_OfficeSP/sp_webpart/cs/webpart1/webpart1.cs#2)]
     [!code-vb[SP_WebPart#2](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_webpart/vb/webpart1/webpart1.vb#2)]  
  
4.  Добавьте следующий код в класс `WebPart1`.  Этот код добавляет пользовательское свойство с именем `DataFilePath` в веб\-часть.  Пользовательское свойство — это свойство в SharePoint, которое может задать пользователь.  Это свойство получает и задает расположение файла XML\-данных, используемых для заполнения сетки данных.  
  
     [!code-csharp[SP_WebPart#3](../snippets/csharp/VS_Snippets_OfficeSP/sp_webpart/cs/webpart1/webpart1.cs#3)]
     [!code-vb[SP_WebPart#3](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_webpart/vb/webpart1/webpart1.vb#3)]  
  
5.  Замените метод `CreateChildControls` следующим кодом.  Этот код выполняет следующие задачи:  
  
    -   Добавляет сетку данных и метку, объявленные в предыдущем шаге.  
  
    -   Привязывает сетку данных к XML\-файлу, содержащему данные о сотрудниках.  
  
     [!code-csharp[SP_WebPart#4](../snippets/csharp/VS_Snippets_OfficeSP/sp_webpart/cs/webpart1/webpart1.cs#4)]
     [!code-vb[SP_WebPart#4](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_webpart/vb/webpart1/webpart1.vb#4)]  
  
6.  Добавьте следующий метод в класс `WebPart1`.  Этот код выполняет следующие задачи:  
  
    -   Создает команду, которая отображается в меню команд отображаемой веб\-части.  
  
    -   Обрабатывает событие, возникающее при выборе пользователем команды из меню команд.  Этот код фильтрует список сотрудников, который отображается в сетке данных.  
  
     [!code-csharp[SP_WebPart#5](../snippets/csharp/VS_Snippets_OfficeSP/sp_webpart/cs/webpart1/webpart1.cs#5)]
     [!code-vb[SP_WebPart#5](../snippets/visualbasic/VS_Snippets_OfficeSP/sp_webpart/vb/webpart1/webpart1.vb#5)]  
  
## Тестирование веб\-части  
 При запуске проекта открывается сайт SharePoint.  Веб\-часть автоматически добавляется в коллекцию веб\-частей в SharePoint.  Веб\-часть можно добавить на любую страницу веб\-части.  
  
#### Тестирование веб\-части  
  
1.  Вставьте следующий XML\-код в файл Блокнота.  Этот XML\-файл содержит образцы данных, которые будут отображаться в веб\-части.  
  
    ```  
  
    <employees xmlns="http://schemas.microsoft.com/vsto/samples">  
       <employee>  
           <name>David Hamilton</name>  
           <hireDate>2001-05-11</hireDate>  
           <title>Sales Associate</title>  
       </employee>  
       <employee>  
           <name>Karina Leal</name>  
           <hireDate>1999-04-01</hireDate>  
           <title>Manager</title>  
       </employee>  
       <employee>  
           <name>Nancy Davolio</name>  
           <hireDate>1992-05-01</hireDate>  
           <title>Sales Associate</title>  
       </employee>  
       <employee>  
           <name>Steven Buchanan</name>  
           <hireDate>1955-03-04</hireDate>  
           <title>Manager</title>  
       </employee>  
       <employee>  
           <name>Suyama Michael</name>  
           <hireDate>1963-07-02</hireDate>  
           <title>Sales Associate</title>  
       </employee>  
    </employees>  
    ```  
  
2.  В строке меню Блокнота выберите **Файл**, **Сохранить как**.  
  
3.  Выберите **Все файлы** в списке **Тип файла** в диалоговом окне **Сохранить как**.  
  
4.  В поле **Имя файла** введите data.xml.  
  
5.  Выберите папку с помощью кнопки **Обзор папок** и нажмите кнопку **Сохранить**.  
  
6.  В Visual Studio нажмите клавишу **F5**.  
  
     Откроется сайт SharePoint.  
  
7.  В меню **Действия сайта** выберите **Дополнительные параметры**.  
  
8.  На странице **Создать** выберите тип **Страница веб\-части**, затем нажмите кнопку **Создать**.  
  
9. На странице **Новая страница веб\-части** назовите страницу **SampleWebPartPage.aspx** и нажмите кнопку **Создать**.  
  
     Отобразится страница веб\-части.  
  
10. Выберите любую зону на странице веб\-части.  
  
11. В верхней части страницы выберите вкладку **Вставка** и выберите пункт **Веб\-часть**.  
  
12. В области **Категории** выберите **пользовательскую** папку, выберите веб\-часть **WebPart1** и нажмите кнопку **Добавить**.  
  
     Веб\-часть отобразится на странице.  
  
## Тестирование пользовательского свойства  
 Для заполнения сетки данных, которая отображается в веб\-части, необходимо задать путь к XML\-файлу с данными о каждом сотруднике.  
  
#### Тестирование пользовательского свойства  
  
1.  Нажмите стрелку, отображающуюся в правой части веб\-части, а затем выберите **Редактирование веб\-части** из появившегося меню.  
  
     В правой части страницы появляется область, содержащая свойства веб\-части.  
  
2.  В этой области разверните узел **Прочие**, введите путь к XML\-файлу, созданному ранее, последовательно нажмите кнопки **Применить** и **ОК**.  
  
     Убедитесь, что список сотрудников отображается в веб\-части.  
  
## Тестирование команды веб\-части  
 Чтобы отобразить или скрыть сотрудников, которые не являются менеджерами, щелкните соответствующий элемент в меню команд веб\-части.  
  
#### Тестирование команды веб\-части  
  
1.  Нажмите стрелку, отображающуюся в правой части веб\-части, а затем выберите **Показывать только менеджеров** из появившегося меню.  
  
     В веб\-части отображаются только сотрудники, являющиеся менеджерами.  
  
2.  Выберите стрелку еще раз, затем выберите **Показывать всех сотрудников** из появившегося меню.  
  
     Сведения обо всех сотрудниках отображаются в веб\-части.  
  
## См. также  
 [Создание веб-частей для SharePoint](../sharepoint/creating-web-parts-for-sharepoint.md)   
 [Практическое руководство. Создание веб-части SharePoint](../sharepoint/how-to-create-a-sharepoint-web-part.md)   
 [Практическое руководство. Создание веб-части SharePoint с помощью конструктора](../sharepoint/how-to-create-a-sharepoint-web-part-by-using-a-designer.md)   
 [Пошаговое руководство. Создание веб-части для SharePoint с помощью конструктора](../sharepoint/walkthrough-creating-a-web-part-for-sharepoint-by-using-a-designer.md)  
  
  