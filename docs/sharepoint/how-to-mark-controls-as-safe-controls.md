---
title: "Практическое руководство. Пометка элементов управления как безопасных"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "безопасные элементы управления [разработка приложений SharePoint в Visual Studio]"
  - "разработка приложений SharePoint в Visual Studio, расширенные средства создания пакетов"
  - "разработка приложений SharePoint в Visual Studio, безопасные элементы управления"
ms.assetid: 813727d5-6750-407c-a23e-c38dd611e78c
caps.latest.revision: 16
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 15
---
# Практическое руководство. Пометка элементов управления как безопасных
  С целью безопасности, SharePoint различает веб\-элементы управления, защищенные и незащищенные от внедрения скриптов.  Недоверенные пользователи могут иметь доступ к защищенным или *безопасным элементам управления*.  Элементы управления можно пометить как безопасные в свойстве "Записи безопасных элементов управления" элемента проекта SharePoint или в **Конструкторе пакета** при добавлении в пакет сборки.  Дополнительные сведения см. в следующем разделе.  
  
 [Изменение параметров файла web.config](http://go.microsoft.com/fwlink/?LinkId=178965) и [Регистрация сборки веб\-части, как безопасного элемента управления](http://go.microsoft.com/fwlink/?LinkId=171013).  
  
> [!IMPORTANT]  
>  Эти процедуры служат для иллюстрации.  Помечайте элементы управления как безопасные только при полной уверенности в их безопасности.  
  
## Маркировка безопасных элементов управления в свойстве "Записи безопасных элементов управления"  
  
#### Маркировка элементов управления как безопасных или небезопасных в свойстве "Записи безопасных элементов управления"  
  
1.  Создайте решение SharePoint с проектом визуальной веб\-части.  
  
2.  Добавьте в веб\-часть два элемента управления: текстовое поле и кнопку.  Оставьте имена, заданные по умолчанию, TextBox1 и Button1 соответственно.  
  
3.  Добавьте две записи в свойство веб\-части **Записи безопасных элементов управления**.  Для этого нажмите кнопку с многоточием \(![Эллипс конструктора ASP.NET для мобильных устройств](~/sharepoint/media/mwellipsis.gif "Эллипс конструктора ASP.NET для мобильных устройств")\) рядом со свойством **Записи безопасных элементов управления** в окне **Свойства**.  
  
     Откроется диалоговое окно **Записи безопасных элементов управления**.  
  
4.  В диалоговом окне **Записи безопасных элементов управления** дважды нажмите кнопку **Добавить**, чтобы на панели **Члены** добавить два безопасных элемента управления; по одному для кнопки и текстового поля.  
  
5.  Выберите первую запись безопасного элемента управления и измените значение его свойства **Безопасно** на **False**, значение свойства **Имя типа** — на **Button1**, а значение свойства **Безопасно в отношении скриптов** — на **False**.  
  
     В этом шаге элемент управления ''Кнопка'' задается как небезопасный элемент управления.  
  
6.  Выберите вторую запись элемента управления в списке.  Оставьте значение свойства **Безопасно** в значении **True** и установите для свойства **Имя типа** значение **TextBox1**, а для свойства **Безопасно в отношении скриптов** — значение **True**.  
  
     Теперь элемент управления "Текстовое поле" отмечен как элемент управления, безопасный в отношении внедрения скриптов.  
  
7.  Выберите кнопку **ОК** чтобы закрыть диалоговое окно.  
  
## Маркировки безопасных элементов управления в "Конструкторе пакетов"  
  
#### Маркировка элементов управления как безопасных или небезопасных в конструкторе пакетов  
  
1.  Создайте решение SharePoint с проектом визуальной веб\-части.  
  
2.  Добавьте в веб\-часть два элемента управления: текстовое поле и кнопку.  Оставьте имена, заданные по умолчанию, TextBox1 и Button1 соответственно.  
  
     Обратите внимание на пространство имен элемента управления, так как оно будет использовано позже.  
  
3.  В строке меню выберите **Построение**, **Построить решение** для сборки проекта.  
  
4.  Создайте еще одно решение SharePoint.  
  
5.  В **обозревателе решений** откройте контекстное меню для файла Package.Package, а затем нажмите кнопку **Открыть**, чтобы открыть **Конструктор пакетов**.  
  
6.  В **Конструкторе пакетов** перейдите на вкладку **Дополнительно**.  
  
7.  В **Дополнительных сборках** нажмите кнопку **Добавить** и выберите из списка **Добавить существующую сборку**.  
  
8.  В диалоговом окне **Добавление существующей сборки** нажмите кнопку с многоточием \(![Эллипс конструктора ASP.NET для мобильных устройств](~/sharepoint/media/mwellipsis.gif "Эллипс конструктора ASP.NET для мобильных устройств")\) рядом с полем **Исходный путь**.  
  
9. Выберите сборку из решения SharePoint, созданном на 1 шаге, а затем нажмите кнопку **Открыть**.  
  
10. Например, для параметра **Цель развертывания** оставьте значение GlobalAssemblyCache.  
  
     В результате этого шага сборка будет развернута в системе "Глобальный кэш сборок".  Выберите этот параметр при необходимости развертывания сборки в папке веб\-приложения \(Bin\).  Дополнительные сведения см. в разделе [Развертывание веб\-частей в SharePoint Foundation](http://go.microsoft.com/fwlink/?LinkId=177509).  
  
11. В поле **Безопасные элементы управления** нажмите кнопку **Добавить новый элемент**.  
  
12. Для свойств введите значения, приведенные в следующей таблице.  
  
    |Имя свойства|Значение|  
    |------------------|--------------|  
    |Пространство имен|Полное имя пространства имен для элемента управления, например, **BdcModelProject1.VisualWebPart1**.|  
    |Имя типа|Button1|  
    |Имя сборки|Строгое имя сборки, например, Microsoft.Office.SharePoint.ClientExtensions, Version\=14.0.0.0, Culture\=neutral, PublicKeyToken\=71e9bce111e9429c.|  
    |Безопасно|Снимите флажок **Безопасно**.|  
    |Безопасно в отношении скриптов|Не устанавливайте флажок **Безопасно в отношении скриптов**.|  
  
    > [!NOTE]  
    >  Значение **Имени сборки** для сборок, добавленных на вкладке **Конструктора пакетовДополнительно**, не может быть токеном, оно должно представлять собой строгое имя сборки.  Дополнительные сведения см. в разделе [Создание и использование сборок со строгими именами](http://go.microsoft.com/fwlink/?LinkId=177513).  
  
13. Нажмите клавишу TAB, чтобы создать еще одну запись безопасного элемента управления.  
  
14. Повторно нажмите кнопку **Добавить новый элемент**.  
  
15. Для свойств введите значения, приведенные в следующей таблице.  
  
    |Имя свойства|Значение|  
    |------------------|--------------|  
    |Пространство имен|Полное имя пространства имен для элемента управления, например, **BdcModelProject1.VisualWebPart1**.|  
    |Имя типа|TextBox1|  
    |Имя сборки|Строгое имя сборки, например, Microsoft.Office.SharePoint.ClientExtensions, Version\=14.0.0.0, Culture\=neutral, PublicKeyToken\=71e9bce111e9429c.|  
    |Безопасно|Установите флажок **Безопасно**.|  
    |Безопасно в отношении скриптов|Установите флажок **Безопасно в отношении скриптов**.|  
  
16. Нажмите клавишу TAB, а затем нажмите кнопку **ОК**, чтобы закрыть диалоговое окно.  
  
## См. также  
 [Предоставление сведений об упаковке и развертывании в элементах проекта](../sharepoint/providing-packaging-and-deployment-information-in-project-items.md)   
 [Упаковка и развертывание решений SharePoint](../sharepoint/packaging-and-deploying-sharepoint-solutions.md)  
  
  