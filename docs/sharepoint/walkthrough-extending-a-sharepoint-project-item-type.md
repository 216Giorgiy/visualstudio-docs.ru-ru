---
title: "Walkthrough: Extending a SharePoint Project Item Type"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "project items [SharePoint development in Visual Studio], extending"
  - "SharePoint project items, extending"
  - "SharePoint development in Visual Studio, extending project items"
ms.assetid: 1cea4e0f-ce33-4cd7-a664-800184865456
caps.latest.revision: 36
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 35
---
# Walkthrough: Extending a SharePoint Project Item Type
  Элемент проекта **Модель подключения к бизнес\-данным** служит для создания модели для службы подключения к бизнес\-данным в SharePoint.  По умолчанию при создании модели с помощью данного элемента проекта данные в модели не отображаются для пользователей.  Необходимо создать в SharePoint внешний список, чтобы пользователи могли видеть данные.  
  
 В данном пошаговом руководстве создается расширение для элемента проекта **Модель подключения к бизнес\-данным**.  Разработчики могут использовать это расширение для создания в проекте внешнего списка, отображающего данные в модели подключения к бизнес\-данным.  В этом пошаговом руководстве показано выполнение следующих задач.  
  
-   Создание расширения Visual Studio для выполнения двух основных задач:  
  
    -   создание внешнего списка, отображающего данные в модели подключения к бизнес\-данным.  В расширении для создания определяющего список файла Elements.xml используется объектная модель системы проектов SharePoint.  Кроме того, при этом файл добавляется в проект, чтобы его можно было развертывать вместе с моделью подключения к бизнес\-данным.  
  
    -   Пункт контекстного меню добавляется в проектные элементы **Модель подключения к бизнес\-данным** в **обозревателе решений**.  С помощью пункта меню разработчики могут создать внешний список для модели подключения к бизнес\-данным.  
  
-   Построение пакета расширения Visual Studio \(VSIX\) для развертывания сборки расширения.  
  
-   Тестирование расширения.  
  
## Обязательные компоненты  
 Для выполнения данного пошагового руководства на компьютере разработчика должны быть установлены следующие компоненты:  
  
-   поддерживаемые выпуски Microsoft Windows, SharePoint и Visual Studio.  Для получения дополнительной информации см. [Требования по разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vssdk_current_long](../sharepoint/includes/vssdk-current-long-md.md)].  В этом пошаговом руководстве шаблон **Проект VSIX** из пакета SDK используется для создания пакета VSIX, который служит для развертывания элемента проекта.  Для получения дополнительной информации см. [Extending the SharePoint Tools in Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md).  
  
 Знание следующих подходов может оказаться полезным, но не требуется для выполнения пошагового руководства.  
  
-   служба подключения к бизнес\-данным в [!INCLUDE[moss_14_long](../sharepoint/includes/moss-14-long-md.md)].  Дополнительные сведения см. в [Архитектура BDC](http://go.microsoft.com/fwlink/?LinkId=177798).  
  
-   схема XML для моделей подключения к бизнес\- данным.  [Инфраструктура модели подключения к бизнес\-данным](http://go.microsoft.com/fwlink/?LinkId=177799) Дополнительные сведения в разделе в.  
  
## Создание проектов  
 Чтобы выполнить это пошаговое руководство, необходимо создать два проекта:  
  
-   проект VSIX, который позволит создать пакет VSIX для развертывания расширения проектного элемента;  
  
-   проект библиотеки классов, реализующей расширение проектного элемента.  
  
 Начните выполнение пошагового руководства с создания проектов.  
  
#### Создание проекта VSIX  
  
1.  Запустите [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
2.  В меню **Файл** выберите **Создать**, **Проект**.  
  
3.  В диалоговом окне **Создание проекта** разверните узел **Visual C\#** или  **Visual Basic**, а затем выберите узел **Расширение среды**.  
  
    > [!NOTE]  
    >  Узел **Расширение среды** доступен только в том случае, если необходимо установить пакет SDK для Visual Studio.  Дополнительные сведения см. в параграфе предварительных требований ранее в этом разделе.  
  
4.  В списке **Создание проекта** в верхней части диалогового окна, выберите команду **.NET Framework 4.5**.  
  
     Для работы с расширениями средств SharePoint требуются компоненты этой версии .NET Framework.  
  
5.  Выберите шаблон **Проект VSIX**.  
  
6.  В поле **Имя** введите **GenerateExternalDataLists**, а затем нажмите кнопку **ОК**.  
  
     Среда [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] добавит проект **GenerateExternalDataLists** в **Обозреватель решений**.  
  
7.  Если файл source.extension.vsixmanifest автоматически не открыт, откройте его контекстное меню в проекте GenerateExternalDataLists, а затем выберите **Открыть**  
  
8.  Убедитесь, что файл source.extension.vsixmanifest имеет непустую запись \(введите Contoso\) для поля из авторов, сохраните файл, а затем ее конечная точка.  
  
#### Создание проекта расширения  
  
1.  В **Обозреватель решений** откройте контекстное меню для узла решения **GenerateExternalDataLists**, выберите **Добавить**, затем выберите **Создание проекта**.  
  
    > [!NOTE]  
    >  В проектах Visual Basic узел решения отображается в **обозревателе решений**, только если в диалоговом окне ["Общие", страница "Проекты и решения", диалоговое окно "Параметры"](http://msdn.microsoft.com/ru-ru/8f8e37e8-b28d-4b13-bfeb-ea4d3312aeca) установлен флажок **Всегда показывать решение**.  
  
2.  В диалоговом окне **Добавить новый проект** разверните узел **Visual C\#** или  **Visual Basic**, а затем выберите узел **Окна**.  
  
3.  В списке в верхней части диалогового окна, выберите команду **.NET Framework 4.5**.  
  
4.  В списке шаблонов проектов выберите **Библиотека классов**.  
  
5.  В поле **Имя** введите **BdcProjectItemExtension**, а затем нажмите кнопку **ОК**.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] добавит проект **BdcProjectItemExtension** в решение и откроет заданный по умолчанию файл с кодом Class1.  
  
6.  Удалите из проекта файл c кодом Class1.  
  
## Настройка проекта расширения  
 Перед созданием кода для расширения элемента проекта добавьте в проект расширения ссылки на файлы с кодом и сборки.  
  
#### Настройка проекта  
  
1.  В проект BdcProjectItemExtension добавьте два файла с кодом со следующими именами.  
  
    -   ProjectItemExtension  
  
    -   GenerateExternalDataLists  
  
2.  Выберите проект BdcProjectItemExtension, а затем в строке меню выберите **Проект**, **Добавить ссылку**.  
  
3.  Разверните узел **Сборки** и выберите узел **основа** и выберите флажок для каждой из следующих сборок:  
  
    -   System.ComponentModel.Composition  
  
    -   WindowsBase  
  
4.  Разверните узел **Сборки** и выберите узел **Расширения**, а затем выделите флажок для следующей сборки:  
  
    -   Microsoft.VisualStudio.SharePoint  
  
5.  Нажмите кнопку **ОК**.  
  
## Определение расширения элемента проекта  
 Создайте класс, определяющий расширение для элемента проекта **Модель подключения к бизнес\-данным**.  Для определения расширения класс реализует интерфейс <xref:Microsoft.VisualStudio.SharePoint.ISharePointProjectItemTypeExtension>.  Этот интерфейс следует реализовывать всякий раз, когда требуется расширить имеющийся тип элемента проекта.  
  
#### Определение расширения элемента проекта  
  
1.  Вставьте следующий код в файл с кодом ProjectItemExtension.  
  
    > [!NOTE]  
    >  После добавления этого кода, проект будет иметь некоторые компилировать ошибки.  Эти ошибки исчезнут при добавлении кода на следующих шагах.  
  
     [!code-csharp[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#1](../snippets/csharp/VS_Snippets_OfficeSP/spextensibility.projectitemextension.bdcgenerateexternaldatalists/cs/bdcprojectitemextension/projectitemextension.cs#1)]
     [!code-vb[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#1](../snippets/visualbasic/VS_Snippets_OfficeSP/spextensibility.projectitemextension.bdcgenerateexternaldatalists/vb/bdcprojectitemextension/projectitemextension.vb#1)]  
  
## Создание внешних списков данных  
 Добавьте частичное определение класса `GenerateExternalDataListsExtension`, который создает внешний список данных для каждой сущности в модели подключения к бизнес\-данным.  Для создания внешнего списка данных этот код сначала считывает относящиеся к сущности данные в модели подключения к бизнес\-данным путем анализа XML\-кода в файле модели.  Затем он создает экземпляр списка на основе данной модели подключения к бизнес\-данным и добавляет экземпляр списка в проект.  
  
#### Создание внешних списков данных  
  
1.  Вставьте следующий код в файл с кодом GenerateExternalDataLists.  
  
     [!code-csharp[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#2](../snippets/csharp/VS_Snippets_OfficeSP/spextensibility.projectitemextension.bdcgenerateexternaldatalists/cs/bdcprojectitemextension/generateexternaldatalists.cs#2)]
     [!code-vb[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#2](../snippets/visualbasic/VS_Snippets_OfficeSP/spextensibility.projectitemextension.bdcgenerateexternaldatalists/vb/bdcprojectitemextension/generateexternaldatalists.vb#2)]  
  
## Контрольная точка  
 Теперь проект содержит весь код, необходимый для реализации расширения элемента проекта, которое рассматривается в данном пошаговом руководстве.  Выполите построение решения, чтобы убедиться, что компиляция проекта выполняется без ошибок.  
  
#### Построение решения  
  
1.  В меню **Сборка** выберите **Собрать решение**.  
  
## Создание пакета VSIX для развертывания расширения элемента проекта  
 Для развертывания расширения воспользуйтесь проектом VSIX в своем решении для создания пакета VSIX.  Сначала настройте пакет VSIX, изменив содержимое файла source.extension.vsixmanifest, входящего в состав проекта VSIX.  Затем создайте пакет VSIX, выполнив построение решения.  
  
#### Настройка и создание пакета VSIX  
  
1.  В **Обозреватель решений** откройте контекстное меню для файла source.extension.vsixmanifest в проекте GenerateExternalDataLists, а затем выберите **Открыть**.  
  
     Файл будет открыт Visual Studio в редакторе манифестов.  Файл source.extension.vsixmanifest является основой файла extension.vsixmanifest, который является обязательным для всех пакетов VSIX.  Дополнительные сведения об этом файле см. в разделе [Справочник по схеме расширения VSIX](http://msdn.microsoft.com/ru-ru/76e410ec-b1fb-4652-ac98-4a4c52e09a2b).  
  
2.  В поле **Название продукта** введите **Генератор списка внешние данные**.  
  
3.  В поле **Автор** введите **Contoso**.  
  
4.  В поле **Описание** введите **Расширения элемента проекта Модели подключения к бизнес\-данным, которые можно использовать для создания списки внешних данных**.  
  
5.  На вкладке **Активы** редактора, нажмите кнопку **Создать**.  
  
     Откроется диалоговое окно **Добавить новый актив**.  
  
6.  В списке **Тип** выберите **Microsoft.VisualStudio.MefComponent**.  
  
    > [!NOTE]  
    >  Это значение соответствует элементу `MefComponent`, описанному в файле extension.vsixmanifest.  Этот элемент задает имя сборки расширения в пакете VSIX.  Для получения дополнительной информации см. [NIB: MEFComponent Element \(VSX Schema\)](http://msdn.microsoft.com/ru-ru/8a813141-8b73-44c9-b80b-ca85bbac9551).  
  
7.  В списке **Источник** выберите **Проект в текущем решении**.  
  
8.  В списке **Проект** выберите **BdcProjectItemExtension**, а затем нажмите кнопку **ОК**.  
  
9. В меню **Сборка** выберите **Собрать решение**.  
  
10. Убедитесь, что проект будет компилироваться и построения без ошибок.  
  
11. Убедитесь, что в выходную папку построения для проекта GenerateExternalDataLists теперь она содержит файл GenerateExternalDataLists.vsix.  
  
     По умолчанию выходной папкой построения является папка. \\bin\\Debug папку в папке, содержащей файл проекта.  
  
## Тестирование расширения элемента проекта  
 Расширение элемента проекта готово к тестированию.  Начните отладку проекта расширения в экспериментальном экземпляре Visual Studio.  Затем с помощью расширения в экспериментальном экземпляре Visual Studio создайте внешний список для модели BDC.  После этого откройте внешний список на сайте SharePoint, чтобы проверить, что он работает ожидаемым образом.  
  
#### Запуск отладки расширения  
  
1.  При необходимости перезапустите Visual Studio с правами администратора, а затем открывает решение GenerateExternalDataLists.  
  
2.  В проект BdcProjectItemExtension, откройте файл с кодом ProjectItemExtension, а затем добавьте точку останова в строке кода в методе `Initialize`.  
  
3.  Откройте файл с кодом GenerateExternalDataLists, а затем добавьте точку останова в первой строке кода в методе `GenerateExternalDataLists_Execute`.  
  
4.  Запустите отладку путем выбора ключа F5 или, в строке меню, выбирая **Отладка**, **Начать отладку**.  
  
     Visual Studio установит расширение в папку %UserProfile%\\AppData\\Local\\Microsoft\\VisualStudio\\10.0Exp\\Extensions\\Contoso\\External Data List Generator\\1.0 и запустит экспериментальный экземпляр Visual Studio.  После этого можно тестировать элемент проекта в открытом экземпляре Visual Studio.  
  
#### Тестирование расширения  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **Файл**, **Создать**, **Проект**.  
  
2.  В диалоговом окне **Создание проекта** разверните узел **Шаблоны**, разверните узел **Visual C\#**, разверните узел **SharePoint** и выберите пункт **2010**.  
  
3.  В списке в верхней части диалогового окна, убедитесь, что выбрано **.NET Framework 3.5**.  Для проектов [!INCLUDE[moss_14_long](../sharepoint/includes/moss-14-long-md.md)] требуется эта версия .NET Framework.  
  
4.  В списке шаблонов проектов выберите **Проект SharePoint 2010**.  
  
5.  В поле **Имя** введите **SharePointProjectTestBDC**, а затем нажмите кнопку **ОК**.  
  
6.  В мастере настройки SharePoint введите URL\-адрес сайта, который требуется использовать для отладки, выберите **Развернуть как решение фермы**, затем нажмите кнопку **Готово**.  
  
7.  Открыть контекстное меню для проекта SharePointProjectTestBDC, выберите **Добавить**, затем выберите **Создать элемент**.  
  
8.  В диалоговом окне **Добавьте NewItem — SharePointProjectTestBDC** разверните узел заданного языка, разверните узел **SharePoint**.  
  
9. Выберите узел **2010**, а затем выберите шаблон **Модель подключения к бизнес\-данным \(только для решения фермы\)**.  
  
10. В поле **Имя** введите **TestBDCModel**, а затем нажмите кнопку **Добавить**.  
  
11. Убедитесь, что выполнение кода в другом экземпляре Visual Studio прерывается на точке останова, заданной в методе `Initialize` файла с кодом ProjectItemExtension.  
  
12. В остановленном экземпляре Visual Studio выберите ключ **F5** или щелкните в строке меню выберите **Отладка**, **Продолжить**, чтобы продолжить отладку проекта.  
  
13. В экспериментальном экземпляре Visual Studio выберите ключ **F5** либо в строке меню выберите **Отладка**, **Начать отладку**, чтобы выполнить построение, развертывание и запустите проект **TestBDCModel**.  
  
     В веб\-браузере будет открыта страница по умолчанию сайта SharePoint, который определен для отладки.  
  
14. Убедитесь, что в разделе **Списки** в области панели быстрого запуска еще не содержит список, основанного на модели подключения к бизнес\-данным по умолчанию в проекте.  Необходимо сначала создать внешний список данных, воспользовавшись для этого пользовательским интерфейсом SharePoint или расширением элемента проекта.  
  
15. Закройте веб\-браузера.  
  
16. В экземпляре Visual Studio с проект TestBDCModel, откройте контекстное меню узла **TestBDCModel** в **Обозреватель решений** и выберите пункт **Создайте список внешние данные**.  
  
17. Убедитесь, что выполнение кода в другом экземпляре Visual Studio прерывается на точке останова, заданной в методе `GenerateExternalDataLists_Execute`.  Выберите ключ **F5** либо в строке меню выберите **Отладка**, **Продолжить**, чтобы продолжить отладку проекта.  
  
18. Экспериментальный экземпляр Visual Studio добавляет с именем **Entity1DataList** экземпляра списка в проект TestBDCModel, а также создает экземпляр с именем **Feature2** функции экземпляра списка.  
  
19. Выберите ключ **F5** либо в строке меню выберите **Отладка**, **Начать отладку**, чтобы выполнить построение, развертывание и запуск проекта TestBDCModel.  
  
     В веб\-браузере будет открыта страница по умолчанию сайта SharePoint, который используется для отладки.  
  
20. В разделе **Списки** области панели быстрого запуска, выберите в списке **Entity1DataList**.  
  
21. Проверьте, что список содержит столбцы с именами Identifier1 и сообщением, в дополнение к одному элементу идентификатор, который имеет значение 0 и сообщение " Hello World ".  
  
     Шаблон **Модель подключения к бизнес\-данным** создает модель подключения к бизнес\-данным по умолчанию, предоставляет всех этих данных.  
  
22. Закройте веб\-браузера.  
  
## Очистка компьютера разработчика  
 После тестирования расширения элемента проекта удалите с сайта SharePoint внешний список и модель подключения к бизнес\-данным, а также удалите из Visual Studio расширение элемента проекта.  
  
#### Удаление внешнего списка данных с сайта SharePoint  
  
1.  В области панели быстрого запуска сайта SharePoint, выберите в списке **Entity1DataList**.  
  
2.  На ленте сайта SharePoint перейдите на вкладку **Список**.  
  
3.  На вкладке **Список** в группе **Параметры** выберите **Параметры списка**.  
  
4.  В разделе **Разрешения и управление** выберите **Удаление этого списка**, а затем нажмите кнопку **ОК**, чтобы подтвердить, что требуется отправить список в корзину.  
  
5.  Закройте веб\-браузера.  
  
#### Удаление модели подключения к бизнес\-данным с сайта SharePoint  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **Построение**, **Отозвать**.  
  
     Visual Studio удаляет модель BDC c сайта SharePoint.  
  
#### Удаление расширения элемента проекта из Visual Studio  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **Сервис**, **Расширения и обновления**.  
  
     Появится диалоговое окно **Расширения и обновления**.  
  
2.  В списке расширений выберите **Генератор списка внешние данные**, а затем нажмите кнопку **Удалить**.  
  
3.  В диалоговом окне, появившемся на экране, нажмите кнопку **Да**, чтобы подтвердить удаление расширения.  
  
4.  Выберите **Перезагрузить сейчас** для завершения процесса удаления.  
  
5.  Закройте оба экземпляра Visual Studio \(экспериментальный экземпляр и экземпляр, в котором GenerateExternalDataLists открыто решение\).  
  
## См. также  
 [Extending the SharePoint Project System](../sharepoint/extending-the-sharepoint-project-system.md)   
 [Создание модели подключения к бизнес-данным](../sharepoint/creating-a-business-data-connectivity-model.md)   
 [Проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md)  
  
  