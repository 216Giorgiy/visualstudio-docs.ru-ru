---
title: 'Пошаговое руководство: Расширение типа элемента проекта SharePoint | Документы Microsoft'
ms.custom: ''
ms.date: 02/02/2017
ms.technology:
- office-development
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- project items [SharePoint development in Visual Studio], extending
- SharePoint project items, extending
- SharePoint development in Visual Studio, extending project items
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: ed2c425af4127af443254bfdc269d58c653bb3c9
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="walkthrough-extending-a-sharepoint-project-item-type"></a>Пошаговое руководство. Расширение типа проектного элемента SharePoint
  Можно использовать **модель подключения к бизнес-данным** элемент проекта для создания модели для службы бизнес-данным (BDC) в SharePoint. По умолчанию при создании модели с помощью этого элемента проекта данные в модели не отображается для пользователей. Необходимо также создать внешнего списка в SharePoint, чтобы пользователи могли просматривать данные.  
  
 В этом пошаговом руководстве вы создадите расширение для **модель подключения к бизнес-данным** элемент проекта. Создание внешнего списка в свой проект, отображающего данные в модели BDC, разработчики могут использовать расширения. В этом пошаговом руководстве описаны следующие задачи.  
  
-   Создание расширения Visual Studio, который выполняет две основные задачи:  
  
    -   Он создает внешний список, отображающий данные в модель BDC. Расширение использует объектную модель для системы проектов SharePoint для создания файла Elements.xml, определяющее список. Он также добавляет файл в проект, чтобы он разворачивается вместе с модель BDC.  
  
    -   Он добавляет пункта контекстного меню к **модель подключения к бизнес-данным** элементами проекта в **обозревателе решений**. Разработчики можно щелкнуть этот элемент меню, чтобы создать внешний список для модели BDC.  
  
-   Построение пакета расширения Visual Studio (VSIX) для развертывания сборки расширения.  
  
-   Тестирование расширения.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Необходимы следующие компоненты на компьютере разработчика для выполнения данного пошагового руководства.  
  
-   Поддерживаемые версии Microsoft Windows, SharePoint и Visual Studio. Дополнительные сведения см. в разделе [требования к разработке решений SharePoint](../sharepoint/requirements-for-developing-sharepoint-solutions.md).  
  
-   [!INCLUDE[vssdk_current_long](../sharepoint/includes/vssdk-current-long-md.md)]. В этом пошаговом руководстве используется **проект VSIX** шаблона в пакете SDK для создания пакета VSIX для развертывания элемента проекта. Дополнительные сведения см. в разделе [расширение инструментов SharePoint в Visual Studio](../sharepoint/extending-the-sharepoint-tools-in-visual-studio.md).  
  
 Изучением приведенных ниже концепций будет полезно, хотя и не требуется для выполнения данного пошагового руководства.  
  
-   Служба BDC в [!INCLUDE[moss_14_long](../sharepoint/includes/moss-14-long-md.md)]. Дополнительные сведения см. в разделе [архитектура BDC](http://go.microsoft.com/fwlink/?LinkId=177798).  
  
-   Схема XML для моделей BDC. Дополнительные сведения см. в разделе [инфраструктуры модели BDC](http://go.microsoft.com/fwlink/?LinkId=177799).  
  
## <a name="creating-the-projects"></a>Создание проектов  
 Для выполнения данного пошагового руководства, необходимо создать два проекта:  
  
-   Проект VSIX для создания пакета VSIX для развертывания расширения элемента проекта.  
  
-   Проект библиотеки классов, который реализует расширения элемента проекта.  
  
 Пошаговое руководство начинается с создания проектов.  
  
#### <a name="to-create-the-vsix-project"></a>Создание проекта VSIX  
  
1.  Запустите [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  
  
2.  В строке меню выберите **Файл**, **Создать**, **Проект**.  
  
3.  В **новый проект** диалогового окна разверните **Visual C#** или **Visual Basic** узлов и нажмите кнопку **расширяемости** узла.  
  
    > [!NOTE]  
    >  **Расширяемости** узел доступен, только если установлен пакет SDK для Visual Studio. Дополнительные сведения см. в разделе предварительных требований этого раздела.  
  
4.  В списке в верхней части **новый проект** диалогового окна выберите **.NET Framework 4.5**.  
  
     Расширения инструментов SharePoint требуют возможности в этой версии платформы .NET Framework.  
  
5.  Выберите **проект VSIX** шаблона.  
  
6.  В **имя** введите **GenerateExternalDataLists**, а затем выберите **ОК** кнопки.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет **GenerateExternalDataLists** проекта **обозревателе решений**.  
  
7.  Если файл source.extension.vsixmanifest не открывается автоматически, откройте ее контекстное меню проекта GenerateExternalDataLists и выберите **открыть**  
  
8.  Убедитесь, что файл source.extension.vsixmanifest имеет запись непустой (введите Contoso) в поле Author сохраните файл и закройте его.  
  
#### <a name="to-create-the-extension-project"></a>Создание проекта расширения  
  
1.  В **обозревателе решений**, откройте контекстное меню для **GenerateExternalDataLists** узел решения, выберите **добавить**и нажмите кнопку **новый проект**.  
  
2.  В **Добавление нового проекта** диалогового окна разверните **Visual C#** или **Visual Basic** узлов и нажмите кнопку **Windows** узла.  
  
3.  В списке вверху диалогового окна выберите **.NET Framework 4.5**.  
  
4.  В списке шаблонов проектов выберите **библиотеки классов**.  
  
5.  В **имя** введите **BdcProjectItemExtension**, а затем выберите **ОК** кнопки.  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Добавляет **BdcProjectItemExtension** в решение проект и открывает файл кода по умолчанию Class1.  
  
6.  Удалите файл Class1 код из проекта.  
  
## <a name="configuring-the-extension-project"></a>Настройка проекта расширения  
 Перед написанием кода для создания расширения элемента проекта добавьте файлы кода и ссылок на сборки в проект расширения.  
  
#### <a name="to-configure-the-project"></a>Настройка проекта  
  
1.  В проекте BdcProjectItemExtension добавьте двух файлах кода, которые имеют следующие имена:  
  
    -   ProjectItemExtension  
  
    -   GenerateExternalDataLists  
  
2.  Выберите проект BdcProjectItemExtension, а затем в строке меню выберите **проекта**, **добавить ссылку**.  
  
3.  В разделе **сборки** узел, выберите **Framework** , а затем установите флажок для каждого из следующих сборок:  
  
    -   System.ComponentModel.Composition  
  
    -   WindowsBase  
  
4.  В разделе **сборки** узел, выберите **расширения** узел, а затем установите флажок для следующей сборки:  
  
    -   Microsoft.VisualStudio.SharePoint  
  
5.  Нажмите кнопку **ОК** .  
  
## <a name="defining-the-project-item-extension"></a>Определение расширения элемента проекта  
 Создайте класс, определяющий расширение для **модель подключения к бизнес-данным** элемент проекта. Чтобы определить расширение, этот класс реализует <xref:Microsoft.VisualStudio.SharePoint.ISharePointProjectItemTypeExtension> интерфейса. Реализуйте этот интерфейс, каждый раз, когда требуется расширить существующий тип элемента проекта.  
  
#### <a name="to-define-the-project-item-extension"></a>Чтобы определить расширение элемента проекта  
  
1.  Вставьте следующий код в файл кода ProjectItemExtension.  
  
    > [!NOTE]  
    >  После добавления этого кода в проект будет содержать некоторые ошибки компиляции. Эти ошибки исчезнут при добавлении кода в последующих шагах.  
  
     [!code-csharp[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#1](../sharepoint/codesnippet/CSharp/generateexternaldatalists/bdcprojectitemextension/projectitemextension.cs#1)]
     [!code-vb[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#1](../sharepoint/codesnippet/VisualBasic/generateexternaldatalists/bdcprojectitemextension/projectitemextension.vb#1)]  
  
## <a name="creating-the-external-data-lists"></a>Создание списков внешних данных  
 Добавьте частичное определение класса `GenerateExternalDataListsExtension` класс, который создает внешний список данных для каждой сущности в модели BDC. Чтобы создать список внешних данных, этот код сначала считывает данные сущности в модели BDC путем синтаксического анализа XML-данных в файле модели. Затем он создает экземпляр списка, который основан на модели BDC и добавляет этот экземпляр списка в проект.  
  
#### <a name="to-create-the-external-data-lists"></a>Для создания списков внешних данных  
  
1.  Вставьте следующий код в файл кода GenerateExternalDataLists.  
  
     [!code-vb[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#2](../sharepoint/codesnippet/VisualBasic/generateexternaldatalists/bdcprojectitemextension/generateexternaldatalists.vb#2)]
     [!code-csharp[SPExtensibility.ProjectItemExtension.BDCGenerateExternalDataLists#2](../sharepoint/codesnippet/CSharp/generateexternaldatalists/bdcprojectitemextension/generateexternaldatalists.cs#2)]  
  
## <a name="checkpoint"></a>Контрольная точка  
 На этом этапе в пошаговом руководстве, весь код для расширения элемента проекта находится в проекте. Постройте решение, чтобы убедиться в том, что проект компилируется без ошибок.  
  
#### <a name="to-build-the-solution"></a>Построение решения  
  
1.  В строке меню последовательно выберите **Сборка**и **Собрать решение**.  
  
## <a name="creating-a-vsix-package-to-deploy-the-project-item-extension"></a>Создание пакета VSIX для развертывания расширения элемента проекта  
 Для развертывания расширения, используйте проект VSIX в решении для создания пакета VSIX. Во-первых настройте пакет VSIX, изменив файл source.extension.vsixmanifest, включенный в проект VSIX. Затем создайте пакет VSIX с построением решения.  
  
#### <a name="to-configure-and-create-the-vsix-package"></a>Для настройки и создания пакета VSIX  
  
1.  В **обозревателе решений**, откройте контекстное меню Файл source.extension.vsixmanifest в проекте GenerateExternalDataLists и затем выберите **откройте**.  
  
     Visual Studio открывает файл в редакторе манифестов. Файл source.extension.vsixmanifest является основой для файл extension.vsixmanifest требуется для всех пакетов VSIX. Дополнительные сведения об этом файле см. в разделе [ссылки 1.0 схемы расширения VSIX](http://msdn.microsoft.com/en-us/76e410ec-b1fb-4652-ac98-4a4c52e09a2b).  
  
2.  В **название продукта** введите **генератор внешнего списка данных**.  
  
3.  В **автор** введите **Contoso**.  
  
4.  В **описание** введите **расширение для элементов проекта модели подключения к бизнес-данным, которые могут использоваться для создания списков внешних данных**.  
  
5.  На **активы** вкладка редактора выберите **New** кнопки.  
  
     **Добавить новый актив** откроется диалоговое окно.  
  
6.  В **тип** выберите **Microsoft.VisualStudio.MefComponent**.  
  
    > [!NOTE]  
    >  Это значение соответствует `MefComponent` элемент в файл extension.vsixmanifest. Этот элемент задает имя сборки расширения в пакете VSIX. Дополнительные сведения см. в разделе [MEFComponent элемент (Схема VSX)](http://msdn.microsoft.com/en-us/8a813141-8b73-44c9-b80b-ca85bbac9551).  
  
7.  В **источника** выберите **проект в текущем решении**.  
  
8.  В **проекта** выберите **BdcProjectItemExtension**, а затем выберите **ОК** кнопки.  
  
9. В строке меню последовательно выберите **Сборка**и **Собрать решение**.  
  
10. Убедитесь, что проект компилируется и сборка выполняется без ошибок.  
  
11. Убедитесь, что в выходную папку построения для проекта GenerateExternalDataLists теперь содержит файл GenerateExternalDataLists.vsix.  
  
     По умолчанию является выходной папке сборки... папку \bin\debug в папке, содержащей файл проекта.  
  
## <a name="testing-the-project-item-extension"></a>Тестирование расширения элемента проекта  
 Теперь все готово для тестирования расширения элемента проекта. Начните отладку проекта расширения в экспериментальном экземпляре Visual Studio. Затем с помощью расширения в экспериментальном экземпляре Visual Studio создайте внешний список для модели BDC. Наконец откройте внешний список на сайте SharePoint, чтобы проверить ее работоспособность.  
  
#### <a name="to-start-debugging-the-extension"></a>Чтобы начать отладку расширения  
  
1.  При необходимости перезапустите Visual Studio с правами администратора и откройте решение GenerateExternalDataLists.  
  
2.  В проекте BdcProjectItemExtension, откройте файл кода ProjectItemExtension и затем добавьте точку останова в строку кода в `Initialize` метод.  
  
3.  Откройте файл кода GenerateExternalDataLists и затем добавьте точку останова в первой строке кода в `GenerateExternalDataLists_Execute` метод.  
  
4.  Запуск отладки, нажав клавишу F5 или выберите в строке меню, выбрав **отладки**, **начать отладку**.  
  
     Visual Studio устанавливает расширение для %UserProfile%\AppData\Local\Microsoft\VisualStudio\10.0Exp\Extensions\Contoso\External Generator\1.0 список данных и запуске экспериментального экземпляра Visual Studio. В этом экземпляре Visual Studio будет тестировать элемент проекта.  
  
#### <a name="to-test-the-extension"></a>Чтобы проверить расширение  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **файл**, **New**, **проекта**.  
  
2.  В **новый проект** диалогового окна разверните **шаблоны** узла, разверните **Visual C#** узла, разверните **SharePoint** узел, а затем Выберите **2010**.  
  
3.  Убедитесь, что в списке в верхней части диалогового **.NET Framework 3.5** выбран. Проекты [!INCLUDE[moss_14_long](../sharepoint/includes/moss-14-long-md.md)] требуется эта версия платформы .NET Framework.  
  
4.  В списке шаблонов проектов выберите **проект SharePoint 2010**.  
  
5.  В **имя** введите **SharePointProjectTestBDC**, а затем выберите **ОК** кнопки.  
  
6.  В мастере настройки SharePoint, введите URL-адрес сайта, который требуется использовать для отладки, нажмите **развернуть как решение фермы**, а затем выберите **Готово**кнопки.  
  
7.  Откройте контекстное меню для проекта SharePointProjectTestBDC, **добавить**, а затем выберите **новый элемент**.  
  
8.  В **добавьте NewItem - SharePointProjectTestBDC** диалогового окна разверните узел установленного языка, разверните **SharePoint** узла.  
  
9. Выберите **2010** узел, а затем выберите **модели подключения к бизнес-данным (только для решения фермы)** шаблона.  
  
10. В **имя** введите **TestBDCModel**, а затем выберите **добавить** кнопки.  
  
11. Убедитесь, что код в другом экземпляре Visual Studio прервано на точке останова, заданные в `Initialize` метод ProjectItemExtension файла кода.  
  
12. В экземпляре Visual Studio, остановлена, выберите **F5** ключа или в строке меню выберите **отладки**, **Продолжить** чтобы продолжить отладку проекта.  
  
13. В экспериментальном экземпляре Visual Studio, выберите **F5** ключа, либо в строке меню выберите **отладки**, **начать отладку** для построения, развертывания и выполнения  **TestBDCModel** проекта.  
  
     Веб-браузере откроется страница по умолчанию сайта SharePoint, которая указана для отладки.  
  
14. Убедитесь, что **перечислены** раздел на панели быстрого запуска еще нет списка, который основан на модели BDC по умолчанию в проекте. Список внешних данных, сначала необходимо создать с помощью пользовательского интерфейса SharePoint или с помощью расширения элемента проекта.  
  
15. Закройте веб-браузер.  
  
16. В экземпляре Visual Studio, который был открыт проект TestBDCModel, откройте контекстное меню для **TestBDCModel** узел в **обозревателе решений**и нажмите кнопку **создания внешних данных Список**.  
  
17. Убедитесь, что код в другом экземпляре Visual Studio прервано на точке останова, заданные в `GenerateExternalDataLists_Execute` метод. Выберите **F5** ключа, либо в строке меню выберите **отладки**, **Продолжить** чтобы продолжить отладку проекта.  
  
18. Экспериментальный экземпляр Visual Studio добавляет экземпляр списка, который называется **Entity1DataList** для TestBDCModel проекта, а экземпляр создает функцию, которая называется **Feature2** для списка экземпляр.  
  
19. Выберите **F5** ключа, либо в строке меню выберите **отладки**, **начать отладку** для построения, развертывания и запуска проекта TestBDCModel.  
  
     Веб-браузере откроется страница по умолчанию сайта SharePoint, который используется для отладки.  
  
20. В **перечислены** раздел панели быстрого запуска выберите **Entity1DataList** списка.  
  
21. Убедитесь, что список содержит столбцы с именами идентификатор1 и сообщения, помимо один элемент, имеющий значение идентификатор1 0 и значение сообщение Hello World.  
  
     **Модель подключения к бизнес-данным** шаблон проекта создает модели BDC по умолчанию, который предоставляет все эти данные.  
  
22. Закройте веб-браузер.  
  
## <a name="cleaning-up-the-development-computer"></a>Очистка компьютера разработчика  
 После завершения тестирования расширения элемента проекта, удалите внешний список и модель BDC с сайта SharePoint и расширения элемента проекта из Visual Studio.  
  
#### <a name="to-remove-the-external-data-list-from-the-sharepoint-site"></a>Чтобы удалить список внешних данных с сайта SharePoint  
  
1.  В области быстрого запуска сайта SharePoint выберите **Entity1DataList** списка.  
  
2.  На ленте на сайте SharePoint, выберите **списка** вкладки.  
  
3.  На **списка** вкладке **параметры** выберите **параметры списка**.  
  
4.  В разделе **разрешения и управление**, выберите **удалить этот список**и нажмите кнопку **ОК** для подтверждения того, что вы хотите отправить список в корзину.  
  
5.  Закройте веб-браузер.  
  
#### <a name="to-remove-the-bdc-model-from-the-sharepoint-site"></a>Чтобы удалить модель BDC с сайта SharePoint  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **построения**, **Retract**.  
  
     Visual Studio удаляет модель BDC с сайта SharePoint.  
  
#### <a name="to-remove-the-project-item-extension-from-visual-studio"></a>Чтобы удалить расширение элемента проекта из Visual Studio  
  
1.  В экспериментальном экземпляре Visual Studio в строке меню выберите **средства**, **расширения и обновления**.  
  
     Появится диалоговое окно **Расширения и обновления**.  
  
2.  В список расширений, выберите **генератор внешнего списка данных**, а затем выберите **удаления** кнопки.  
  
3.  В появившемся диалоговом окне, выберите **Да** для подтверждения того, что вы хотите удалить расширение.  
  
4.  Выберите **Перезагрузить сейчас** для завершения удаления.  
  
5.  Закройте оба экземпляра Visual Studio (экспериментальный экземпляр и экземпляр, в котором открыт GenerateExternalDataLists решения).  
  
## <a name="see-also"></a>См. также  
 [Расширение системы проектов SharePoint](../sharepoint/extending-the-sharepoint-project-system.md)   
 [Создание модели подключения к бизнес-данным](../sharepoint/creating-a-business-data-connectivity-model.md)   
 [Проектирование модели подключения к бизнес-данным](../sharepoint/designing-a-business-data-connectivity-model.md)  
  
  