---
title: "Проектирование модели подключения к бизнес-данным"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "подключение к бизнес-данным [разработка приложений SharePoint в Visual Studio], проектирование модели"
  - "служба подключения к бизнес-данным [разработка приложений SharePoint в Visual Studio], проектирование модели"
ms.assetid: 19cad8cf-8a82-4000-84cf-1e5aff54e5af
caps.latest.revision: 41
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 40
---
# Проектирование модели подключения к бизнес-данным
  Модель для службы подключения к бизнес\-данным \(BDC\) можно разработать посредством добавления в файл модели сущностей и методов.  Сущность описывает коллекцию полей данных.  Например, сущность может представлять таблицу в базе данных.  Метод выполняет такие задачи, как добавление, удаление или обновление данных, представленных сущностями.  Для получения дополнительной информации см. [Интеграция бизнес-данных в SharePoint](../sharepoint/integrating-business-data-into-sharepoint.md).  
  
## Добавление сущностей  
 Сущность можно добавить, перетащив или скопировав **Сущность** с **панели элементов** Visual Studio в конструктор BDC.  Для получения дополнительной информации см. [Практическое руководство. Добавление сущности в модель](../sharepoint/how-to-add-an-entity-to-a-model.md).  
  
 Определите поля сущности в классе.  Например, если необходимо добавить поле с названием `Address` в класс `Customer`.  Можно либо добавить новый класс в проект, либо использовать существующий класс, созданный с помощью других средств, таких как "Реляционный конструктор объектов".  Имя сущности и имя класса, представляющего сущность, должны совпадать.  Отнесение класса к сущности происходит при определении методов модели.  
  
## Добавление методов  
 Служба BDC вызывает методы в модели, когда пользователь просматривает, добавляет, обновляет или удаляет сведения в списке или веб\-части на основании модели.  Модели каждой задачи, выполняемой пользователем, необходимо добавить метод.  Создайте методы, выбрав любой из пяти основных типов методов в окне **Подробности метода BDC**.  В следующей таблице описываются пять основных методов модели BDC:  
  
|Метод|Описание|  
|-----------|--------------|  
|Поиск|Возвращает коллекцию экземпляров сущности.  Вызывается при открытии пользователем списка или веб\-части.  Для получения дополнительной информации см. [Практическое руководство. Добавление метода Finder](../sharepoint/how-to-add-a-finder-method.md).|  
|Конкретный поиск|Возвращает конкретный экземпляр сущности.  Вызывается при просмотре пользователем сведений о конкретном элементе списка.  Для получения дополнительной информации см. [Практическое руководство. Добавление определенного метода Finder](../sharepoint/how-to-add-a-specific-finder-method.md).|  
|Создание|Добавляет новые данные в источник данных сущности.  Вызывается при нажатии пользователем кнопки **Создать элемент** на ленте списка, основанного на модели.  Для получения дополнительной информации см. [Практическое руководство. Добавление метода Creator](../sharepoint/how-to-add-a-creator-method.md).|  
|Обновление|Изменяет данные списка.  Вызывается при обновлении пользователем информации в списке.  Для получения дополнительной информации см. [Практическое руководство. Добавление метода Updater](../sharepoint/how-to-add-an-updater-method.md).|  
|Удаление|Удаляет данные.  Вызывается при удалении пользователем элементов из списка.  Для получения дополнительной информации см. [Практическое руководство. Добавление метода Deleter](../sharepoint/how-to-add-a-deleter-method.md).|  
  
## Определение параметров метода  
 При создании метода, Visual Studio добавляет входные и выходные параметры, соответствующие типу метода.  Эти параметры представляют собой всего лишь заполнители.  В большинстве случаев необходимо изменить параметры таким образом, чтобы они передавали или возвращали правильный тип данных.  Например, метод поиска по умолчанию возвращает строку.  В большинстве случаев, требуется изменить возвращаемый параметр метода поиска таким образом, чтобы он возвращает коллекцию сущностей.  Сделать это можно, изменив дескриптор типа параметра.  Дескриптор типа представляет собой коллекцию атрибутов, описывающих тип данных параметра.  Для получения дополнительной информации см. [Практическое руководство. Определение дескриптора типа параметра](../sharepoint/how-to-define-the-type-descriptor-of-a-parameter.md).  
  
 Visual Studio позволяет копировать дескрипторы типа из одного параметра модели в другой.  Например, следует определить дескриптор типа с именем `CustomerTD` для возвращаемого параметра метода `GetCustomer`.  Дескриптор типа `CustomerTD` можно скопировать в **Проводник BDC**, а затем вставить этот дескриптор типа во входной параметр метода `CreateCustomer`.  Это позволит не определять один и тот же дескриптор типа более одного раза.  
  
##  <a name="MethodInstances"></a> Метод экземпляров  
 При создании метода, Visual Studio добавляет метод экземпляра по умолчанию.  Метод экземпляра представляет собой ссылку на метод, плюс значения параметра по умолчанию.  Единичный метод может содержать несколько экземпляров метода.  Каждый экземпляр является комбинацией сигнатуры метода и набора значений по умолчанию.  Для получения дополнительной информации см. [Практическое руководство. Определение дескриптора типа параметра](../sharepoint/how-to-define-the-type-descriptor-of-a-parameter.md).  
  
 Во время выполнения проекта, экземпляры метода появляются в раскрывающемся списке над списком SharePoint.  Пользователи могут выбрать экземпляры метода для просмотра данных.  
  
 Чтобы добавить в экземпляр метода значения по умолчанию, необходимо непосредственно изменить XML модели.  Дополнительные сведения см. в разделе [DefaultValue](http://go.microsoft.com/fwlink/?LinkID=169279).  
  
## Добавление дескрипторов фильтра  
 У пользователей модели может возникнуть необходимость в извлечении экземпляров сущности, удовлетворяющих некоторому критерию.  Чтобы активировать данную функциональность, можно добавить методу дескриптор фильтра.  Дескрипторы фильтра позволяют пользователям модели фильтровать результирующий набор элементов метода посредством передачи значений методам перед их выполнением.  Дополнительные сведения см. в разделе [How to: Add Filter Parameters to Operations to Limit Instances from the External System](http://go.microsoft.com/fwlink/?LinkID=169267).  
  
 SharePoint предоставляет несколько компонентов, позволяющих пользователям указывать значения фильтра.  Например, веб\-части бизнес\-данных имеют текстовое поле фильтра.  Пользователи могут ограничить данные в списке введением значения в данное текстовое поле.  Дополнительные сведения о том, как добавить в метод дескриптор фильтра, см. в разделе [Практическое руководство. Добавление дескриптора фильтра в метод Finder](../sharepoint/how-to-add-a-filter-descriptor-to-a-finder-method.md).  
  
### Свойства дескриптора фильтра  
 Необходимо задать значения свойств дескриптора фильтра **Связанный дескриптор типа**, **Имя** и **Тип**.  Все прочие свойства являются необязательными.  
  
 Свойство **Связанный дескриптор типа** связывает дескриптор фильтра с входным параметром.  При указании значения фильтра, служба BDC передает это значение методу с помощью входного параметра.  
  
 Свойство **Тип** описывает шаблон фильтрации, который следует использовать.  В SharePoint, выбранный шаблон фильтрации влияет на текст, отображаемый в пользовательском интерфейсе.  Например, для средства сравнивания шаблона фильтрации, текст **равен** появляется над веб\-частью бизнес\-данных в качестве элемента управления.  Дополнительные сведения о каждом шаблоне фильтрации см. в разделе [Types of Filters Supported by the BDC](http://go.microsoft.com/fwlink/?LinkId=169287).  
  
 Дополнительные сведения о свойствах дескриптора фильтра см. в разделе [FilterDescriptor](http://go.microsoft.com/fwlink/?LinkID=169280).  
  
### Использование значений по умолчанию  
 В некоторых случаях пользователь может не указывать значение фильтра.  Использовать значение по умолчанию можно, добавив методу экземпляра значение по умолчанию или настроив значение по умолчанию в коде метода.  Дополнительные сведения о том, как добавить методу значение по умолчанию, см. в разделе [MethodInstance](http://go.microsoft.com/fwlink/?LinkID=169282).  Пример установки значения по умолчанию для входного параметра в коде метода см. в разделе [Практическое руководство. Добавление дескриптора фильтра в метод Finder](../sharepoint/how-to-add-a-filter-descriptor-to-a-finder-method.md).  
  
## Проверка модели  
 Во время разработки, модель можно проверить.  Visual Studio выявляет проблемы, которые могут нарушить ожидаемое поведение модели.  Эти проблемы в Visual Studio отображаются в **Списке ошибок**.  
  
 Чтобы проверить модель, откройте контекстное меню для конструктора BDC, а затем выберите **Проверить**.  Если модель содержит ошибки, они отображаются в **Списке ошибок**.  Можно быстро переместить курсор в код, который содержит ошибку, дважды щелкнув на неё в списке.  В качестве альтернативы можно использовать клавиши F8 или Shift\+F8, чтобы перемещаться вперед и назад по списку ошибок.  
  
 Ошибки проверки могут возникнуть в случае, если правила модели некоторым образом нарушены.  Например, если свойство **IsCollection** дескриптора типа имеет значение **true**, а дочерний дескриптор типа не существует, отобразится ошибка проверки.  Возможно следует обратиться к правилам модели BDC, чтобы понять некоторые ошибки, отображаемые в **Списке ошибок** Visual Studio.  Дополнительные сведения о правилах модели BDC см. в разделе [BDCMetadata Schema](http://go.microsoft.com/fwlink/?LinkID=169275).  
  
## Отладка решения, содержащего модель  
 Исправить код можно во время отладки кода в Visual Studio.  Чтобы отладить код, установите точки останова в любом месте кода, а затем запустите отладчик.  Visual Studio откроет сайт SharePoint.  В SharePoint создайте список или веб\-часть, использующую бизнес\-данные.  Затем, можно выполнить код по шагам.  Дополнительные сведения об отладке проектов SharePoint см. в разделе [Устранение неполадок решений SharePoint](../sharepoint/troubleshooting-sharepoint-solutions.md).  
  
 Также возможна отладка кода в пользовательских сборках, добавляемых к проекту.  Однако для отладки кода в пользовательской сборке необходимо добавить сборку к пакету решения.  Для получения дополнительной информации см. [Практическое руководство. Добавление и удаление дополнительных сборок](../sharepoint/how-to-add-and-remove-additional-assemblies.md).  
  
 Дополнительные сведения о добавлении пользовательской сборки в проект см. в разделе [Практическое руководство. Добавление пользовательской сборки в функцию BDC](../sharepoint/how-to-include-a-custom-assembly-in-a-bdc-feature.md).  
  
### Настройка системы безопасности BDC  
 Возможно, для отладки решения потребуется изменить параметры безопасности в SharePoint.  Чтобы изменить настройки, откройте на веб\-сайте центра администрирования SharePoint 2010 сервисное приложение подключения к бизнес\-данным.  В диалоговом окне **Задание разрешений хранилища метаданных** добавьте учетную запись пользователя, а затем выберите любой из следующих параметров:  
  
|Задача|Команда|  
|------------|-------------|  
|Развертывание моделей в службе BDC.|Edit|  
|Создание списков и веб\-частей с помощью внешних типов контента \(сущностей\) модели.|Выбирается в клиентах|  
|Создание, чтение, обновление и удаление данных сущности.|Выполнение|  
  
 Дополнительные сведения об этих параметрах см. в разделе [Business Data Connectivity service management](http://go.microsoft.com/fwlink/?LinkID=178883).  
  
 Также можно установить параметры безопасности для отдельных моделей или внешних типов контента.  Дополнительные сведения о том, как устанавливать настройки безопасности для модели см. в разделе [BDC model management](http://go.microsoft.com/fwlink/?LinkID=178884).  Дополнительные сведения о том, как устанавливать настройки безопасности для внешнего типа контента см. в разделе [External content type management](http://go.microsoft.com/fwlink/?LinkID=178885).  
  
> [!NOTE]  
>  Используйте эти настройки для отладки решения на локальном сервере SharePoint.  Дополнительные сведения о настройке параметров безопасности, относящихся к BDC, на рабочем сервере SharePoint см. [Business Data Connectivity Services security overview](http://go.microsoft.com/fwlink/?LinkID=178886).  
  
### Отзыв поврежденных моделей  
 При первом запуске отладчика, Visual Studio развертывает всю модель в SharePoint.  Каждый следующий раз Visual Studio обновляет модель в SharePoint с изменениями, внесенными между развертываниями.  
  
 Может возникнуть ситуация, в которой потребуется с помощью Visual Studio полностью отозвать модель из SharePoint.  Например, модель может быть повреждена.  Чтобы повторно развернуть модель в SharePoint, свойству модели **Добавочное обновление** задайте значение **False**, затем запустите отладчик.  Свойство **Добавочное обновление** отображается в окне **Свойства** при выборе узла, представляющего модель в **Обозревателе BDC**.  По умолчанию модели присваивается имя **BdcModel1**.  
  
### Изменение имен идентификаторов сущностей в модели  
 При изменении имени идентификатора после развертывания модели может возникнуть ошибка развертывания.  Эту ошибку нельзя разрешить, задав для свойства модели **Добавочное обновление** значение **False**.  Необходимо вручную отозвать модель, а затем выполнить развертывание решения заново.  Для получения дополнительной информации см. [Устранение неполадок решений SharePoint](../sharepoint/troubleshooting-sharepoint-solutions.md).  Можно избежать этой ошибки, задав для свойства модели **Добавочное обновление** значение **False** до первого развертывания модели.  
  
## Размещение документации для элементов модели BDC  
 Visual Studio добавляет к модели XML\-элемент для каждой сущности, метода или другого создаваемого элемента.  Атрибуты элемента отображаются в качестве свойств в окне **Свойства**.  Дополнительные сведения об элементах и атрибутах, создаваемых Visual Studio при конструировании модели см. [BDCMetadata Schema](http://go.microsoft.com/fwlink/?LinkID=169275).  
  
## Связанные разделы  
  
|Название|Описание|  
|--------------|--------------|  
|[Общие сведения о средствах разработки моделей подключения к бизнес-данным](../sharepoint/bdc-model-design-tools-overview.md)|Описывает средства, которые можно использовать для визуального проектирования модели для BDC.|  
|[Практическое руководство. Добавление сущности в модель](../sharepoint/how-to-add-an-entity-to-a-model.md)|Показывает способы добавления в модель внешних типов контента или сущностей.|  
|[Практическое руководство. Добавление метода Finder](../sharepoint/how-to-add-a-finder-method.md)|Показывает способы добавления метода, позволяющего пользователям просматривать сущности в списке или веб\-части.|  
|[Практическое руководство. Добавление определенного метода Finder](../sharepoint/how-to-add-a-specific-finder-method.md)|Показывает способы добавления метода, позволяющего пользователям просматривать сведения об определенной сущности.|  
|[Практическое руководство. Добавление метода Creator](../sharepoint/how-to-add-a-creator-method.md)|Показывает способы добавления метода, позволяющего пользователям добавлять записи в источник данных непосредственно из списка или веб\-части.|  
|[Практическое руководство. Добавление метода Deleter](../sharepoint/how-to-add-a-deleter-method.md)|Показывает способы добавления метода, позволяющего пользователям удалять данные из источника данных с помощью параметров пользовательского интерфейса списка или веб\-части.|  
|[Практическое руководство. Добавление метода Updater](../sharepoint/how-to-add-an-updater-method.md)|Показывает способы добавления метода, позволяющего пользователям изменять данные в источнике данных непосредственно из списка или веб\-части.|  
|[Практическое руководство. Добавление параметра в метод](../sharepoint/how-to-add-a-parameter-to-a-method.md)|Показывает способы использования окна "Подробности метода" в Visual Studio для добавления в метод входных и возвратных параметров.|  
|[Практическое руководство. Определение дескриптора типа параметра](../sharepoint/how-to-define-the-type-descriptor-of-a-parameter.md)|Показывает способы определения в модели параметра типов данных.|  
|[Практическое руководство. Определение экземпляра метода](../sharepoint/how-to-define-a-method-instance.md)|Показывает способы создания экземпляра метода, выполняющего BDC.|  
|[Практическое руководство. Добавление дескриптора фильтра в метод Finder](../sharepoint/how-to-add-a-filter-descriptor-to-a-finder-method.md)|Показывает способы, позволяющие пользователю ограничивать количество возвращаемых экземпляров с помощью метода поиска.|  
|[Создание ассоциации между сущностями](../sharepoint/creating-an-association-between-entities.md)|Описывает определение в модели отношений между сущностями.  Бизнес\-данные веб\-частей, внешних списков и пользовательских приложений могут отображать отношения данных в пользовательском интерфейсе.|  
|[Практическое руководство. Создание ассоциации между сущностями](../sharepoint/how-to-create-an-association-between-entities.md)|Показывает способы определения в модели отношений между сущностями.|  
|[Пошаговое руководство. Создание внешнего списка в SharePoint с помощью бизнес-данных](../sharepoint/walkthrough-creating-an-external-list-in-sharepoint-by-using-business-data.md)|Предоставляет пошаговые инструкции, показывающие создание и тестирование модели, отображающей контакты во внешнем списке SharePoint.|  
|[Интеграция бизнес-данных в SharePoint](../sharepoint/integrating-business-data-into-sharepoint.md)|Предоставляет обзор создания и проектирования моделей для службы BDC.|  
  
  