---
title: Как перенести и опубликовать веб-приложения в Azure облачную службу из Visual Studio | Документация Майкрософт
description: Узнайте, как перенести и опубликовать веб-приложения в Azure облачную службу с помощью Visual Studio
author: ghogen
manager: douge
ms.assetid: 9394adfd-a645-4664-9354-dd5df08e8c91
ms.prod: visual-studio-dev14
ms.technology: vs-azure
ms.custom: vs-azure
ms.workload: azure-vs
ms.topic: conceptual
ms.date: 11/10/2017
ms.author: ghogen
ms.openlocfilehash: c122b54a4e22285678d13213cc73d6492baba629
ms.sourcegitcommit: e481d0055c0724d20003509000fd5f72fe9d1340
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/05/2018
ms.locfileid: "51003044"
---
# <a name="how-to-migrate-and-publish-a-web-application-to-an-azure-cloud-service-from-visual-studio"></a>Практическое: миграция и публикация веб-приложения в Azure облачную службу из Visual Studio

Чтобы воспользоваться преимуществами служб размещения и масштабирования, предлагаемые Azure, можно для переноса и развертывания веб-приложения в Azure облачную службу. Требуются только минимальные изменения. В этой статье описывается развертывание облачных служб; для службы приложений, см. в разделе [веб-приложениями в службе приложений Azure](/azure/app-service/app-service-deploy-local-git).

> [!Important]
> Этот вид миграции поддерживается только для определенных проектов ASP.NET, Silverlight, WCF и рабочего процесса WCF. Не поддерживается для проектов ASP.NET Core. См. в разделе [поддерживаемые шаблоны проектов](#supported-project-templates).

## <a name="migrate-a-project-to-cloud-services"></a>Миграция проекта в облачные службы

1. Щелкните правой кнопкой мыши проект веб-приложения и выберите **преобразовать > Преобразовать в проект облачной службы Microsoft Azure**. (Обратите внимание, что эта команда не отображается, если уже имеется веб-роль проекта в решении).
1. Visual Studio создает проект облачной службы в решение, которое содержит необходимые веб-роли. Имя этого проекта соответствует имени проекта приложения с помощью и суффикса `.Azure`.
1. Visual Studio также задает **Копировать локально** присваивается значение true для всех сборок, которые необходимы для MVC 2, MVC 3, MVC 4 и бизнес-приложений Silverlight. Это свойство добавляет эти сборки в пакет службы, который используется для развертывания.

   > [!Important]
   > Если у вас есть другие сборки или файлы, необходимые для этого веб-приложения, необходимо вручную задать свойства для этих файлов. Сведения о задании этих свойств см. в разделе [включаемых файлов в пакете службы](#include-files-in-the-service-package).

### <a name="errors-and-warnings"></a>Ошибки и предупреждения

Все предупреждения или ошибки, возникающие неполадками нужно исправить перед развертыванием в Azure, например, отсутствие сборки.

Если построить приложение, запустите его локально с помощью эмулятора вычислений или опубликовать его в Azure, может появиться ошибка: «указанный путь и имя файла имеют слишком большую длину.» Эта ошибка означает, что длина имени полное проекта Azure превышает 146 знаков. Чтобы решить проблему, переместите решение в другую папку с более коротким путем.

Дополнительные сведения о том, как обрабатывать все предупреждения как ошибки, см. в разделе [настроить проект облачной службы Azure с помощью Visual Studio](vs-azure-tools-configuring-an-azure-project.md).

### <a name="test-the-migration-locally"></a>Локальное тестирование миграции

1. В Visual Studio **обозревателе решений**, щелкните правой кнопкой мыши добавленный проект облачной службы и выберите **Назначить запускаемым проектом**.
1. Выберите **Отладка > Начать отладку** (F5), чтобы запустить среду отладки Azure. В частности, эта среда предоставляет эмуляции различных служб Azure.

### <a name="use-an-azure-sql-database-for-your-application"></a>Использование базы данных SQL Azure для приложения

При наличии строки подключения для веб-приложения, который использует базу данных SQL Server в локальной, необходимо перенести базу данных в базе данных SQL Azure вместо и обновление строки подключения. Руководство по этому процессу см. в следующих разделах:

- [Перенос базы данных SQL Server в базу данных SQL в облаке](/azure/sql-database/sql-database-cloud-migrate)
- [Использование .NET (C#) с Visual Studio для подключения и запроса и базы данных Azure SQL](/azure/sql-database/sql-database-connect-query-dotnet-visual-studio).

## <a name="publish-the-application-to-azure-cloud-service"></a>Публикация приложения в облачной службе Azure

1. Создание необходимых облачных учетных записей хранения и службы в подписке Azure как описано в разделе [Подготовка к публикации или развертыванию приложения Azure из Visual Studio](vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio.md).
1. В Visual Studio, щелкните правой кнопкой мыши проект приложения и выберите **публикация в Microsoft Azure...**  (который отличается от команды «Опубликовать …».).
1. В **опубликовать приложение Azure** , появится, войдите с учетной записью с вашей подпиской Azure и выберите **Далее >**.
1. В **параметры > Общие параметры** выберите целевую облачную службу из **облачной службы** стрелку раскрывающегося списка, вместе с выбранной среде и конфигураций. 
1. В **параметры > Дополнительные параметры**, выберите учетную запись хранения, а затем выберите **Далее >**.
1. В **диагностики**, выберите, следует ли отправлять сведения в Application Insights.
1. Выберите **Далее >** для просмотра сводки, выберите **публикации** начать развертывание.
1. В Visual Studio откроется окно журнала действий, в котором вы можете отслеживать ход выполнения:

    ![VST_AzureActivityLog](./media/vs-azure-tools-migrate-publish-web-app-to-cloud-service/IC744149.png)

1. (Необязательно) Чтобы отменить процесс развертывания, щелкните правой кнопкой мыши соответствующую строку в журнале действий и выберите **отменить и удалить**. Эта команда останавливает процесс развертывания и удалить среду развертывания из Azure. Примечание: чтобы удалить среду развертывания после его развертывания, необходимо использовать [портала Azure](https://portal.azure.com).
1. (Необязательно) После запуска экземпляров ролей Visual Studio автоматически отображает среду развертывания в **обозреватель серверов > облачные службы** узла. Здесь можно просмотреть состояние отдельных экземпляров ролей.
1. Чтобы получить доступ к приложению после развертывания, щелкните стрелку рядом с развертыванием, когда состояние **завершено** отображается в **журнал действий Azure** вместе с URL-адрес. Дополнительные сведения о запуске веб-приложения определенного типа из Azure см.

## <a name="using-the-compute-emulator-and-starting-application-in-azure"></a>С помощью эмулятора вычислений и запуск приложения в Azure

Все типы приложений можно запустить в браузере, подключенном к отладчику Visual Studio, выбрав **Отладка > Начать отладку** (F5). Проект пустое веб-приложение ASP.NET, необходимо сначала добавить `.aspx` страницы в приложении и задать его в качестве начальной страницы в веб-проект.

В следующей таблице приведены сведения о запуске приложения в Azure:

   | Тип веб-приложения | В Azure |
   | --- | --- | --- |
   | Веб-приложение ASP.NET<br/>(включая MVC 2, MVC 3, MVC 4) | Выберите URL-адрес в **развертывания** вкладке **журнал действий Azure**. |
   | ASP.NET пустое веб-приложение | Если у вас есть значение по умолчанию `.aspx` страницы в приложении, выберите URL-адрес в **развертывания** вкладке **журнал действий Azure**. Чтобы перейти на другую страницу, введите URL-адрес следующего вида в браузере: `<deployment_url>/<page_name>.aspx` |
   | Приложение Silverlight<br/>Бизнес-приложения Silverlight<br/>Приложение навигации Silverlight | Перейдите к заданной странице вашего приложения в URL-адрес следующего вида: `<deployment_url>/<page_name>.aspx` |
    Приложение службы WCF<br/>Приложение службы рабочего процесса WCF | Задайте `.svc` файл в качестве начальной страницы для проекта службы WCF. Затем перейдите к `<deployment_url>/<service_file>.svc` |
   | Динамических сущностей ASP.NET<br/>Платформа динамических данных Linq to SQL | Обновите строку подключения, как описано в следующем разделе. Затем перейдите к `<deployment_url>/<page_name>.aspx`. Для Linq to SQL необходимо использовать базу данных Azure SQL. |

## <a name="update-a-connection-string-for-aspnet-dynamic-entities"></a>Обновить строку подключения для динамических сущностей ASP.NET

1. Создание базы данных SQL Azure для веб-приложение динамических сущностей ASP.NET, как ранее (#use-an-azuresql-database-for-your-application).
1. Добавьте таблицы и поля, необходимые для этой базы данных на портале Azure.
1. Укажите строку подключения в `web.config` в следующем формате и сохраните файл:

    ```xml
    <addname="tempdbEntities"connectionString="metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SqlClient;provider connection string=&quot;data source=<server name>\SQLEXPRESS;initial catalog=<database name>;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;"providerName="System.Data.EntityClient"/>
    ```

    Обновление *connectionString* значение строкой подключения ADO.NET для базы данных SQL Azure, следующим образом:

    ```xml
    XMLCopy<addname="tempdbEntities"connectionString="metadata=res://*/Model1.csdl|res://*/Model1.ssdl|res://*/Model1.msl;provider=System.Data.SqlClient;provider connection string=&quot;Server=tcp:<SQL Azure server name>.database.windows.net,1433;Database=<database name>;User ID=<user name>;Password=<password>;Trusted_Connection=False;Encrypt=True;multipleactiveresultsets=True;App=EntityFramework&quot;"providerName="System.Data.EntityClient"/>
    ```

## <a name="supported-project-templates"></a>Поддерживаемые шаблоны проектов

Приложения, можно перенести и опубликовать в облачных службах, должны использовать один из шаблонов в следующей таблице. ASP.NET Core не поддерживается.

| Группа шаблонов | Шаблон проекта |
| --- | --- |
| Интернет | Веб-приложения ASP.NET (.NET Framework) |
| Интернет | Веб-приложение ASP.NET MVC 2 |
| Интернет | Веб-приложение ASP.NET MVC 3 |
| Интернет | Веб-приложение ASP.NET MVC 4 |
| Интернет | ASP.NET пустое веб-приложение (или сайт) |
| Интернет | Пустое веб-приложение ASP.NET MVC 2 |
| Интернет | Сущностей динамических данных ASP.NET, веб-приложения |
| Интернет | Платформа динамических данных Linq to SQL веб-приложения |
| Silverlight | Приложение Silverlight |
| Silverlight | Бизнес-приложения Silverlight |
| Silverlight | Приложение навигации Silverlight |
| WCF | Приложение службы WCF |
| WCF | Приложение службы рабочего процесса WCF |
| Рабочий процесс | Приложение службы рабочего процесса WCF |

## <a name="next-steps"></a>Следующие шаги

- [Подготовка к публикации или развертыванию приложения Azure из Visual Studio](vs-azure-tools-cloud-service-publish-set-up-required-services-in-visual-studio.md)
- [Настройка именованных учетных данных проверки подлинности](vs-azure-tools-setting-up-named-authentication-credentials.md).
