---
title: Правка адаптеров таблиц | Документация Майкрософт
ms.custom: ''
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
f1_keywords:
- vs.datasource.dbtablefunctionwizard
- vs.datasource.datacomponentquerywizard
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- data [Visual Studio], data component queries
- data [Visual Studio], TableAdapters
- TableAdapter Query Configuration Wizard
- data [Visual Studio], table adapter queries
ms.assetid: 8c06b306-24d0-4521-948d-07e3b7badd95
caps.latest.revision: 24
author: gewarren
ms.author: gewarren
manager: ghogen
robots: noindex,nofollow
ms.openlocfilehash: faeac90c92675c897774cc3650575cd60f5be991
ms.sourcegitcommit: 9ceaf69568d61023868ced59108ae4dd46f720ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2018
ms.locfileid: "49288409"
---
# <a name="editing-tableadapters"></a>Правка адаптеров таблиц
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Иногда может потребоваться изменить схему таблицы адаптера. Чтобы сделать это, необходимо изменить основного адаптера `Fill` метод. Адаптеры таблиц создаются с помощью основного `Fill` метод, который определяет схему связанной таблицы данных. Основной `Fill` метод на основе запроса или хранимой процедуры, введенные при первоначальной настройке TableAdapter; это первый метод (самых верхних) в таблице данных на [Создание и изменение типизированных наборов DataSet](../data-tools/creating-and-editing-typed-datasets.md).  
  
 ![TableAdapter с несколькими запросами](../data-tools/media/tableadapter.gif "адаптера таблицы")  
  
 Любые изменения, внесенные в адаптер таблицы основной `Fill` метод отражаются в схему связанной таблицы данных. Например, удаление столбца из запроса в основном `Fill` метод также удаляет столбец из связанной таблицы данных. Кроме того, удаление столбца из главного `Fill` метод удаляет столбец из любых дополнительных запросов для этого TableAdapter.  
  
 Можно использовать **мастер настройки запроса TableAdapter** для создания и изменения дополнительных запросов для TableAdapter. Эти дополнительные запросы должны соответствовать схемы таблицы, если они возвращают скалярное значение.  Дополнительные запросы с именами вами (например, `CustomersTableAdapter.FillByCity(NorthwindDataSet.Customers, "Seattle")`.)  
  
#### <a name="to-start-the-tableadapter-query-configuration-wizard-with-a-new-query"></a>Чтобы запустить мастер настройки запроса адаптера таблицы с помощью нового запроса  
  
1.  Откройте набор данных в **конструктор наборов данных**.  
  
2.  Если вы создаете новый запрос, перетащите **запроса** объекта из **набора данных** вкладке **элементов** на <xref:System.Data.DataTable>, или выберите **добавить запрос**TableAdapter контекстном меню. Можно также перетащить **запроса** объекта на пустую область **конструктор наборов данных**, которая создает адаптер таблиц без связанного <xref:System.Data.DataTable>. Эти запросы ограничены возврат отдельных значений (скаляр) или выполнение UPDATE, INSERT или удалить команды в базе данных. Дополнительные сведения см. в разделе [как: Добавление глобальных запросов в адаптер таблицы](../data-tools/how-to-add-global-queries-to-a-tableadapter.md).  
  
3.  На **Выбор подключения к данным** странице выберите или создайте подключение, будет использоваться запросом.  
  
    > [!NOTE]
    >  Эта страница отображается только в том случае, если конструктор не может определить правильное подключение для использования или доступных соединений нет.  
  
4.  На **Выбор типа команды** страницу, выберите один из следующих методов получения данных из базы данных:  
  
    -   **С помощью инструкций SQL** позволяет ввести инструкцию SQL для выбора данных из базы данных.  
  
    -   **Создать новую хранимую процедуру** — выберите этот параметр, чтобы мастер создал новую хранимую процедуру (в базе данных) на основе указанной инструкции SELECT.  
  
    -   **Использовать существующие хранимые процедуры** — выберите этот параметр для выполнения существующей хранимой процедуры при запуске запроса.  
  
#### <a name="to-start-the-tableadapter-query-configuration-wizard-on-an-existing-query"></a>Чтобы запустить мастер настройки запроса адаптера таблицы в существующий запрос  
  
-   При редактировании существующего запроса адаптера таблицы, щелкните правой кнопкой мыши запрос и выберите **Настройка** в контекстном меню.  
  
    > [!NOTE]
    >  Щелкните правой кнопкой мыши основного запроса адаптера таблицы перенастраивает адаптер таблицы и <xref:System.Data.DataTable> схемы, тогда как щелчок дополнительный запрос в TableAdapter настраивает только выбранного запроса. **Мастер настройки адаптера таблицы** перенастраивает определение адаптера таблицы; **мастер настройки запроса TableAdapter** перенастраивает только выбранный запрос.  
  
## <a name="running-the-wizard"></a>Запуск мастера  
 Перетащите запросы в **конструктор наборов данных**, или настройте имеющиеся запросы (любой запрос, перечисленных ниже в первом запросе).  
  
 Первый запрос в адаптере таблицы является его основным запросом. Изменение этого запроса открывает **мастер настройки адаптера таблицы** и изменяется схема таблицы данных адаптера таблицы. Все запросы, указанные под основным запросом, являются дополнительными и настраиваются с помощью **мастер настройки запроса TableAdapter**. Дополнительные сведения о запуске мастера, см. в разделе [как: запустите мастер настройки запроса TableAdapter](http://msdn.microsoft.com/library/fc7b468e-3417-48a4-a8aa-cace8f99c24a).  
  
## <a name="choose-your-data-connection"></a>Выбор подключения базы данных  
 Выберите существующее подключение из списка подключений или щелкните **новое подключение** для создания подключения к базе данных.  
  
 По завершении **свойства соединения** диалоговом окне **сведения о подключении** области отображается только для чтения сведения о выбранном поставщике, а также строку подключения.  
  
## <a name="save-the-connection-string-to-the-application-configuration-file"></a>Сохранение подключения в файле конфигурации приложения  
 Выберите **Да, сохранить подключение как** для хранения строки подключения в файле конфигурации приложения. Введите имя подключения или используйте имя по умолчанию.  
  
 Сохранение строк подключения в файле конфигурации приложения упрощает процесс обслуживания приложения в случае изменения подключения к базе данных. При изменении подключения к базе данных вы можете отредактировать строку подключения в файле конфигурации приложения. При этом вам не нужно изменять исходный код и перекомпилировать приложение. Сведения об изменении строки подключения в файле конфигурации приложения, см. в разделе [как: сохранение и изменение строк подключения](~/E:/Repos/visualstudio-docs-pr/docs/data-tools/how-to-save-and-edit-connection-strings.md).  
  
> [!IMPORTANT]
>  Информация хранится в файле конфигурации приложения в виде обычного текста. Чтобы снизить вероятность несанкционированного доступа к конфиденциальной информации, вы можете зашифровать свои данные. Дополнительные сведения см. в разделе [шифрование и расшифровка данных](http://msdn.microsoft.com/en-us/22812ae8-e082-4eb1-a29b-21b6ee00c6b5).  
  
## <a name="use-sql-statements"></a>Использовать инструкции SQL  
 В этом разделе описаны способы выполнения **мастер настройки запроса TableAdapter** при выборе **использовать инструкции SQL** параметр.  
  
## <a name="choose-a-query-type"></a>Выбор типа запроса  
 Мастер создает несколько типов запросов в зависимости от потребностей вашего приложения. Вы можете выбрать запросы SELECT, которые возвращают строки данных (таблицу данных) или запросы SELECT, которые возвращают скалярное значение (отдельное значение, такое как `Count` или `Sum`).  
  
 На **Выбор типа запроса** выберите тип создаваемого запроса из списка доступных запросов.  
  
> [!NOTE]
>  Создание инструкции INSERT, UPDATE или DELETE не заменяет собой команды адаптера таблицы, используемые при вызове его метода `Update`. Например, при выборе UPDATE в качестве типа запроса создается новый запрос с именем, которое задается на более позднем шаге в мастере. Для выполнения данного запроса вы вызываете этот именованный метод адаптера таблицы. Вызов метода `Update` адаптера таблицы выполняет инструкции, созданные при первоначальной настройке адаптера таблицы.  
  
## <a name="specify-a-sql-query-type-statement"></a>Укажите SQL \<тип запроса > инструкции  
 На **указать инструкцию SQL** введите инструкцию SQL, выполняемую при вызове запроса.  
  
> [!TIP]
>  Мастер предоставляет доступ к **построитель запросов**, — визуальное средство для создания SQL-запросов. Чтобы открыть его, нажмите кнопку **построитель запросов** кнопки.  
  
## <a name="choose-methods-to-generate"></a>Выбор методов для автоматического создания  
 Параметры на этой странице позволяют выбрать, какие именно методы мастер создает для данного запроса.  
  
 **Заполнение DataTable**  
 Создает метод, служащий для заполнения таблицы данных. Вы передаете имя таблицы данных в качестве параметра при вызове этого метода для заполнения таблицы данных возвращенными данными.  
  
 При необходимости можно изменить имя по умолчанию в **имя метода** поле. Указание понятного имени может помочь при работе с данным запросом в коде.  
  
 **Вернуть таблицу данных**  
 Создает метод, служащий для возвращения заполненной таблицы данных. В некоторых приложениях может быть предпочтительнее возвращать заполненную таблицу данных, чем заполнять имеющуюся таблицу данных.  
  
 При необходимости можно изменить имя по умолчанию в **имя метода** поле.  
  
## <a name="choose-function-name"></a>Выбор имени функции  
 Введите имя для функции. При создании запроса адаптера таблицы в этот адаптер добавляется метод с указанным здесь именем. Вызовите этот метод для выполнения запроса. Указание понятного имени помогает при работе с данным запросом в коде.  
  
> [!NOTE]
>  При создании новых хранимых процедур вам требуется указать два имени. Первое имя — это имя хранимой процедуры, создаваемой в базе данных; второе имя — это имя метода в адаптере таблицы, выполняющего хранимую процедуру при вызове.  
  
## <a name="create-new-stored-procedures"></a>Создать новые хранимые процедуры  
 В этом разделе описаны способы выполнения **мастер настройки запроса TableAdapter** при выборе **создать новые хранимые процедуры** параметр.  
  
1.  В **Создание хранимых процедур** введите инструкцию SQL, выполняемую при вызове хранимой процедуры.  
  
    > [!NOTE]
    >  Мастер предоставляет доступ к **построитель запросов**, — визуальное средство для создания SQL-запросов. Чтобы открыть его, нажмите кнопку **построитель запросов** кнопки.  
  
2.  В **Создание хранимых процедур** выполните следующее:  
  
    1.  Введите имя новой хранимой процедуры.  
  
    2.  Укажите, требуется ли создавать хранимую процедуру в основной базе данных.  
  
        > [!NOTE]
        >  Возможность создания хранимой процедуры в базе данных определяется параметрами безопасности и разрешениями, установленными для этой конкретной базы данных.  
  
     **Просмотр результатов работы мастера** странице отображаются результаты создания запроса адаптера таблицы. Если мастер сталкивается с проблемами, на этой странице выводятся сведения об ошибке.  
  
## <a name="use-existing-stored-procedures"></a>Использовать существующие хранимые процедуры  
 В этом разделе описаны способы выполнения **мастер настройки запроса TableAdapter** при выборе **использовать существующие хранимые процедуры** параметр.  
  
1.  Выберите существующую хранимую процедуру из раскрывающегося списка на **выберите существующую хранимую процедуру** странице мастера.  
  
     **Параметры** и **результаты** для выбранной хранимой процедуры отображаются для справки.  
  
2.  Нажмите кнопку **Далее**.  
  
## <a name="choose-the-shape-of-data-returned-by-the-stored-procedure"></a>Выбор формы данных, возвращаемых хранимой процедурой  
 Тип данных, возвращаемых выбранной хранимой процедурой, определяет, как именно мастер создает методы адаптера таблицы.  
  
 Выберите тип данных, возвращаемых этим запросом.  
  
-   Выбрав **табличных данных** открывает **Выбор методов для создания** страницы, (описанная ранее на этой странице справки), который позволяет указать типы методов, имена методов и поддержка разбиения на страницы должен быть создан.  
  
-   Выбрав **одно значение** создается типизированный метод, возвращающий одиночное значение. Этот параметр открывает **Выбор имени функции** страницы, (описанная ранее на этой странице справки).  
  
-   Выбрав **значение не** создается типизированный метод, который выполняет хранимую процедуру и ожидает, что данные не должны быть возвращены. Этот параметр открывает **Выбор имени функции** страницы, (описанная ранее на этой странице справки).  
  
## <a name="view-wizards-results"></a>Просмотр результатов работы мастера  
 **Просмотр результатов работы мастера** странице отображаются результаты создания запроса адаптера таблицы. Если мастер сталкивается с проблемами, на этой странице выводятся соответствующие сведения.  
  
## <a name="see-also"></a>См. также  
 [Общие сведения о TableAdapter](../data-tools/tableadapter-overview.md)   
 [Практическое: изменение запросов TableAdapter](../data-tools/how-to-edit-tableadapter-queries.md)   
 [Примеры работы с данными](http://msdn.microsoft.com/library/15a88fb8-3bee-4962-914d-7a1f8bd40ec4)   
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)   
 [Общие сведения о данных приложений в Visual Studio](../data-tools/overview-of-data-applications-in-visual-studio.md)   
 [Подключение к данным в Visual Studio](../data-tools/connecting-to-data-in-visual-studio.md)   
 [Подготовка приложения для получения данных](http://msdn.microsoft.com/library/c17bdb7e-c234-4f2f-9582-5e55c27356ad)   
 [Выборка данных в приложение](../data-tools/fetching-data-into-your-application.md)   
 [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md)   
 [Редактирование данных в приложении](../data-tools/editing-data-in-your-application.md)   
 [Проверка данных](http://msdn.microsoft.com/library/b3a9ee4e-5d4d-4411-9c56-c811f2b4ee7e)   
 [Сохранение данных](../data-tools/saving-data.md)