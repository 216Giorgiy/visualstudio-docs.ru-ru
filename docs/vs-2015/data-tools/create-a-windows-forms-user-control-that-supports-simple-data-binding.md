---
title: Создать пользовательский элемент управления Windows Forms, который поддерживает простую привязку данных | Документация Майкрософт
ms.custom: ''
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- custom controls [Visual Studio], Data Sources Window
- Data Sources Window, controls
ms.assetid: b1488366-6dfb-454e-9751-f42fd3f3ddfb
caps.latest.revision: 17
author: gewarren
ms.author: gewarren
manager: ghogen
ms.openlocfilehash: f761f28ebbe069d3fe0b0d0c468194247a36dafa
ms.sourcegitcommit: 9ceaf69568d61023868ced59108ae4dd46f720ab
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/12/2018
ms.locfileid: "49260901"
---
# <a name="create-a-windows-forms-user-control-that-supports-simple-data-binding"></a>Создать пользовательский элемент управления Windows Forms, который поддерживает простую привязку данных
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

  
При отображении данных на формах в приложениях Windows, можно выбрать существующие элементы управления из **элементов**, или можно создать пользовательские элементы управления, если вашему приложению требуется функциональность, которая недоступна в стандартных элементах управления. В этом пошаговом руководстве демонстрируется создание элемента управления, реализующего <xref:System.ComponentModel.DefaultBindingPropertyAttribute>. Элементы управления, реализующие <xref:System.ComponentModel.DefaultBindingPropertyAttribute>, могут содержать одно свойство, которое можно привязать к данным. Такие элементы управления похожи на <xref:System.Windows.Forms.TextBox> или <xref:System.Windows.Forms.CheckBox>.  
  
 Дополнительные сведения о создании элементов управления, см. в разделе [Разработка Windows Forms элементов управления во время разработки](http://msdn.microsoft.com/library/e5a8e088-7ec8-4fd9-bcb3-9078fd134829).  
  
 При создании элементов управления для использования в сценариях привязки данных, должны реализовывать один из следующих атрибутов привязки к данным:  
  
|Использование атрибута привязки данных|  
|-----------------------------------|  
|Реализуйте <xref:System.ComponentModel.DefaultBindingPropertyAttribute> на простых элементах управления, таких как <xref:System.Windows.Forms.TextBox>, которые отображают отдельный столбец (или свойство) данных. (Этот процесс описан в данном пошаговом руководстве.)|  
|Реализуйте <xref:System.ComponentModel.ComplexBindingPropertiesAttribute> на элементах управления, таких как <xref:System.Windows.Forms.DataGridView>, которые отображают списки (или таблицы) данных. Дополнительные сведения см. в разделе [создать пользовательский элемент управления Windows Forms, который поддерживает сложную привязку данных](../data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding.md).|  
|Реализуйте <xref:System.ComponentModel.LookupBindingPropertiesAttribute> на элементах управления, таких как <xref:System.Windows.Forms.ComboBox>, которые отображают списки (или таблицы) данных, но также должны представлять отдельный столбец или отдельное свойство. Дополнительные сведения см. в разделе [создать пользовательский элемент управления Windows Forms с привязкой данных подстановки](../data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding.md).|  
  
 В этом пошаговом руководстве создается простой элемент управления, отображающий данные из одного столбца в таблице. В данном примере используется столбец `Phone` таблицы `Customers` из учебной базы данных "Борей". Этот простой элемент управления отображает номера телефонов заказчиков в стандартный формат номера телефона, с помощью <xref:System.Windows.Forms.MaskedTextBox> и задавая маску для номера телефона.  
  
 В этом пошаговом руководстве описаны следующие процедуры.  
  
-   Создайте новый **приложения Windows**.  
  
-   Добавьте новый **пользовательский элемент управления** в проект.  
  
-   Визуальное проектирование пользовательского элемента управления.  
  
-   Реализация атрибута `DefaultBindingProperty`.  
  
-   Создание набора данных с помощью **конфигурации источника данных** мастера.  
  
-   Задайте **Phone** столбца в **источников данных** окна для использования нового элемента управления.  
  
-   Создание формы для отображения данных в новом элементе управления.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения данного пошагового руководства требуется:  
  
-   Доступ к примеру базы данных "Борей". Дополнительные сведения см. в разделе [как: установить образцы баз данных](../data-tools/how-to-install-sample-databases.md).  
  
## <a name="create-a-windows-application"></a>Создание приложения Windows  
 Первым шагом является создание **приложения Windows**.  
  
#### <a name="to-create-the-new-windows-project"></a>Порядок создания нового проекта Windows  
  
1.  В Visual Studio из **файл** меню, создайте новый **проекта**.  
  
2.  Назовите проект **SimpleControlWalkthrough**.  
  
3.  Выберите **приложения Windows** и нажмите кнопку **ОК**. Дополнительные сведения см. в разделе [клиентских приложений](http://msdn.microsoft.com/library/2dfb50b7-5af2-4e12-9bbb-c5ade0e39a68).  
  
     **SimpleControlWalkthrough** проект создан и добавлен **обозревателе решений**.  
  
## <a name="add-a-user-control-to-the-project"></a>Добавьте в проект пользовательский элемент управления  
 В этом пошаговом руководстве создается простой элемент управления можно привязать к данным из **пользовательский элемент управления**, поэтому необходимо добавить **пользовательский элемент управления** элемент **SimpleControlWalkthrough** проекта.  
  
#### <a name="to-add-a-user-control-to-the-project"></a>Добавление пользовательского элемента управления в проект  
  
1.  Из **проекта** меню, выберите **добавить пользовательский элемент управления**.  
  
2.  Тип `PhoneNumberBox` в имя области, а также выберите **добавить**.  
  
     **PhoneNumberBox** элемент управления добавляется **обозревателе решений**и откроется в конструкторе.  
  
## <a name="design-the-phonenumberbox-control"></a>Порядок проектирования элемента управления PhoneNumberBox  
 В этом пошаговом руководстве расширяется существующий <xref:System.Windows.Forms.MaskedTextBox> для создания элемента управления `PhoneNumberBox`.  
  
#### <a name="to-design-the-phonenumberbox-control"></a>Порядок проектирования элемента управления PhoneNumberBox  
  
1.  Перетащите <xref:System.Windows.Forms.MaskedTextBox> из **элементов** в область конструктора пользовательского элемента управления.  
  
2.  Выберите смарт-тег на <xref:System.Windows.Forms.MaskedTextBox> вы просто перетащить и выберите команду **Установка маски**.  
  
3.  Выберите **номер телефона** в **маска ввода** диалоговое окно и нажмите кнопку **ОК** для задания маски.  
  
## <a name="add-the-required-data-binding-attribute"></a>Добавьте необходимый атрибут привязки данных  
 Для простых элементов управления, поддерживающих привязку к данным, реализуйте <xref:System.ComponentModel.DefaultBindingPropertyAttribute>.  
  
#### <a name="to-implement-the-defaultbindingproperty-attribute"></a>Реализация атрибута DefaultBindingProperty  
  
1.  Переключите элемент управления `PhoneNumberBox` в представление кода. (На **представление** меню, выберите **кода**.)  
  
2.  Замените код в `PhoneNumberBox` следующим кодом:  
  
     [!code-csharp[VbRaddataDisplaying#3](../snippets/csharp/VS_Snippets_VBCSharp/VbRaddataDisplaying/CS/PhoneNumberBox.cs#3)]
     [!code-vb[VbRaddataDisplaying#3](../snippets/visualbasic/VS_Snippets_VBCSharp/VbRaddataDisplaying/VB/PhoneNumberBox.vb#3)]  
  
3.  В меню **Построение** выберите пункт **Построить решение**.  
  
## <a name="create-a-data-source-from-your-database"></a>Создать источник данных из базы данных  
 Этот шаг использует **конфигурации источника данных**мастер для создания источника данных на основе `Customers` таблицы в базе данных Northwind. Для создания подключения необходимо иметь доступ к учебной базе данных "Борей". Сведения о настройке учебной базе данных Northwind, см. в разделе [как: установить образцы баз данных](../data-tools/how-to-install-sample-databases.md).  
  
#### <a name="to-create-the-data-source"></a>Создание источника данных  
  
1.  В меню **Данные** выберите команду **Показать источники данных**.  
  
2.  В **источников данных** выберите **добавить новый источник данных** запустить **конфигурации источника данных** мастера.  
  
3.  На **Выбор типа источника данных** выберите **базы данных**, а затем нажмите кнопку **Далее**.  
  
4.  На **Выбор подключения базы данных** выполните одно из следующих:  
  
    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.  
  
    -   Выберите **новое подключение** для запуска **Добавить/изменить подключение** диалоговое окно.  
  
5.  Если для базы данных требуется пароль, выберите параметр для включения конфиденциальных данных и нажмите кнопку **Далее**.  
  
6.  На **сохранение подключения в файле конфигурации приложения** щелкните **Далее**.  
  
7.  На **Выбор объектов базы данных** странице, разверните узел **таблиц** узла.  
  
8.  Выберите `Customers` таблицы, а затем нажмите кнопку **Готово**.  
  
     **NorthwindDataSet** добавляется в проект и `Customers` таблица появится в **источников данных** окна.  
  
## <a name="set-the-phone-column-to-use-the-phonenumberbox-control"></a>Порядок настройки столбца телефона на использование элемента управления PhoneNumberBox  
 В рамках **источников данных** окно, можно задать элемент управления должен быть создан перед перетаскиванием элементов на форму.  
  
#### <a name="to-set-the-phone-column-to-bind-to-the-phonenumberbox-control"></a>Порядок настройки столбца телефона на привязку к элементу управления PhoneNumberBox  
  
1.  Откройте **Form1** в конструкторе.  
  
2.  Разверните **клиентов** узел в **источников данных** окна.  
  
3.  Щелкните стрелку раскрывающегося списка в **клиентов** узел и выберите **сведения** в списке элементов управления.  
  
4.  Щелкните стрелку раскрывающегося списка в **Phone** столбец и выберите **Настройка**.  
  
5.  Выберите **PhoneNumberBox** из списка **связанные элементы управления** в **параметры настройки пользовательского интерфейса данных** диалоговое окно.  
  
6.  Щелкните стрелку раскрывающегося списка в **Phone** столбец и выберите **PhoneNumberBox**.  
  
## <a name="addcontrols-to-the-form"></a>Addcontrols в форму  
 Созданием элементов управления с привязкой к данным путем перетаскивания элементов из **источников данных** окна в форму.  
  
#### <a name="to-create-data-bound-controls-on-the-form"></a>Создание элементов управления с привязкой к данным на форме  
  
-   Перетащите главный **клиентов** узел из **источников данных** окна в форму и убедитесь, что `PhoneNumberBox` элемент управления используется для отображения данных в `Phone` столбца.  
  
     Привязанные к данным элементы управления с метками описания отображаются на форме вместе с панелью инструментов (<xref:System.Windows.Forms.BindingNavigator>) для перемещения по записям. Объект [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), [CustomersTableAdapter](../data-tools/tableadapter-overview.md), <xref:System.Windows.Forms.BindingSource>, и <xref:System.Windows.Forms.BindingNavigator> отображаются в области компонентов.  
  
## <a name="run-the-application"></a>Запуск приложения  
  
#### <a name="to-run-the-application"></a>Запуск приложения  
  
-   Нажмите клавишу F5 для запуска приложения.  
  
## <a name="next-steps"></a>Следующие шаги  
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания элемента управления, поддерживающего привязку к данным. Некоторые типичные дальнейшие действия.  
  
-   Помещение пользовательских элементов управления в библиотеку элементов управления, чтобы их можно было повторно использовать в других приложениях.  
  
-   Создание элементов управления, поддерживающих более сложных сценариев привязки к данным. Дополнительные сведения см. в разделе [создать пользовательский элемент управления Windows Forms, который поддерживает сложную привязку данных](../data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding.md) и [создать пользовательский элемент управления Windows Forms с привязкой данных подстановки](../data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding.md).  
  
## <a name="see-also"></a>См. также  
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)   
 [Задание поведения, при котором элемент управления создается при перетаскивании из окна "Источники данных"](../data-tools/set-the-control-to-be-created-when-dragging-from-the-data-sources-window.md)

