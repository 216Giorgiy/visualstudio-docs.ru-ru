---
title: Создайте форму Windows для поиска данных | Документация Майкрософт
ms.custom: ''
ms.date: 2018-06-30
ms.prod: visual-studio-dev14
ms.reviewer: ''
ms.suite: ''
ms.tgt_pltfrm: ''
ms.topic: article
dev_langs:
- VB
- CSharp
- C++
- aspx
helpviewer_keywords:
- Windows Forms, searching data
- Windows Forms, displaying data
- parameters, displaying filtered data
- data [Visual Studio], paramaterizing queries
- data [Visual Studio], searching
ms.assetid: 65ca79a9-7458-466c-af55-978cd24c549e
caps.latest.revision: 31
author: gewarren
ms.author: gewarren
manager: ghogen
ms.openlocfilehash: a64377e2689ca4e5111f316c13808aee6cfb59be
ms.sourcegitcommit: 55f7ce2d5d2e458e35c45787f1935b237ee5c9f8
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/22/2018
ms.locfileid: "47569728"
---
# <a name="create-a-windows-form-to-search-data"></a>Создание формы Windows Forms для поиска данных
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Последнюю версию этого раздела можно найти в [создать форму Windows для поиска данных](https://docs.microsoft.com/visualstudio/data-tools/create-a-windows-form-to-search-data).  
  
  
Довольно распространенным сценарием приложения является отображение выбранных данных на форме. Например, вам может потребоваться отобразить заказы для определенного клиента или сведения о конкретном заказе. В таком сценарии пользователь вводит в форму информацию, после чего выполняется запрос, включающий в себя эти введенные пользователем данные в качестве параметра; таким образом, данные выбираются на основе параметризированного запроса. Запрос возвращает только те данные, которые удовлетворяют введенным пользователем условиям. Это пошаговое руководство показывает, как создать запрос, возвращающий клиентов из определенного города, и изменить пользовательский интерфейс, чтобы пользователи могли ввести название города и нажать кнопку для выполнения запроса.  
  
 Использование параметризованных запросов помогает сделать приложение эффективным, так как позволяет базе данных заниматься своей непосредственной задачей — быстрой фильтрацией записей. Напротив Если запросить всю таблицу базы данных, передается по сети и использовать логику приложения для поиска нужных записей, ваше приложение станет медленным и неэффективным.  
  
 Параметризованные запросы можно добавить любой адаптер таблицы (и элементы управления для приема значений параметров и выполнения запроса), с помощью **Построитель условий поиска** диалоговое окно. Открыть диалоговое окно, выбрав **добавить запрос** команды **данных** меню (или на любом смарт-теге адаптера таблицы).  
  
 В данном пошаговом руководстве представлены следующие задачи.  
  
-   Создание нового проекта приложения Windows Forms.  
  
-   Создание и настройка источника данных в приложении с помощью **конфигурации источника данных** мастера.  
  
-   Настройка типа удаления элементов в **источников данных**окна.  
  
-   Создание элементов управления, отображающие данные путем перетаскивания элементов из **источников данных** окна в форму.  
  
-   Добавление элементов управления для отображения данных на форме.  
  
-   Завершение работы **Построитель условий поиска** диалоговое окно.  
  
-   Ввод параметров в форму и выполнение параметризованного запроса.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения данного пошагового руководства требуется:  
  
-   Доступ к примеру базы данных "Борей".  
  
## <a name="create-the-windows-application"></a>Создание приложения Windows  
 Первым шагом является создание **приложения Windows**. Присвоение имени проекту на данном этапе, но вы дадите его имя, так как вы сохраните их позже.  
  
#### <a name="to-create-the-new-windows-application-project"></a>Порядок создания нового проекта приложения Windows  
  
1.  Из **файл** меню, создайте новый проект.  
  
2.  Задайте для проекта имя `WindowsSearchForm`.  
  
3.  Выберите **приложения Windows** и нажмите кнопку **ОК**.  
  
     **WindowsSearchForm** проекта создается и добавляется к **обозревателе решений**.  
  
## <a name="create-the-data-source"></a>Создание источника данных  
 Этот шаг создает источник данных из базы данных с помощью **конфигурации источника данных** мастера. Для создания подключения необходимо иметь доступ к учебной базе данных "Борей". Сведения о настройке учебной базе данных Northwind, см. в разделе [Установка SQL Server образцы баз данных](../data-tools/install-sql-server-sample-databases.md).  
  
#### <a name="to-create-the-data-source"></a>Создание источника данных  
  
1.  В меню **Данные** выберите команду **Показать источники данных**.  
  
2.  В **источников данных** выберите **добавить новый источник данных** запустить **конфигурации источника данных** мастера.  
  
3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.  
  
4.  На **Выбор подключения базы данных** странице выполните одно из следующих:  
  
    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.  
  
    -   Выберите **новое подключение** для запуска **Добавить/изменить подключение** диалоговое окно.  
  
5.  Если для базы данных требуется пароль, выберите параметр для включения конфиденциальных данных и нажмите кнопку **Далее**.  
  
6.  На **сохранение подключения в файле конфигурации приложения** щелкните **Далее**.  
  
7.  На **Выбор объектов базы данных** странице, разверните узел **таблиц** узла.  
  
8.  Выберите **клиентов** таблицы, а затем нажмите кнопку **Готово**.  
  
     **NorthwindDataSet** добавляется в проект и **клиентов** таблица появится в **источников данных** окна.  
  
## <a name="create-the-form"></a>Создание формы  
 Созданием элементов управления с привязкой к данным путем перетаскивания элементов из **источников данных** окна на форму.  
  
#### <a name="to-create-data-bound-controls-on-the-form"></a>Создание элементов управления с привязкой к данным на форме  
  
1.  Разверните **клиентов** узел в **источников данных** окна.  
  
2.  Перетащите **клиентов** узел из **источников данных** окна в форму.  
  
     На форме появляются <xref:System.Windows.Forms.DataGridView> и полоса инструментов (<xref:System.Windows.Forms.BindingNavigator>) для перемещения по записям. Объект [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), [CustomersTableAdapter](../data-tools/tableadapter-overview.md), <xref:System.Windows.Forms.BindingSource>, и <xref:System.Windows.Forms.BindingNavigator> отображаются в области компонентов.  
  
## <a name="addparameterization-search-functionality-to-the-query"></a>Addparameterization (функциональности поиска) в запрос  
 Можно добавить предложение WHERE в исходный запрос с помощью **Построитель условий поиска** диалоговое окно.  
  
#### <a name="to-create-a-parameterized-query-and-controls-to-enter-the-parameters"></a>Порядок создания параметризованного запроса и элементов управления для ввода параметров  
  
1.  Выберите <xref:System.Windows.Forms.DataGridView> управления, а затем выберите **добавить запрос** на **данных** меню.  
  
2.  Тип `FillByCity` в **имя нового запроса** область **Построитель условий поиска** диалоговое окно.  
  
3.  Добавить `WHERE City = @City` в запрос на **текст запроса** области.  
  
     Запрос должен выглядеть примерно следующим образом:  
  
     `SELECT CustomerID, CompanyName, ContactName, ContactTitle, Address, City, Region, PostalCode, Country, Phone, Fax`  
  
     `FROM Customers`  
  
     `WHERE City = @City`  
  
    > [!NOTE]
    >  Источники данных Access и OLE DB используют вопросительный знак ("?") для обозначения параметров, поэтому предложение WHERE может выглядеть следующим образом: `WHERE City = ?`.  
  
4.  Нажмите кнопку **ОК** закрыть **Построитель условий поиска** диалоговое окно.  
  
     Объект **FillByCityToolStrip** добавляется в форму.  
  
## <a name="testing-the-application"></a>Тестирование приложения  
 При запуске приложения открывается ваша форма, готовая к получению входных данных в качестве параметра.  
  
#### <a name="to-test-the-application"></a>Тестирование приложения  
  
1.  Нажмите клавишу F5 для запуска приложения.  
  
2.  Тип **Лондон** в **Город** текстовое поле, а затем нажмите кнопку **FillByCity**.  
  
     Сетка данных заполняется клиентов, соответствующих критериям. В этом примере сетка данных отображает только клиентов, имеющих значение **Лондон** в их **Город** столбца.  
  
## <a name="next-steps"></a>Следующие шаги  
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания параметризованной формы. Ниже приводится перечень рекомендаций, позволяющих улучшить полученный результат.  
  
-   Добавление элементов управления, отображающих связанные данные. Дополнительные сведения см. в разделе [Практическое руководство. Отображение связанных данные в приложении Windows Forms](../data-tools/how-to-display-related-data-in-a-windows-forms-application.md).  
  
-   Изменение набора данных для добавления или удаления объектов базы данных. Дополнительные сведения см. в разделе, посвященном [созданию и настройке наборов данных](../data-tools/create-and-configure-datasets-in-visual-studio.md).  
  
## <a name="see-also"></a>См. также  
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)

