---
title: Поддержка представления нескольких документов | Документация Майкрософт
ms.custom: ''
ms.date: 11/15/2016
ms.prod: visual-studio-dev14
ms.reviewer: ''
ms.suite: ''
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: ''
ms.topic: article
helpviewer_keywords:
- editors [Visual Studio SDK], custom - multiple document views
ms.assetid: c7ec2366-91c4-477f-908d-e89068bdb3e3
caps.latest.revision: 26
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: 6be1e48917c8ad5e7035f01caa4f74b78a6fa3d0
ms.sourcegitcommit: af428c7ccd007e668ec0dd8697c88fc5d8bca1e2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2018
ms.locfileid: "51792259"
---
# <a name="supporting-multiple-document-views"></a>Поддержка представления нескольких документов
[!INCLUDE[vs2017banner](../includes/vs2017banner.md)]

Можно предоставить несколько представлений документа, создав разделяют данные документа и объекты представления документа для редактора. Приведены в некоторых случаях, в которых может потребоваться дополнительный документ-представление.  
  
- Поддержка новых окон: требуется редактора, чтобы предоставить два или несколько представлений одного типа, таким образом, чтобы пользователь, имеющий уже открыт в редакторе окно можно открыть новое окно, выбрав **новое окно** команду **окно** меню.  
  
- Формы и код просмотра поддержки: требуется редактора для создания представлений различных типов. [!INCLUDE[vbprvb](../includes/vbprvb-md.md)], например, предоставляет представление формы и представление кода.  
  
  Дополнительные сведения об этом см. в разделе процедуры CreateEditorInstance в файле EditorFactory.cs в проект пользовательский редактор, созданный шаблона пакета Visual Studio. Дополнительные сведения об этом проекте см. в разделе [Пошаговое руководство: Создание специализированного редактора](../extensibility/walkthrough-creating-a-custom-editor.md).  
  
## <a name="synchronizing-views"></a>Синхронизация представлений  
 При реализации нескольких представлений, объект данных документа несет ответственность за сохранение всех представлений с данными. Событие, обработкой интерфейсы можно использовать <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> для синхронизации нескольких представлений с данными.  
  
 Если вы не используете <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> объект для синхронизации несколько представлений, а затем необходимо реализовать собственную систему событий для обработки изменений, внесенных в объект данных документа. Обновлять несколько представлений, можно использовать разные уровни детализации. С параметром максимальную степень детализации, при вводе в одном представлении другие представления немедленно обновляется. С помощью минимальная степень детализации другие представления не обновляются, пока они активируются.  
  
## <a name="determining-whether-document-data-is-already-open"></a>Определение ли данные документа открыт уже  
 Таблице выполняющихся документов (RDT) в интегрированной среде разработки (IDE) помогает отслеживать ли данные документа уже открыт, как показано на следующей схеме.  
  
 ![График docdataview](../extensibility/media/docdataview.gif "Docdataview")  
Несколько представлений  
  
 По умолчанию каждое представление (объекта представления документа) содержится в свой собственный фрейм окна (<xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame>). Как уже было сказано Однако данные документа могут отображаться в нескольких представлениях. Чтобы включить этот параметр, Visual Studio проверяет RDT, чтобы определить, является ли рассматриваемый документ уже открыт в редакторе. При вызове метода интегрированной среды разработки <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory.CreateEditorInstance%2A> необходимо создавать редактор, отличных от NULL значение, возвращаемое в `punkDocDataExisting` параметр указывает, что документ уже открыт в другом редакторе. Дополнительные сведения о том, как функции RDT, см. в разделе [таблице выполняющихся документов](../extensibility/internals/running-document-table.md).  
  
 В вашей <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory> реализации, проверьте объект данных документа, возвращаемый в `punkDocDataExisting` для определения, подходит ли данные документа для редактора. (Например, только HTML данные должны отображаться с помощью редактора HTML.) При необходимости, фабрикой редактора должен предоставить во втором представлении данных. Если `punkDocDataExisting` параметр не `NULL`, можно либо что объект данных документа открыт в другом редакторе или, скорее всего, что данные документа уже открыт в другое представление с таким же редактора. Если данные документа открыт в другом редакторе, не поддерживает свою фабрику редактора, затем Visual Studio не удается открыть фабрикой редактора. Дополнительные сведения см. в разделе [как: присоединение представления для данных документа](../extensibility/how-to-attach-views-to-document-data.md).

