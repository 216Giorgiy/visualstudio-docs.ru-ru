---
title: "Пошаговое руководство. Вставка текста в документ из панели действий | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "панели действий [разработка решений Office в Visual Studio], добавление элементов управления"
  - "панели действий [разработка решений Office в Visual Studio], создание в Word"
  - "смарт-документы [разработка решений Office в Visual Studio], добавление элементов управления"
  - "смарт-документы [разработка решений Office в Visual Studio], создание в Word"
ms.assetid: fd14c896-5737-4a20-94f7-6064b67112c5
caps.latest.revision: 70
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 69
---
# Пошаговое руководство. Вставка текста в документ из панели действий
  В этом пошаговом руководстве демонстрируется, как создать панель действий в Microsoft Office Word.  Панель действий содержит два основных элемента управления, которые собирают ввод и затем отправляют текст в документ.  
  
 [!INCLUDE[appliesto_wdalldoc](../vsto/includes/appliesto-wdalldoc-md.md)]  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Проектирование интерфейса с помощью элементов управления Windows Forms на элементе управления панели действий.  
  
-   Отображение панели действий при открытии приложения.  
  
> [!NOTE]  
>  Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях.  Эти элементы определяются используемым выпуском Visual Studio и его параметрами.  Дополнительные сведения см. в разделе [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]  
  
-   [!INCLUDE[Word_15_short](../vsto/includes/word-15-short-md.md)] или [!INCLUDE[Word_14_short](../vsto/includes/word-14-short-md.md)].  
  
## Создание проекта  
 Сначала следует создать проект документа Word.  
  
#### Создание нового проекта  
  
1.  Создайте проект документа Word с именем My Basic Actions Pane.  Выберите в мастере **Создать новый документ**.  Дополнительные сведения см. в разделе [Практическое руководство. Создание проектов Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).  
  
     Visual Studio откроет новый документ Word в режиме конструктора и добавит проект **My Basic Actions Pane** в **Обозреватель Решений**.  
  
## Добавление текста и закладок в документ  
 Панель действий будет посылать текст в закладки документа.  Чтобы сконструировать документ, введете какой\-либо текст в основную форму.  
  
#### Добавление текста в документ  
  
1.  Введите следующий текст в документ Word:  
  
     21 марта, 2008  
  
     Имя  
  
     Адрес  
  
     Это пример базовой панели действий в Word.  
  
 Можно добавить элемент управления <xref:Microsoft.Office.Tools.Word.Bookmark> к документу, перетащив его из элемента **Панель элементов** в Visual Studio или используя диалоговое окно **Закладка** в Word.  
  
#### Добавление элемента управления "Закладка" в документ  
  
1.  Из закладки **Элементы управления Word** объекта **Панель элементов** перетащите элемент управления <xref:Microsoft.Office.Tools.Word.Bookmark> в документ.  
  
     Откроется диалоговое окно **Добавление элемента управления "Закладка"**.  
  
2.  Выберите слово **Имя**, не выбирая знак абзаца, и нажмите кнопку **ОК**.  
  
    > [!NOTE]  
    >  Знак абзаца должен находиться вне закладки.  Если знаки абзаца невидимы в документе, щелкните меню **Сервис**, укажите пункт **Средства Microsoft Office Word**, и затем щелкните пункт **Параметры**.  Щелкните вкладку **Вид**, и установите флажок **Знаки абзаца** в разделе **Знаки форматирования** диалогового окна **Параметры**.  
  
3.  В окне **Свойства**, измените свойство **Name** объекта **Bookmark1** на **showName**.  
  
4.  Выберите слово **Адрес**, не выбирая знак абзаца.  
  
5.  На вкладке **Вставка** на ленте, в группе **Связи**, щелкните **Закладка**.  
  
6.  В диалоговом окне **Закладка** введите **showAddress** в поле **Имя закладки** и щелкните пункт **Добавить**.  
  
## Добавление элементов управления на панель действий  
 Для разработки интерфейса панели действий, добавьте элемент управления панели действия к проекту, и затем добавьте элементы управления Windows Forms к элементу управления панели действий.  
  
#### Добавление элемента управления панели действий  
  
1.  Выберите проект **Моя базовая панель действий** в **обозревателе решений**.  
  
2.  В меню **Проект** выберите команду **Добавить новый элемент**.  
  
3.  В диалоговом окне **Добавить новый элемент** щелкните **Элемент управления панелью действий**, назовите элемент управления **InsertTextControl,** и нажмите кнопку **Добавить**.  
  
#### Добавление элементов управления Windows Forms в первый элемент управления панели действий  
  
1.  Если панель действий невидима в конструкторе, дважды щелкните **InsertTextControl**.  
  
2.  Со вкладки **Общие элементы управленияпанели элементов**, перетащите элемент управления **Label** на элемент управления панели действий.  
  
3.  Измените значение свойства **Text** элемента управления "Метка" на **Имя**.  
  
4.  Добавьте элемент управления **TextBox** к элементу управления панели действий и измените следующие свойства.  
  
    |Свойство|Значение|  
    |--------------|--------------|  
    |**Имя**|**getName**|  
    |**Размер**|**130, 20**|  
  
5.  Добавьте второй элемент управления **Label** к элементу управления панели действий и измените значение свойства **Text** на **Address**.  
  
6.  Добавьте второй элемент управления **TextBox** к элементу управления панели действий и измените следующие свойства.  
  
    |Свойство|Значение|  
    |--------------|--------------|  
    |**Имя**|**getAddress**|  
    |**Accepts Return**|**True**|  
    |**Multiline**|**True**|  
    |**Размер**|**130, 40**|  
  
7.  Добавьте элемент управления **Button** к элементу управления панели действий и измените следующие свойства.  
  
    |Свойство|Значение|  
    |--------------|--------------|  
    |**Имя**|**addText**|  
    |**Текст.**|**Атрибут Insert**|  
  
## Добавление кода для вставки текста в документ  
 В панели действий введите код, который вставляет текст и текстовые поля в соответствующие элементы управления <xref:Microsoft.Office.Tools.Word.Bookmark> в документе.  Можно использовать класс `Globals` для доступа к элементам управления в документе из элементов управления в панели действий.  Дополнительные сведения см. в разделе [Глобальный доступ к объектам в проектах Office](../vsto/global-access-to-objects-in-office-projects.md).  
  
#### Вставка текста из панели действий в закладку документа  
  
1.  Добавьте следующий код к обработчику событий <xref:System.Windows.Forms.Control.Click> кнопки **addText**.  
  
     [!code-csharp[Trin_VstcoreActionsPaneWord#8](../snippets/csharp/VS_Snippets_OfficeSP/Trin_VstcoreActionsPaneWord/CS/InsertTextControl.cs#8)]
     [!code-vb[Trin_VstcoreActionsPaneWord#8](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_VstcoreActionsPaneWord/VB/InsertTextControl.vb#8)]  
  
2.  В C\# также необходимо добавить обработчик событий для события нажатия кнопки.  Этот код можно поместить в конструктор `InsertTextControl` после обращения к `IntializeComponent`.  Дополнительные сведения о создании обработчиков событий см. в разделе [Практическое руководство. Создание обработчиков событий в проектах Office](../vsto/how-to-create-event-handlers-in-office-projects.md).  
  
     [!code-csharp[Trin_VstcoreActionsPaneWord#9](../snippets/csharp/VS_Snippets_OfficeSP/Trin_VstcoreActionsPaneWord/CS/InsertTextControl.cs#9)]  
  
## Добавление кода для показа панели действий  
 Чтобы показать панель действий, добавьте элемент управления, включенный в коллекцию элемента управления.  
  
#### Отображение панели действий  
  
1.  Создайте новый экземпляр управляющего элемента панели действий в классе `ThisDocument`.  
  
     [!code-csharp[Trin_VstcoreActionsPaneWord#10](../snippets/csharp/VS_Snippets_OfficeSP/Trin_VstcoreActionsPaneWord/CS/ThisDocument.cs#10)]
     [!code-vb[Trin_VstcoreActionsPaneWord#10](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_VstcoreActionsPaneWord/VB/ThisDocument.vb#10)]  
  
2.  Добавьте следующий код в обработчик событий <xref:Microsoft.Office.Tools.Word.Document.Startup> книги `ThisDocument`.  
  
     [!code-csharp[Trin_VstcoreActionsPaneWord#11](../snippets/csharp/VS_Snippets_OfficeSP/Trin_VstcoreActionsPaneWord/CS/ThisDocument.cs#11)]
     [!code-vb[Trin_VstcoreActionsPaneWord#11](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_VstcoreActionsPaneWord/VB/ThisDocument.vb#11)]  
  
## Тестирование приложения  
 Протестируйте документ, чтобы убедиться, что панель действий открывается при открытии документа и что текст, вводимый в текстовые поля, помещается в закладки при нажатии кнопки.  
  
#### Проверка документа  
  
1.  Нажмите клавишу F5 для запуска проекта.  
  
2.  Убедитесь, что панель действий отображается.  
  
3.  Введите имя и адрес в текстовые поля в панели действий и щелкните **Вставить**.  
  
## Следующие действия  
 Далее будут рассмотрены следующие задачи:  
  
-   Создание панели действий в Excel.  Дополнительные сведения см. в разделе [How to: Add an Actions Pane to Excel Workbooks](http://msdn.microsoft.com/ru-ru/62abfce6-e44f-419d-85d8-26bf59f33872).  
  
-   Привязка данных к элементам управления в панели действий.  Дополнительные сведения см. в разделе [Пошаговое руководство. Привязка данных к элементам управления в панели действий Word](../vsto/walkthrough-binding-data-to-controls-on-a-word-actions-pane.md).  
  
## См. также  
 [Общие сведения о панели действий](../vsto/actions-pane-overview.md)   
 [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md)   
 [How to: Add an Actions Pane to Excel Workbooks](http://msdn.microsoft.com/ru-ru/62abfce6-e44f-419d-85d8-26bf59f33872)   
 [Практическое руководство. Управление структурой элементов управления в панели действий](../vsto/how-to-manage-control-layout-on-actions-panes.md)   
 [Элементы управления Bookmark](../vsto/bookmark-control.md)  
  
  