---
title: "Общие сведения об использовании элементов управления Windows Forms в документах Office | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "ошибочное отображение старых данных [разработка решений Office в Visual Studio]"
  - "элементы управления Windows Forms [разработка решений Office в Visual Studio], Word"
  - "элементы управления Windows Forms [разработка решений Office в Visual Studio], добавление"
  - "элементы управления Windows Forms [разработка решений Office в Visual Studio], выравнивание"
  - "данные [разработка решений Office в Visual Studio], ошибочное отображение старых данных"
  - "пользовательские элементы управления [разработка решений Office в Visual Studio], Windows Forms"
  - "Windows Forms - элементы управления [разработка решений Office в Visual Studio]"
  - "элементы управления Windows Forms [разработка решений Office в Visual Studio], удаление"
  - "разработка приложений [разработка решений Office в Visual Studio], элементы управления Windows Forms"
  - "элементы управления [разработка решений Office в Visual Studio], элементы управления Windows Forms"
  - "Office [разработка решений Office в Visual Studio], элементы управления Windows Forms"
  - "документы Office [разработка решений Office в Visual Studio], элементы управления"
  - "документы [разработка решений Office в Visual Studio], элементы управления Windows Forms"
  - "настройки уровня документа [разработка решений Office в Visual Studio], элементы управления Windows Forms"
  - "элементы управления Windows Forms [разработка решений Office в Visual Studio], сведения об элементах управления Windows Forms"
  - "приложения Office [разработка решений Office в Visual Studio], Windows Forms"
ms.assetid: a959506b-5038-49c2-831a-d63c6d6b797d
caps.latest.revision: 76
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 75
---
# Общие сведения об использовании элементов управления Windows Forms в документах Office
  Элементы управления Windows Forms — это объекты, с которыми пользователи могут взаимодействовать для ввода данных и работы с ними. В проектах для Microsoft Office Excel или Microsoft Office Word на уровне документа можно добавлять элементы управления Windows Forms в документ или книгу в проекте во время проектирования или добавить их программными средствами в среде выполнения. Программными средствами в среде выполнения эти элементы управления можно добавлять в любой открытый документ или книгу в надстройке VSTO для Excel или Word.  
  
 Дополнительные сведения см. в разделе [Практическое руководство. Добавление элементов управления Windows Forms в документы Office](../vsto/how-to-add-windows-forms-controls-to-office-documents.md).  
  
 [!INCLUDE[appliesto_controls](../vsto/includes/appliesto-controls-md.md)]  
  
## Использование элементов управления Windows Forms  
 Вы можете добавлять элементы управления Windows Forms в документы и в элементы настраиваемого пользовательского интерфейса, включая панели действий, настраиваемые области задач и Windows Forms. В целом элементы управления Windows Forms действуют в документах так же, как в других элементах пользовательского интерфейса, однако существуют некоторые различия. Сведения см. в разделе [Ограничения по использованию элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md).\)  
  
 Целесообразность добавления элементов управления Windows Forms в документ или в какой\-либо другой элемент пользовательского интерфейса определяется несколькими факторами. При разработке пользовательского интерфейса решения рассмотрите возможность использования элементов управления Windows Forms, как описано в следующей таблице.  
  
 В документе.  
 -   Если требуется отображать элементы управления 100 % времени.  
  
-   Если пользователи должны вводить данные непосредственно в документ: например, в документах на основе форм, в которых поверхность редактирования заблокирована.  
  
-   Если вы хотите, чтобы элементы управления отображались в одну линию с данными в документе. Например при добавлении кнопок к каждой строке объекта\-списка требуется, чтобы они находились в одной строке с каждым элементом списка.  
  
 В области действий или в настраиваемой области задач.  
 -   Если требуется предоставлять пользователю контекстную информацию.  
  
-   Если требуется, чтобы в документе отображались только результаты, но не элементы управления запроса и данные.  
  
-   Если необходимо обеспечить, чтобы элементы управления не печатались вместе с документом.  
  
-   Если необходимо обеспечить, чтобы элементы управления не влияли на представление документа.  
  
 В форме Windows.  
 -   Если требуется управлять размерами элементов пользовательского интерфейса.  
  
-   Если требуется запретить пользователям скрытие или удаление элементов управления.  
  
-   Если требуется получить входные данные от пользователя и предотвратить выполнение любых операций в документе, пока не будут получены эти входные данные.  
  
## Добавление элементов управления Windows Forms программными средствами  
 В документы Word или листы Excel вы можете добавлять элементы управления Windows Forms в среде выполнения.[!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] предоставляет вспомогательные методы для добавления наиболее распространенных элементов управления Windows Forms. Эти вспомогательные методы позволяют быстро добавлять элементы управления в документ Office и получать доступ к объединенным функциональным возможностям элементов управления Windows Forms и их функциям, связанным с Office.  
  
 Дополнительные сведения см. в разделе [Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md).  
  
## Использование элементов управления Windows Forms в проектах уровня документа  
 Некоторые аспекты использования элементов управления Windows Forms в документах, относящиеся только к проектам уровня документа, позволяют создавать пользовательский интерфейс документа с помощью конструктора Visual Studio.  
  
### Создание настраиваемых пользовательских элементов управления  
 Вы можете добавить в проект пользовательский элемент управления, а затем добавить его в **панель элементов**. Далее можно перетаскивать этот пользовательский элемент управления непосредственно в документ так же, как это делается с элементом управления Windows Forms. Существуют некоторые особенности, которые необходимо учитывать при создании пользовательских элементов управления.  
  
-   Не создавайте пользовательский элемент управления **sealed**. При перетаскивании элемента управления в документ Visual Studio создает класс\-оболочку, производный от пользовательского элемента управления, для его расширения и поддержки его использования в документах. Если пользовательский элемент управления — **sealed**, Visual Studio не может создать класс\-оболочку.  
  
-   Пользовательские элементы управления должны иметь атрибут <xref:System.Runtime.InteropServices.ComVisibleAttribute>, установленный в значение **true**. У пользовательских элементов управления, созданных в проекте Office, этот атрибут имеет значение **true** по умолчанию, но у пользовательских элементов управления, являющихся частью внешних проектов, этот атрибут может не иметь значение **true**.  
  
-   После добавления пользовательского элемента управления в документ не переименовывайте класс <xref:System.Windows.Forms.UserControl> и не удаляйте его из проекта. Если вам нужно изменить имя пользовательского элемента управления, то необходимо сначала удалить его из документа, а после изменения имени снова его добавить.  
  
### Выравнивание элементов управления во время разработки  
 При добавлении нескольких элементов управления в документы Word и Excel во время разработки вы можете быстро настроить выравнивание для всех выбранных элементов управления с помощью панелей инструментов **Microsoft Office Word** и **Microsoft Office Excel** в Visual Studio. Эти панели инструментов доступны только в том случае, если документ или лист открыт в конструкторе.  
  
 Выбрав несколько элементов управления в конструкторе, вы можете упорядочить их с помощью следующих кнопок на этих панелях инструментов:  
  
-   **Выравнивание левых границ**  
  
-   **Выравнивание по центру**  
  
-   **Выравнивание правых границ**  
  
-   **Выравнивание верхних границ**  
  
-   **Выравнивание по середине**  
  
-   **Выравнивание нижних границ**  
  
-   **Сделать интервалы по горизонтали равными**  
  
-   **Сделать интервалы по вертикали равными**  
  
> [!NOTE]  
>  В проектах Word эти кнопки включены только в том случае, если выбранные элементы управления не находятся в текстовой строке. По умолчанию элементы управления, добавляемые в документ во время разработки, находятся в текстовых строках.  
  
### Предотвращение отображения старых данных в книгах Excel во время загрузки  
 Если вы добавляете элементы управления Windows Forms в документы или листы во время разработки, элементы управления остаются в документе, когда пользователь закрывает документ. Элементы управления, добавленные во время разработки, также называются *статическими элементами управления*.  
  
 При открытии книги Excel, содержащей статические элементы управления, эта книга отображает растровое изображение элемента управления в элементе управления ActiveX, пока выполняется код настройки и загружается фактический элемент управления. Excel создает это растровое изображение и сохраняет его в книге при каждом сохранении книги. Это растровое изображение показывает элемент управления в том виде, в каком он был при последнем сохранении книги, включая все данные, которые в нем отображались. Дополнительные сведения об элементе управления ActiveX, содержащем элементы управления Windows Forms и растровые изображения, см. в разделе [Ограничения по использованию элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md).  
  
 В определенных условиях код не загружается и отображается только растровое изображение, например когда пользователь открывает книгу в режиме конструктора. Кроме того, если пользователь открывает книгу на компьютере, на котором не установлена среда выполнения [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)], настройка для загрузки элементов управления не может быть запущена, и поэтому отображается только растровое изображение элемента управления. Всегда следует удалять личные сведения из элементов управления в книгах, прежде чем сохранить книгу и отправить ее другому пользователю, чтобы ваши личные сведения не были случайно раскрыты.  
  
### Соответствие размера элемента управления размеру ячейки на листе Excel  
 Вы можете задать автоматическое изменение размера элемента управления при изменении размера его родительской ячейки. Для получения дополнительной информации см. [Практическое руководство. Изменение размера внутри ячеек листа Excel](../vsto/how-to-resize-controls-within-worksheet-cells.md).  
  
### Добавление компонентов, совместно используемых всеми листами  
 Вы можете добавлять компоненты, которые будут совместно использоваться всеми листами, такие как <xref:System.Data.DataSet>, не в сами листы, а в конструктор книги. Такой компонент будет отображаться в области компонентов.  
  
### Формула для внедрения элементов управления на лист Excel  
 При выборе элемента управления в Excel вы увидите **\=EMBED\("WinForms.Control.Host",""\)**  в **строке формул**. Этот текст обязательный, его не следует удалять.  
  
### Стиль макета элементов управления в документе Word  
 При добавлении элемента управления в документ Word в проекте уровня документа с помощью конструктора Visual Studio этот элемент управления добавляется в тексте. Чтобы изменить стиль макета элемента управления, щелкните правой кнопкой мыши элемент управления и выберите пункт **Формат элемента управления**. Выберите стиль обтекания на странице **Макет** диалогового окна **Формат объекта**.  
  
 При добавлении элемента управления в документ Word в среде выполнения вы можете указать стиль макета нового элемента управления с помощью различных перегрузок метода `Add`\<*класс элемента управления*\> класса <xref:Microsoft.Office.Tools.Word.ControlCollection>.  
  
-   Чтобы добавить элемент управления в тексте, используйте перегрузку, которая принимает объект <xref:Microsoft.Office.Interop.Word.Range>, указывающий расположение элемента управления.  
  
-   Чтобы добавить элемент управления как перемещаемую форму, используйте перегрузку, которая принимает верхнюю и левую координаты элемента управления.  
  
 Для получения дополнительной информации см. [Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md).  
  
 При открытии шаблона Word в конструкторе Visual Studio не являющиеся встроенными элементы управления шаблона могут не отображаться, поскольку Visual Studio открывает шаблон в **обычном** режиме. Чтобы увидеть эти элементы управления, измените режим представления на **режим разметки**.  
  
### Элементы управления вне основного текста документа  
 Элементы управления Windows Forms не поддерживаются в верхнем и нижнем колонтитуле, а также внутри вложенного документа.  
  
### Добавление компонентов во время разработки  
 Некоторые компоненты или элементы управления отображаются не в документе, а в области компонентов. Visual Studio предоставляет область компонентов для каждого окна документа. Область компонентов отображается на экране, только если в этом документе существуют компоненты.  
  
## См. также  
 [Элементы управления в документах Office](../vsto/controls-on-office-documents.md)   
 [Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md)   
 [Общие сведения о ведущих элементах и элементах управления ведущего приложения](../vsto/host-items-and-host-controls-overview.md)   
 [Общие сведения о панели действий](../vsto/actions-pane-overview.md)   
 [Элементы управления Windows Forms](http://msdn.microsoft.com/library/f050de8f-4ebd-4042-94b8-edf9a1dbd52a)   
 [Ограничения по использованию элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md)   
 [Практическое руководство. Добавление элементов управления Windows Forms в документы Office](../vsto/how-to-add-windows-forms-controls-to-office-documents.md)   
 [Практическое руководство. Изменение размера внутри ячеек листа Excel](../vsto/how-to-resize-controls-within-worksheet-cells.md)   
 [Практическое руководство. Скрытие элементов управления на листах при печати](../vsto/how-to-hide-controls-on-worksheets-when-printing.md)   
 [Пошаговое руководство. Изменение форматирования листа с использованием элементов управления CheckBox](../vsto/walkthrough-changing-worksheet-formatting-using-checkbox-controls.md)   
 [Пошаговое руководство. Изменение форматирования документа с использованием элементов управления CheckBox](../vsto/walkthrough-changing-document-formatting-using-checkbox-controls.md)   
 [Пошаговое руководство. Отображение текста в текстовом поле рабочего листа с помощью кнопки](../vsto/walkthrough-displaying-text-in-a-text-box-in-a-worksheet-using-a-button.md)   
 [Пошаговое руководство. Отображение текста в текстовом поле документа с помощью кнопки](../vsto/walkthrough-displaying-text-in-a-text-box-in-a-document-using-a-button.md)   
 [Ограничения по использованию элементов управления Windows Forms в документах Office](../vsto/limitations-of-windows-forms-controls-on-office-documents.md)   
 [Пошаговое руководство. Обновление диаграммы в документе с помощью переключателей](../vsto/walkthrough-updating-a-chart-in-a-document-using-radio-buttons.md)   
 [Пошаговое руководство. Обновление диаграммы на листе с помощью переключателей](../vsto/walkthrough-updating-a-chart-in-a-worksheet-using-radio-buttons.md)  
  
  