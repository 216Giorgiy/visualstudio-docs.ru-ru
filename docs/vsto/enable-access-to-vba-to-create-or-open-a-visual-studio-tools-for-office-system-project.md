---
title: Включение доступа к коду VBA, чтобы создать или открыть Visual Studio Tools для системы Microsoft Office project
decsprition: You must explicitly enable access to the Office VBA project system before you can create or open a Visual Studio Tools for Office system project
ms.custom: ''
ms.date: 02/02/2017
ms.technology: office-development
ms.prod: visual-studio-dev15
ms.topic: conceptual
f1_keywords:
- vst.project.vbawrongversion
- VST.Project.VBASecurityGenericError
- VST.Project.VBASecurityPermissions
- VST.SelectDocWizard.MissingCOM
- VST.Project.VBASecurityNotSet
dev_langs:
- VB
- CSharp
author: TerryGLee
ms.author: tglee
manager: douge
ms.workload:
- office
ms.openlocfilehash: f17c4e1481e7f33034e16d1e60a285b25c6f8230
ms.sourcegitcommit: 1466ac0f49ebf7448ea4507ae3f79acb25d51d3e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/22/2018
---
# <a name="enable-access-to-vba-to-create-or-open-a-visual-studio-tools-for-the-microsoft-office-system-project"></a>Включение доступа к коду VBA, чтобы создать или открыть Visual Studio Tools для системы Microsoft Office project

Прежде чем можно будет создать или открыть Visual Studio Tools для системы Microsoft Office project, необходимо явно включить доступ к Visual Basic для приложений (VBA) система проектов в Microsoft Office.

 Разработка проектов Microsoft Office требуется доступ к Visual Basic для приложений (VBA) система проектов Microsoft Office Word и Microsoft Office Excel, даже если проекты не используют Visual Basic для приложений. Поддержка элементов управления времени разработки в проектах Visual Basic и C# зависит от системы проектов Visual Basic для приложений.

 Некоторые макровирусы Microsoft Office пытаются автоматизировать систему проектов Visual Basic для приложений как способ своего распространения. Разрешая доступ к системе проектов Visual Basic для приложений, вы отключаете средство защиты, которое позволяет предотвратить распространение макровирусов. Тем не менее, остаются стандартные средства обеспечения безопасности макросов: уровень безопасности макросов и список надежных издателей, поддерживаемый для приложений Office, помогут выявить выполнение макросов на компьютере.

> [!NOTE]
> Это касается только компьютера разработки. Компьютеры конечных пользователей не обязательно включать эту возможность для запуска решений Office.

 Важно отметить, что отключение доступа к системе проектов Visual Basic для приложений само по себе не защитит вас от вирусов, оно просто помогает предотвратить распространение некоторых вирусов в другие документы в случае заражения компьютера макровирусом. Эта возможность отключена по умолчанию, что обеспечивает дополнительный уровень защиты компьютера. Однако ее включение не делает ваш компьютер более подверженным атакам, если вы выполняете рекомендации по обеспечению безопасности.

 Лучший способ защиты от макровирусов Office — выполнение приложений Office с высоким или очень высоким уровнем безопасности, чтобы доверять макросам только из проверенных и известных источников оставаться в курсе последних исправлений системы безопасности и антивирусных программ.

 Дополнительные сведения о защите компьютера от вирусов и другого вредоносного кода см. в разделе [ http://www.microsoft.com/protect ](http://www.microsoft.com/protect).

 Можно включить или отключить параметр **Доверять доступ к проекту Visual Basic** вручную.

 При появлении ошибок VBA или COM можно восстановить установку Office.

## <a name="to-enable-or-disable-access-to-visual-basic-projects"></a>Чтобы включить или отключить доступ к проектам Visual Basic

1. Перейдите на вкладку **Файл** .

2. Щелкните **Параметры**.

3. Нажмите кнопку **Центр управления безопасностью**, а затем нажмите кнопку **параметры центра управления безопасностью**.

4. В **Центр управления безопасностью**, нажмите кнопку **параметры макросов**.

5. Установите или снимите **Доверять доступ к объектной модели project VBA** для включения или отключения доступа к проектам Visual Basic.

6. Нажмите кнопку **ОК**.

### <a name="to-enable-or-disable-access-to-visual-basic-projects-with-the-2007-microsoft-office-system"></a>Чтобы включить или отключить доступ к проектам Visual Basic в выпуске 2007 системы Microsoft Office

1. На **средства** меню в Word или Excel наведите указатель **макрос**, а затем нажмите кнопку **безопасности**.

2. В **безопасности** диалоговое окно, нажмите кнопку **Доверенные издатели** вкладки.

3. Выберите для включения или снимите флажок, чтобы отключить, **Доверять доступ к проекту Visual Basic**.

4. Нажмите кнопку **ОК**.

## <a name="to-set-your-office-macro-security-level"></a>Настройка уровня безопасности макросов в Office

1. Перейдите на вкладку **Файл** .

2. Щелкните **Параметры**.

3. Нажмите кнопку **Центр управления безопасностью**, а затем нажмите кнопку **параметры центра управления безопасностью**.

4. В **Центр управления безопасностью**, нажмите кнопку **параметры макросов**.

5. В **параметры макросов** выберите необходимый вариант.

6. Нажмите кнопку **ОК**.

### <a name="to-set-your-office-macro-security-level-with-the-2007-microsoft-office-system"></a>Чтобы задать уровень безопасности макросов Microsoft Office в выпуске 2007 системы Microsoft Office

1. На **средства** меню в Word или Excel наведите указатель **макрос**, а затем нажмите кнопку **безопасности**.

2. На **уровень безопасности** выберите необходимый вариант.

    **Уровень безопасности** вкладка содержит сведения о каждом уровне. Дополнительные сведения см. в разделе "Уровни безопасности макросов" справки Microsoft Office.

### <a name="to-install-vba-with-the-2007-microsoft-office-system"></a>Установка VBA в выпуске 2007 системы Microsoft Office

1. В панели управления запустите **Установка и удаление программ** или **программы и компоненты**.

2. Установите Office в **установленные программы** списка.

3. Щелкните **Изменить**.

4. Выберите **добавить или удалить компоненты**, а затем нажмите кнопку **Продолжить**.

5. Выберите **Расширенная настройка приложений**, а затем нажмите кнопку **Далее**.

6. Разверните **Общие средства Office** в **Выбор параметров обновления для приложений и средств** списка.

7. Откройте раскрывающееся меню рядом со **Visual Basic для приложений**, а затем нажмите кнопку **запускать с моего компьютера**.

8. Нажмите кнопку **Продолжить**.

9. Нажмите кнопку **Закрыть**.

## <a name="to-repair-your-installation-of-office"></a>Восстановление установки Office

1. В панели управления запустите **Установка и удаление программ** или **программы и компоненты**.

2. Выберите нужную версию Office в **установленные программы** списка.

3. Щелкните **Изменить**.

4. Выберите **переустановить или восстановить**, а затем нажмите кнопку **Далее**.

5. Выберите **найти и исправить ошибки в установке Office**, а затем нажмите кнопку **установить**.

## <a name="see-also"></a>См. также

 [Безопасные решения Office](../vsto/securing-office-solutions.md)