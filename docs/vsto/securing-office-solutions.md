---
title: "Обеспечение безопасности решений Office | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "Office - приложения [разработка решений Office в Visual Studio], безопасность"
  - "Office - разработка решений в Visual Studio, безопасность"
  - "безопасность [разработка решений Office в Visual Studio]"
ms.assetid: af840916-dda4-4e52-b536-802ebcab30ca
caps.latest.revision: 78
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 77
---
# Обеспечение безопасности решений Office
  Модель безопасности для решений Office использует несколько технологий: [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)], [!INCLUDE[ndptecclick](../vsto/includes/ndptecclick-md.md)], центр управления безопасностью в Microsoft Office и зону ограниченных узлов браузера Internet Explorer. Работа различных функций безопасности описана в следующих разделах.  
  
-   [Присвоение уровня доверия решениям Office](#GrantingTrustToSolutions)  
  
-   [Присвоение уровня доверия документам](#GrantingTrustToDocuments)  
  
-   [Предоставление доверия при использовании установщика Windows](#GrantingTrustWindowsInstaller)  
  
-   [Рекомендации по обеспечению безопасности для решений Office](#Security)  
  
-   [Безопасность во время разработки](#SecurityDuringDeployment)  
  
-   [Набор средств Visual Studio для Office \(среда выполнения\)](#VisualStudioToolsForOfficeRuntime)  
  
 [!INCLUDE[appliesto_all](../vsto/includes/appliesto-all-md.md)]  
  
##  <a name="GrantingTrustToSolutions"></a> Присвоение уровня доверия решениям Office  
 Присвоение уровня доверия решениям Office означает изменение политики безопасности для каждого конечного пользователя таким образом, что доверие решению Office предоставляется на основании следующего свидетельства.  
  
-   Сертификат, используемый для подписания манифеста развертывания.  
  
-   URL\-адрес манифеста развертывания.  
  
 Дополнительные сведения см. в разделе [Присвоение уровня доверия решениям Office](../vsto/granting-trust-to-office-solutions.md).  
  
##  <a name="GrantingTrustToDocuments"></a> Присвоение уровня доверия документам  
 Настройка уровня документа требует, чтобы документ находился в каталоге, назначенном в качестве надежного расположения.  Дополнительные сведения см. в разделе [Присвоение уровня доверия документам](../vsto/granting-trust-to-documents.md).  
  
##  <a name="GrantingTrustWindowsInstaller"></a> Предоставление доверия при использовании установщика Windows  
 Чтобы создать MSI\-файл для установки решений Office в каталог Program Files, можно использовать установщик Windows. Для этого требуются права администратора.  В случае размещения решений Office в каталоге Program Files среда выполнения набора средств Visual Studio 2010 для Office считает эти решения Office доверенными и не выводит запрос о доверии ClickOnce.  
  
##  <a name="Security"></a> Рекомендации по обеспечению безопасности для решений Office  
 Средства безопасности, предоставляемые [!INCLUDE[net_v40_short](../sharepoint/includes/net-v40-short-md.md)], [!INCLUDE[net_v45](../vsto/includes/net-v45-md.md)] и Microsoft Office, помогают защитить решения Office от различных угроз безопасности.  Дополнительные сведения см. в разделе [Рекомендации по обеспечению безопасности для решений Office](../vsto/specific-security-considerations-for-office-solutions.md).  
  
##  <a name="SecurityDuringDeployment"></a> Безопасность во время разработки  
 Чтобы упростить процесс разработки, Visual Studio задает политику безопасности, требуемую для выполнения и отладки решения на компьютере, при каждой сборке проекта.  В некоторых случаях могут потребоваться дополнительные меры обеспечения безопасности при разработке проекта.  
  
### Решения уровня документа  
 При разработке следующих типов проектов необходимо добавить полный путь к документу в список надежных расположений в приложении Microsoft Office.  
  
-   Решения уровня документа, которые находятся в общей сетевой папке, например *\\\\servername\\sharename*.  
  
-   Решения уровня документа для Word, использующие файлы с расширениями DOC и DOCM.  
  
 При добавлении местоположения документа в список надежных расположений включите подкаталоги или конкретно укажите папки для отладки и сборки.  Дополнительные сведения см. в статье справки Microsoft Office Online [Создание, удаление или изменение надежного расположения для файлов](https://support.office.com/en-au/article/Create-remove-or-change-a-trusted-location-for-your-files-f5151879-25ea-4998-80a5-4208b3540a62).  
  
### Временные сертификаты  
 Если сертификат для подписи еще не существует, Visual Studio создает временный сертификат.  Этот временный сертификат следует использовать только во время разработки, а для развертывания необходимо приобрести официальный сертификат.  
  
 Временный сертификат создается после первой сборки проекта Office.  При последующем нажатии клавиши F5 сборка проекта выполняется заново, поскольку проект помечается как измененный при добавлении сертификата.  
  
 Через некоторое время может накопиться большое количество временных сертификатов, поэтому их нужно периодически удалять.  
  
##  <a name="VisualStudioToolsForOfficeRuntime"></a> Набор средств Visual Studio для Office \(среда выполнения\)  
 [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] имеет функции для проверки удостоверения издателя и разрешений, выданных для настройки.  Он проверяет разрешения, выполняя последовательность проверок безопасности.  
  
### Безопасность во время загрузки настройки  
 Во время загрузки настройки уровня документа [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] всегда проверяет, находится ли документ в списке надежных расположений.  Кроме того, среда выполнения проверяет, запрашивает ли решение разрешения FullTrust в манифесте приложения. Во время загрузки настройки он не выполняет дополнительные проверки безопасности.  
  
### Последовательность проверок безопасности во время установки  
 При установке или обновлении решения Office [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] выполняет ряд проверок безопасности в определенной последовательности для принятия решения о доверии.  Решение устанавливается или обновляется только в том случае, если среда выполнения определяет, что это решение является доверенным.  
  
 Процесс установки можно запустить одним из четырех способов: с помощью программы установки, открыв манифест развертывания, открыв узел приложения Microsoft Office или запустив файл VSTOInstaller.exe.  
  
 Первая проверка безопасности применяется только к решениям уровня документа.  Документ, принадлежащий решению уровня документа, должен находиться в надежном расположении.  Если документ находится в удаленной сетевой общей папке либо имеет расширение имени файла DOC или DOCM, расположение документа необходимо добавить в список надежных расположений.  Дополнительные сведения см. в разделе [Присвоение уровня доверия документам](../vsto/granting-trust-to-documents.md).  
  
 ![Безопасность VSTO – установка с Microsoft Office](../vsto/media/host-install.png "Безопасность VSTO – установка с Microsoft Office")  
  
 Следующий набор проверок безопасности выполняется [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] и ClickOnce.  Чтобы пройти эти проверки, решения Office должны запрашивать разрешения FullTrust, должны быть подписаны сертификатом, отсутствующим в списке издателей, к которым нет доверия, и должны находиться в расположении, не входящем в зону ограниченных узлов браузера Internet Explorer.  Если сертификат находится в списке надежных издателей, решение устанавливается немедленно.  В противном случае, если решение проходит все проверки, оно передается на последний этап проверок.  
  
 ![Безопасность VSTO для установки решений](../vsto/media/installing.png "Безопасность VSTO для установки решений")  
  
 Если разрешен запрос о доверии [!INCLUDE[ndptecclick](../vsto/includes/ndptecclick-md.md)] и решению еще не присвоен уровень доверия, среда выполнения предоставляет возможность принять решение о доверии конечному пользователю.  Если пользователь предоставляет решению доверие, в пользовательский список включения добавляется запись.  Все решения в пользовательском списке включения имеют полное доверие и могут быть установлены и запущены.  
  
 Начиная с версии Visual Studio 2010, список включения игнорируется в том случае, если решение Office установлено с помощью установщика Windows \(MSI\) в каталог Program Files.  Дополнительные сведения см. в разделе [Предоставление доверия решениям Office с помощью списков включения](../vsto/trusting-office-solutions-by-using-inclusion-lists.md).  
  
 ![Безопасность VSTO – установка с помощью программы установки](../vsto/media/setup-vstoinstaller.png "Безопасность VSTO – установка с помощью программы установки")  
  
## См. также  
 [Присвоение уровня доверия решениям Office](../vsto/granting-trust-to-office-solutions.md)   
 [Присвоение уровня доверия документам](../vsto/granting-trust-to-documents.md)   
 [Предоставление доверия решениям Office с помощью списков включения](../vsto/trusting-office-solutions-by-using-inclusion-lists.md)   
 [Практическое руководство. Настройка безопасности списка включения](../vsto/how-to-configure-inclusion-list-security.md)   
 [Практическое руководство. Подписывание решений Office](../vsto/how-to-sign-office-solutions.md)   
 [Устранение неполадок, связанных с безопасностью решений Office](../vsto/troubleshooting-office-solution-security.md)   
 [Манифесты приложений для решений Office](../vsto/application-manifests-for-office-solutions.md)   
 [Манифесты развертывания для решений Office](../vsto/deployment-manifests-for-office-solutions.md)   
 [Справочные сведения ClickOnce](../deployment/clickonce-reference.md)   
 [Развертывание решения Office](../vsto/deploying-an-office-solution.md)  
  
  