---
title: "Практическое руководство. Выполнение с выделенным кодом документов с ограниченными разрешениями"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "код [разработка решений Office в Visual Studio], выполнение перед документами с ограниченным доступом"
  - "документы [разработка решений Office в Visual Studio], ограниченные разрешения"
  - "управление правами на доступ к данным [разработка решений Office в Visual Studio]"
  - "IRM [разработка решений Office в Visual Studio]"
  - "Office - документы [разработка решений Office в Visual Studio], ограниченные разрешения"
  - "разрешения [разработка решений Office в Visual Studio"
ms.assetid: d037eae5-cf83-4be0-85ba-05e9f7d570e1
caps.latest.revision: 27
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 26
---
# Практическое руководство. Выполнение с выделенным кодом документов с ограниченными разрешениями
  Чтобы ограничить разрешения для документа или книги, используйте функцию управления правами на доступ к данным \(IRM\) пакета Microsoft Office.  По умолчанию выполнение с выделенным кодом документа Microsoft Office Word или книги Microsoft Office Excel не допускается.  При необходимости можно изменить настройку по умолчанию, чтобы разрешить обращение к объектной модели из расширений управляемого кода и обеспечить работу решения.  
  
 [!INCLUDE[appliesto_alldoc](../vsto/includes/appliesto-alldoc-md.md)]  
  
 Изменять параметры разрешений может только автор документа или книги, а также пользователь, обладающий правами полного доступа к ним.  
  
### Выполнение выделенного кода для документов с ограниченными разрешениями  
  
1.  Откройте документ или книгу в приложении Word или Excel.  
  
2.  Перейдите на вкладку **Файл**, **Подготовить**, **Ограничьте разрешения**, а затем нажмите кнопку **Ограниченный доступ**.  
  
    > [!NOTE]  
    >  При первом использовании отображается запрос на установку клиента управления правами Windows.  После установки клиента может потребоваться повторение этих действий.  
  
3.  В диалоговом окне **Разрешения** выберите пункт **Ограничить разрешения на документ** и нажмите кнопку **Дополнительно**.  
  
4.  В разделе **Дополнительные разрешения для пользователей** выберите пункт **Программный доступ к содержимому**.  
  
 В приложении Word или Excel включается программный доступ к объектной модели.  
  
## См. также  
 [Общие сведения об управлении правами на доступ к данным и расширениях управляемого кода](../vsto/information-rights-management-and-managed-code-extensions-overview.md)   
 [Защита документов в решениях уровня документа](../vsto/document-protection-in-document-level-solutions.md)   
 [Защита паролей в документах Office](../vsto/password-protection-on-office-documents.md)   
 [Проектирование и создание решений Office](../vsto/designing-and-creating-office-solutions.md)   
 [Обеспечение безопасности решений Office](../vsto/securing-office-solutions.md)   
 [Развертывание решения Office](../vsto/deploying-an-office-solution.md)  
  
  