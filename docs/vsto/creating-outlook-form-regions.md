---
title: "Создание областей форм Outlook"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "MICROSOFT.OFFICE.TOOLS.OUTLOOK.FORMREGION"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "области формы [разработка решений Office в Visual Studio]"
  - "области формы [разработка решений Office в Visual Studio], создание"
  - "Outlook [разработка решений Office в Visual Studio], области формы"
ms.assetid: a8005641-cc8b-4e07-8dca-294327cdc8d4
caps.latest.revision: 42
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 41
---
# Создание областей форм Outlook
  Для настройки форм Microsoft Office Outlook можно использовать области формы.  Visual Studio предоставляет расширенные средства, которые упрощают процесс проектирования, разработки и отладки областей формы.  
  
 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]  
  
 В данном разделе содержатся следующие сведения:  
  
-   [Преимущества использования областей формы](#Enhance)  
  
-   [Добавление области формы Outlook в проект](#Adding)  
  
-   [Применение конструктора областей формы](#UsingFormRegionDesigner)  
  
-   [Применение области формы, спроектированной в Outlook](#UsingFormRegionDesignedOutlook)  
  
-   [Добавление пользовательского кода в область формы](#AddingCustomCode)  
  
-   [Сборка проекта](#Building)  
  
-   [Отладка области формы](#Debugging)  
  
-   [Развертывание области формы](#Deploying)  
  
##  <a name="Enhance"></a> Преимущества использования областей формы  
 Области формы значительно расширяют традиционные возможности разработки форм Outlook.  
  
-   Настройка страницы по умолчанию любой стандартной формы.  
  
-   Добавление до 12 дополнительных страниц в любую стандартную форму.  
  
-   Замена или расширение любой стандартной формы.  
  
-   Отображение настраиваемого пользовательского интерфейса в области чтения и в инспекторах.  
  
 Дополнительные сведения см. в разделе [Настройка страниц формы и областей формы](HV10038632).  
  
##  <a name="Adding"></a> Добавление области формы Outlook в проект  
 Для проектирования новой области формы или импорта области формы, спроектированной в Outlook, можно использовать мастер **Новая область формы Outlook**.  Кроме того, если у вас есть область формы, которую вы использовали в другом проекте надстройки Outlook VSTO, то эту область формы можно использовать повторно.  
  
###  <a name="CreatingFormRegion"></a> Создание новой области формы с помощью мастера  
 Для создания области формы добавьте элемент **Область формы Outlook** в проект надстройки Outlook VSTO.  При этом запускается мастер **Новая область формы Outlook**.  
  
 Укажите в мастере, что необходимо сделать — создать новую область формы или импортировать область формы, спроектированную в Outlook.  Дополнительные сведения о проектировании новой области формы см. в разделе [Применение конструктора областей формы](#UsingFormRegionDesigner).  Дополнительные сведения об использовании области формы, спроектированной в Outlook, см. в разделе [Импорт области формы, спроектированной в Outlook](#UsingFormRegionDesignedOutlook).  
  
 Укажите в мастере тип области формы, которую требуется создать.  В следующей таблице указаны все типы областей формы.  
  
|Тип области|Описание|  
|-----------------|--------------|  
|Отдельные|Добавляет область формы как новую страницу в форме Outlook.|  
|Смежные|Добавляет область формы в нижнюю часть страницы по умолчанию формы Outlook.|  
|Замена|Добавляет область формы как новую страницу, которая заменяет страницу по умолчанию формы Outlook.|  
|Заменить все|Заменяет всю форму Outlook на область формы.|  
  
 В мастере также можно указать условия отображения и выбрать тип формы для расширения.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).  
  
 Значения, выбираемые в мастере, влияют на параметры, доступные на других страницах мастера.  Например, если выбрать пункт **Смежные** или **Отдельные** на странице **Создание новой области формы Outlook**, то поля **Заголовок** и **Описание** на странице **Введите текст описания и выберите параметры отображения** будут недоступны.  Это объясняется тем, что при отображении смежной или отдельной области формы Outlook не использует эти поля.  
  
#### Файлы области формы  
 При вводе данных в мастере **Новая область формы Outlook** Visual Studio автоматически добавляет в проект следующие файлы.  
  
-   Файл кода области формы.  Этот файл имеет имя, заданное для элемента **Область формы Outlook** в диалоговом окне **Добавить новый элемент**.  Добавьте код для обработки событий области формы в этот файл.  
  
-   Файл кода конструктора областей формы.  Этот файл содержит код, созданный конструктором областей формы \(его не следует изменять прямо в файле\).  
  
-   Файл хранилища форм Outlook \(OFS\).  
  
    > [!NOTE]  
    >  Этот файл добавляется в проект только при импорте области формы, которая была спроектирована в Outlook.  
  
#### Класс фабрики областей формы  
 Файл кода области формы содержит разделяемый класс, реализующий интерфейс <xref:Microsoft.Office.Tools.Outlook.IFormRegionFactory>.  Это класс фабрики областей формы.  Класс фабрики областей формы отвечает за создание новых экземпляров области формы.  
  
 Для поиска данного класса разверните область **Фабрика областей формы**.  
  
 Мастер **Новая область формы Outlook** добавляет атрибуты в этот класс, которые указывают внутреннее имя области формы и классы сообщений, отображающие область формы.  Эти атрибуты можно изменять вручную после добавления файла в проект.  
  
 Основная часть класса фабрики областей формы реализована в файле конструктора областей формы.  Однако обработчик событий `FormRegionInitializing` предоставляется в файле кода области формы.  Этот обработчик событий можно использовать, чтобы указать, должен ли Outlook отображать область формы.  Дополнительные сведения см. в разделе [Обработка событий области формы](#HandlingFormRegionEvents).  
  
###  <a name="AddingExistingFormRegion"></a> Добавление существующей области формы в проект  
 Если у вас есть область формы Outlook, которую вы использовали в другом проекте Outlook, ее можно повторно использовать в текущем проекте надстройки Outlook VSTO с помощью диалогового окна **Добавление существующего элемента**.  
  
 Существующая область формы должна иметь файл кода \(VB или CS\). С помощью диалогового окна **Добавление существующего элемента** файлы хранилища форм Outlook \(OFS\) добавить невозможно.  Тем не менее новую область формы можно создать путем импорта файла хранилища форм Outlook.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).  
  
##  <a name="UsingFormRegionDesigner"></a> Применение конструктора областей формы  
 Конструктор областей формы позволяет спроектировать макет и внешний вид области формы.  Управляемые элементы управления можно перетаскивать в область конструктора. Для этого дважды щелкните элементы управления, чтобы открыть обработчики событий, и настройте свойства в окне **Свойства**.  
  
> [!NOTE]  
>  Свойства, влияющие на способ отображения области формы в Outlook, находятся в узле **Манифест** окна **Свойства**.  
  
 Конструктор областей формы доступен только в том случае, если установить флажок **Создать новую область формы** на странице **Выберите способ создания области формы** в мастере **Новая область формы Outlook**.  
  
 Чтобы открыть конструктор областей формы, можно использовать три способа.  
  
-   В **обозревателе решений** дважды щелкните файл кода области формы.  
  
-   В **обозревателе решений** щелкните правой кнопкой мыши файл кода области формы и выберите пункт **Конструктор представлений**.  
  
-   В **обозревателе решений** выберите файл кода области формы, а затем в меню **Представление** щелкните **Конструктор**.  
  
 Конструктор областей формы поддерживает только управляемые элементы управления.  Добавлять собственные элементы управления Outlook нельзя.  
  
##  <a name="UsingFormRegionDesignedOutlook"></a> Импорт области формы, спроектированной в Outlook  
 В ходе проектирования в Outlook в область формы можно добавлять собственные элементы управления Outlook.  Собственные элементы управления Outlook позволяют осуществлять привязку к данным Outlook во время разработки.  Тем не менее для добавления управляемых элементов управления или изменения структуры области формы конструктор областей формы использовать нельзя.  
  
 Для импорта областей формы в проект надстройки Outlook VSTO можно использовать мастер **Новая область формы Outlook**.  На странице **Выберите способ создания области формы** выберите **Импортировать файл хранилища форм Outlook \(.ofs\)**.  Затем перейдите в расположение файла хранилища форм Outlook \(OFS\).  \(Outlook сохраняет области формы в виде OFS\-файлов.\)  
  
 Мастер **Новая область формы Outlook** копирует OFS\-файл в каталог проекта и добавляет ссылки на элементы управления в файл конструктора областей формы.  Затем события элементов управления можно обработать в файле кода области формы.  
  
 Для обработки событий в проекте Visual Basic выберите событие в списке имен методов в верхней части редактора кода.  
  
 Для обработки событий в проекте C\# подпишитесь на события элементов управления в методе <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing>.  Дополнительные сведения см. в разделе [Практическое руководство. Подписка и отмена подписки на события &#40;Руководство по программированию в C&#35;&#41;](http://msdn.microsoft.com/library/6319f39f-282c-4173-8a62-6c4657cf51cd).  
  
 Свойства области формы можно изменить в методе `InitializeManifest` класса фабрики областей формы.  
  
> [!NOTE]  
>  Для импорта области формы необходимо работать в проекте, ориентированном на ту же версию Outlook, которая установлена на компьютере разработчика.  Например, если установлен Outlook 2010, импорт формы области будет работать только в проекте, созданном с помощью шаблона проекта **Надстройка Outlook 2010**.  
  
### Обновление импортированного проекта области формы  
 Элементы управления можно добавлять, удалять или изменять в области формы.  Перед этим следует создать резервную копию любого кода, добавленного в файл кода области формы.  Затем откройте OFS\-файл в Outlook, измените область формы и сохраните изменения.  Для импорта измененного OSF\-файла используйте мастер **Новая область формы Outlook**.  Затем код можно вставить в файл кода новой области формы.  
  
##  <a name="AddingCustomCode"></a> Добавление пользовательского кода в область формы  
 Пространство имен <xref:Microsoft.Office.Tools.Outlook> предоставляет доступ к классам, которые представляют область формы, элемент Outlook, отображающий область формы, и другие полезные элементы.  Элемент **Область формы Outlook** автоматически добавляет в проект ссылку на эту сборку и вставляет соответствующий оператор **using** или **Imports** в верхнюю часть файла кода области формы.  
  
 Для выполнения большинства задач программирования для Outlook можно использовать классы, методы и свойства в пространстве имен Microsoft.Office.Interop.Outlook.  Дополнительные сведения об объектной модели Outlook см. в разделе [Общие сведения об объектной модели Outlook](../vsto/outlook-object-model-overview.md).  Примеры типичных задач, в которых используется объектная модель Outlook, см. в разделе [Решения Outlook](../vsto/outlook-solutions.md).  
  
###  <a name="HandlingFormRegionEvents"></a> Обработка событий области формы  
 Элемент **Область формы Outlook** автоматически добавляет в файл кода области формы три следующих обработчика событий.  
  
|Событие|Описание|  
|-------------|--------------|  
|FormRegionInitializing|Возникает перед инициализацией области формы.  В этом обработчике событий можно проверять условия, чтобы указать, должен ли Outlook отображать область формы.  Дополнительные сведения см. в разделе [Практическое руководство. Отсутствие отображения области формы в Outlook](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md).|  
|FormRegionShowing|Возникает после создания экземпляра области формы, но перед отображением области формы.|  
|FormRegionClosed|Возникает перед закрытием области формы.|  
  
##  <a name="Building"></a> Сборка проекта  
 При сборке проекта надстройки Outlook VSTO, содержащего область формы, Visual Studio добавляет в реестр следующую информацию.  
  
-   Раздел для каждого класса сообщений, связанного с одной или несколькими областями формы.  
  
-   Запись для каждой области формы и соответствующее значение, представляющее имя надстройки Outlook VSTO.  
  
 Outlook использует эту информацию для загрузки областей формы.  
  
##  <a name="Debugging"></a> Отладка области формы  
 Надстройку Outlook VSTO, содержащую область формы, можно отлаживать таким же образом, как и другие проекты [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)].  При запуске отладчика [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] Visual Studio автоматически запускает Outlook.  
  
 Для просмотра области формы необходимо открыть соответствующий элемент Outlook.  Например, если смежная область формы добавляется в конец почтового элемента, откройте почтовый элемент.  
  
##  <a name="Deploying"></a> Развертывание области формы  
 Области формы автоматически развертываются вместе со связанной надстройкой Outlook VSTO.  Таким образом, для развертывания области формы никакие специальные действия выполнять не нужно.  Дополнительные сведения о развертывании надстроек VSTO см. в разделе [Развертывание решения Office](../vsto/deploying-an-office-solution.md).  
  
## См. также  
  
|Заголовок|Описание|  
|---------------|--------------|  
|[Рекомендации по созданию областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)|Представлены сведения, которые могут помочь оптимизировать области формы и предотвратить потенциальные проблемы.|  
|[Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)|Демонстрируется создание области формы для расширения стандартной или настраиваемой формы Microsoft Office Outlook с помощью мастера **Новая область формы Outlook**.|  
|[Связывание области формы с классом сообщений Outlook](../vsto/associating-a-form-region-with-an-outlook-message-class.md)|Объясняется, как указать элементы Microsoft Office Outlook, которые будут отображать область формы, путем связывания области формы с классом сообщений каждого элемента.|  
|[Пошаговое руководство. Разработка области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md)|Показано, как проектировать настраиваемую область формы, которая отображается в виде новой страницы в окне инспектора элемента контактов.|  
|[Пошаговое руководство. Импорт области формы, созданной в Outlook](../vsto/walkthrough-importing-a-form-region-that-is-designed-in-outlook.md)|Демонстрируется создание области формы в Microsoft Office Outlook, а затем импорт области формы в проект надстройки Outlook VSTO с помощью мастера **Новая области формы Outlook**.|  
|[Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)|Описывается написание кода для отображения, скрытия или изменения элементов управления в области формы. Пользователям предоставляется возможность выполнить код из других областей проекта с помощью класса `Globals`.|  
|[Практическое руководство. Отсутствие отображения области формы в Outlook](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md)|Показано, как запретить в Microsoft Office Outlook отображение области формы для конкретного элемента.|  
|Показано, как получить доступ к элементу Outlook, в котором отображается область формы.|  
|[Пользовательские действия в областях форм Outlook](../vsto/custom-actions-in-outlook-form-regions.md)|Описывает, как предоставить пользователям возможность реагировать на элемент Outlook.|  
  
  