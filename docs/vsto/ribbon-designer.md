---
title: "Конструктор лент"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "Designer_Microsoft.VisualStudio.Tools.Office.Ribbon.Design.RibbonDesigner"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "элементы управления [разработка решений Office в Visual Studio], лента"
  - "настраиваемая лента"
  - "настраиваемая лента, сведения о конструкторе лент"
  - "настройка ленты"
  - "настройка ленты, сведения о конструкторе лент"
  - "конструкторы [разработка решений Office в Visual Studio], лента"
  - "свойства только для чтения"
  - "лента [разработка решений Office в Visual Studio], общие задачи"
  - "лента [разработка решений Office в Visual Studio], элементы управления"
  - "лента [разработка решений Office в Visual Studio], настройка"
  - "лента [разработка решений Office в Visual Studio], сочетания клавиш"
  - "лента [разработка решений Office в Visual Studio], визуальный конструктор"
  - "конструктор ленты [разработка решений Office в Visual Studio]"
ms.assetid: 26617206-f4da-416f-a18a-d817b2d4872d
caps.latest.revision: 79
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 78
---
# Конструктор лент
  Конструктор лент представляет собой средство визуальной разработки.  Конструктор лент используется для добавления пользовательских вкладок, групп и элементов управления на ленту приложения системы Microsoft Office.  
  
 [!INCLUDE[appliesto_ribbon](../vsto/includes/appliesto-ribbon-md.md)]  
  
 Чтобы открыть конструктор лент, добавьте в проект элемент **Лента \(визуальный конструктор\)**.  Конструктор можно использовать для выполнения указанных ниже задач.  
  
-   [Разработка макета ленты](#DesigningRibbonLayout)  
  
-   [Обработка событий и установка свойств элементов управления](#HandleEventsSetProperties)  
  
-   [Добавление элементов управления в представление Backstage](#CustomizingMicrosoftOfficeButton)  
  
> [!NOTE]  
>  Имеется ряд задач, которые невозможно выполнить с помощью конструктора лент.  Дополнительные сведения об этих задачах и о способах их выполнения см. в разделе [Обзор ленты](../vsto/ribbon-overview.md).  
  
 ![ссылка на видео](~/data-tools/media/playvideo.gif "ссылка на видео") Для просмотра соответствующих демонстрационных видеороликов перейдите по ссылке [How Do I: Use the Ribbon Designer to Customize the Ribbon in Outlook?](http://go.microsoft.com/fwlink/?LinkID=130312).  
  
## Добавление в проект элемента "Лента \(визуальный конструктор\)"  
 Чтобы воспользоваться конструктором лент, добавьте в проект новый элемент **Лента \(визуальный конструктор\)**.  Для получения дополнительной информации см. [Практическое руководство. Работа с настройкой ленты](../vsto/how-to-get-started-customizing-the-ribbon.md).  
  
 При добавлении нового элемента **Лента \(визуальный конструктор\)** Visual Studio автоматически добавляет в проект указанные ниже файлы.  
  
-   Файл кода ленты.  Этому файлу присваивается имя, указанное для элемента **Лента \(визуальный конструктор\)** в диалоговом окне **Добавление нового элемента**.  Добавьте в этот файл код для обработки событий ленты.  
  
-   Файл кода конструктора лент.  Этот файл содержит созданный конструктором лент код, который не следует изменять непосредственно.  
  
-   Файл ресурсов.  Этот файл содержит значения свойств каждого элемента управления на ленте.  
  
 При наличии элемента **Лента \(визуальный конструктор\)** из другого проекта, его можно повторно использовать в текущем проекте, вызвав диалоговое окно **Добавление существующего элемента**.  
  
##  <a name="DesigningRibbonLayout"></a> Разработка ленты  
 Существует три указанных ниже способа открыть конструктор лент.  
  
-   Дважды щелкните файл кода ленты в **обозревателе решений**.  
  
-   В **обозревателе решений** щелкните правой кнопкой мыши файл кода ленты и выберите пункт **Конструктор представлений**.  
  
-   В **обозревателе решений** выделите файл кода ленты, после чего выберите в меню **Вид** пункт **Конструктор**.  
  
 Конструктор лент по умолчанию содержит вкладку и группу.  Из конструктора лент можно удалит вкладку и группу по умолчанию.  Чтобы удалить группу по умолчанию, щелкните группу **Group1** правой кнопкой мыши и выберите пункт **Удалить**.  Чтобы удалить вкладку по умолчанию, щелкните пустое место на рабочей области конструирования правой кнопкой мыши и выберите пункт **Удалить вкладку ленты**.  
  
 В конструктор лент также можно добавить пользовательские вкладки, группы и элементы управления.  Эти элементы управления находятся на **Панели элементов** в группе **Элементы управления ленты Office**.  Существует три указанных ниже способа добавления в конструктор лент элементов управления из группы **Элементы управления ленты Office**.  
  
-   Перетащите элемент управления в необходимое положение на конструкторе лент.  
  
-   Щелкните элемент управления, после чего щелкните необходимое место на конструкторе лент.  
  
-   Выделите на конструкторе лент необходимое место, после чего дважды щелкните элемент управления на **Панели элементов**.  
  
### Процесс разработки ленты  
 Чтобы разработать макет ленты, выполните указанные ниже базовые действия.  
  
1.  [Добавление в ленту пользовательской вкладки](#AddTabToRibbon).  
  
2.  [Добавьте на вкладку группы](#AddGroupsToTab).  
  
3.  [Добавьте в группы элементы управления](#AddControlsToGroups).  
  
 Элементы управления можно перетаскивать только в группы; элемент управления невозможно перетащить непосредственно на вкладку или на ленту.  Группы можно перетаскивать только на вкладки; группу невозможно перетащить непосредственно на ленту.  
  
 Упорядочите элементы управления, перетащив их в нужное положение.  В окне **Свойства** также можно настроить свойства элементов управления.  
  
 Элементы управления нельзя перетаскивать с одной вкладки на ленте на другую вкладку.  Если необходимо переместить элемент управления на другую вкладку, необходимо воспользоваться командой **Вырезать**, чтобы удалить элемент управления с одной вкладки, после чего вставить элемент управления на другую вкладку.  При вырезании и вставке элемента управления обработчик событий перестает работать.  Чтобы заново подключить обработчик событий, воспользуйтесь окном **Свойства**.  Для получения дополнительной информации см. [окно свойств](../ide/reference/properties-window.md).  
  
###  <a name="AddTabToRibbon"></a> Добавление в ленту пользовательских вкладок  
 Существует три способа добавления пользовательской вкладки в ленту.  
  
-   Добавьте вкладку с **Панели элементов**.  
  
-   Щелкните конструктор лент правой кнопкой мыши и выберите команду **Добавить вкладку ленты**.  
  
-   Откройте **Редактор коллекции вкладок** и нажмите кнопку **Добавить**.  
  
     Чтобы открыть **Редактор коллекции вкладок**, выберите в окне **Свойства** свойство **Вкладки** и нажмите кнопку с многоточием ![Эллипс конструктора ASP.NET для мобильных устройств](~/sharepoint/media/mwellipsis.gif "Эллипс конструктора ASP.NET для мобильных устройств").  
  
 После добавления вкладки на нее можно добавить группы, которые будут содержать элементы управления.  
  
#### Удаление пользовательских вкладок из ленты  
 Существует три указанных ниже способа удалить пользовательскую вкладку из ленты.  
  
-   Щелкните конструктор лент правой кнопкой мыши и выберите команду **Удалить вкладку ленты**.  
  
-   В области **Команды** окна **Свойства** нажмите кнопку **Удалить вкладку ленты**.  
  
-   Откройте **Редактор коллекции вкладок**, выделите вкладку и нажмите кнопку **Удалить**.  
  
#### Изменение положения вкладки на ленте  
 Можно изменить порядок пользовательских вкладок на ленте.  Кроме того, пользовательские вкладки можно разместить на ленте до или после встроенной вкладки.  Для получения дополнительной информации см. [Практическое руководство. Изменение положения вкладки на ленте](../vsto/how-to-change-the-position-of-a-tab-on-the-ribbon.md).  
  
#### Настройка встроенных вкладок на ленте  
 Встроенная вкладка — это вкладка, которая уже имеется на ленте приложения Microsoft Office.  Например, вкладка **Данные** является встроенной вкладкой Excel.  
  
 На встроенную вкладку можно добавлять группы и элементы управления.  По умолчанию настраиваемая группа выводится на встроенную вкладку последней, хотя ее можно переместить перед или после любой встроенной группы на вкладке.  
  
 Удалить встроенные группы нельзя.  
  
 Дополнительные сведения о настройке встроенной вкладки см. в разделе [Практическое руководство. Настройка встроенной вкладки](../vsto/how-to-customize-a-built-in-tab.md).  
  
###  <a name="AddGroupsToTab"></a> Добавление групп на вкладку  
 Группы используются для логического упорядочения на ленте элементов управления.  Добавьте группы на вкладки.  Добавьте в группу все необходимые элементы управления.  
  
###  <a name="AddControlsToGroups"></a> Добавление в группы элементов управления  
 Добавьте в группу один или несколько элементов управления.  В приведенной ниже таблице описывается каждый элемент управления.  
  
|Элемент управления|Описание|  
|------------------------|--------------|  
|**Поле**|Контейнер, упорядочивающий элементы управления в группе.  В поле можно добавить любой элемент управления, за исключением разделителя, группы и вкладки.  Поле может быть горизонтальным или вертикальным.|  
|**Кнопка**|Кнопка, запускающая действие.  Кнопку можно добавить в группу, группу кнопок, раскрывающийся список, коллекцию, меню или разворачивающуюся кнопку.|  
|**ButtonGroup**|Группа, содержащая одну или несколько кнопок, выключателей, меню, раскрывающихся кнопок или коллекций.  Группу кнопок можно добавить в группу или меню.|  
|**CheckBox**|Флажок, который можно устанавливать или снимать, чтобы включить или отключить какой\-либо параметр.|  
|**ComboBox**|Поле редактирования со вложенным списком.  Пользователи могут либо ввести значение, либо выбрать значение из списка.  В поле отображается выбранный в настоящее время элемент.  Свойство <xref:Microsoft.Office.Tools.Ribbon.RibbonComboBox.Items%2A> используется для добавления и удаления элементов во время выполнения до или после загрузки ленты в приложение Office.|  
|**DropDown**|Список элементов, которые пользователь может выбирать.  Пользователь не может добавлять в раскрывающийся список новые элементы.<br /><br /> Свойство <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Items%2A> используется для добавления в список элементов.  Элементы можно добавлять и удалять во время выполнения.<br /><br /> Свойство <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Buttons%2A> используется для добавления в список кнопок.  Однако после загрузки ленты в приложение Office добавлять и удалять кнопки во время выполнения нельзя.|  
|**EditBox**|Поле, в которое пользователь может вводить текст.|  
|**Коллекция**|Меню, предоставляющее пользователю для выбора массив или сетку визуальных элементов.  Макет визуальных элементов управления можно изменить.  Свойства <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.ColumnCount%2A> и <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.RowCount%2A> используются для указания количества строк и столбцов, в которых будут отображаться элементы и кнопки коллекции.|  
|**Метка**|Текст, используемый для обозначения элементов на ленте.|  
|**Меню**|Раскрывающийся список, который может содержать один из указанных ниже элементов управления.<br /><br /> -   Кнопка<br />-   Флажок<br />-   Коллекция<br />-   Меню<br />-   Разворачивающаяся кнопка<br />-   Выключатель<br />-   Разделитель<br /><br /> Чтобы добавить элемент управления в меню в конструкторе лент, нажмите стрелку меню — откроется рабочая область конструирования меню.  После этого в меню можно перетащить элементы управления ленты из **Панели элементов**.  Чтобы упорядочить элементы управления, перетащите их в нужное положение.<br /><br /> Чтобы добавить элементы управления в элемент управления <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu> после загрузки ленты в приложение Office, необходимо присвоить свойству <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu.Dynamic%2A> значение **true** до загрузки ленты.  Дополнительные сведения об этой операции см. в разделе [Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md).|  
|**Разделитель**|Тонкая полоса, используемая для разделения элемента в списке.  При добавлении в группу полоса становится вертикальной.  При добавлении в меню полоса становится горизонтальной.|  
|**SplitButton**|Кнопка с вложенным меню.  Разворачивающаяся кнопка, которая может содержать любые из указанных ниже элементов управления.<br /><br /> -   Кнопка<br />-   Флажок<br />-   Коллекция<br />-   Меню<br />-   Разворачивающаяся кнопка<br />-   Выключатель<br />-   Разделитель<br /><br /> Подобно меню, разворачивающаяся кнопка обладает собственной рабочей областью конструирования.  Однако в отличие от меню обновлять элементы в разворачивающейся кнопке можно только до загрузки ленты в приложение Office.  Дополнительные сведения об обновлении элементов в разворачивающейся кнопке см. в разделе [Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md).|  
|**ToggleButton**|Кнопка, отображаемая нажатой или ненажатой.|  
  
##  <a name="HandleEventsSetProperties"></a> Обработка событий и присвоение значений свойствам  
 В конструкторе лент значения свойств задаются во время разработки в окне **Свойства**.  Кроме того, лента имеет типобезопасную объектную модель, которую можно использовать для возврата и установки значений свойств элементов управления ленты во время выполнения.  
  
 Чтобы открыть обработчик событий для события по умолчанию элемента управления, следует дважды щелкнуть на любой элемент управления в режиме конструктора.  С помощью окна **Свойства** можно создавать обработчики событий для всех остальных событий элемента управления.  
  
 События и свойства ленты находятся в пространстве имен <xref:Microsoft.Office.Tools.Ribbon>.  Элемент **Лента \(визуальный конструктор\)** автоматически добавляет в проект ссылку на эту сборку и вставляет необходимый оператор **using** или **Imports** в начало файла кода ленты.  
  
 Сведения об обработке событий ленты и присвоении значений свойствам элементов управления ленты во время выполнения см. в разделе [Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md).  
  
##  <a name="CustomizingMicrosoftOfficeButton"></a> Настройка Представления Backstage  
 Можно использовать конструктор лент для добавления элементов управления в меню, которое открывается, если щелкнуть вкладку **Файл**.  Это меню вызывает представление Backstage.  
  
 Невозможно разместить элементы управления до или после встроенных элементов управления, используя конструктор ленты.  Встроенный элемент управления — элемент управления, который уже отображается в представлении Backstage.  Если требуется разместить элементы управления до или после встроенных элементов управления, следует использовать XML ленты.  Дополнительные сведения о **ленте \(XML\)** см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  Дополнительные сведения о настройке представления Backstage см. на веб\-сайте [Введение в представление Backstage в Office 2010 для разработчиков](http://go.microsoft.com/fwlink/?LinkId=182189) и [Настройка представления Backstage в Office 2010 для разработчиков](http://go.microsoft.com/fwlink/?LinkId=182188).  
  
 [!INCLUDE[appliesto_ribbon_2010](../vsto/includes/appliesto-ribbon-2010-md.md)]  
  
 Сведения о том, как добавлять элементы управления в представление Backstage см. в разделе [Практическое руководство. Добавление элементов управления в представление Backstage](../vsto/how-to-add-controls-to-the-backstage-view.md).  
  
##  <a name="Accessibility"></a> Специальные возможности в конструкторе лент  
 Для перемещения элементов управления в конструкторе лент можно использовать сочетания клавиш.  Некоторые сочетания клавиш используются для всех элементов управления, а некоторые — только для элементов управления с меню.  
  
 В приведенной ниже таблице перечислены сочетания клавиш, применяемые ко всем элементам управления.  
  
|Действие|Сочетание клавиш|  
|--------------|----------------------|  
|Перемещение элемента управления в положение перед предыдущим элементом управления в списке.|CTRL \+ СТРЕЛКА ВВЕРХ<br /><br /> CTRL \+ СТРЕЛКА ВЛЕВО|  
|Перемещение элемента управления в положение после предыдущего элемента управления в списке.|CTRL \+ СТРЕЛКА ВНИЗ<br /><br /> CTRL \+ СТРЕЛКА ВПРАВО|  
|Перемещение выделения с одного элемента управления на другой в этой же группе.  Для раскрывающейся панели перемещение между родительским элементом управления и элементами управления на этой панели.|СТРЕЛКА ВВЕРХ<br /><br /> СТРЕЛКА ВНИЗ|  
|Итерация вперед по списку всех элементов управления.|TAB|  
|Итерация назад по списку всех элементов управления.|SHIFT\+TAB|  
|Удаление выделенного элемента управления или набора элементов управления.|DELETE|  
|Копирование выделенных элементов управления.|CTRL \+ C|  
|Вырезание выделенных элементов управления.|CTRL \+ X|  
|Вставка элементов управления из буфера обмена.|CTRL \+ V|  
|Выделение **Панели элементов**.|CTRL \+ ALT \+ X|  
|Выделение родительского компонента.|ESC|  
  
 В приведенной ниже таблице перечислены сочетания клавиш, применяемые к меню Microsoft Office, <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu> и <xref:Microsoft.Office.Tools.Ribbon.RibbonSplitButton>.  
  
|Действие|Сочетание клавиш|  
|--------------|----------------------|  
|Выделение родительского элемента управления, если раскрывающаяся панель открыта и в ней выделен элемент управления.|СТРЕЛКА ВЛЕВО|  
|Закрытие раскрывающейся панели, если она открыта и выделен родительский элемент управления.|СТРЕЛКА ВЛЕВО|  
|Открытие раскрывающейся панели.|СТРЕЛКА ВПРАВО|  
|Выделение первого элемента управления на раскрывающейся панели, если она открыта.|СТРЕЛКА ВПРАВО|  
|Закрытие раскрывающейся панели.|ESC|  
  
## См. также  
 [Обзор ленты](../vsto/ribbon-overview.md)   
 [XML-ленты](../vsto/ribbon-xml.md)   
 [Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)   
 [Практическое руководство. Экспорт лент из конструктора лент в XML-ленты](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md)   
 [Практическое руководство. Работа с настройкой ленты](../vsto/how-to-get-started-customizing-the-ribbon.md)   
 [Доступ к ленте во время выполнения](../vsto/accessing-the-ribbon-at-run-time.md)  
  
  