---
title: "Конструктора ленты | Документы Microsoft"
ms.custom: 
ms.date: 02/02/2017
ms.reviewer: 
ms.suite: 
ms.technology: office-development
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords: Designer_Microsoft.VisualStudio.Tools.Office.Ribbon.Design.RibbonDesigner
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- custom Ribbon, about Ribbon Designer
- controls [Office development in Visual Studio], Ribbon
- Ribbon [Office development in Visual Studio], controls
- customizing the Ribbon, about Ribbon Designer
- Ribbon [Office development in Visual Studio], visual designer
- customizing the Ribbon
- custom Ribbon
- designers [Office development in Visual Studio], Ribbon
- Ribbon [Office development in Visual Studio], customizing
- Ribbon [Office development in Visual Studio], common tasks
- Ribbon Designer [Office development in Visual Studio]
- read-only properties
- Ribbon [Office development in Visual Studio], shortcut keys
ms.assetid: 26617206-f4da-416f-a18a-d817b2d4872d
caps.latest.revision: "79"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.openlocfilehash: 941ca002d2f840805253624e7e0004fb560c4167
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="ribbon-designer"></a>Конструктор лент
  Конструктор ленты — основа для визуальной разработки. Используйте конструктор лент для добавления пользовательских вкладок, групп и элементов управления на ленту приложения Microsoft Office.  
  
 [!INCLUDE[appliesto_ribbon](../vsto/includes/appliesto-ribbon-md.md)]  
  
 Чтобы открыть конструктор лент, добавьте **Лента (визуальный конструктор)** в проект. Затем можно использовать средства разработки для выполнения следующих задач:  
  
-   [Разработка макета ленты](#DesigningRibbonLayout)  
  
-   [Обработка событий и установка свойств элемента управления](#HandleEventsSetProperties)  
  
-   [Добавление элементов управления в представление Backstage](#CustomizingMicrosoftOfficeButton)  
  
> [!NOTE]  
>  Есть ряд задач, которые невозможно выполнить с помощью конструктора лент. Дополнительные сведения об этих задачах и способ их выполнения см. в разделе [Обзор ленты](../vsto/ribbon-overview.md).  
  
 ![ссылка на видео](../vsto/media/playvideo.gif "ссылку видео") связанные демонстрационные видеоролики см. в разделе [практические советы. Использование конструктора ленты для настройки ленты в Outlook?](http://go.microsoft.com/fwlink/?LinkID=130312).  
  
## <a name="adding-a-ribbon-visual-designer-item-to-a-project"></a>Добавление в проект элемента Лента (визуальный конструктор)  
 Чтобы использовать конструктор лент, добавьте новый **Лента (визуальный конструктор)** в проект. Для получения дополнительной информации см. [How to: Get Started Customizing the Ribbon](../vsto/how-to-get-started-customizing-the-ribbon.md).  
  
 При добавлении нового **Лента (визуальный конструктор)** товар, Visual Studio автоматически добавляет следующие файлы в проект:  
  
-   Файл кода ленты. Этот файл имеет имя, указанное для **Лента (визуальный конструктор)** элемент **Добавление нового элемента** диалоговое окно. Добавьте код для обработки событий ленты в этот файл.  
  
-   Файл кода конструктора лент. Этот файл содержит код, созданный с помощью конструктора лент и не следует изменять непосредственно.  
  
-   Файл ресурсов. Этот файл содержит значения свойств каждого элемента управления на ленте.  
  
 Если у вас уже есть **Лента (визуальный конструктор)** элемента из другого проекта, ее можно повторно использовать в текущем проекте с помощью **Добавление существующего элемента** диалоговое окно.  
  
##  <a name="DesigningRibbonLayout"></a>Разработка ленты  
 Чтобы открыть конструктор лент тремя способами:  
  
-   В **обозревателе решений**, дважды щелкните файл кода ленты.  
  
-   В **обозревателе решений**, щелкните правой кнопкой мыши файл кода ленты и выберите команду **конструктор представлений**.  
  
-   В **обозревателе решений**, выберите файл кода ленты и выберите команду **конструктор** на **представление** меню.  
  
 Конструктор ленты содержит вкладка по умолчанию и группы. Вкладка по умолчанию и группы можно удалить из конструктора лент. Чтобы удалить группу по умолчанию, щелкните правой кнопкой мыши **Group1**, а затем нажмите кнопку **удалить**. Чтобы удалить вкладку по умолчанию, щелкните правой кнопкой мыши пустую область конструктора, затем щелкните **удалить вкладку ленты**.  
  
 Также можно добавить пользовательские вкладки, группы и элементы управления в конструкторе лент. Можно найти эти элементы управления в **элементов**в **элементы управления ленты Office** группы. Существует три способа добавления элементов управления из **элементы управления ленты Office** группы конструктор лент:  
  
-   Перетащите элемент управления в соответствующую область в конструкторе лент.  
  
-   Щелкните элемент управления и выберите соответствующую область, в конструкторе лент.  
  
-   Выберите соответствующую область в конструкторе, а затем дважды щелкните элемент управления в **элементов**.  
  
### <a name="ribbon-design-workflow"></a>Процесс разработки ленты  
 Выполните эти шаги, чтобы разработать макет ленты.  
  
1.  [Добавление настраиваемой вкладки на ленту](#AddTabToRibbon).  
  
2.  [Добавление групп на вкладку](#AddGroupsToTab).  
  
3.  [Добавление элементов управления в группе](#AddControlsToGroups).  
  
 Элементы управления можно перетаскивать только в группы; Нельзя перетащить элемент управления непосредственно на вкладку или на ленту. Группы можно перетаскивать только на вкладки; группу невозможно перетащить непосредственно на ленту.  
  
 Размещение элементов управления, перетаскивая их в нужное положение. Можно задать свойства элемента управления с помощью **свойства** окна.  
  
 Нельзя перетаскивать элементы управления с одной вкладки на другую на ленте. Если вы хотите переместить элемент управления на другую вкладку, необходимо использовать **Вырезать** команду, чтобы удалить элемент управления с одной вкладки, а затем вставьте элемент управления на другую вкладку. Если управления Вырезать и вставить его, обработчик событий перестает работать. Можно заново подключить обработчик событий **свойства** окна. Дополнительные сведения см. в разделе [окно свойств](/visualstudio/ide/reference/properties-window).  
  
###  <a name="AddTabToRibbon"></a>Добавление настраиваемых вкладок на ленту  
 Существует три способа добавления настраиваемой вкладки на ленту:  
  
-   Добавить вкладку из **элементов**.  
  
-   Щелкните правой кнопкой мыши в конструкторе лент и нажмите кнопку **добавить вкладку ленты**.  
  
-   Откройте **редактор коллекции вкладок**, а затем нажмите кнопку **добавить**.  
  
     Чтобы открыть **редактор коллекции вкладок**в **свойства** выберите **вкладки** свойство и нажмите кнопку с многоточием ![ASP.NET для мобильных устройств Эллипс конструктора](../sharepoint/media/mwellipsis.gif "эллипс конструктора ASP.NET Mobile").  
  
 После добавления вкладки можно добавить группы для размещения элементов управления.  
  
#### <a name="removing-custom-tabs-from-the-ribbon"></a>Удаление пользовательских вкладок на ленте  
 Чтобы удалить настраиваемую вкладку на ленте тремя способами:  
  
-   Щелкните правой кнопкой мыши конструктор и нажмите кнопку **удалить вкладку ленты**.  
  
-   В **команды** области **свойства** окно, нажмите кнопку **удалить вкладку ленты**.  
  
-   Откройте **редактор коллекции вкладок**, перейдите на вкладку и нажмите кнопку **удалить**.  
  
#### <a name="changing-the-position-of-a-tab-on-the-ribbon"></a>Изменение положения вкладки на ленте  
 Можно изменить порядок пользовательских вкладок на ленте. Кроме того, пользовательские вкладки можно разместить до или после встроенной вкладки на ленте. Дополнительные сведения см. в разделе [как: изменение положения вкладки на ленте](../vsto/how-to-change-the-position-of-a-tab-on-the-ribbon.md).  
  
#### <a name="customizing-built-in-tabs-on-the-ribbon"></a>Настройка встроенных вкладок на ленте  
 Встроенная вкладка — это вкладка, которая уже находится на ленте приложения Microsoft Office. Например **данные** — Встроенная вкладка в Excel.  
  
 На встроенную вкладку можно добавить группы и элементы управления. По умолчанию пользовательская группа отображается последней группы на встроенную вкладку на то, что его можно переместить перед или после любой встроенной группы на вкладке.  
  
 Невозможно удалить встроенные группы.  
  
 Дополнительные сведения о том, как настройка встроенной вкладки см. в разделе [как: Настройка встроенной вкладки](../vsto/how-to-customize-a-built-in-tab.md).  
  
###  <a name="AddGroupsToTab"></a>Добавление групп на вкладку  
 Группы логически упорядочить элементы управления на ленте. Добавление групп вкладок. Добавление других элементов управления в группу.  
  
###  <a name="AddControlsToGroups"></a>Добавление элементов управления для групп  
 Добавьте один или несколько элементов управления в группу. В следующей таблице описаны каждого элемента управления.  
  
|Control|Описание|  
|-------------|-----------------|  
|**Поле**|Контейнер, который упорядочивает элементы управления в группе. Любой элемент управления можно добавить в поле, за исключением разделителя, группы или вкладки. Поле может быть горизонтальная или вертикальная.|  
|**Button**|Кнопка, запускающая действие. Можно добавить кнопку с группой, группе, раскрывающегося списка, галереи, меню или разворачивающуюся кнопку.|  
|**ButtonGroup**|Группа, содержит один или несколько кнопок, переключателей, меню, разворачивающихся кнопок и галереи. Группу можно добавить к группе или меню.|  
|**CheckBox**|Окно, в котором устанавливается или снимается, чтобы включить или отключить соответствующий параметр.|  
|**ComboBox**|Поле редактирования со вложенным списком. Пользователей можно ввести или выбрать значение из списка. В окне отображается текущее выделение. Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonComboBox.Items%2A> свойство для добавления и удаления элементов во время выполнения до или после загрузки ленты в приложение Office.|  
|**Раскрывающийся список**|Список элементов, которые пользователь может выбрать. Пользователь не может ввести новый элемент в раскрывающемся списке.<br /><br /> Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Items%2A> свойство для добавления элементов в список. Можно добавлять и удалять элементы во время выполнения.<br /><br /> Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonDropDown.Buttons%2A> свойство для добавления кнопок в список. Однако невозможно добавить и удалить кнопки во время выполнения после загрузки ленты в приложение Office.|  
|**Поля ввода**|Поле, в котором пользователь может вводить текст.|  
|**Коллекции**|Меню, предоставляющее массив или сетку визуальных вариантов, из которых могут выбирать пользователи. Можно управлять размещением выбранные элементы в меню. Используйте <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.ColumnCount%2A> и <xref:Microsoft.Office.Tools.Ribbon.RibbonGallery.RowCount%2A> свойства, чтобы указать число строк и столбцов, которые будут отображать элементы и кнопки коллекции.|  
|**Label**|Текст, который можно использовать для определения элементов управления на ленте.|  
|**Menu**|Раскрывающегося списка, который может содержать любой из следующих элементов управления:<br /><br /> -Кнопка<br />-Флажок<br />-Коллекция<br />-Меню<br />-Разворачивающаяся кнопка<br />-Переключатель<br />-Разделитель<br /><br /> Чтобы добавить элемент управления меню в конструкторе лент, нажмите кнопку со стрелкой вниз в меню, чтобы предоставить области конструктора меню. Затем можно перетащить элементы управления ленты из **элементов** в меню. Размещение элементов управления, перетащите их в нужное положение.<br /><br /> Добавить элементы управления для <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu> после загрузки ленты в приложение Office, необходимо задать <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu.Dynamic%2A> свойства **true** до загрузки ленты. Сведения о том, как это сделать в разделе [Обзор модели объекта ленты](../vsto/ribbon-object-model-overview.md).|  
|**Separator**|Тонкая полоса, используемая для разделения элементов в списке. При добавлении в группу полоса становится вертикальной. При добавлении в меню, строке располагаются горизонтально.|  
|**SplitButton**|Кнопка с вложенным меню. Разворачивающаяся кнопка может содержать любой из следующих элементов управления:<br /><br /> -Кнопка<br />-Флажок<br />-Коллекция<br />-Меню<br />-Разворачивающаяся кнопка<br />-Переключатель<br />-Разделитель<br /><br /> Подобно меню Разворачивающаяся кнопка обладает собственной рабочей областью конструирования. Однако в отличие от меню, можно обновить только элементы в разворачивающейся кнопки до загрузки ленты в приложение Office. Сведения об обновлении элементов в разворачивающейся кнопки см. в разделе [Обзор модели объекта ленты](../vsto/ribbon-object-model-overview.md).|  
|**Элемент управления ToggleButton**|Кнопка, которая появляется нажата или не нажата.|  
  
##  <a name="HandleEventsSetProperties"></a>Обработка событий и задание свойств  
 Конструктор лент позволяет задавать свойства элемента управления во время разработки с помощью **свойства** окна. Кроме того лента предоставляет строго типизированную объектную модель, который можно использовать для получения и задания свойств элементов управления ленты во время выполнения.  
  
 Можно дважды щелкнуть любой элемент управления в конструкторе, чтобы открыть обработчик событий для события элемента управления по умолчанию. Можно создать обработчики событий для всех событий элемента управления с помощью **свойства** окна.  
  
 События и свойства ленты находятся в <xref:Microsoft.Office.Tools.Ribbon> пространства имен. **Лента (визуальный конструктор)** автоматически добавляет в проект ссылку на эту сборку и вставляет соответствующий **с помощью** или **Imports** в верхней файла кода ленты.  
  
 Сведения об обработке событий ленты и задания свойств элементов управления ленты во время выполнения см. в разделе [Обзор модели объекта ленты](../vsto/ribbon-object-model-overview.md).  
  
##  <a name="CustomizingMicrosoftOfficeButton"></a>Настройка представление Backstage  
 Конструктор лент можно использовать для добавления элементов управления меню, которое открывается при нажатии кнопки **файл** вкладки. Это меню, называется представление Backstage.  
  
 Нельзя размещать элементы до или после встроенных элементов управления с помощью конструктора лент. Встроенный элемент управления является элементом управления, который уже присутствует в представление Backstage. Если вы хотите разместить элементы управления до или после встроенных элементов управления, необходимо использовать XML-ленты. Дополнительные сведения о **Лента (XML)**, в разделе [XML-ленты](../vsto/ribbon-xml.md). Дополнительные сведения о настройке представления Backstage см. в разделе [введение в Office 2010 Backstage для разработчиков](http://go.microsoft.com/fwlink/?LinkId=182189) и [Настройка Office 2010 Backstage для разработчиков](http://go.microsoft.com/fwlink/?LinkId=182188).  
  
 [!INCLUDE[appliesto_ribbon_2010](../vsto/includes/appliesto-ribbon-2010-md.md)]  
  
 Сведения о том, как добавлять элементы управления в представление Backstage см. в разделе [как: Добавление элементов управления в представление Backstage](../vsto/how-to-add-controls-to-the-backstage-view.md).  
  
##  <a name="Accessibility"></a>Специальные возможности в конструкторе лент  
 Можно использовать сочетания клавиш для перемещения элементов управления в конструкторе лент. Некоторые сочетания клавиш применяются ко всем элементам управления, а некоторые применяются только к элементам управления, имеющих меню.  
  
 В следующей таблице показаны сочетания клавиш, которые применяются ко всем элементам управления.  
  
|Действие|Сочетание клавиш|  
|------------|-----------------------|  
|Перемещение элемента управления до предыдущего элемента управления в списке.|CTRL + СТРЕЛКА ВВЕРХ<br /><br /> CTRL + СТРЕЛКА ВЛЕВО|  
|Переместите элемент управления после следующего элемента управления в списке.|CTRL + СТРЕЛКА ВНИЗ<br /><br /> CTRL + СТРЕЛКА ВПРАВО|  
|Перемещение выбранного из одного элемента управления к другому в одной группе. Для раскрывающуюся панель перемещение между родительского элемента управления и элементов управления в раскрывающейся панели.|ВВЕРХ<br /><br /> ВНИЗ|  
|Итерация вперед по списку всех элементов управления.|TAB|  
|Итерация назад по всем элементам управления.|SHIFT+TAB|  
|Удалите выбранный элемент управления или набора элементов управления.|DELETE|  
|Копирование выбранных элементов управления.|CTRL + C|  
|Вырежьте выбранные элементы управления.|CTRL + X|  
|Вставка элементов управления из буфера обмена.|CTRL + V|  
|Выберите **элементов**.|CTRL+ALT+X|  
|Выберите родительский компонент.|ESC|  
  
 Сочетания клавиш, которые применяются только к меню Microsoft Office, <xref:Microsoft.Office.Tools.Ribbon.RibbonMenu>, и <xref:Microsoft.Office.Tools.Ribbon.RibbonSplitButton> показано в следующей таблице.  
  
|Действие|Сочетание клавиш|  
|------------|-----------------------|  
|Выберите родительский элемент управления, если она открыта и элемент управления, выбранного на панели «раскрывающийся список».|LEFT|  
|Закройте панель раскрывающийся список, если она открыта и выделен родительский элемент управления.|LEFT|  
|Откройте панель раскрывающегося списка.|RIGHT|  
|Выберите первый элемент управления на панели «раскрывающийся список», если она открыта.|RIGHT|  
|Закройте панель раскрывающегося списка.|ESC|  
  
## <a name="see-also"></a>См. также  
 [Обзор ленты](../vsto/ribbon-overview.md)   
 [XML-ленты](../vsto/ribbon-xml.md)   
 [Пошаговое руководство: Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)   
 [Как: экспорт ленты из конструктора лент в XML-ленты](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md)   
 [Как: работа с настройкой ленты](../vsto/how-to-get-started-customizing-the-ribbon.md)   
 [Доступ к ленте во время выполнения](../vsto/accessing-the-ribbon-at-run-time.md)  
  
  