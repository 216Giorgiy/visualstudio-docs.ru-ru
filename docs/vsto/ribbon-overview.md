---
title: "Обзор ленты | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "настраиваемая лента, несколько лент"
  - "настройка ленты, несколько лент"
  - "лента [разработка решений Office в Visual Studio]"
  - "лента [разработка решений Office в Visual Studio], сведения о ленте"
  - "лента [разработка решений Office в Visual Studio], несколько лент"
  - "панели инструментов [разработка решений Office в Visual Studio]"
  - "панели инструментов [разработка решений Office в Visual Studio], лента"
ms.assetid: 2bdef092-190d-47e3-9440-e862b95dacaa
caps.latest.revision: 64
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 62
---
# Обзор ленты
  Лента позволяет так организовать связанные команды, чтобы их можно было легко найти.  Команды отображаются на ленте в виде элементов управления.  Элементы управления объединены в *группы* на горизонтальной полосе в верхней части окна приложения.  Связанные группы расположены на вкладках.  
  
 Большинство функций, доступ к которым раньше выполнялся с помощью меню и панелей инструментов в более ранних версиях системы Microsoft Office, теперь доступны с помощью ленты.  Дополнительные сведения см. в технической статье [Обзор пользовательского интерфейса Microsoft Office 2007 для разработчиков](http://go.microsoft.com/fwlink/?LinkID=70860).  
  
 [!INCLUDE[appliesto_ribbon](../vsto/includes/appliesto-ribbon-md.md)]  
  
## Настройка ленты Microsoft Office  
 Для настройки ленты добавьте один из указанных ниже элементов ленты в проект Office:  
  
-   **Лента \(визуальный конструктор\)**  
  
-   **Лента \(XML\)**  
  
 Например, для настройки ленты Excel добавьте элемент ленты в проект надстройки VSTO для Excel.  
  
### Элемент «Лента \(визуальный конструктор\)»  
 Элемент **Лента \(визуальный конструктор\)** предоставляет расширенные средства, облегчающие проектирование и разработку настраиваемой ленты.  Используйте элемент **Лента \(визуальный конструктор\)** для настройки ленты следующими способами.  
  
-   Добавление пользовательских или встроенных вкладок на ленту.  
  
-   Добавление пользовательских групп на встроенную или пользовательскую вкладку на ленте.  
  
    > [!NOTE]  
    >  Встроенная вкладка или группа — это вкладка или группа, которая уже есть на ленте приложения Microsoft Office.  Например, **Данные** — это встроенная вкладка Excel.  Группа **Соединений** — это встроенная группа вкладки **Данные**.  
  
-   Добавление пользовательских элементов в пользовательскую группу.  
  
-   Добавление пользовательских элементов управления в представление Backstage.  
  
 Дополнительные сведения о настройке ленты с помощью элемента **Лента \(визуальный конструктор\)** см. в разделе [Конструктор лент](../vsto/ribbon-designer.md).  
  
### Элемент «Лента \(XML\)»  
 Используйте элемент **Лента \(XML\)**, чтобы настроить ленту специальным образом, который не поддерживается элементом **Лента \(визуальный конструктор\)**.  Используйте элемент **Лента \(XML\)** для настройки ленты следующими способами.  
  
-   Добавление *встроенных* групп на встроенную или пользовательскую вкладку.  
  
-   Добавление встроенных элементов управления в пользовательскую группу.  
  
-   Добавление пользовательского кода для переопределения обработчиков событий встроенных элементов управления.  
  
-   Настройка панели быстрого доступа.  
  
-   Совместное использование настройки ленты между надстройками VSTO с помощью полного идентификатора.  
  
 Дополнительные сведения о настройке ленты с помощью элемента **Лента \(XML\)** см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  
  
## Экспорт ленты из конструктора лент в XML\-ленту  
 Если вы создали ленту с помощью конструктора лент и решили, что нужно настроить ленту таким способом, который не поддерживается элементом **Лента \(визуальный конструктор\)**, можно экспортировать ленту в формат XML.  
  
 Visual Studio автоматически создает элемент **Лента \(XML\)** и заполняет XML\-файл ленты элементами и атрибутами для каждого элемента управления на ленте.  
  
 Не все свойства, которые находятся в окне **Свойства** конструктора лент, переносятся в XML\-файл ленты.  Например, Visual Studio не экспортирует значение свойств **Изображение** или **Текст**.  Это связано с тем, что необходимо создать метод обратного вызова в файле кода ленты экспортированного проекта, чтобы указать изображение или текст элемента управления.  Visual Studio не создает методы обратного вызова автоматически в процессе экспорта.  
  
 Кроме того, все неизмененные значения свойств по умолчанию не отображаются в полученном файле XML\-ленты.  
  
 Дополнительные сведения об экспорте ленты в формат XML см. в разделе [Практическое руководство. Экспорт лент из конструктора лент в XML-ленты](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md).  
  
### Обновление кода  
 Новый файл кода ленты добавляется в **обозреватель решений**.  Он содержит класс XML ленты.  Вам необходимо создать методы обратного вызова в области `Ribbon Callbacks` этого класса для обработки действий пользователя, таких как нажатие кнопки.  Переместите свой код из обработчиков событий в методы обратного вызова и модифицируйте этот код, чтобы работать с моделью программирования расширения ленты \(RibbonX\).  Дополнительные сведения см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  
  
 Вы также должны добавить код в класс `ThisAddIn`, `ThisWorkbook` или `ThisDocument`, который переопределяет метод CreateRibbonExtensibilityObject и возвращает XML\-класс ленты в приложение Office.  
  
 Дополнительные сведения см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  
  
## Добавление нескольких элементов ленты в проект  
 В один проект можно добавить несколько лент.  Это полезно, если вам необходимо выполнить одно из следующих действий.  
  
-   Создать ленты для *инспекторов* Outlook.  Дополнительные сведения см. в разделе [Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md).  
  
    > [!NOTE]  
    >  Инспектор — это окно, которое открывается при выполнении пользователем определенных задач, таких как создание электронного сообщения.  
  
-   Выбрать ленту, которая отображается во время выполнения.  
  
### Выбор лент, которые отображаются во время выполнения  
 Поскольку проект может содержать несколько лент, вы можете выбрать, какую ленту следует отображать во время выполнения.  
  
 Для этого переопределите метод CreateRibbonExtensibilityObject в классе `ThisAddin`, `ThisWorkbook` или `ThisDocument` проекта и возвратите ленту, которую нужно отобразить.  Следующий пример проверяет значение поля с именем `myCondition` и возвращает соответствующую ленту.  
  
> [!NOTE]  
>  Синтаксис, используемый в данном примере, возвращает ленту, созданную с помощью элемента **Лента \(визуальный конструктор\)**.  Синтаксис, возвращающий ленту, созданную с помощью элемента **Лента \(XML\)**, немного отличается.  Дополнительные сведения о возврате элемента **Лента \(XML\)** см. в статье [XML-ленты](../vsto/ribbon-xml.md).  
  
 Добавьте следующий код:  
  
 [!code-csharp[Trin_Ribbon_Choose_Ribbon#1](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Ribbon_Choose_Ribbon/CS/ThisWorkbook.cs#1)]
 [!code-vb[Trin_Ribbon_Choose_Ribbon#1](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Ribbon_Choose_Ribbon/VB/ThisWorkbook.vb#1)]  
  
### См. также  
  
|Заголовок|Описание|  
|---------------|--------------|  
|[Практическое руководство. Работа с настройкой ленты](../vsto/how-to-get-started-customizing-the-ribbon.md)|Здесь показано, как настроить ленту приложения Microsoft Office и добавить элемент **Лента \(визуальный конструктор\)** или **Лента \(XML\)** в проект Office.|  
|[Конструктор лент](../vsto/ribbon-designer.md)|Описание использования конструктора лент для добавления пользовательских вкладок, групп и элементов управления на ленту приложения Microsoft Office.|  
|[Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)|Здесь показано, как создать настраиваемую вкладку ленты с помощью конструктора лент.  Конструктор лент позволяет добавлять и размещать элементы управления на настраиваемой вкладке.|  
|[Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md)|Общие сведения о строго типизированной объектной модели, которую можно использовать для получения и установки свойств элементов управления ленты во время выполнения.|  
|[Пошаговое руководство. Обновление элементов управления на ленте во время выполнения](../vsto/walkthrough-updating-the-controls-on-a-ribbon-at-run-time.md)|Здесь показано, как использовать объектную модель ленты для обновления элементов управления на ленте после загрузки ленты в приложение Office.|  
|[Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md)|Рекомендации по настройке ленты в Microsoft Office Outlook.|  
|[Настройка ленты для InfoPath](../vsto/customizing-a-ribbon-for-infopath.md)|Рекомендации по настройке ленты в Microsoft Office InfoPath.|  
|[Доступ к ленте во время выполнения](../vsto/accessing-the-ribbon-at-run-time.md)|Здесь показано, как отобразить, скрыть или изменить ленту и позволить пользователям запускать код из элементов управления в настраиваемой области задач, панели действий или области формы Outlook.|  
|[Практическое руководство. Изменение положения вкладки на ленте](../vsto/how-to-change-the-position-of-a-tab-on-the-ribbon.md)|Здесь показано, как изменить порядок вкладок на ленте.|  
|[Практическое руководство. Настройка встроенной вкладки](../vsto/how-to-customize-a-built-in-tab.md)|Здесь показано, как добавить группы и элементы управления на встроенную вкладку.|  
|[Практическое руководство. Добавление элементов управления в представление Backstage](../vsto/how-to-add-controls-to-the-backstage-view.md)|Здесь показано, как добавить элементы управления в меню, которое открывается при нажатии кнопки **Файл**.|  
|[Практическое руководство. Добавление кнопки запуска диалогового окна в группу ленты](../vsto/how-to-add-a-dialog-box-launcher-to-a-ribbon-group.md)|Здесь показано, как добавить кнопку запуска диалогового окна в любую группу ленты.|  
|[Практическое руководство. Экспорт лент из конструктора лент в XML-ленты](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md)|Здесь описываются расширенные способы настройки ленты с помощью экспорта ленты из конструктора в XML.|  
|[XML-ленты](../vsto/ribbon-xml.md)|Описание настройки ленты с помощью XML\-ленты.|  
|[Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)|Здесь показано, как создать вкладку на настраиваемой ленте с помощью элемента **Лента \(XML\)**.|  
  
  