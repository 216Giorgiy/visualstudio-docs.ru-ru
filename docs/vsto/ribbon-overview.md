---
title: "Общие сведения о ленте | Документы Microsoft"
ms.custom: 
ms.date: 02/02/2017
ms.reviewer: 
ms.suite: 
ms.technology: office-development
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- customizing the Ribbon, multiple Ribbons
- Ribbon [Office development in Visual Studio], about Ribbon
- toolbars [Office development in Visual Studio], Ribbon
- Ribbon [Office development in Visual Studio]
- Ribbon [Office development in Visual Studio], multiple Ribbons
- toolbars [Office development in Visual Studio]
- custom Ribbon, multiple Ribbons
ms.assetid: 2bdef092-190d-47e3-9440-e862b95dacaa
caps.latest.revision: "64"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.workload: office
ms.openlocfilehash: fcf026af4877ee2aefe17551763752d385b63493
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="ribbon-overview"></a>Обзор ленты
  Лента позволяет так организовать связанные команды, чтобы их можно было легко найти. Команды отображаются на ленте в виде элементов управления. Элементы управления объединены в *группы* на горизонтальной полосе в верхней части окна приложения. Связанные группы расположены на вкладках.  
  
 Большинство возможностей, доступ к которым раньше выполнялся с помощью меню и панелей инструментов в более ранних версиях системы Microsoft Office, теперь доступны с помощью ленты. Дополнительные сведения см. в технической статье [разработчиков обзор пользовательского интерфейса для Microsoft Office 2007](http://go.microsoft.com/fwlink/?LinkID=70860).  
  
 [!INCLUDE[appliesto_ribbon](../vsto/includes/appliesto-ribbon-md.md)]  
  
## <a name="customizing-the-microsoft-office-ribbon"></a>Настройка ленты Microsoft Office  
 Для настройки ленты добавьте один из указанных ниже элементов ленты в проект Office:  
  
-   **Лента (визуальный конструктор)**  
  
-   **Лента (XML)**  
  
 Например, для настройки ленты Excel добавьте элемент ленты в проект надстройки VSTO для Excel.  
  
### <a name="ribbon-visual-designer-item"></a>Элемент «Лента (визуальный конструктор)»  
 **Лента (визуальный конструктор)** предоставляет расширенные средства, облегчающие проектирование и разработку настраиваемой ленты. Используйте **Лента (визуальный конструктор)** элемента для настройки ленты следующими способами:  
  
-   Добавление пользовательских или встроенных вкладок на ленту.  
  
-   Добавление пользовательских групп на встроенную или пользовательскую вкладку на ленте.  
  
    > [!NOTE]  
    >  Встроенная вкладка или группа — это вкладка или группа, которая уже есть на ленте приложения Microsoft Office. Например **данные** — Встроенная вкладка в Excel. **Подключений** группа включена встроенная группа **данные** вкладки.  
  
-   Добавление пользовательских элементов в пользовательскую группу.  
  
-   Добавление пользовательских элементов управления в представление Backstage.  
  
 Дополнительные сведения о настройке ленты с помощью **Лента (визуальный конструктор)** см. в разделе [конструктор лент](../vsto/ribbon-designer.md).  
  
### <a name="ribbon-xml-item"></a>Элемент «Лента (XML)»  
 Используйте **Лента (XML)** элемент, если вы хотите настроить ленту способом, который не поддерживается **Лента (визуальный конструктор)** элемента. Используйте **Лента (XML)** элемента для настройки ленты следующими способами:  
  
-   Добавить *встроенные* групп на встроенную вкладку или пользовательскую вкладку.  
  
-   Добавление встроенных элементов управления в пользовательскую группу.  
  
-   Добавление пользовательского кода для переопределения обработчиков событий встроенных элементов управления.  
  
-   Настройка панели быстрого доступа.  
  
-   Совместное использование настройки ленты между надстройками VSTO с помощью полного идентификатора.  
  
 Дополнительные сведения о настройке ленты с помощью **Лента (XML)** см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  
  
## <a name="exporting-a-ribbon-from-the-ribbon-designer-to-ribbon-xml"></a>Экспорт ленты из конструктора лент в XML-ленту  
 Если вы создали ленту с помощью конструктора лент и решить, нужно настроить ленту таким способом, **Лента (визуальный конструктор)** элемент не поддерживает, можно экспортировать ленту в формат XML.  
  
 Visual Studio автоматически создает **Лента (XML)** и заполняет XML-файл ленты элементами и атрибутами для каждого элемента управления на ленте.  
  
 Не все свойства, которые находятся в **свойства** окна конструктора лент, переносятся в XML-файле ленты.  Например, Visual Studio не экспортирует значение **изображения** или **текст** свойство. Это связано с тем, что необходимо создать метод обратного вызова в файле кода ленты экспортированного проекта, чтобы указать изображение или текст элемента управления. Visual Studio не создает методы обратного вызова автоматически в процессе экспорта.  
  
 Кроме того, все неизмененные значения свойств по умолчанию не отображаются в полученном файле XML-ленты.  
  
 Дополнительные сведения об экспорте ленты в формат XML см. в разделе [как: экспорт ленты из конструктора лент в XML-ленты](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md).  
  
### <a name="updating-the-code"></a>Обновление кода  
 Новый файл кода ленты добавляется **обозревателе решений**. Он содержит класс XML ленты. Вам необходимо создать методы обратного вызова в области `Ribbon Callbacks` этого класса для обработки действий пользователя, таких как нажатие кнопки. Переместите свой код из обработчиков событий в методы обратного вызова и модифицируйте этот код, чтобы работать с моделью программирования расширения ленты (RibbonX). Дополнительные сведения см. в разделе [Ribbon XML](../vsto/ribbon-xml.md).  
  
 Необходимо также добавить код для `ThisAddIn`, `ThisWorkbook`, или `ThisDocument` класс, который переопределяет метод CreateRibbonExtensibilityObject и возвращает класс XML ленты в приложение Office.  
  
 Дополнительные сведения см. в разделе [Ribbon XML](../vsto/ribbon-xml.md).  
  
## <a name="adding-multiple-ribbon-items-to-a-project"></a>Добавление нескольких элементов ленты в проект  
 В один проект можно добавить несколько лент. Это полезно, если вам необходимо выполнить одно из следующих действий.  
  
-   Создать ленты для Outlook *инспекторов*. Дополнительные сведения см. в разделе [Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md).  
  
    > [!NOTE]  
    >  Инспектор — это окно, которое открывается при выполнении пользователем определенных задач, таких как создание электронного сообщения.  
  
-   Выбрать ленту, которая отображается во время выполнения.  
  
### <a name="selecting-which-ribbons-to-display-at-run-time"></a>Выбор лент, которые отображаются во время выполнения  
 Поскольку проект может содержать несколько лент, вы можете выбрать, какую ленту следует отображать во время выполнения.  
  
 Чтобы выбрать ленту следует отображать во время выполнения, переопределите метод CreateRibbonExtensibilityObject в `ThisAddin`, `ThisWorkbook`, или `ThisDocument` класс проекта и возвратите ленту, будет отображаться. Следующий пример проверяет значение поля с именем `myCondition` и возвращает соответствующую ленту.  
  
> [!NOTE]  
>  Синтаксис, используемый в этом примере, возвращает ленту, была создана с помощью **Лента (визуальный конструктор)** элемента. Синтаксис, возвращающий ленту, созданную с помощью **Лента (XML)** немного отличается. Дополнительные сведения о возврате **Лента (XML)** см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  
  
 Добавьте следующий код:  
  
 [!code-vb[Trin_Ribbon_Choose_Ribbon#1](../vsto/codesnippet/VisualBasic/trin_ribbon_choose_ribbon_4/ThisWorkbook.vb#1)]
 [!code-csharp[Trin_Ribbon_Choose_Ribbon#1](../vsto/codesnippet/CSharp/trin_ribbon_choose_ribbon_4/ThisWorkbook.cs#1)]  
  
### <a name="related-topics"></a>См. также  
  
|Заголовок|Описание:|  
|-----------|-----------------|  
|[Практическое руководство. Приступая к настройке ленты](../vsto/how-to-get-started-customizing-the-ribbon.md)|Показано, как настроить ленту приложения Microsoft Office, добавьте **Лента (визуальный конструктор)** или **Лента (XML)** элемента в проект Office.|  
|[Конструктор лент](../vsto/ribbon-designer.md)|Описание использования конструктора лент для добавления пользовательских вкладок, групп и элементов управления на ленту приложения Microsoft Office.|  
|[Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)|Здесь показано, как создать настраиваемую вкладку ленты с помощью конструктора лент. Конструктор лент позволяет добавлять и размещать элементы управления на настраиваемой вкладке.|  
|[Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md)|Общие сведения о строго типизированной объектной модели, которую можно использовать для получения и установки свойств элементов управления ленты во время выполнения.|  
|[Пошаговое руководство. Обновление элементов управления на ленте во время выполнения](../vsto/walkthrough-updating-the-controls-on-a-ribbon-at-run-time.md)|Здесь показано, как использовать объектную модель ленты для обновления элементов управления на ленте после загрузки ленты в приложение Office.|  
|[Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md)|Рекомендации по настройке ленты в Microsoft Office Outlook.|  
|[Настройка ленты для InfoPath](../vsto/customizing-a-ribbon-for-infopath.md)|Рекомендации по настройке ленты в Microsoft Office InfoPath.|  
|[Доступ к ленте во время выполнения](../vsto/accessing-the-ribbon-at-run-time.md)|Здесь показано, как отобразить, скрыть или изменить ленту и позволить пользователям запускать код из элементов управления в настраиваемой области задач, панели действий или области формы Outlook.|  
|[Практическое руководство. Изменение положения вкладки на ленте](../vsto/how-to-change-the-position-of-a-tab-on-the-ribbon.md)|Здесь показано, как изменить порядок вкладок на ленте.|  
|[Практическое руководство. Настройка встроенной вкладки](../vsto/how-to-customize-a-built-in-tab.md)|Здесь показано, как добавить группы и элементы управления на встроенную вкладку.|  
|[Практическое руководство. Добавление элементов управления в представление Backstage](../vsto/how-to-add-controls-to-the-backstage-view.md)|Демонстрируется добавление элементов управления в меню, которое открывается при нажатии кнопки **файл**.|  
|[Практическое руководство. Добавление кнопки запуска диалогового окна в группу ленты](../vsto/how-to-add-a-dialog-box-launcher-to-a-ribbon-group.md)|Здесь показано, как добавить кнопку запуска диалогового окна в любую группу ленты.|  
|[Практическое руководство. Экспорт лент из конструктора лент в XML-ленты](../vsto/how-to-export-a-ribbon-from-the-ribbon-designer-to-ribbon-xml.md)|Здесь описываются расширенные способы настройки ленты с помощью экспорта ленты из конструктора в XML.|  
|[XML-ленты](../vsto/ribbon-xml.md)|Описание настройки ленты с помощью XML-ленты.|  
|[Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)|Показано, как создать настраиваемую вкладку ленты с помощью **Лента (XML)** элемента.|  
  
  