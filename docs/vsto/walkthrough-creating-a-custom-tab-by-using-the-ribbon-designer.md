---
title: "Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "панели действий [разработка решений Office в Visual Studio], управление из ленты"
  - "настраиваемая лента, вкладки"
  - "настраиваемая вкладка [разработка решений Office в Visual Studio]"
  - "настройка ленты, вкладки"
  - "лента [разработка решений Office в Visual Studio], настройка"
  - "конструктор ленты [разработка решений Office в Visual Studio]"
ms.assetid: 312865e6-950f-46ab-88de-fe7eb8036bfe
caps.latest.revision: 68
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 67
---
# Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент
  Конструктор лент позволяет создать настраиваемую вкладку, а затем добавить и расположить на ней элементы управления.  
  
 [!INCLUDE[appliesto_xlalldoc](../vsto/includes/appliesto-xlalldoc-md.md)]  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   [Создание панелей действий](#BKMK_CreateActionsPanes).  
  
-   [Создание настраиваемой вкладки](#BKMK_CreateCustomTab).  
  
-   [Скрытие и отображение панелей действий при помощи кнопок настраиваемой вкладки](#BKMK_HideShowActionsPane).  
  
> [!NOTE]  
>  Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях.  Это зависит от имеющегося выпуска Visual Studio и используемых параметров.  Дополнительные сведения см. в разделе [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]  
  
-   Microsoft Excel  
  
## Создание проекта книги Excel  
 Этапы использования конструктора лент практически идентичны для всех приложений Office.  В этом примере используется книга Excel.  
  
#### Создание проекта книги Excel  
  
-   Создайте проект книги Excel с именем MyExcelRibbon.  Дополнительные сведения см. в статье [Практическое руководство. Создание проектов Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).  
  
     Новая книга открывается в конструкторе Visual Studio, а проект **MyExcelRibbon** добавляется в **обозреватель решений**.  
  
##  <a name="BKMK_CreateActionsPanes"></a> Создание панелей действий  
 Добавьте в проект две настраиваемые панели действий.  Позже на настраиваемой вкладке будут добавлены кнопки для скрытия и отображения этих панелей действий.  
  
#### Создание панелей действий  
  
1.  В меню **Проект** выберите пункт **Добавить новый элемент**.  
  
2.  В диалоговом окне **Добавление нового элемента** выберите **ActionsPaneControl** и нажмите кнопку **Добавить**.  
  
     В конструкторе открывается файл **ActionsPaneControl1.cs** или **ActionsPaneControl1.vb**.  
  
3.  Добавьте в рабочую область конструктора метку со вкладки **Стандартные элементы управления** в **панели элементов**.  
  
4.  В окне **Свойства** присвойте свойству **Text** метки label1 значение «Панель действий 1».  
  
5.  Повторите этапы 1–5, чтобы создать вторую панель действий и метку.  Присвойте свойству **Text** второй метки значение «Панель действий 2».  
  
##  <a name="BKMK_CreateCustomTab"></a> Создание настраиваемой вкладки  
 Один из принципов проектирования приложений Office состоит в том, что пользователь всегда должен иметь возможность распоряжаться пользовательским интерфейсом приложения Office.  Чтобы обеспечить такую возможность для панелей действий, можно добавить на настраиваемую вкладку ленты кнопки, скрывающие и отображающие каждую панель.  Чтобы создать настраиваемую вкладку, добавьте в проект элемент **Лента \(визуальный конструктор\)**.  Конструктор помогает добавлять и размещать элементы управления, задавать их свойства и обрабатывать связанные с ними события.  
  
#### Создание настраиваемой вкладки  
  
1.  В меню **Проект** выберите пункт **Добавить новый элемент**.  
  
2.  В диалоговом окне **Добавление нового элемента** выберите элемент **Лента \(визуальный конструктор\)**.  
  
3.  Измените имя новой ленты на **MyRibbon** и нажмите кнопку **Добавить**.  
  
     В конструкторе лент откроется файл **MyRibbon.cs** или **MyRibbon.vb**; отобразятся вкладка и группа, используемые по умолчанию.  
  
4.  В конструкторе лент перейдите на вкладку по умолчанию.  
  
5.  В окне **Свойства**, разверните свойство **ControlId**, затем присвойте свойству **ControlIdType** значение **Настраиваемый**.  
  
6.  Задайте для свойства **Метка** значение My Custom Tab.  
  
7.  В конструкторе лент выберите группу **group1**.  
  
8.  В окне **Свойства** присвойте свойству **Label** значение «Диспетчер панелей действий».  
  
9. Перетащите кнопку с вкладки **Элементы управления ленты Office** в **панели элементов** в группу **group1**.  
  
10. Выберите **button1**.  
  
11. В окне **Свойства** присвойте свойству **Label** значение «Отобразить панель действий 1».  
  
12. Добавьте вторую кнопку в **group1** и присвойте свойству **Label** значение «Отобразить панель действий 2».  
  
13. Перетащите элемент управления **Выключатель** с вкладки **Элементы управления ленты Office** в **панели элементов** в группу **group1**.  
  
14. Присвойте свойству **Label** значение «Скрыть панель действий».  
  
##  <a name="BKMK_HideShowActionsPane"></a> Скрытие и отображение панелей действий при помощи кнопок настраиваемой вкладки  
 Последним этапом является добавление кода, который взаимодействует с пользователем.  Добавьте обработчики событий для событий <xref:Microsoft.Office.Tools.Ribbon.RibbonButton.Click> обеих кнопок и события <xref:Microsoft.Office.Tools.Ribbon.RibbonToggleButton.Click> выключателя.  Добавьте в эти обработчики событий код для скрытия и отображения панелей действий.  
  
#### Скрытие и отображение панелей действий при помощи кнопок настраиваемой вкладки  
  
1.  В **обозревателе решений** откройте контекстное меню для файла MyRibbon.cs или MyRibbon.vb и выберите команду **Просмотреть код**.  
  
2.  Добавьте следующий код в начало класса `MyRibbon`.  Данный код создает два объекта панелей действий.  
  
     [!code-csharp[Trin_Ribbon_Custom_Tab#1](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab/CS/MyRibbon.cs#1)]
     [!code-vb[Trin_Ribbon_Custom_Tab#1](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab/VB/MyRibbon.vb#1)]  
  
3.  Замените метод `MyRibbon_Load` следующим кодом.  Данный код добавляет объекты панелей действий в коллекцию панелей действий <xref:Microsoft.Office.Tools.ActionsPane.Controls%2A> и скрывает объекты.  Кроме того, код Visual C\# присоединяет делегаты к нескольким событиям элементов управления ленты.  
  
     [!code-csharp[Trin_Ribbon_Custom_Tab#2](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab/CS/MyRibbon.cs#2)]
     [!code-vb[Trin_Ribbon_Custom_Tab#2](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab/VB/MyRibbon.vb#2)]  
  
4.  Добавьте следующие три метода обработчиков событий в класс `MyRibbon`.  Эти методы обрабатывают события <xref:Microsoft.Office.Tools.Ribbon.RibbonButton.Click> обеих кнопок и события <xref:Microsoft.Office.Tools.Ribbon.RibbonToggleButton.Click> выключателя.  Обработчики событий button1 и button2 отображают соответствующие панели действий.  Обработчик событий toggleButton1 отображает и скрывает активную панель действий.  
  
     [!code-csharp[Trin_Ribbon_Custom_Tab#3](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab/CS/MyRibbon.cs#3)]
     [!code-vb[Trin_Ribbon_Custom_Tab#3](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab/VB/MyRibbon.vb#3)]  
  
## Тестирование настраиваемой вкладки  
 При запуске проекта запускается приложение Excel, на ленте появляется вкладка **My Custom Tab**.  Нажимая кнопки на вкладке **My Custom Tab**, можно скрывать и отображать панели действий.  
  
#### Тестирование настраиваемой вкладки  
  
1.  Нажмите клавишу F5 для запуска проекта.  
  
2.  Перейдите на вкладку **My Custom Tab**.  
  
3.  В группе **Диспетчер настраиваемой панели действий** выберите **Отобразить панель действий 1**.  
  
     Отобразится панель действий с надписью Панель действий 1.  
  
4.  Выберите **Отобразить панель действий 2**.  
  
     Отобразится панель действий с надписью «Панель действий 2».  
  
5.  Выберите **Скрыть панель действий**.  
  
     Панели действий будут скрыты.  
  
## Следующие действия  
 Дополнительные сведения о настройке пользовательского интерфейса Office см. в следующих разделах:  
  
-   Добавление пользовательского интерфейса на основе контекста к настройкам уровня документа.  Дополнительные сведения см. в разделе [Общие сведения о панели действий](../vsto/actions-pane-overview.md).  
  
-   Расширение стандартной или пользовательской формы Microsoft Office Outlook.  Дополнительные сведения см. в разделе [Пошаговое руководство. Разработка области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md).  
  
## См. также  
 [Доступ к ленте во время выполнения](../vsto/accessing-the-ribbon-at-run-time.md)   
 [Обзор ленты](../vsto/ribbon-overview.md)   
 [Конструктор лент](../vsto/ribbon-designer.md)   
 [Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md)   
 [Практическое руководство. Работа с настройкой ленты](../vsto/how-to-get-started-customizing-the-ribbon.md)   
 [Практическое руководство. Изменение положения вкладки на ленте](../vsto/how-to-change-the-position-of-a-tab-on-the-ribbon.md)   
 [Практическое руководство. Настройка встроенной вкладки](../vsto/how-to-customize-a-built-in-tab.md)   
 [Практическое руководство. Добавление элементов управления в представление Backstage](../vsto/how-to-add-controls-to-the-backstage-view.md)   
 [Общие сведения об объектной модели ленты](../vsto/ribbon-object-model-overview.md)  
  
  