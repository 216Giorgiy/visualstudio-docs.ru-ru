---
title: "Защита документов в решениях уровня документа | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "документы [разработка решений Office в Visual Studio], ограниченные разрешения"
  - "Office - документы [разработка решений Office в Visual Studio], ограниченные разрешения"
  - "разрешения [разработка решений Office в Visual Studio"
  - "ограниченные разрешения [разработка решений Office в Visual Studio]"
  - "книги [разработка решений Office в Visual Studio], ограниченные разрешения"
ms.assetid: a25472ad-03f0-4804-9d19-e5ff71340d49
caps.latest.revision: 36
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 35
---
# Защита документов в решениях уровня документа
  В проектах уровня документа можно использовать функции защиты Microsoft Office Word и Microsoft Office Excel.  Эти функции блокируют попытки несанкционированного внесения изменений в защищенные части документа.  
  
 [!INCLUDE[appliesto_alldoc](../vsto/includes/appliesto-alldoc-md.md)]  
  
 Excel позволяет включить или выключить защиту, пока книга открыта в конструкторе.  Word позволяет включить защиту только вне конструктора.  Во время выполнения и для Word, и для Excel можно разрешить и запретить защиту программными средствами.  
  
 Если защита включена для документа, открытого в конструкторе, все элементы управления удаляются с **Панели элементов** или становятся недоступными, а также запрещается перетаскивание элементов из окна **Источники данных** в документ.  
  
## ServerDocument и защищенные документы  
 Если документ защищен, то обращение к кэшу данных извне невозможно.  Разработчик не может использовать класс <xref:Microsoft.VisualStudio.Tools.Applications.ServerDocument> для извлечения или управления данными, которые кэшируются в защищенном документе, а также использовать другие методы класса <xref:Microsoft.VisualStudio.Tools.Applications.Runtime.ServerDocument>.  
  
## Защита документов Word в конструкторе  
 Если защита добавляется к документу или шаблону Word в то время, пока он открыт в Visual Studio, нельзя принудительно включить защиту в конструкторе.  Когда документ открыт в Visual Studio, он находится в режиме конструктора, и он должен находиться в режиме выполнения перед принудительным включением защиты.  
  
 Тем не менее, при создании проекта, использующего существующий документ Word со включенной защитой, открытый в конструкторе документ будет защищен.  Нельзя изменять защищенные части документа, но можно писать код в редакторе кода для автоматизации документа.  Также нельзя построить проект, если защита включена в то время, пока документ открыт в Visual Studio.  
  
 Можно отключить защиту, пока документ находится в конструкторе, чтобы отредактировать документ и построить проект.  Нельзя отключить защиту для копии документа, открытой в конструкторе, пока идет отладка, так как документ, который открывается во время отладки, является отдельной копией документа, открытого в конструкторе \(выходная копия сохраняется в каталоге \\bin для Visual Basic и \\bin\\debug для C\#\).  
  
 Можно включить защиту той копии документа, которая открыта в конструкторе. Для этого нужно закрыть проект в Visual Studio, открыть копию документа, которая находится в каталоге проекта, и включить защиту.  
  
## Принудительная защита документа Word при построении проекта  
 Visual Studio включает принудительную защиту для документов и шаблонов Word при построении проекта, поэтому защита документа включена, когда он открыт для отладки.  Документ защищается пустым паролем.  
  
 Поскольку защита включена при построения проекта, если в событии документа <xref:Microsoft.Office.Tools.Word.Document.Startup> есть код, который может вызвать исключение или изменить поведение приложения, этот код можно корректно отладить.  Если защита включается после открытия документа, код инициализации нельзя отладить или протестировать.  
  
## Установка пароля  
 Visual Studio автоматически включает защиту, но не устанавливает пароль по умолчанию.  Если требуется, чтобы документ был защищен паролем, добавьте его перед развертыванием решения.  Добавление пароля позволит полномочным пользователям снять защиту с документа, в то время как без пароля защиту легко снять нельзя.  Подробные сведения об установке пароля см. в справке по конкретному приложению Office.  
  
## См. также  
 [Практическое руководство. Программная защита документов и их частей](../vsto/how-to-programmatically-protect-documents-and-parts-of-documents.md)   
 [Образцы и пошаговые руководства разработки Office](../vsto/office-development-samples-and-walkthroughs.md)   
 [Общие сведения об управлении правами на доступ к данным и расширениях управляемого кода](../vsto/information-rights-management-and-managed-code-extensions-overview.md)   
 [Защита паролей в документах Office](../vsto/password-protection-on-office-documents.md)   
 [Практическое руководство. Выполнение с выделенным кодом документов с ограниченными разрешениями](../vsto/how-to-permit-code-to-run-behind-documents-with-restricted-permissions.md)   
 [Проектирование и создание решений Office](../vsto/designing-and-creating-office-solutions.md)  
  
  