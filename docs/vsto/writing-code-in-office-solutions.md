---
title: "Написание кода в решениях Office"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "VST.Project.RefactoringCancelled"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "решения [разработка решений Office в Visual Studio], написание кода"
  - "управляемый код [разработка решений Office в Visual Studio]"
  - "разработка решений Office в Visual Studio, поддерживаемые языки программирования"
  - "приложения Office [разработка решений Office в Visual Studio], автоматизация"
  - "приложения Office [разработка решений Office в Visual Studio], написание кода"
  - "написание кода для решений Office"
  - "программирование [разработка решений Office в Visual Studio], модель"
  - "автоматизация [разработка решений Office в Visual Studio], управляемый код"
  - "разработка приложений [разработка решений Office в Visual Studio], модель программирования"
  - "решения Office [разработка решений Office в Visual Studio], написание кода"
  - "автоматизация приложений Office"
  - "разработка приложений [разработка решений Office в Visual Studio], написание кода"
  - "разработка приложений [разработка решений Office в Visual Studio], автоматизация"
  - "проекты Office [разработка решений Office в Visual Studio], изменение пространств имен"
  - "решения [разработка решений Office в Visual Studio], модель программирования"
  - "программирование [разработка решений Office в Visual Studio]"
  - "пространства имен [разработка решений Office в Visual Studio], изменение в решениях Office"
  - "проекты [разработка решений Office в Visual Studio], написание кода"
  - "приложения Office [разработка решений Office в Visual Studio], модель программирования"
  - "расширения управляемого кода [разработка решений Office в Visual Studio], написание кода"
ms.assetid: 2d4d8fd0-e881-4829-976f-0d1a9221dec0
caps.latest.revision: 37
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 36
---
# Написание кода в решениях Office
  Написание кода в проектах Office и в проектах других типов в Visual Studio несколько отличается друг от друга. Многие из этих отличий связаны с тем, каким образом объектные модели Office предоставляются управляемому коду. Другие отличия связаны со структурой проектов Office.  
  
 [!INCLUDE[appliesto_all](../vsto/includes/appliesto-all-md.md)]  
  
## Управляемый код и программирование для Office  
 Основная технология, делающая возможным создание интегрированного решения Microsoft Office, — это автоматизация, которая является частью технологии объектной модели компонентов \(COM\). Автоматизация позволяет использовать код для создания и управления программными объектами, предоставляемыми любым приложением, библиотекой DLL или элементом ActiveX, которые поддерживают соответствующие программные интерфейсы.  
  
### Основные сведения об основных сборках взаимодействия  
 Приложения Microsoft Office предоставляют многие свои функциональные возможности для автоматизации. Однако непосредственно для автоматизации приложений Office управляемый код \(например, Visual Basic или C\#\) использовать нельзя. Для автоматизации приложений Office с помощью управляемого кода необходимо использовать основные сборки взаимодействия \(PIA\) для Office. Основная сборка взаимодействия позволяет управляемому коду взаимодействовать с основанной на COM объектной моделью приложений Office.  
  
 Каждое приложение Microsoft Office имеет сборку PIA. При создании проекта Office в Visual Studio ссылка на соответствующую сборку PIA автоматически добавляется в проект. Чтобы автоматизировать функции других приложений Office из проекта, необходимо вручную добавить ссылку на соответствующую сборку PIA. Дополнительные сведения см. в разделе [Практическое руководство. Обращение к приложениям Office с помощью основных сборок взаимодействия](../vsto/how-to-target-office-applications-through-primary-interop-assemblies.md).  
  
### Использование основных сборок взаимодействия на этапе разработки и во время выполнения  
 Для выполнения большинства задач разработки необходимо, чтобы основные сборки взаимодействия Office были установлены и зарегистрированы в глобальном кэше сборок на компьютере разработчика. Для получения дополнительной информации см. [Настройка компьютера для разработки решений Office](../vsto/configuring-a-computer-to-develop-office-solutions.md).  
  
 Наличие основных сборок взаимодействия Office на компьютере конечного пользователя для запуска решений Office, предназначенных для [!INCLUDE[net_v40_short](../sharepoint/includes/net-v40-short-md.md)] или более поздних версий, не требуется. Дополнительные сведения см. в разделе [Проектирование и создание решений Office](../vsto/designing-and-creating-office-solutions.md).  
  
### Использование типов в основных сборках взаимодействия  
 Основные сборки взаимодействия Office содержат комбинацию типов, предоставляющих объектную модель приложений Office и дополнительные типы инфраструктуры, которые не предназначены для прямого использования в коде. Общие сведения о типах в основных сборках взаимодействия Office см. в разделе [Overview of Classes and Interfaces in the Office Primary Interop Assemblies](http://msdn.microsoft.com/ru-ru/da92dc3c-8209-44de-8095-a843659368d5).  
  
 Так как типы в сборках Office PIA соответствуют типам в основанных на COM объектных моделях, способ использования этих типов часто отличается от других управляемых типов. Например, способ вызова методов, имеющих необязательные параметры, в основной сборке взаимодействия Office зависит от языка программирования, применяемого в вашем проекте. Дополнительные сведения см. в следующих разделах:  
  
-   [Необязательные параметры в решениях Office](../vsto/optional-parameters-in-office-solutions.md).  
  
-   [Позднее связывание в решениях Office](../vsto/late-binding-in-office-solutions.md).  
  
## Модель программирования для проектов Office  
 Все проекты Office содержат один или несколько созданных классов, которые предоставляют точку входа для кода. Эти классы также обеспечивают доступ к объектной модели ведущего приложения, а также доступ к функциям, например, к панелям действий и настраиваемым областям задач.  
  
### Основные сведения о созданных классах  
 В проектах уровня документа для Excel и Word созданный класс похож на объект верхнего уровня в объектной модели приложения. Например, созданный класс `ThisDocument` в проекте документа Word содержит те же элементы, что и класс <xref:Microsoft.Office.Interop.Word.Document> в объектной модели Word. Дополнительные сведения о созданных классах в проектах уровня документа см. в статье [Настройки программирования уровня документа](../vsto/programming-document-level-customizations.md).  
  
 Проекты надстроек VSTO предоставляют созданный класс с именем `ThisAddIn`. Этот класс не похож на класс в объектной модели ведущего приложения. Он представляет саму надстройку VSTO, а также содержит члены, которые можно использовать для доступа к объектной модели ведущего приложения и доступа к другим функциям, доступным для надстроек VSTO. Дополнительные сведения см. в разделе [Приступая к программированию надстроек VSTO](../vsto/programming-vsto-add-ins.md).  
  
 Все созданные классы в проектах Office содержат обработчики событий `Startup` и `Shutdown`. Чтобы начать процесс написания кода, обычно код добавляется в эти обработчики событий. Для инициализации надстройки VSTO можно добавить код в обработчик событий `Startup`. Чтобы очистить ресурсы, используемые надстройкой VSTO, можно добавить код в обработчик событий `Shutdown`. Для получения дополнительной информации см. [События в проектах Office](../vsto/events-in-office-projects.md).  
  
### Доступ к созданным классам во время выполнения  
 При загрузке решения Office среда [!INCLUDE[vsto_runtime](../vsto/includes/vsto-runtime-md.md)] создает экземпляры всех созданных классов в проекте. Для доступа к этим объектам из любого кода в вашем проекте можно использовать класс `Globals`. Например, можно использовать класс `Globals` для вызова кода в классе `ThisAddIn` из обработчика событий кнопки "Лента" в надстройке VSTO.  
  
 Для получения дополнительной информации см. [Глобальный доступ к объектам в проектах Office](../vsto/global-access-to-objects-in-office-projects.md).  
  
### Рекомендации по пространству имен в решениях Office  
 После создания проекта *пространство имен по умолчанию* \(или *корневое пространство имен* в Visual Basic\) проекта Office изменить будет нельзя. Пространство имен по умолчанию будет всегда соответствовать имени проекта, указанному при создании проекта. Если проект переименовать, пространство имен по умолчанию изменено не будет. Дополнительные сведения о пространстве имен по умолчанию в проектах см. в разделах [Страница "Приложение" в конструкторе проектов &#40;C&#35;&#41;](../ide/reference/application-page-project-designer-csharp.md) и [Страница «Приложение» в конструкторе проектов &#40;Visual Basic&#41;](../ide/reference/application-page-project-designer-visual-basic.md).  
  
### Изменение пространства имен классов ведущих элементов в проектах C\#  
 В проектах Office на Visual C\# классы ведущих элементов \(например, `ThisAddIn`, `ThisWorkbook` или `ThisDocument`\) имеют собственные пространства имен. По умолчанию пространство имен для ведущих элементов в проекте совпадает с именем проекта, которое было указано при создании проекта.  
  
 Чтобы изменить пространство имен ведущих элементов в проекте Office на Visual C\#, используйте свойство **Пространство имен для элемента узла**. Для получения дополнительной информации см. [Свойства в проектах Office](../vsto/properties-in-office-projects.md).  
  
## Поддерживаемые языки программирования в проектах Office  
 Шаблоны проектов Office в Visual Studio поддерживает только языки программирования Visual Basic и Visual C\#. Поэтому эти шаблоны проектов доступны только в узлах **Visual Basic** и **Visual C\#** в диалоговом окне **Создание проекта** в [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)]. Дополнительные сведения см. в разделе [Практическое руководство. Создание проектов Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).  
  
## Выбор языка и программирование для Office  
 Microsoft Office и Visual Basic для приложений \(VBA\) были разработаны для совместной работы с целью оптимизации рабочего процесса настройки приложения. Язык Visual Basic унаследовал некоторые результаты этих разработок. Например, Visual Basic поддерживает необязательные параметры. Это означает, что по сравнению с языком Visual C\#, вы можете написать меньше кода при вызове некоторых методов в основных сборках взаимодействия Microsoft Office.  
  
## Программирование на Visual Basic или на Visual C\# в решениях Office  
 Решения Office можно создавать с помощью языков Visual Basic или Visual C\#. Так как объектные модели Microsoft Office были разработаны для использования с Microsoft Visual Basic для приложений \(VBA\), разработчики Visual Basic могут комфортно работать с объектами, предоставляемыми приложениями Microsoft Office. Разработчики Visual C\# могут использовать большинство тех же функций, что и разработчики Visual Basic. Но в некоторых случаях для использования объектной модели Office им необходимо написать дополнительный код. Основы процедур программирования при разработке решений Office и написание управляемого кода на Visual Basic и C\# немного отличаются.  
  
## Основные различия между Visual Basic и Visual C\#  
 В следующей таблице показаны основные различия между Visual Basic и Visual C\# при разработке решений Office.  
  
|Функция|Описание|Поддержка Visual Basic|Поддержка Visual C\#|  
|-------------|--------------|----------------------------|--------------------------|  
|Необязательные параметры|Многие методы Microsoft Office имеют параметры, которые не являются обязательными при вызове метода. Если для параметра никакое значение не передается, используется значение по умолчанию.|Visual Basic поддерживает необязательные параметры.|Visual C\# поддерживает необязательные параметры в большинстве случаев. Для получения дополнительной информации см. [Необязательные параметры в решениях Office](../vsto/optional-parameters-in-office-solutions.md).|  
|Передача параметров по ссылке|В большинстве основных сборок взаимодействия Microsoft Office необязательные параметры могут передаваться по значению. Однако в некоторых основных сборках взаимодействия необязательные параметры, которые принимают ссылочные типы, должны передаваться по ссылке.<br /><br /> Дополнительные сведения о параметрах типов значений и ссылочных типов см. в разделах [Передача аргументов по значению и по ссылке &#40;Visual Basic&#41;](/dotnet/visual-basic/programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference) \(для Visual Basic\) и [Передача параметров &#40;Руководство по программированию в C&#35;&#41;](/dotnet/csharp/programming-guide/classes-and-structs/passing-parameters).|Для передачи параметров по ссылке дополнительные действия не требуются. При необходимости компилятор Visual Basic автоматически передает параметры по ссылке.|В большинстве случаев компилятор Visual C\# автоматически передает параметры по ссылке. Для получения дополнительной информации см. [Необязательные параметры в решениях Office](../vsto/optional-parameters-in-office-solutions.md).|  
|Параметризованные свойства|Некоторые свойства принимают параметры и действуют как функции только для чтения.|Visual Basic поддерживает свойства, принимающие параметры.|Visual C\# поддерживаются свойства, принимающие параметры.|  
|Позднее связывание|Позднее связывание подразумевает определение свойств объектов во время выполнения, а не приведение переменных к типу объекта во время разработки.|Visual Basic выполняет позднее связывание, если параметр **Option Strict**  отключен. Если параметр **Option Strict** включен, для доступа к членам с поздним связыванием необходимо явным образом преобразовать объекты и использовать типы в пространстве имен <xref:System.Reflection>. Дополнительные сведения см. в разделе [Позднее связывание в решениях Office](../vsto/late-binding-in-office-solutions.md).|Visual C\# выполняет позднее связывание в проектах, предназначенных для [!INCLUDE[net_v40_short](../sharepoint/includes/net-v40-short-md.md)]. Дополнительные сведения см. в разделе [Позднее связывание в решениях Office](../vsto/late-binding-in-office-solutions.md).|  
  
## Основные различия между разработкой для Office и управляемым кодом  
 В таблице ниже указаны основные различия между разработкой для Office и управляемым кодом, написанным на Visual Basic или Visual C\#.  
  
|Функция|Описание|Поддержка Visual Basic и Visual C\#|  
|-------------|--------------|-----------------------------------------|  
|Индексы массивов|Нижняя граница массива коллекций в приложениях Microsoft Office начинается с 1. Visual Basic и Visual C\# используют массивы, которые начинаются с нуля. Дополнительные сведения см. в разделах [Массивы &#40;Руководство по программированию на C&#35;&#41;](/dotnet/csharp/programming-guide/arrays/index) и [Массивы в Visual Basic](/dotnet/visual-basic/programming-guide/language-features/arrays/index).|Для доступа к первому элементу коллекции в объектной модели приложения Microsoft Office используйте индекс 1 вместо 0.|  
  
## См. также  
 [Необязательные параметры в решениях Office](../vsto/optional-parameters-in-office-solutions.md)   
 [Глобальный доступ к объектам в проектах Office](../vsto/global-access-to-objects-in-office-projects.md)   
 [События в проектах Office](../vsto/events-in-office-projects.md)   
 [Практическое руководство. Обращение к приложениям Office с помощью основных сборок взаимодействия](../vsto/how-to-target-office-applications-through-primary-interop-assemblies.md)   
 [Практическое руководство. Создание обработчиков событий в проектах Office](../vsto/how-to-create-event-handlers-in-office-projects.md)   
 [Позднее связывание в решениях Office](../vsto/late-binding-in-office-solutions.md)   
 [Совместная разработка решений Office](../vsto/collaborative-development-of-office-solutions.md)  
  
  