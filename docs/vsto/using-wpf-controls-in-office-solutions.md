---
title: "Использование элементов управления WPF в решениях Office"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "WPF [разработка решений Office в Visual Studio]"
ms.assetid: 305a212b-0a95-40ad-87aa-22896fe80a04
caps.latest.revision: 25
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 24
---
# Использование элементов управления WPF в решениях Office
  Хотя решения, созданные с помощью средств разработки Office в Visual Studio, предназначены для работы непосредственно с элементами управления Windows Forms, в них также можно использовать элементы управления WPF.  Windows Presentation Foundation \(WPF\) — это альтернатива Windows Forms для разработки пользовательских интерфейсов.  WPF использует язык разметки XAML для реализации новых методов включения элементов пользовательского интерфейса, объектов мультимедиа и документов.  Дополнительные сведения см. в разделе [Введение в WPF в Visual Studio 2015](http://msdn.microsoft.com/library/582a314e-e23d-4144-b45b-acbbd5579252).  
  
 [!INCLUDE[appliesto_all](../vsto/includes/appliesto-all-md.md)]  
  
 Любой элемент пользовательского интерфейса, который может содержать элементы управления Windows Forms в решении Office, может содержать и элементы управления WPF.  К ним относятся:  
  
-   документы и книги в настройках уровня документа;  
  
-   панели действий в настройках уровня документа;  
  
-   настраиваемые области задач в надстройках VSTO;  
  
-   области формы в надстройках VSTO для Outlook.  
  
## Добавление элементов управления WPF в проекты Office во время разработки  
 Невозможно добавить элементы управления WPF напрямую в элементы пользовательского интерфейса в решениях Office.  Вместо этого добавьте элемент **Пользовательский элемент управления \(WPF\)** в проект, а затем используйте его в качестве рабочей области конструирования для элементов управления WPF.  Затем добавьте пользовательский элемент управления WPF в элемент пользовательского интерфейса в проекте.  
  
#### Добавление элементов управления WPF в панель действий, настраиваемую область задач или область формы  
  
1.  Откройте проект, в который требуется добавить настраиваемую область задач, панель действий или область формы.  
  
2.  Добавьте элемент **Пользовательский элемент управления \(WPF\)** в проект.  
  
3.  Добавьте элементы управления WPF из **панели элементов** в рабочую область конструирования пользовательского элемента управления WPF.  
  
     По умолчанию, когда конструктор пользовательских элементов управления WPF открыт, **панель элементов** содержит только элементы управления WPF.  
  
4.  Выполните построение проекта.  
  
5.  Добавьте в проект панель действий, область формы или настраиваемую область задач:  
  
    -   Для областей формы добавьте элемент **Область формы Outlook** в проект.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).  
  
    -   Для панели действий добавьте элемент **Панель действий** или **Пользовательский элемент управления** в проект.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md) и [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md).  
  
    -   Для настраиваемых областей задач добавьте элемент **Пользовательский элемент управления** в проект.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление настраиваемой панели задач в приложение](../vsto/how-to-add-a-custom-task-pane-to-an-application.md).  
  
6.  Из вкладки *имя\_проекта* **Пользовательские элементы управления WPFпанели элементов** перетащите пользовательский элемент управления WPF в конструктор панели действий, области формы или настраиваемой области задач.  
  
     Visual Studio автоматически создает объект <xref:System.Windows.Forms.Integration.ElementHost>, в котором размещается пользовательский элемент управления WPF, в элементе пользовательского интерфейса.  
  
7.  Перестройте проект.  
  
#### Добавление элементов управления WPF в документ или на лист в проекте уровня документа  
  
1.  Откройте проект уровня документа для Word или Excel.  
  
2.  Добавьте элемент **Пользовательский элемент управления \(WPF\)** в проект.  
  
3.  Добавьте элементы управления WPF из **панели элементов** в рабочую область конструирования пользовательского элемента управления WPF.  
  
4.  Выполните построение проекта.  
  
5.  Добавьте в проект элемент **Пользовательский элемент управления** \(т. е. пользовательский элемент управления Windows Forms\).  
  
6.  Откройте конструктор пользовательского элемента управления Windows Forms.  
  
7.  Из вкладки *имя\_проекта* **Пользовательские элементы управления WPFпанели элементов** перетащите пользовательский элемент управления WPF в конструктор.  
  
     Visual Studio автоматически создает объект <xref:System.Windows.Forms.Integration.ElementHost>, в котором размещается пользовательский элемент управления WPF, в пользовательском элементе управления Windows Forms.  
  
8.  Напишите код, который программными средствами добавляет пользовательский элемент управления Windows Forms в документ или на лист.  Дополнительные сведения см. в разделе [Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md).  
  
    > [!NOTE]  
    >  В конструкторе невозможно перетащить пользовательский элемент управления Windows Forms в документ или на лист.  
  
9. Перестройте проект.  
  
## Размещение элементов управления WPF с помощью класса ElementHost  
 Visual Studio предоставляет средства, помогающие использовать элементы управления Windows Forms в решениях Office, но не предоставляет аналогичные функциональные возможности для элементов управления WPF.  Например, вы можете добавить элементы управления Windows Forms в документы и на листы во время разработки, перетаскивая элементы из **панели элементов**, или во время выполнения с помощью вспомогательных методов.  Однако эти средства недоступны для элементов управления WPF.  
  
 Элементы управления WPF используют класс <xref:System.Windows.Forms.Integration.ElementHost> как уровень интеграции между элементом управления или формой Windows Forms и элементом управления WPF.  При добавлении элементов управления WPF в решение во время разработки Visual Studio автоматически создает объект <xref:System.Windows.Forms.Integration.ElementHost>.  
  
## Ресурсы WPF  
 Дополнительные сведения об архитектуре и проектировании для размещения элементов управления WPF в элементах управления и формах Windows Forms см. в следующих разделах:  
  
-   [Windows Forms и архитектура ввода взаимодействия WPF](http://msdn.microsoft.com/library/0eb6f137-f088-4c5e-9e37-f96afd28f235)  
  
-   [Сопоставление свойств Windows Forms и WPF](http://msdn.microsoft.com/library/999d8298-9c04-467d-a453-86e41002057d)  
  
-   [Взаимодействие WPF и Windows Forms](http://msdn.microsoft.com/library/9e8aa6b6-112c-4579-98d1-c974917df499)  
  
-   [Элементы управления Windows Forms и эквивалентные элементы управления WPF](http://msdn.microsoft.com/library/8a157e6b-8054-46db-a5cf-a78966acc7a1)  
  
 Дополнительные сведения о добавлении элементов управления WPF к элементам управления и формам Windows Forms в Visual Studio во время разработки см. в следующих разделах:  
  
-   [Пошаговое руководство. Создание нового содержимого WPF для формы Windows Forms во время разработки](http://msdn.microsoft.com/library/2e92d8e8-f0e4-4df7-9f07-2acf35cd798c)  
  
-   [Пошаговое руководство. Упорядочение содержимого WPF для формы Windows Forms во время разработки](http://msdn.microsoft.com/library/5efb1c53-1484-43d6-aa8a-f4861b99bb8a)  
  
-   [Пошаговое руководство. Применение стилей к содержимому WPF](http://msdn.microsoft.com/library/e574aac7-7ea4-4cdb-8034-bab541f000df)  
  
## См. также  
 [Настройка пользовательского интерфейса Office](../vsto/office-ui-customization.md)   
 [Общие сведения об использовании элементов управления Windows Forms в документах Office](../vsto/windows-forms-controls-on-office-documents-overview.md)   
 [Общие сведения о панели действий](../vsto/actions-pane-overview.md)   
 [Настраиваемые области задач](../vsto/custom-task-panes.md)   
 [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md)   
 [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md)   
 [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md)   
 [Практическое руководство. Добавление настраиваемой панели задач в приложение](../vsto/how-to-add-a-custom-task-pane-to-an-application.md)   
 [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)  
  
  