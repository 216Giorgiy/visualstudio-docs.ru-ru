---
title: "Использование элементов управления WPF в решениях Office | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "WPF [разработка решений Office в Visual Studio]"
ms.assetid: 305a212b-0a95-40ad-87aa-22896fe80a04
caps.latest.revision: 25
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 24
---
# Использование элементов управления WPF в решениях Office
  Хотя решения, созданные с помощью средств разработки Office в Visual Studio, предназначены для работы непосредственно с элементами управления Windows Forms, в них также можно использовать элементы управления WPF.  Windows Presentation Foundation \(WPF\) — это альтернатива Windows Forms для разработки пользовательских интерфейсов.  WPF использует язык разметки XAML для реализации новых методов включения элементов пользовательского интерфейса, объектов мультимедиа и документов.  Дополнительные сведения см. в разделе [Введение в WPF в Visual Studio 2015](../Topic/Introduction%20to%20WPF%20in%20Visual%20Studio%202015.md).  
  
 [!INCLUDE[appliesto_all](../vsto/includes/appliesto-all-md.md)]  
  
 Любой элемент пользовательского интерфейса, который может содержать элементы управления Windows Forms в решении Office, может содержать и элементы управления WPF.  К ним относятся:  
  
-   документы и книги в настройках уровня документа;  
  
-   панели действий в настройках уровня документа;  
  
-   настраиваемые области задач в надстройках VSTO;  
  
-   области формы в надстройках VSTO для Outlook.  
  
## Добавление элементов управления WPF в проекты Office во время разработки  
 Невозможно добавить элементы управления WPF напрямую в элементы пользовательского интерфейса в решениях Office.  Вместо этого добавьте элемент **Пользовательский элемент управления \(WPF\)** в проект, а затем используйте его в качестве рабочей области конструирования для элементов управления WPF.  Затем добавьте пользовательский элемент управления WPF в элемент пользовательского интерфейса в проекте.  
  
#### Добавление элементов управления WPF в панель действий, настраиваемую область задач или область формы  
  
1.  Откройте проект, в который требуется добавить настраиваемую область задач, панель действий или область формы.  
  
2.  Добавьте элемент **Пользовательский элемент управления \(WPF\)** в проект.  
  
3.  Добавьте элементы управления WPF из **панели элементов** в рабочую область конструирования пользовательского элемента управления WPF.  
  
     По умолчанию, когда конструктор пользовательских элементов управления WPF открыт, **панель элементов** содержит только элементы управления WPF.  
  
4.  Выполните построение проекта.  
  
5.  Добавьте в проект панель действий, область формы или настраиваемую область задач:  
  
    -   Для областей формы добавьте элемент **Область формы Outlook** в проект.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).  
  
    -   Для панели действий добавьте элемент **Панель действий** или **Пользовательский элемент управления** в проект.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md) и [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md).  
  
    -   Для настраиваемых областей задач добавьте элемент **Пользовательский элемент управления** в проект.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление настраиваемой панели задач в приложение](../vsto/how-to-add-a-custom-task-pane-to-an-application.md).  
  
6.  Из вкладки *имя\_проекта* **Пользовательские элементы управления WPFпанели элементов** перетащите пользовательский элемент управления WPF в конструктор панели действий, области формы или настраиваемой области задач.  
  
     Visual Studio автоматически создает объект <xref:System.Windows.Forms.Integration.ElementHost>, в котором размещается пользовательский элемент управления WPF, в элементе пользовательского интерфейса.  
  
7.  Перестройте проект.  
  
#### Добавление элементов управления WPF в документ или на лист в проекте уровня документа  
  
1.  Откройте проект уровня документа для Word или Excel.  
  
2.  Добавьте элемент **Пользовательский элемент управления \(WPF\)** в проект.  
  
3.  Добавьте элементы управления WPF из **панели элементов** в рабочую область конструирования пользовательского элемента управления WPF.  
  
4.  Выполните построение проекта.  
  
5.  Добавьте в проект элемент **Пользовательский элемент управления** \(т. е. пользовательский элемент управления Windows Forms\).  
  
6.  Откройте конструктор пользовательского элемента управления Windows Forms.  
  
7.  Из вкладки *имя\_проекта* **Пользовательские элементы управления WPFпанели элементов** перетащите пользовательский элемент управления WPF в конструктор.  
  
     Visual Studio автоматически создает объект <xref:System.Windows.Forms.Integration.ElementHost>, в котором размещается пользовательский элемент управления WPF, в пользовательском элементе управления Windows Forms.  
  
8.  Напишите код, который программными средствами добавляет пользовательский элемент управления Windows Forms в документ или на лист.  Дополнительные сведения см. в разделе [Добавление элементов управления в документы Office во время выполнения](../vsto/adding-controls-to-office-documents-at-run-time.md).  
  
    > [!NOTE]  
    >  В конструкторе невозможно перетащить пользовательский элемент управления Windows Forms в документ или на лист.  
  
9. Перестройте проект.  
  
## Размещение элементов управления WPF с помощью класса ElementHost  
 Visual Studio предоставляет средства, помогающие использовать элементы управления Windows Forms в решениях Office, но не предоставляет аналогичные функциональные возможности для элементов управления WPF.  Например, вы можете добавить элементы управления Windows Forms в документы и на листы во время разработки, перетаскивая элементы из **панели элементов**, или во время выполнения с помощью вспомогательных методов.  Однако эти средства недоступны для элементов управления WPF.  
  
 Элементы управления WPF используют класс <xref:System.Windows.Forms.Integration.ElementHost> как уровень интеграции между элементом управления или формой Windows Forms и элементом управления WPF.  При добавлении элементов управления WPF в решение во время разработки Visual Studio автоматически создает объект <xref:System.Windows.Forms.Integration.ElementHost>.  
  
## Ресурсы WPF  
 Дополнительные сведения об архитектуре и проектировании для размещения элементов управления WPF в элементах управления и формах Windows Forms см. в следующих разделах:  
  
-   [Windows Forms и архитектура ввода взаимодействия WPF](../Topic/Windows%20Forms%20and%20WPF%20Interoperability%20Input%20Architecture.md)  
  
-   [Сопоставление свойств Windows Forms и WPF](../Topic/Windows%20Forms%20and%20WPF%20Property%20Mapping.md)  
  
-   [Взаимодействие WPF и Windows Forms](../Topic/WPF%20and%20Windows%20Forms%20Interoperation.md)  
  
-   [Элементы управления Windows Forms и эквивалентные элементы управления WPF](../Topic/Windows%20Forms%20Controls%20and%20Equivalent%20WPF%20Controls.md)  
  
 Дополнительные сведения о добавлении элементов управления WPF к элементам управления и формам Windows Forms в Visual Studio во время разработки см. в следующих разделах:  
  
-   [Пошаговое руководство. Создание нового содержимого WPF для формы Windows Forms во время разработки](../Topic/Walkthrough:%20Creating%20New%20WPF%20Content%20on%20Windows%20Forms%20at%20Design%20Time.md)  
  
-   [Пошаговое руководство. Упорядочение содержимого WPF для формы Windows Forms во время разработки](../Topic/Walkthrough:%20Arranging%20WPF%20Content%20on%20Windows%20Forms%20at%20Design%20Time.md)  
  
-   [Пошаговое руководство. Применение стилей к содержимому WPF](../Topic/Walkthrough:%20Styling%20WPF%20Content.md)  
  
## См. также  
 [Настройка пользовательского интерфейса Office](../vsto/office-ui-customization.md)   
 [Общие сведения об использовании элементов управления Windows Forms в документах Office](../vsto/windows-forms-controls-on-office-documents-overview.md)   
 [Общие сведения о панели действий](../vsto/actions-pane-overview.md)   
 [Настраиваемые области задач](../vsto/custom-task-panes.md)   
 [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md)   
 [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md)   
 [Практическое руководство. Добавление области действий в документы Word или книги Excel](../vsto/how-to-add-an-actions-pane-to-word-documents-or-excel-workbooks.md)   
 [Практическое руководство. Добавление настраиваемой панели задач в приложение](../vsto/how-to-add-a-custom-task-pane-to-an-application.md)   
 [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)  
  
  