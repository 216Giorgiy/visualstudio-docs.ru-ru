---
title: "Пошаговое руководство. Разработка области формы Outlook"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "области формы [разработка решений Office в Visual Studio], создание"
ms.assetid: b033fc06-cdeb-4d7f-804b-86d15bfa022a
caps.latest.revision: 41
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 40
---
# Пошаговое руководство. Разработка области формы Outlook
  Пользовательские области формы расширяют стандартные или настраиваемые формы Microsoft Office Outlook.  В этом пошаговом руководстве показано, как проектировать пользовательскую область формы, которая отображается в виде новой страницы в окне инспектора элемента контактов.  В этой области формы отображается карта каждого адреса, указанного для контакта, путем отправки информации об адресе на веб\-сайт локального поиска Windows Live.  Дополнительные сведения об областях формы см. в разделе [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md).  
  
 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Создание нового проекта надстройки Outlook VSTO  
  
-   Добавление области формы в проект надстройки VSTO  
  
-   Разработка макета области формы  
  
-   Настройка поведения области формы  
  
-   Тестирование области формы Outlook  
  
> [!NOTE]  
>  Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях.  Это зависит от имеющегося выпуска Visual Studio и используемых параметров.  Дополнительные сведения см. в разделе [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]  
  
-   [!INCLUDE[Outlook_15_short](../vsto/includes/outlook-15-short-md.md)] или [!INCLUDE[Outlook_14_short](../vsto/includes/outlook-14-short-md.md)].  
  
 ![ссылка на видео](~/docs/data-tools/media/playvideo.gif "ссылка на видео") Видеоверсию этого раздела см. на странице [Практическое видеоруководство. Разработка области формы Outlook](http://go.microsoft.com/fwlink/?LinkId=140824).  
  
## Создание нового проекта надстройки Outlook VSTO  
 Сначала создайте базовый проект надстройки VSTO.  
  
#### Порядок создания нового проекта надстройки Outlook VSTO  
  
1.  В [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] создайте проект надстройки Outlook VSTO с именем MapItAddIn.  
  
2.  В диалоговом окне **Создание проекта** выберите **Создать каталог для решения**.  
  
3.  Сохраните проект в любом каталоге.  
  
     Дополнительные сведения см. в разделе [Практическое руководство. Создание проектов Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).  
  
## Добавление области формы в проект надстройки Outlook VSTO  
 Решение надстройки Outlook VSTO может содержать один или несколько элементов области формы Outlook.  Добавьте в проект элемент области формы с помощью мастера **Новая область формы Outlook**.  
  
#### Порядок добавления области формы в проект надстройки Outlook VSTO  
  
1.  В **обозревателе решений** выберите проект **MapItAddIn**.  
  
2.  В меню **Проект** выберите пункт **Добавить новый элемент**.  
  
3.  В диалоговом окне **Добавление нового элемента** выберите **Область формы Outlook**, назначьте файлу имя MapIt и нажмите кнопку **Добавить**.  
  
     Запускается мастер **Новаяобласть формы Outlook**.  
  
4.  На странице **Выберите способ создания области формы** щелкните **Создать новую область формы** и нажмите кнопку **Далее**.  
  
5.  На странице **Выберите тип области формы, которую следует создать** щелкните **Отдельные** и нажмите кнопку **Далее**.  
  
     *Отдельная* область формы добавляет новую страницу в форму Outlook.  Дополнительные сведения о типах областей формы см. в разделе [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md).  
  
6.  На странице **Введите текст описания и выберите параметры отображения** введите **Map It** в поле **Имя**.  
  
     Это имя отображается на ленте окна инспектора при открытии элемента контактов.  
  
7.  Выберите **Инспекторы в режиме создания** и **Инспекторы в режиме чтения**, а затем нажмите кнопку **Далее**.  
  
8.  На странице **Укажите классы сообщений, в которых будет отображаться эта область формы** снимите флажок **Сообщение**, выберите **Контакт** и нажмите кнопку **Готово**.  
  
     Файл MapIt.cs или MapIt.vb добавляется в проект.  
  
## Разработка макета области формы.  
 Для визуальной разработки областей формы используйте *Конструктор областей формы*.  Управляемые элементы управления можно перетаскивать на поверхность конструктора областей формы.  Для настройки макета и внешнего вида элемента управления используйте конструктор и окно **Свойства**.  
  
#### Порядок разработки макета области формы  
  
1.  В **обозревателе решений** разверните проект **MapItAddIn**, а затем дважды щелкните файл MapIt.cs или MapIt.vb, чтобы открыть конструктор областей формы.  
  
2.  Щелкните правой кнопкой мыши конструктор и выберите пункт **Свойства**.  
  
3.  В окне **Свойства** в поле **Размер** установите значение 664, 469.  
  
     Это гарантирует, что область формы будет достаточно большой, чтобы отображать карту.  
  
4.  В меню **Вид** выберите пункт **Панель элементов**.  
  
5.  На вкладке **Общие элементы управления** окна **Панель элементов** добавьте **WebBrowser** в область формы.  
  
     **WebBrowser**будет отображать карту каждого адреса, включенного в контакт.  
  
## Настройка поведения области формы  
 Для настройки поведения области формы во время выполнения добавьте код в обработчики событий области формы.  Для этой области формы код проверяет свойства элемента Outlook и определяет, следует ли отображать область формы Map It.  Если область формы отображается, код переходит на веб\-сайт локального поиска Windows Live и загружает карту для каждого адреса, включенного в элемент контактов Outlook.  
  
#### Порядок настройки поведения области формы  
  
1.  В **обозревателе решений** щелкните правой кнопкой мыши файл MapIt.cs или MapIt.vb, а затем выберите команду **Просмотреть код**.  
  
     Файл MapIt.cs или MapIt.vb открывается в редакторе кода.  
  
2.  Разверните область кода **Фабрика областей формы**.  
  
     Предоставляется класс фабрики областей формы с именем `MapItFactory`.  
  
3.  Добавьте следующий код в обработчик событий `MapItFactory_FormRegionInitializing`.  Этот обработчик событий будет вызываться, когда пользователь открывает элемент контактов.  Следующий код определяет, содержит ли элемент контактов адрес.  Если элемент контактов не содержит адрес, этот код устанавливает для свойства <xref:System.ComponentModel.CancelEventArgs.Cancel%2A> класса <xref:Microsoft.Office.Tools.Outlook.FormRegionInitializingEventArgs> значение **true** и область формы не отображается.  В противном случае надстройка VSTO выдает событие <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing> и отображает область формы.  
  
     [!code-csharp[Trin_Outlook_FR_Separate#1](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Outlook_FR_Separate/CS/MapIt.cs#1)]
     [!code-vb[Trin_Outlook_FR_Separate#1](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Outlook_FR_Separate/VB/MapIt.vb#1)]  
  
4.  Добавьте следующий код в обработчик событий <xref:Microsoft.Office.Tools.Outlook.FormRegionControl.FormRegionShowing>.  Этот код выполняет следующие задачи:  
  
    -   Сцепляет каждый адрес в элементе контактов и создает строку URL\-адреса.  
  
    -   Вызывает метод <xref:System.Windows.Forms.WebBrowser.Navigate%2A> объекта <xref:System.Windows.Forms.WebBrowser> и передает строку URL\-адреса в качестве параметра.  
  
     Веб\-сайт локального поиска отображается в области формы Map It и представляет каждый адрес в тестовой области.  
  
     [!code-csharp[Trin_Outlook_FR_Separate#2](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Outlook_FR_Separate/CS/MapIt.cs#2)]
     [!code-vb[Trin_Outlook_FR_Separate#2](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Outlook_FR_Separate/VB/MapIt.vb#2)]  
  
## Тестирование области формы Outlook  
 При запуске проекта в Visual Studio открывается Outlook.  Для просмотра области формы Map It откройте элемент контактов.  Область формы Map It отображается в виде страницы в форме каждого элемента контактов, содержащего адрес.  
  
#### Порядок тестирования области формы Map It  
  
1.  Для запуска проекта нажмите клавишу F5.  
  
     Открывается Outlook.  
  
2.  В Outlook на вкладке **Главная** щелкните **Новые элементы** и затем **Контакт**.  
  
3.  В форме контактов введите **Ann Beebe** в качестве имени контакта, а затем укажите три следующих адреса.  
  
    |Тип адреса|Адрес|  
    |----------------|-----------|  
    |**Business**|4567 Main St.  Buffalo, NY|  
    |**Главная**|1234 North St.  Buffalo, NY|  
    |**Другое**|3456 Main St.  Seattle, WA|  
  
4.  Сохраните и закройте элемент контактов.  
  
5.  Снова откройте элемент контактов **Ann Beebe**.  
  
6.  В группе **Показать** ленты элемента щелкните **Map It**, чтобы открыть область формы Map It.  
  
     Появляется область формы Map It, где отображается веб\-сайт локального поиска.  В тестовой области появляются адреса **Business**, **Home** и **Other**.  Выберите в тестовой области адрес, который необходимо сопоставить.  
  
## Следующие действия  
 Дополнительные сведения о настройке пользовательского интерфейса приложения Outlook см. в следующих разделах.  
  
-   Дополнительные сведения о настройке ленты элемента Outlook см. в разделе [Настройка ленты для Outlook](../vsto/customizing-a-ribbon-for-outlook.md).  
  
## См. также  
 [Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)   
 [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md)   
 [Рекомендации по созданию областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)   
 [Пошаговое руководство. Импорт области формы, созданной в Outlook](../vsto/walkthrough-importing-a-form-region-that-is-designed-in-outlook.md)   
 [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md)   
 [Связывание области формы с классом сообщений Outlook](../vsto/associating-a-form-region-with-an-outlook-message-class.md)   
 [Пользовательские действия в областях форм Outlook](../vsto/custom-actions-in-outlook-form-regions.md)   
 [Практическое руководство. Отсутствие отображения области формы в Outlook](../vsto/how-to-prevent-outlook-from-displaying-a-form-region.md)  
  
  