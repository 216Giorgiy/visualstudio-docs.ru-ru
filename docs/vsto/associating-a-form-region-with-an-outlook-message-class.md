---
title: "Связывание области формы с классом сообщений Outlook"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "VSTO.NewFormRegionWizard.InvalidMessageClassName"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "области формы [разработка решений Office в Visual Studio], классы сообщений"
  - "FormRegionMessageClassAttribute"
ms.assetid: e2db8d61-fd5f-4059-beec-33b66970f520
caps.latest.revision: 43
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 42
---
# Связывание области формы с классом сообщений Outlook
  Можно указать, какие элементы Microsoft Office Outlook отображают область формы путем связывания области формы с классом сообщений каждого элемента.  Например, если требуется присоединить область формы к нижней части сообщения, то можно связать область формы с классом сообщений IPM.Note.  
  
 Чтобы связать область формы с классом сообщений, укажите имя класса сообщений в мастере **Новая область формы Outlook** или примените атрибут к классу фабрики области формы.  
  
 [!INCLUDE[appliesto_olkallapp](../vsto/includes/appliesto-olkallapp-md.md)]  
  
## Основные сведения о классах сообщений Outlook  
 Класс сообщений Outlook определяет тип элемента Outlook.  В следующей таблице перечислены восемь стандартных типов элементов и имена их классов сообщений.  
  
|Тип элемента Outlook|Имя класса сообщений|  
|--------------------------|--------------------------|  
|AppointmentItem|IPM.Appointment|  
|ContactItem|IPM.Contact|  
|DistListItem|IPM.DistList|  
|JournalItem|IPM.Activity|  
|MailItem|IPM.Note|  
|PostItem|IPM.Post или IPM.Post.RSS|  
|TaskItem|IPM.Task|  
  
 Также можно указать имена пользовательских классов сообщений.  Пользовательские классы сообщений идентифицируют настраиваемые формы, определенные в Outlook.  
  
> [!NOTE]  
>  Для замены и групповой замены всех областей форм можно указать новое имя пользовательского класса сообщений.  Не нужно использовать имя класса сообщений существующей настраиваемой формы.  Имя пользовательского класса имен должно быть уникальным.  Один из способов обеспечения уникальности имени — это использование следующего соглашения об именовании: \<*StandardMessageClassName*\>.\<*Company*\>.\<*MessageClassName*\> \(например: IPM.Note.Contoso.MyMessageClass\).  
  
## Связывание области формы с классом сообщений Outlook  
 Существуют два способа связывания области формы с классом сообщений:  
  
-   Использование мастера **Новая область формы Outlook**.  
  
-   Применение атрибутов классов.  
  
### Использование мастера "Новая область формы Outlook".  
 На последней странице мастера **Новая область формы Outlook** можно выбрать стандартные классы сообщений и ввести имена пользовательских классов сообщений, которые следует связать с областью формы.  
  
 Стандартные классы сообщений недоступны, если область формы предназначена для замены всей формы или заданной по умолчанию страницы формы.  Можно указать имена стандартных классов сообщений только для форм, добавляющих новую страницу к форме или прикрепленных в нижней части формы.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).  
  
 Чтобы включить один или несколько пользовательских классов сообщений, введите их названия в поле **Какие пользовательские классы сообщений будут отображать эту область формы?**  
  
 При вводе имен необходимо соблюдать следующие рекомендации:  
  
-   Используйте полное имя класса сообщений \(например: "IPM.Note.Contoso"\).  
  
-   Используйте разделители для отделения нескольких имен классов сообщений.  
  
-   Не включайте стандартные классы сообщений Outlook, например, "IPM.Note" или "IPM.Contact".  Включайте только пользовательские классы сообщений, например, "IPM.Note.Contoso".  
  
-   Не указывайте основной класс сообщений \(например: "IPM"\).  
  
-   Не превышайте заданное количество символов для каждого класса сообщений \(256 символов\).  
  
 Мастер **Новая область формы Outlook** выполняет проверку формата вводимых данных при нажатии кнопки **Готово**.  
  
> [!NOTE]  
>  Мастер **Новая область формы Outlook** не выполняет проверку правильность или допустимости имен классов сообщений.  
  
 По завершению работ мастер **Новая область формы Outlook** прикрепляет атрибуты к классу области формы, содержащему указанные имена классов сообщений.  Также данные атрибуты можно прикрепить вручную.  
  
### Применение атрибутов классов.  
 Область формы можно связать с классами сообщений Outlook после завершения работы мастера **Новая область формы Outlook**.  Чтобы сделать это, следует прикрепить атрибуты к классу фабрики области формы.  
  
 В следующем примере показаны два атрибута <xref:Microsoft.Office.Tools.Outlook.FormRegionMessageClassAttribute>, прикрепленные к классу фабрики области формы под названием `myFormRegion`.  Первый атрибут связывает область формы со стандартным классом сообщений для формы сообщений.  Второй атрибут связывает область формы с пользовательским классом сообщения под названием `IPM.Task.Contoso`.  
  
 [!code-csharp[Trin_Outlook_FR_Attributes#1](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Outlook_FR_Attributes/CS/FormRegion1.cs#1)]
 [!code-vb[Trin_Outlook_FR_Attributes#1](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Outlook_FR_Attributes/VB/FormRegion1.vb#1)]  
  
 Атрибуты должны соответствовать следующим рекомендациям:  
  
-   Для пользовательских классов сообщений используйте полное имя класса сообщений \(например: "IPM.Note.Contoso"\).  
  
-   Не указывайте основной класс сообщений \(например: "IPM"\).  
  
-   Не превышайте заданное количество символов для каждого класса сообщений \(256 символов\).  
  
-   Не включайте имена стандартных классов сообщений, если область формы производит замену всей формы или заданной по умолчанию страницы формы.  Можно указать имена стандартных классов сообщений только для форм, добавляющих новую страницу к форме или прикрепленных в нижней части формы.  Дополнительные сведения см. в разделе [Практическое руководство. Добавление области формы в проект надстройки Outlook](../vsto/how-to-add-a-form-region-to-an-outlook-add-in-project.md).  
  
 Visual Studio выполняет проверку формата имен классов сообщений при построении проекта.  
  
> [!NOTE]  
>  Visual Studio не выполняет проверку правильности или допустимости имен классов сообщений.  
  
## См. также  
 [Доступ к области формы во время выполнения](../vsto/accessing-a-form-region-at-run-time.md)   
 [Создание областей форм Outlook](../vsto/creating-outlook-form-regions.md)   
 [Пошаговое руководство. Разработка области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md)   
 [Рекомендации по созданию областей формы Outlook](../vsto/guidelines-for-creating-outlook-form-regions.md)   
 [О классе формы имени и сообщений](HV01044315)   
 [В outlook форм и элементов взаимодействия](HV01044298)  
  
  