---
title: "XML-схемы и данные в настройках на уровне документа | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "Office - разработка решений в Visual Studio, XML"
  - "схемы [разработка решений Office в Visual Studio]"
  - "XML [разработка решений Office в Visual Studio], схемы XML"
  - "схемы XML [разработка решений Office в Visual Studio]"
  - "схемы XML [разработка решений Office в Visual Studio], сведения о схемах XML и данных"
ms.assetid: 74bd5773-6cb0-44fb-9738-75e2f2c6e48d
caps.latest.revision: 28
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 27
---
# XML-схемы и данные в настройках на уровне документа
  **Важным** набор сведений в этом разделе, касающиеся Microsoft Word исключительно для использования преимущества и цене и организаций, найдены вне Соединенные Штаты и его территорий или используют или разработки программ, запущенных на продуктов Microsoft Word, которые были лицензированы Майкрософт до января 2010, когда выполненного реализация конкретной функциональности Майкрософт, связанное с пользовательским XML в Microsoft Word.  Данная информация, относящаяся к Microsoft Word, не предназначена для чтения и использования лицами или организациями, расположенными в США или их территориях, которые используют продукты Microsoft Word, лицензированные корпорацией Майкрософт после 10 января 2010 г., или разрабатывают программы для этих продуктов; поведение данных продуктов отличается от поведения продуктов, лицензированных до указанной даты или приобретенных и лицензированных за пределами США.  
  
 [!INCLUDE[appliesto_alldoc](../vsto/includes/appliesto-alldoc-md.md)]  
  
 Microsoft Office Excel и Microsoft Office Word предоставляют возможность сопоставлять схемы с документами.  Это позволяет упростить импорт и экспорт XML\-данных из документов.  
  
 В настройках уровня документа сопоставляемые элементы схемы среда Visual Studio представляет в программной модели как элементы управления.  Для Excel среда Visual Studio добавляет возможность привязки элементов управления к данным в веб\-службах, базах данных и объектах.  Для Word и Excel среда Visual Studio добавляет поддержку панелей действий, которые можно использовать с документами на базе схем с целью повышения эффективности взаимодействия пользователей с решениями.  Дополнительные сведения см. в разделе [Общие сведения о панели действий](../vsto/actions-pane-overview.md).  
  
> [!NOTE]  
>  Нельзя использовать составные XML\-схемы в решениях Excel.  
  
## Создаваемые объекты при присоединении схем к книгам Excel  
 Когда схема присоединяется к книге, Visual Studio автоматически создает несколько объектов и добавляет их в проект.  Эти объекты не следует удалять средствами Visual Studio, так как ими управляет Excel.  Чтобы их удалить, уберите сопоставленные элементы с листа или отсоедините схему средствами Excel.  
  
 Есть два основных объекта:  
  
-   Схема XML \(XSD\-файл\).  Для каждой схемы в книге Visual Studio добавляет в проект одну схему.  В **обозревателе решений** схема представляется как элемент проекта с расширением XSD.  
  
-   Типизированный класс <xref:System.Data.DataSet>.  Этот класс набора данных создается на основе схемы.  и отображается в **Представлении классов**.  
  
## Создаваемые объекты при сопоставлении элементов схем с листами Excel  
 Когда элемент схемы из области задач **Источник XML** сопоставляется с листом, Visual Studio автоматические создает несколько объектов и добавляет их в проект:  
  
-   Элементы управления.  В программной модели для каждого сопоставляемого объекта в книге создается элемент управления <xref:Microsoft.Office.Tools.Excel.XmlMappedRange> \(для неповторяющихся элементов схем\) или элемент управления <xref:Microsoft.Office.Tools.Excel.ListObject> \(для повторяющихся элементов схем\).  Удалить элемент управления <xref:Microsoft.Office.Tools.Excel.ListObject> можно только путем удаления из книги сопоставлений и сопоставляемых объектов.  Дополнительные сведения об элементах управления см. в разделе [Общие сведения о ведущих элементах и элементах управления ведущего приложения](../vsto/host-items-and-host-controls-overview.md).  
  
-   BindingSource.  Когда создается элемент управления <xref:Microsoft.Office.Tools.Excel.XmlMappedRange> путем сопоставления с листом неповторяющегося элемента схемы, создается <xref:System.Windows.Forms.BindingSource>, и элемент управления <xref:Microsoft.Office.Tools.Excel.XmlMappedRange> привязывается к <xref:System.Windows.Forms.BindingSource>.  Необходимо выполнить привязку <xref:System.Windows.Forms.BindingSource> к экземпляру источника данных, который соответствует схеме, сопоставляемой документу, например, к созданному экземпляру типизированного класса <xref:System.Data.DataSet>.  Создайте привязку, установив свойства <xref:System.Windows.Forms.BindingSource.DataSource%2A> и <xref:System.Windows.Forms.BindingSource.DataMember%2A> в окне **Свойства**.  
  
    > [!NOTE]  
    >  <xref:System.Windows.Forms.BindingSource> не создается для объектов <xref:Microsoft.Office.Tools.Excel.ListObject>.  Необходимо вручную привязать <xref:Microsoft.Office.Tools.Excel.ListObject> к источнику данных, установив свойства <xref:System.Windows.Forms.BindingSource.DataSource%2A> и <xref:System.Windows.Forms.BindingSource.DataMember%2A> в окне **Свойства**.  
  
### Сопоставляемые схемы Office и окно Visual Studio "Источники данных"  
 Функциональность сопоставляемых схем и окно Visual Studio **Источники данных** могут помочь представить данные на листе Excel для создания отчетов или редактирования.  В обоих случаях можно перетащить элементы данных на лист Excel.  Оба метода создают элементы управления, которые через <xref:System.Windows.Forms.BindingSource> привязаны к источнику данных, например, <xref:System.Data.DataSet> или веб\-службе.  
  
> [!NOTE]  
>  Когда повторяющийся элемент схемы сопоставляется с листом, среда Visual Studio создает <xref:Microsoft.Office.Tools.Excel.ListObject>.  <xref:Microsoft.Office.Tools.Excel.ListObject> автоматически не привязывается к данным через <xref:System.Windows.Forms.BindingSource>.  Необходимо вручную привязать <xref:Microsoft.Office.Tools.Excel.ListObject> к источнику данных, установив свойства <xref:System.Windows.Forms.BindingSource.DataSource%2A> и <xref:System.Windows.Forms.BindingSource.DataMember%2A> в окне **Свойства**.  
  
 В приведенной ниже таблице показаны некоторые различия между двумя методами.  
  
|схема XML|Окно "Источники данных"|  
|---------------|-----------------------------|  
|Использует интерфейс Office.|Использует окно **Источники данных** в Visual Studio.|  
|Позволяет использовать встроенные функции Office для импорта и экспорта данных из XML\-файлов.|Функциональность импорта и экспорта должна обеспечиваться программными средствами.|  
|Необходимо писать код для заполнения данными сгенерированных элементов управления.|Для элементов управления, добавляемых из окна **Источники данных**, генерируются автоматически и код их заполнения, и необходимые строки подключения при использовании серверов баз данных.|  
  
## Присоединение схем к документам Word  
 Когда к документу Word, который используется в проектах Office на уровне документа, присоединяется схема, объекты данных не создаются.  Но когда элемент схемы сопоставляется с документом, элементы управления создаются.  Тип элемента управления зависит от типа сопоставляемого элемента. Повторяющиеся элементы генерируют элементы управления <xref:Microsoft.Office.Tools.Word.XMLNodes>, а неповторяющиеся элементы — <xref:Microsoft.Office.Tools.Word.XMLNode>.  Дополнительные сведения см. в разделах [Элемент управления XMLNodes](../vsto/xmlnodes-control.md) и [Элемент управления XMLNode](../vsto/xmlnode-control.md).  
  
## Развертывание решений, содержащих XML\-схемы  
 Для развертывания решения, которое использует сопоставленную с документом схему XML, необходимо создать программу установки.  Программа установки должна зарегистрировать схему в библиотеке схем на компьютере конечного пользователя.  Если схема не зарегистрирована, решение все же будет работать, потому что Word создает временную схему на основе элементов, которые находятся в документе, когда он открывается пользователем.  Однако пользователь не сможет выполнить проверку или сохранение схемы, которая использовалась для создания проекта.  Дополнительные сведения о программах установки см. в разделе [Развертывание приложений, служб и компонентов](../deployment/deploying-applications-services-and-components.md).  
  
 Также в проект можно добавить код, проверяющий, присутствует ли схема в библиотеке и зарегистрирована ли она.  и предупреждающий пользователя, если это не так.  
  
 [!code-csharp[Trin_VstcoreDataWord#1](../snippets/csharp/VS_Snippets_OfficeSP/Trin_VstcoreDataWord/CS/ThisDocument.cs#1)]
 [!code-vb[Trin_VstcoreDataWord#1](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_VstcoreDataWord/VB/ThisDocument.vb#1)]  
  
## См. также  
 [Практическое руководство. Сопоставление схем и документов Word в Visual Studio](../vsto/how-to-map-schemas-to-word-documents-inside-visual-studio.md)   
 [Практическое руководство. Сопоставление схем и листов внутри Visual Studio](../vsto/how-to-map-schemas-to-worksheets-inside-visual-studio.md)  
  
  