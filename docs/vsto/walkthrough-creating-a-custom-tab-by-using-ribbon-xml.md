---
title: "Пошаговое руководство. Создание настраиваемой вкладки с помощью XML-лент"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "настраиваемая вкладка [разработка решений Office в Visual Studio]"
  - "настройка ленты, tabscustom - лента, вкладки"
  - "лента [разработка решений Office в Visual Studio], настройка"
  - "лента [разработка решений Office в Visual Studio], вкладки"
  - "лента [разработка решений Office в Visual Studio], XML"
  - "XML [разработка решений Office в Visual Studio], лента"
ms.assetid: f6391a01-df1a-4a0f-bfbb-a9526c73b2b3
caps.latest.revision: 35
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 34
---
# Пошаговое руководство. Создание настраиваемой вкладки с помощью XML-лент
  В этом пошаговом руководстве показано, как создать вкладку на настраиваемой ленте с помощью элемента **Лента \(XML\)**.  
  
 [!INCLUDE[appliesto_ribbon](../vsto/includes/appliesto-ribbon-md.md)]  
  
 В данном пошаговом руководстве рассмотрены следующие задачи:  
  
-   Добавление кнопок на вкладку **Надстройки**.  Вкладка **Надстройки** — это вкладка по умолчанию, которая определена в XML\-файле ленты.  
  
-   Автоматизация Microsoft Office Word с помощью кнопок на вкладке **Надстройки**.  
  
> [!NOTE]  
>  Отображаемые на компьютере имена или расположения некоторых элементов пользовательского интерфейса Visual Studio могут отличаться от указанных в следующих инструкциях.  Это зависит от имеющегося выпуска Visual Studio и используемых параметров.  Дополнительные сведения см. в разделе [Customizing Development Settings in Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
## Обязательные компоненты  
 Ниже приведены компоненты, необходимые для выполнения данного пошагового руководства.  
  
-   [!INCLUDE[vsto_vsprereq](../vsto/includes/vsto-vsprereq-md.md)]  
  
-   Microsoft Word.  
  
## Создание проекта  
 Первым шагом является создание проекта надстройки Word VSTO.  После этого следует настроить вкладку **Надстройки** этого документа.  
  
#### Создание нового проекта  
  
1.  Создайте проект **Надстройка Word** с именем MyRibbonAddIn.  
  
     Дополнительные сведения см. в разделе [Практическое руководство. Создание проектов Office в Visual Studio](../vsto/how-to-create-office-projects-in-visual-studio.md).  
  
     [!INCLUDE[vsprvs](../sharepoint/includes/vsprvs-md.md)] открывает файл кода **ThisAddIn.cs** или **ThisAddIn.vb** и добавляет проект **MyRibbonAddIn** в **обозреватель решений**.  
  
## Создание вкладки надстройки VSTO  
 Для создания вкладки **Надстройка** добавьте элемент **Лента \(XML\)** в свой проект.  Далее в этом пошаговом руководстве мы добавим некоторые кнопки на эту вкладку.  
  
#### Создание вкладки «Надстройки»  
  
1.  В меню **Проект** выберите пункт **Добавить новый элемент**.  
  
2.  В диалоговом окне **Добавление нового элемента** выберите элемент **Лента \(XML\)**.  
  
3.  Измените имя новой ленты на **MyRibbon** и нажмите кнопку **Добавить**.  
  
     В конструкторе открывается файл **MyRibbon.cs** или **MyRibbon.vb**.  В проект также добавляется XML\-файл с именем **MyRibbon.xml**.  
  
4.  В **обозревателе решений** щелкните правой кнопкой мыши файл **ThisAddin.cs** или **ThisAddin.vb** и выберите в контекстном меню команду **Просмотреть код**.  
  
5.  Добавьте следующий код в класс **ThisAddin**.  Этот код переопределяет метод CreateRibbonExtensibilityObject и возвращает XML\-класс ленты в приложение Office.  
  
     [!code-csharp[Trin_Ribbon_Custom_Tab_XML#1](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab_XML/CS/ThisAddIn.cs#1)]
     [!code-vb[Trin_Ribbon_Custom_Tab_XML#1](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab_XML/VB/ThisAddIn.vb#1)]  
  
6.  В **обозревателе решений** щелкните проект **MyRibbonAddIn** правой кнопкой мыши проект и выберите пункт **Сборка**.  Убедитесь, что сборка проекта выполняется без ошибок.  
  
## Добавление кнопок на вкладку «Надстройки»  
 Данная надстройка VSTO предназначена для того, чтобы пользователи могли добавлять стандартный текст и конкретную таблицу в активный документ.  Для предоставления пользовательского интерфейса добавьте две кнопки на вкладку **Надстройки** путем внесения изменений в XML\-файл ленты.  Далее в этом пошаговом руководстве мы определим методы обратного вызова для кнопок.  Дополнительные сведения об XML\-файле ленты см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  
  
#### Добавление кнопок на вкладку «Надстройки»  
  
1.  В **обозревателе решений** щелкните правой кнопкой мыши файл **MyRibbon.xml** и выберите команду **Открыть**.  
  
2.  Замените содержимое элемента **tab** следующим кодом XML.  Этот XML\-код изменяет метку группы элементов управления по умолчанию на **Содержимое**, а также добавляет две новые кнопки с метками **Вставить текст** и **Вставить таблицу**.  
  
    ```  
    <tab idMso="TabAddIns">  
        <group id="ContentGroup" label="Content">  
            <button id="textButton" label="Insert Text"  
                 screentip="Text" onAction="OnTextButton"  
                 supertip="Inserts text at the cursor location."/>  
            <button id="tableButton" label="Insert Table"  
                 screentip="Table" onAction="OnTableButton"  
                 supertip="Inserts a table at the cursor location."/>  
        </group>  
    </tab>  
    ```  
  
## Автоматизация документа с помощью кнопок  
 Необходимо добавить методы обратного вызова `onAction` для кнопок **Вставить текст** и **Вставить таблицу**, чтобы выполнять действия при нажатии их пользователем.  Дополнительные сведения о методах обратного вызова для элементов управления ленты см. в разделе [XML-ленты](../vsto/ribbon-xml.md).  
  
#### Добавление методов обратного вызова для кнопок  
  
1.  В **обозревателе решений** щелкните правой кнопкой мыши файл **MyRibbon.cs** или **MyRibbon.vb** и выберите команду **Открыть**.  
  
2.  Добавьте следующий код в начало файла **MyRibbon.cs** или **MyRibbon.vb**.  Этот код создает псевдоним для пространства имен <xref:Microsoft.Office.Interop.Word>.  
  
     [!code-csharp[Trin_RibbonButtons#1](../snippets/csharp/VS_Snippets_OfficeSP/Trin_RibbonButtons/CS/MyRibbon.cs#1)]
     [!code-vb[Trin_RibbonButtons#1](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_RibbonButtons/VB/MyRibbon.vb#1)]  
  
3.  Добавьте следующий метод в класс `MyRibbon`.  Это метод обратного вызова для кнопки **Вставить текст**, которая добавляет строку в активный документ в текущем положении курсора.  
  
     [!code-csharp[Trin_Ribbon_Custom_Tab_XML#2](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab_XML/CS/MyRibbon.cs#2)]
     [!code-vb[Trin_Ribbon_Custom_Tab_XML#2](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab_XML/VB/MyRibbon.vb#2)]  
  
4.  Добавьте следующий метод в класс `MyRibbon`.  Это метод обратного вызова для кнопки **Вставить таблицу**, которая добавляет таблицу в активный документ в текущем положении курсора.  
  
     [!code-csharp[Trin_Ribbon_Custom_Tab_XML#3](../snippets/csharp/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab_XML/CS/MyRibbon.cs#3)]
     [!code-vb[Trin_Ribbon_Custom_Tab_XML#3](../snippets/visualbasic/VS_Snippets_OfficeSP/Trin_Ribbon_Custom_Tab_XML/VB/MyRibbon.vb#3)]  
  
## Тестирование надстройки VSTO  
 При запуске проекта открывается Word и на ленте появляется вкладка с именем **Надстройки**.  Для тестирования кода нажмите кнопки **Вставить текст** и **Вставить таблицу** на вкладке **Надстройки**.  
  
#### Тестирование надстройки VSTO  
  
1.  Нажмите клавишу F5 для запуска проекта.  
  
2.  Убедитесь, что вкладка **Надстройки** отображается на ленте.  
  
3.  Перейдите на вкладку **Надстройки**.  
  
4.  Убедитесь, что группа **Содержимое** отображается на ленте.  
  
5.  Нажмите кнопку **Вставить текст** в группе **Содержимое**.  
  
     Строка добавляется в документ в текущем положении курсора.  
  
6.  Нажмите кнопку **Вставить таблицу** в группе **Содержимое**.  
  
     Таблица добавляется в документ в текущем положении курсора.  
  
## Следующие действия  
 Дополнительные сведения о настройке пользовательского интерфейса Office см. в следующих разделах:  
  
-   Настройка ленты другого приложения Office.  Дополнительные сведения о приложениях, поддерживающих настройку ленты, см. в разделе [Обзор ленты](../vsto/ribbon-overview.md).  
  
-   Настройка ленты приложения Office с помощью конструктора лент.  Дополнительные сведения см. в разделе [Конструктор лент](../vsto/ribbon-designer.md).  
  
-   Создание настраиваемой панели действий.  Дополнительные сведения см. в разделе [Общие сведения о панели действий](../vsto/actions-pane-overview.md).  
  
-   Настройка пользовательского интерфейса для Microsoft Office Outlook с помощью областей формы Outlook.  Дополнительные сведения см. в разделе [Пошаговое руководство. Разработка области формы Outlook](../vsto/walkthrough-designing-an-outlook-form-region.md).  
  
## См. также  
 [Обзор ленты](../vsto/ribbon-overview.md)   
 [XML-ленты](../vsto/ribbon-xml.md)   
 [Пошаговое руководство. Создание настраиваемой вкладки с помощью конструктора лент](../vsto/walkthrough-creating-a-custom-tab-by-using-the-ribbon-designer.md)  
  
  