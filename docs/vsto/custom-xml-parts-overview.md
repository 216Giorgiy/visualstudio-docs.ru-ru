---
title: "Общие сведения о пользовательских XML-частях | Microsoft Docs"
ms.custom: ""
ms.date: "02/02/2017"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "office-development"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
helpviewer_keywords: 
  - "настраиваемые XML-части [разработка решений Office в Visual Studio]"
  - "настраиваемые XML-части [разработка решений Office в Visual Studio], сведения"
  - "данные [разработка решений Office в Visual Studio], настраиваемые XML-части"
  - "документы [разработка решений Office в Visual Studio], настраиваемые XML-части"
  - "внедрение данных XML в документы [разработка решений Office в Visual Studio]"
  - "Excel [разработка решений Office в Visual Studio], настраиваемые XML-части"
  - "Office - документы [разработка решений Office в Visual Studio], настраиваемые XML-части"
  - "Office Open XML - форматы [разработка решений Office в Visual Studio]"
  - "Word [разработка решений Office в Visual Studio], настраиваемые XML-части"
  - "XML [разработка решений Office в Visual Studio], настраиваемые XML-части"
  - "XML - форматы файлов [разработка решений Office в Visual Studio]"
  - "XML - части [разработка решений Office в Visual Studio]"
ms.assetid: a14119dc-59e8-4614-94f1-08c92bdf7300
caps.latest.revision: 33
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 32
---
# Общие сведения о пользовательских XML-частях
  Для некоторых приложений Microsoft Office в документах можно внедрять XML\-данные.  При внедрении в документ такие XML\-данные называются *пользовательской XML\-частью*.  
  
 Для создания и изменения пользовательских XML\-частей в документе можно использовать надстройку VSTO или решение в Visual Studio на уровне документа.  Для создания и изменения пользовательских XML\-частей запускать приложение Microsoft Office не требуется.  
  
 **Применимость.** Информация в этой статье относится к проектам уровня документа и проектам надстроек VSTO для Excel, PowerPoint и Word.  Дополнительные сведения см. в разделе [Доступность функций по типам приложений Office и проектов](../vsto/features-available-by-office-application-and-project-type.md).  
  
> [!NOTE]  
>  Visual Studio также позволяет кэшировать объекты данных в настройках на уровне документа.  Несмотря на некоторые сходства, эта функция отличается от пользовательских XML\-частей.  Дополнительные сведения см. в разделе [Кэшированные данные в настройках уровня документа](../vsto/cached-data-in-document-level-customizations.md).  
  
## Основные сведения о пользовательских XML\-частях  
 Пользовательские XML\-части впервые появились в системе Microsoft Office 2007 вместе с форматами Open XML.  К этим форматам относятся новые форматы файлов на основе XML для Excel, PowerPoint и Word \(XLSX, PPTX и DOCX\).  Документы в этих форматах состоят из XML\-файлов \(также называемых *XML\-частями*\), которые располагаются в папках в ZIP\-архиве.  Большинство XML\-частей представляют собой встроенные части, позволяющие определить структуру и состояние документа.  Однако документы также могут содержать пользовательские XML\-части, которые можно использовать для хранения произвольных XML\-данных в документах.  
  
 Форматы XML\-файлов позволяют приложениям работать с документами по\-новому, не так как со старыми форматами двоичных файлов \(например, XLS, PPT и DOC\).  Любое приложение, которое может читать ZIP\-архивы, может проверять и изменять содержимое документов даже в том случае, если Microsoft Office не установлен.  
  
 Дополнительные сведения о структуре Open XML и пользовательских XML\-частей см. в следующих статьях.  
  
-   [Знакомство с форматами файлов Office \(2007\) Open XML](http://msdn.microsoft.com/ru-ru/96018532-f62c-4da7-bbff-16b96a483fbf)  
  
-   [Практическое руководство. Обработка документов в форматах Open XML](http://msdn.microsoft.com/ru-ru/c989d4e2-053d-4e1f-83be-257c608b343f)  
  
-   [Пошаговое руководство. Формат Word 2007 XML](http://msdn.microsoft.com/ru-ru/fc1afcb2-27fb-4608-9f29-11b7bd23ea4a)  
  
-   [Построение документов Word 2007 с помощью форматов Open XML](http://msdn.microsoft.com/ru-ru/59a46f4e-5a5a-4dac-86e5-7dfd43330766)  
  
> [!NOTE]  
>  Excel, Word и PowerPoint также позволяют использовать пользовательские XML\-части в документах, которые были сохранены в форматах двоичных файлов.  Однако, если документ сохранен в двоичном формате, для добавления или изменения пользовательских XML\-частей необходимо запустить приложение Microsoft Office.  
  
## Создание и изменение пользовательских XML\-частей  
 Пользовательские XML\-части можно создавать или изменять, когда документ открыт в приложении Office или когда документ закрыт \(даже если Microsoft Office не установлен\).  
  
### Изменение XML\-частей, когда приложение Office работает  
 Для работы с пользовательскими XML\-частями можно использовать настройку на уровне документа или надстройку VSTO.  При использовании настройки на уровня документе работа обычно ведется с теми пользовательскими XML\-частями, которые находятся в настроенном документе.  С помощью надстройки VSTO можно создавать или изменять пользовательские XML\-части в любом документе, который открыт в приложении.  
  
 Для создания пользовательской XML\-части с помощью Visual Studio добавьте новую <xref:Microsoft.Office.Core.CustomXMLPart> в коллекцию <xref:Microsoft.Office.Core.CustomXMLParts> в документе.  Дополнительные сведения см. в следующих разделах:  
  
-   [Практическое руководство. Добавление пользовательских XML-частей в настройках уровня документа](../vsto/how-to-add-custom-xml-parts-to-document-level-customizations.md)  
  
-   [Практическое руководство. Добавление пользовательских XML-частей в документы с помощью надстроек VSTO](../vsto/how-to-add-custom-xml-parts-to-documents-by-using-vsto-add-ins.md)  
  
### Изменение XML\-частей без запуска приложения Office  
 Пользовательские XML\-части можно добавлять или изменять без запуска Excel, PowerPoint или Word.  Это удобно в том случае, если вам нужно работать с XML\-данными в документе на компьютере, на котором приложения Microsoft Office не установлены, например на сервере.  
  
 Для добавления пользовательской XML\-части без запуска Microsoft Office используйте классы в пакете SDK для Open XML.  Эти классы предоставляют доступ к содержимому Open XML, характерному для документов Office.  Например, для добавления пользовательской XML\-части в книгу Excel следует использовать метод [AddNewPart\<T\>](http://msdn.microsoft.com/ru-ru/47c348c0-77ab-a504-5097-bcd6a213921a) объекта [WorkbookPart](http://msdn.microsoft.com/ru-ru/d011e6f4-77dd-d02d-66ef-dc4a9e7b26f2).  Дополнительные сведения см. в разделе [Open XML SDK 2.0](http://msdn.microsoft.com/ru-ru/f6a9ae68-7989-4208-97f5-3c945137a0ab).  
  
## Привязка пользовательских XML\-частей к элементам управления содержимым Word  
 Элементы управления содержимым в решении Word можно привязать к элементам в пользовательской XML\-части.  Если элемент управления содержимым привязан к пользовательской XML\-части, ее данные отображаются в пользовательском интерфейсе элемента управления содержимым.  Если пользователь редактирует текст в элементе управления, автоматически обновляется соответствующий XML\-элемент.  Аналогичным образом, если значения элементов в пользовательских XML\-частях изменяются, элементы управления содержимым, привязанные к XML\-элементам, отображают новые данные.  Дополнительные сведения см. в разделе [Элементы управления содержимым](../vsto/content-controls.md).  
  
## См. также  
 [XML-схемы и данные в настройках на уровне документа](../vsto/xml-schemas-and-data-in-document-level-customizations.md)   
 [Практическое руководство. Добавление пользовательских XML-частей в настройках уровня документа](../vsto/how-to-add-custom-xml-parts-to-document-level-customizations.md)   
 [Практическое руководство. Добавление пользовательских XML-частей в документы с помощью надстроек VSTO](../vsto/how-to-add-custom-xml-parts-to-documents-by-using-vsto-add-ins.md)   
 [Элементы управления содержимым](../vsto/content-controls.md)   
 [Пошаговое руководство. Привязка элементов управления содержимым к пользовательским XML-частям](../vsto/walkthrough-binding-content-controls-to-custom-xml-parts.md)  
  
  