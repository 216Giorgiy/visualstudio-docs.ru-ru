---
title: Включение отладки для приложений ASP.NET | Документация Майкрософт
ms.custom: H1HackMay2017
ms.date: 09/21/17
ms.technology: vs-ide-debug
ms.topic: conceptual
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- debugging ASP.NET Web applications
- Web.config configuration file, debug mode
- debugging [Visual Studio], ASP.NET
ms.assetid: 3beed819-cece-4864-8184-bd410000973a
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- aspnet
ms.openlocfilehash: 438e5a96ef07faf399d06ae517afe313a44673b4
ms.sourcegitcommit: 0bf2aff6abe485e3fe940f5344a62a885ad7f44e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/27/2018
ms.locfileid: "37057854"
---
# <a name="debug-aspnet-applications-in-visual-studio"></a>Отладка приложений ASP.NET в Visual Studio

Можно выполнять отладку приложений ASP.NET из Visual Studio.

## <a name="requirements"></a>Требования

Следуйте инструкциям, приведенным в этой статье, вам потребуется:

- IIS Express, который включен по умолчанию в Visual Studio 2012 и более поздних версий

    - или -

- Локальный веб-служб IIS server (версии 8.0 или более поздней версии), правильно настроен и можно запустить приложение ASP.NET без ошибок.

Если удаленный сервер, удаленный отладчик должен работать на удаленном компьютере. Для отладки на удаленном сервере IIS, см. в разделе [удаленной отладке ASP.NET на компьютере со службами IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md). 

## <a name="configure-debug-settings"></a>Настройка параметров отладки

### <a name="enable-aspnet-debugging-in-the-project-properties"></a>Включить отладку ASP.NET в свойствах проекта

1. Откройте проект ASP.NET в Visual Studio.

2. Щелкните правой кнопкой мыши проект в **обозревателе решений**, выберите **свойства**, а затем нажмите кнопку **Web** вкладку.

    Для некоторых типов проектов выберите **свойства > Отладка** вместо этого. Для проекта веб-форм ASP.NET, щелкните правой кнопкой мыши проект и выберите **страницы свойств > Параметры запуска**.
  
3.  В окне **Отладчики**установите флажок **ASP.NET** .

    ![Параметры отладчика](../debugger/media/dbg-aspnet-enable-debugging.png "параметры отладчика")

> [!NOTE]
> При создании нового проекта ASP.NET (**файл > Новый проект**), параметры отладки уже настроены правильно.

### <a name="enable-debugging-in-the-webconfig-file"></a>Включить отладку в файле web.config  

Чтобы выполнить отладку веб-приложения, в файле web.config должен быть настроен правильно. Файл web.config является обязательным, если вы размещаете приложение в службах IIS или IIS Express.

Для ASP.NET Core файл web.config создается автоматически при развертывании приложения (если его еще нет).

> [!TIP]
> Процесс развертывания может обновить параметры файла web.config. Поэтому перед попыткой выполнить отладку, проверьте параметр web.config на сервере.
  
1.  В Visual Studio откройте файл web.config проекта.  
  
    > [!NOTE]  
    > Удаленный доступ к файлу web.config с помощью веб-браузер. Из соображений безопасности настройка служб Microsoft IIS [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] осуществляется ASP.NET таким образом, чтобы предотвратить прямой доступ к файлам Web.config с помощью браузеров. При попытке доступа к файлу конфигурации с помощью браузера, появится ошибка доступа HTTP 403 (запрещено).  
  
2.  Найдите элемент `configuration/system.web/compilation` . Если элемент compilation не существует, создайте его.

    Файл Web.config — это XML-файл, поэтому он содержит вложенные разделы, помеченные тегами.
  
3.  Если элемент `compilation` не содержит атрибут `debug` , добавьте этот атрибут к элементу.  
  
4.  Убедитесь в том, что значение атрибута `debug` равно `true`.  
  
Файл web.config должен выглядеть как в следующем примере:

> [!NOTE]
> В этом примере — это файл частичного web.config. Дополнительные разделы XML, обычно присутствуют между элементами system.web и configuration. Элемент compilation может также содержать другие элементы или атрибуты.
  
#### <a name="example"></a>Пример  
  
```xml
<configuration>  
    ...  
    <system.web>  
        <compilation  
            debug="true"  
            ...  
        >  
        ...  
        </compilation>  
    </system.web>  
</configuration>  
```

При использовании внешнего сервера вместо сервера IIS Express по умолчанию, необходимо также убедиться в том, `targetFramework` значение атрибута соответствует конфигурации на сервере.

> [!IMPORTANT]
> Для наилучшей производительности значение рабочего приложения `debug=false` и указание сборки выпуска при построении и публикации приложения.

## <a name="configure-project-settings-for-the-server"></a>Настройка параметров проекта для сервера

Для отладки на локальный веб-сервер, задайте свойства проекта. Для отладки на удаленном сервере, выполните более подробные инструкции, описанные в [Remote Debugging ASP.NET on IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md) вместо этого.

1. В **Web** проекта на вкладке Свойства, выберите либо **IIS Express** или **внешнего сервера** в разделе **Server** параметры. (Для некоторых типов проектов, эти параметры отображаются в **Отладка** вкладке вместо.)

    ![Параметры сервера](../debugger/media/dbg-aspnet-server-settings.png "параметры сервера")

    IIS Express является сервером по умолчанию для ASP.NET и не требует специальной настройки. Это самый простой способ отладить приложение ASP.NET.

    Для проекта веб-форм ASP.NET, щелкните правой кнопкой мыши проект, выберите **страницы свойств > Параметры запуска**и выберите либо **использовать по умолчанию веб-сервер** или **использовать другой сервер** () вместо **внешнего сервера**).

    ![Параметры сервера для приложения веб-форм](../debugger/media/dbg-aspnet-server-settings-webforms.png "параметры сервера для приложения веб-форм")

2. Если внешний сервер (пользовательский), введите правильный URL-адрес в **URL-адрес проекта** (или **базовый URL-адрес**) поля.

    Если внешний сервер является локальный сервер IIS, IIS должен быть установлен и настроен правильно. Например необходимая версия ASP.NET должны настраиваться в IIS. Дополнительные сведения см. в разделе [IIS 8.0 с ASP.NET 3.5 и ASP.NET 4.5](/iis/get-started/whats-new-in-iis-8/iis-80-using-aspnet-35-and-aspnet-45). Если вы хотите протестировать развертывание, а также отладки, см. в разделе [развертывание для тестирования](/aspnet/web-forms/overview/deployment/visual-studio-web-deployment/deploying-to-iis).

    Если внешний сервер [удаленного](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md), присоединиться к процессу, вместо того, эти параметры проекта не используются для отладки.

## <a name="local-iis-web-server-configure-iis"></a>(Локальный сервер IIS веб-сервер) Настройка служб IIS

Для IIS Express, не нужно настроить веб-сервер (пропустите этот раздел). IIS Express рекомендуется для первоначального тестирования.

Если вы используете локальный веб-сервер IIS, выполните следующие действия.

1. Убедитесь, что IIS установлен правильно. Дополнительные сведения см. в разделе [IIS 8.0 с ASP.NET 3.5 и ASP.NET 4.5](/iis/get-started/whats-new-in-iis-8/iis-80-using-aspnet-35-and-aspnet-45).

    * Убедитесь, что установить правильную версию ASP.NET на сервере. Используйте установщик веб-платформы (WebPI) для установки ASP.NET 4.5 (узел сервера в Windows Server 2012 R2, выберите **получить новый веб-платформы компоненты** и выполните поиск по ASP.NET). Чтобы установить ASP.NET Core, см. в разделе [публикация в службах IIS](https://docs.asp.net/en/latest/publishing/iis.html#iis-configuration).

    > [!NOTE]
    > Если вы используете Windows Server 2008 R2, установите ASP.NET 4, вместо этого с помощью следующей команды:

     **C:\Windows\Microsoft.NET\Framework64\v4.0.30319\aspnet_regiis.exe -ir**

2. Откройте **Internet Information Services (IIS) Manager**. (В левой области диспетчера серверов выберите **IIS**. Щелкните правой кнопкой мыши сервер и выберите **Internet Information Services (IIS) Manager**.)

3. В разделе **подключений** в левой области перейдите в раздел **сайты**.

4. Щелкните правой кнопкой мыши узел **Веб-сайт по умолчанию** и выберите команду **Добавить приложение**.

5. Задайте **псевдоним** поле **MyASPApp**, примите имя по умолчанию пула приложений (**DefaultAppPool**) и задайте **физический путь** для  **C:\inetpub\myNewFolder** (создайте новую папку для приложения).

6. В разделе **подключений**выберите **пулы приложений**. Откройте **DefaultAppPool** и присвоено значение, которое будет правильным для приложения (использование ASP.NET 4 для ASP.NET 4.5 поле пул приложений. Используйте **без управляемого кода** для ASP.NET Core).

## <a name="local-iis-web-server-deploy-the-app"></a>(Локальный сервер IIS веб-сервер) Развертывание приложения

Для IIS Express, веб-приложение развертывается автоматически при запуске отладки (пропустите этот раздел).

Если вы используете локальный веб-сервер IIS, выполните следующие действия. Чтобы опубликовать приложение в IIS разными способами. На этих шагах показано, как создать и использовать профиль публикации таким образом, можно развернуть в файловой системе.

1. Перезапустите Visual Studio с правами администратора.

    Чтобы развернуть с помощью этого метода, необходимо иметь права администратора.

2. В Visual Studio щелкните проект правой кнопкой мыши и выберите **публикации** (для веб-форм, используйте **публикации веб-приложение**).

3. Выберите **IIS, FTP, и т.д.** и нажмите кнопку **публикации**.

    ![Публикация в IIS](../debugger/media/dbg-aspnet-local-iis.png "публикация в IIS")

    Для приложения веб-форм, нажать **Custom** в диалоговом окне публикации, введите имя профиля и выберите **ОК**.

4. В **метод публикации** переключатель **файловая система**.

5. Для **целевое расположение**, нажмите кнопку **Обзор** кнопки.

6. (ASP.NET Core) Выберите **файловой системы** и выберите папку, где вы ранее создали для приложения.

6. (ASP.NET) Выберите **локальный сервер IIS**и выберите веб-сайт, вы создали и нажмите кнопку **откройте**.

    ![Публикация в IIS](../debugger/media/dbg-aspnet-local-iis-select-site.png "публикация в IIS")

    > [!TIP]
    > Если видно, что сообщение о веб-сервер настроен неправильно, убедитесь, что необходимая версия ASP.NET установлен для служб IIS.

7. Нажмите кнопку **Далее** и выберите **Отладка** конфигурации.

    > [!NOTE]
    > При развертывании в конфигурации выпуска, таким образом задается `debug=false` в файле web.config для сервера.

8. Нажмите кнопку **Сохранить** сохранить параметры публикации, а затем нажмите кнопку **публикации**.

    > [!CAUTION]
    >  Если вам нужно внести изменения в код или перестроение, необходимо повторно опубликовать и повторите этот шаг. Исполняемый файл, скопированный на удаленный компьютер, должен в точности совпадать с локальным исходным кодом и символами.

## <a name="set-a-breakpoint-and-start-debugging"></a>Установите точку останова и начните отладку

1. В проекте в Visual Studio установите точку остановки в код, который вы знаете, будет выполняться.

2. Чтобы начать отладку, нажмите клавишу **F5** (**Отладка > Начать отладку**).

3. Выполните действия, чтобы запустить код, который содержит точку останова.

    Отладчик приостанавливает, где вы задали точку останова.

### <a name="local-iis-troubleshooting-cannot-hit-the-breakpoint"></a>(Локальный сервер IIS) Устранение неполадок: Не удается достигнута точка останова

1. Запустите веб-приложения из служб IIS и убедитесь, что он работает правильно. Оставьте веб-приложения под управлением.

2. В Visual Studio последовательно выберите **Отладка > присоединение к процессу** и подключитесь к процессу ASP.NET (обычно **w3wp.exe** или **dotnet.exe**). Дополнительные сведения см. в разделе [присоединение к процессу](../debugger/attach-to-running-processes-with-the-visual-studio-debugger.md).

    Если вы можете подключиться с помощью **присоединение к процессу** в точку останова, но не удается начать отладку с помощью **F5**, скорее всего, что неверный параметр в свойствах проекта. Если вы используете файл HOSTS, убедитесь, что она настроена правильно.

  
## <a name="robust-programming"></a>Отказоустойчивость  
С помощью объекта [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] производится автоматическое обнаружение изменений в файлах Web.config и применяются новые параметры конфигурации. При этом нет необходимости перезагружать компьютер или IIS, чтобы изменения вступили в силу.  
  
Веб-сайт может содержать несколько виртуальных каталогов и подкаталогов. и файлы Web.config могут содержаться в каждом из них. Приложения [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] наследуют параметры от файлов Web.config, находящихся на более высоких уровнях URL-пути. Файлы иерархической конфигурации позволяют изменять параметры различных приложений [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] одновременно, например, для всех приложений, расположенных ниже по иерархии. Тем не менее если `debug` задается в файле более низкого уровня в иерархии, он переопределяет более высокое значение.  
  
Например, можно указать `debug="true"` в файле www.microsoft.com/aaa/Web.config и любое приложение, в папке aaa, либо в любом подкаталоге aaa наследует эту настройку. Поэтому, если ваш [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] приложение находится в www.microsoft.com/aaa/bbb, он наследует эту настройку, как и любой [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] приложений www.microsoft.com/aaa/ccc, www.microsoft.com/aaa/ddd и т. д. Единственное исключение — случай, когда одно из приложений переопределяет настройку посредством собственного файла Web.config, находящегося ниже по иерархии.  
  
> [!IMPORTANT]
> Включение режима отладки сильно влияет на производительность вашего [!INCLUDE[vstecasp](../code-quality/includes/vstecasp_md.md)] приложения. Режим отладки следует отключить перед развертыванием конечного приложения или перед оценкой его производительности.  
  
## <a name="see-also"></a>См. также  
[Отладка ASP.NET: системные требования](aspnet-debugging-system-requirements.md)   
[Практическое: выполнение рабочего процесса с учетной записью пользователя](how-to-run-the-worker-process-under-a-user-account.md)   
[Практическое: поиск имени процесса ASP.NET](how-to-find-the-name-of-the-aspnet-process.md)   
[Отладка развернутых веб-приложений](debugging-deployed-web-applications.md)   
[Пошаговое руководство: Отладка веб-формы](walkthrough-debugging-a-web-form.md)   
[Практическое: Отладка исключений ASP.NET](how-to-debug-aspnet-exceptions.md)   
[Отладка веб-приложений: ошибки и устранение неполадок](debugging-web-applications-errors-and-troubleshooting.md)
  
