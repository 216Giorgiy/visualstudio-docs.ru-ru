---
title: Создание визуальной карты стека вызовов | Документация Майкрософт
ms.custom: ''
ms.date: 05/18/2017
ms.technology: vs-ide-debug
ms.topic: conceptual
f1_keywords:
- vs.progression.debugwithcodemaps
dev_langs:
- CSharp
- VB
- FSharp
- C++
helpviewer_keywords:
- call stacks, code maps
- Call Stack window, mapping calls
- debugging [Visual Studio], diagramming the call stack
- call stacks, mapping
- Call Stack window, visualizing
- debugging code visually
- debugging [Visual Studio], mapping the call stack
- call stacks, visualizing
- debugging, code maps
- Call Stack window, tracing calls visually
- Call Stack window, show on code map
- debugging [Visual Studio], tracing the call stack visually
- debugging [Visual Studio], visualizing the call stack
ms.assetid: d6a72e5e-f88d-46fc-94a3-1789d34805ef
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: 9fe3471f7165cf48f62dee3ca657e78fbfafd273
ms.sourcegitcommit: 240c8b34e80952d00e90c52dcb1a077b9aff47f6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/23/2018
ms.locfileid: "49837403"
---
# <a name="create-a-visual-map-of-the-call-stack-while-debugging-in-visual-studio-enterprise"></a>Создание визуальной карты стека вызовов при отладке в Visual Studio Enterprise, выполните следующие действия.
Создайте карту кода визуальном отслеживании стека вызовов при отладке. В это сопоставление можно вносить примечания для отслеживания операций, выполняемых кодом. Таким образом, вы сможете сосредоточиться на поиске ошибок.

 Требуется:

-   [Visual Studio Enterprise](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017)

-   Код, который можно отлаживать, таких как Visual C#, Visual Basic, C++, JavaScript или X ++

Ниже приведен краткий обзор карту кода.

 ![Отладка со стеками вызовов на картах кода](../debugger/media/debuggermap_overview.png "DebuggerMap_Overview")

 Пример

- [Видео: Визуальная отладка с интеграцией отладчика сопоставления кода (канал 9)](http://go.microsoft.com/fwlink/?LinkId=293418)

- [Сопоставьте стек вызовов](#MapStack)

- [Добавление примечаний в код](#MakeNotes)

- [Обновление сопоставления путем добавления следующего стека вызовов](#UpdateMap)

- [Добавление связанного кода на карту](#AddRelatedCode)

- [Поиск ошибок с помощью карты](#FindBugs)

- [ВОПРОСЫ И ОТВЕТЫ](#QA)

  Узнать о командах и действиях, которые можно использовать при работе с картами кода, см. в разделе [Просмотр и реорганизация карт кода](../modeling/browse-and-rearrange-code-maps.md).

##  <a name="MapStack"></a> Сопоставьте стек вызовов

1.  Приступите к отладке. (Клавиатура: **F5**)

2.  Когда приложение переходит в режим приостановки выполнения или при входе в функцию, нажмите кнопку **карта кода**. (Клавиатура: **Ctrl** + **Shift** + **`**)

     ![Выберите карту кода, чтобы запустить сопоставление стека вызовов](../debugger/media/debuggermap_choosecodemap.png "DebuggerMap_ChooseCodeMap")

     Текущий стек вызовов выделен в новой карте кода оранжевым цветом:

     ![См. в разделе стек вызовов на карте кода](../debugger/media/debuggermap_seeundocallstack.png "DebuggerMap_SeeUndoCallStack")

     Эта карта будет автоматически обновляться в ходе отладки. См. в разделе [обновление сопоставления путем добавления следующего стека вызовов](#UpdateMap).

##  <a name="MakeNotes"></a> Добавление примечаний в код
 Добавьте комментарии, чтобы отслеживать, что происходит в коде. Чтобы добавить новую строку в комментарий, нажмите клавишу **Shift + Return**.

 ![Добавление комментария к стеку вызовов на карте кода](../debugger/media/debuggermap_addcomment.png "DebuggerMap_AddComment")

##  <a name="UpdateMap"></a> Обновление сопоставления путем добавления следующего стека вызовов
 Выполните приложение до следующей точки останова или зайдите в функцию. В сопоставление будет добавлен новый стек вызовов.

 ![Обновление карты кода следующим стеком вызовов](../debugger/media/debuggermap_addclearcallstack.png "DebuggerMap_AddClearCallStack")

##  <a name="AddRelatedCode"></a> Добавление связанного кода на карту
 Теперь у вас есть карта — что далее? Если вы работаете с Visual C# или Visual Basic, добавьте элементы, такие как поля, свойства и другие методы, чтобы отслеживать, что происходит в коде.

 Дважды щелкните метод для просмотра его определения кода или используйте контекстное меню метода. (Клавиатура: выделите метод в сопоставлении и нажмите клавишу **F12**)

 ![Перейти к определению кода для метода на карте кода](../debugger/media/debuggermap_gotocodedefinition.png "DebuggerMap_GoToCodeDefinition")

 Добавьте элементы, которые необходимо отслеживать в сопоставлении.

 ![Отображение полей в методе на карте кода со стеком вызовов](../debugger/media/debuggermap_showfields.png "DebuggerMap_ShowFields")

> [!NOTE]
>  По умолчанию при добавлении элементов в сопоставление также добавляются узлы родительской группы, соответствующие, например, классу, пространству имен или сборке. Хотя эта возможность полезна, вы можете постоянно карты простой, отключение этой функции через **включить родительские элементы** кнопки на панели инструментов карты или нажимая клавиши **CTRL** при добавлении элементов.

 ![Поля, связанные с методом на карте кода со стеком вызовов](../debugger/media/debuggermap_showedfields.png "DebuggerMap_ShowedFields")

 Нетрудно определить, какие методы используют одинаковые поля. Последние добавленные элементы отображаются зеленым цветом.

 Продолжайте формировать сопоставление, чтобы увидеть дополнительный код.

 ![См. в разделе методов, использующие поле: карте кода со стеком вызовов](../debugger/media/debuggermap_findallreferences.png "DebuggerMap_FindAllReferences")

 ![Методы, использующие поле на карте кода со стеком вызовов](../debugger/media/debuggermap_foundallreferences.png "DebuggerMap_FoundAllReferences")

##  <a name="FindBugs"></a> Поиск ошибок с помощью карты
 Визуализация кода поможет вам быстрее находить ошибки. Например предположим, что вы ищите ошибку в программе для рисования. Когда вы создаете линию и пробуете отменить ее создание, ничего не происходит до тех пор, пока не будет нарисована следующая линия.

 Установив точки останова в методах `clear`, `undo` и `Repaint`, вы начинаете отладку и создаете сопоставление, аналогичное представленному ниже:

 ![Добавление другого стека вызовов на карте кода](../debugger/media/debuggermap_addpaintobjectcallstack.png "DebuggerMap_AddPaintObjectCallStack")

 Учтите, что все жесты пользователя в сопоставлении вызывают метод `Repaint`, за исключением `undo`. Возможно, именно `undo` срабатывает не сразу.

 Когда вы исправите ошибку и продолжите выполнение программы, в сопоставление будет добавлен новый вызов из `undo` в `Repaint`.

 ![Добавить новый стек вызова к вызову метода на карте кода](../debugger/media/debuggermap_addnewcallforrepaint.png "DebuggerMap_AddNewCallForRepaint")

##  <a name="QA"></a> Вопросы и ответы

- **Не все вызовы отображаются на карте. Почему?**

   По умолчанию в сопоставлении отображается только ваш код. Чтобы просмотреть внешний код, включите его **стек вызовов** окна:

   ![Отображение внешнего кода, в окне стека вызовов](../debugger/media/debuggermap_callstackmenu.png "DebuggerMap_CallStackMenu")

   или отключите **включить только мой код** в параметрах отладки Visual Studio:

   ![Показать внешний код, используя диалоговое окно параметров](../debugger/media/debuggermap_debugoptions.png "DebuggerMap_DebugOptions")

- **Изменение сопоставления влияет на код?**

   Изменение сопоставления не влияет на код любым способом. Можно свободно переименовать, изменить или удалить любой элемент в сопоставлении.

- **Что означает сообщение: «диаграмме могут основываться на более старой версии кода»?**

   С момента последнего обновления сопоставления код мог измениться. Например, вызов в сопоставлении может уже не существовать в коде. Закройте сообщение, а затем попытайтесь повторить сборку решения, прежде чем повторно обновлять сопоставление.

- **Как управлять макетом сопоставления?**

   Откройте **макета** меню на панели инструментов карты:

  -   Измените макет по умолчанию.

  -   Чтобы остановить автоматическую перекомпоновку сопоставления, отключите режим **автоматически формировать макет при отладке**.

  -   Для изменения порядка как можно реже карты, при добавлении элементов, отключите **последовательный макет**.

- **Можно ли совместно использовать карты с другими пользователями?**

   Сопоставление можно экспортировать, отправить его другим пользователям при наличии Microsoft Outlook или сохранить его в решении, чтобы можно было вернуть его в систему управления версиями Team Foundation.

   ![Карта кода стек вызова общей папки с другими пользователями](../debugger/media/debuggermap_sharewithothers.png "DebuggerMap_ShareWithOthers")

- **Как остановить сопоставление добавляло новые стеки вызова автоматически?**

   Выберите ![кнопку &#45; стек вызовов Показать на карте кода автоматически](../debugger/media/debuggermap_automaticupdateicon.gif "DebuggerMap_AutomaticUpdateIcon") на панели инструментов карты. Чтобы вручную добавить текущий стек вызовов на карту, нажмите клавишу **Ctrl** + **Shift** + **`**.

   По-прежнему будут выделение существующие стеки вызовов на карте, во время отладки.

- **Что значки элементов и стрелки означают?**

   Чтобы получить дополнительные сведения об элементе, наведите указатель мыши и просмотрите подсказку элемента. Вы также можете изучить **условных обозначений** чтобы узнать, что означает каждый значок.

   ![Что означают значки на карте кода со стеком вызовов ](../debugger/media/debuggermap_showlegend.png "DebuggerMap_ShowLegend")

  Пример

- [Сопоставьте стек вызовов](#MapStack)

- [Добавление примечаний в код](#MakeNotes)

- [Обновление сопоставления путем добавления следующего стека вызовов](#UpdateMap)

- [Добавление связанного кода на карту](#AddRelatedCode)

- [Поиск ошибок с помощью карты](#FindBugs)

## <a name="see-also"></a>См. также
 [Сопоставление зависимостей в решениях](../modeling/map-dependencies-across-your-solutions.md) [использование карт кода для отладки приложений](../modeling/use-code-maps-to-debug-your-applications.md) [поиска потенциальных проблем, с помощью кода сопоставления анализаторы](../modeling/find-potential-problems-using-code-map-analyzers.md) [Просмотр и реорганизация карт кода](../modeling/browse-and-rearrange-code-maps.md)