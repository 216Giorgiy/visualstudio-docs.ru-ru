---
title: Просмотреть предыдущее состояние приложения, с помощью IntelliTrace
ms.description: Learn how to take snapshots, and view snapshots with IntelliTrace step-back
ms.custom: mvc
ms.date: 09/19/2018
ms.technology: vs-ide-debug
ms.topic: tutorial
ms.assetid: 7c60d929-d993-49dc-9db3-43b30be9912b
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- multiple
ms.openlocfilehash: 85b34fd85e8449949bb1e96efc1dd79aacbc1bd9
ms.sourcegitcommit: 1c675dae7c348defb32d9f7ccf7079a1062a1c4b
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/03/2018
ms.locfileid: "48243956"
---
# <a name="inspect-previous-app-states-using-intellitrace-step-back-in-visual-studio"></a>Проверьте предыдущие состояния приложения, используя шаг назад в IntelliTrace в Visual Studio

Шаг назад в IntelliTrace автоматически создает моментальный снимок приложения во все точки останова и отладчик шаг события. Используя записанные моментальные снимки, вы можете возвращаться к этим точкам останова и шагам, просматривая предыдущее состояние приложения. Возможность возврата на шаг назад в IntelliTrace позволяет сэкономить время в тех случаях, когда вам нужно просмотреть предыдущее состояние приложения, но не требуется перезапускать отладку или воссоздавать необходимое состояние приложения.

Шаг назад в IntelliTrace доступна, начиная с Visual Studio Enterprise 2017 версии 15.5 и более поздней версии и требует Юбилейное обновление Windows 10 или более поздней версии. Эта функция в настоящее время поддерживается для отладки ASP.NET, WinForms, WPF, управляемых консольных приложений и библиотеках управляемых классов. Начиная с Visual Studio Enterprise 2017 версии 15.7, эта функция также поддерживается для ASP.NET Core и .NET Core. Начиная с Visual Studio 2017 Enterprise версии 15.9 предварительной версии 2, эта функция также поддерживается для собственных приложений, предназначенных для Windows. Отладка приложений UWP в настоящее время не поддерживается.

В этом руководстве рассмотрены следующие задачи:

> [!div class="checklist"]
> * Включить события Intellitrace и моментальные снимки
> * Перейдите с помощью команд на шаг назад и вперед шаг события
> * Моментальные снимки представления событий
  
## <a name="enable-intellitrace-events-and-snapshots-mode"></a>Включить режим события и моментальные снимки IntelliTrace 

1. Откройте проект в Visual Studio Enterprise.

1. Откройте **средства** > **параметры** > **IntelliTrace** и выберите параметр **IntelliTrace события и моментальные снимки** . 

    Начиная с Visual Studio 2017 Enterprise версии 15.9 предварительной версии 2, этот параметр является **моментальные снимки IntelliTrace (управляемый и машинный)**. 

    ![Включить режим события IntelliTrace и моментальные снимки](../debugger/media/intellitrace-enable-snapshots.png "режим включения сведений о событиях и моментальных снимков")

1. Если вы хотите настроить параметры для просмотра моментальных снимков в исключения, выберите **IntelliTrace** > **Дополнительно** из **параметры** диалоговое окно.

    Эти параметры доступны, начиная с Visual Studio Enterprise 2017 версии 15.7.

    ![Настройте для моментальных снимков на исключения](../debugger/media/intellitrace-enable-snapshots-on-exceptions.png)

    При включении события и моментальные снимки, моментальные снимки для исключений также включается по умолчанию. Моментальные снимки для исключений можно отключить, отменив выделение **сбор моментальных снимков для событий исключений**. Если эта функция включена, создаются моментальные снимки для необработанных исключений. Обработанные исключения создаются моментальные снимки, только в том случае, если исключение создается, и если это не заново вызвать исключение ранее исключение. Можно задать максимальное количество моментальных снимков по исключениям, выбрав значение из раскрывающегося списка. Максимум применяется каждый раз, что приложение переходит в режим приостановки выполнения (например, когда приложение достигает точки останова).

    > [!NOTE]
    > Моментальные снимки только для событий исключений, записываемых IntelliTrace. Для управляемого кода, можно указать какие события IntelliTrace, выбрав **средства** > **параметры** > **события IntelliTrace**.

1. В проекте, задайте один или несколько точек останова и начните отладку (нажмите клавишу **F5**), или начать отладку путем перехода по коду (**F10** или **F11**).

    IntelliTrace создается моментальный снимок процесс приложения на каждом этапе работы отладчика, событие точки останова и необрабатываемого события исключения. Эти события записываются в **события** вкладке **средства диагностики** окне вместе с другими событиями IntelliTrace. Чтобы открыть это окно, выберите **Отладка** > **Windows** > **Показать средства диагностики**.

    Значок камеры появится рядом с событиями, для которых доступны моментальные снимки. 

    ![События вкладку с моментальными снимками](../debugger/media/intellitrace-events-tab-with-snapshots.png "вкладке \"события\" с помощью моментальных снимков в точках останова и действия")

    По соображениям производительности моментальные снимки не применяются при выполнении шага с очень быстро. Если значок камеры, не отображается рядом с действием, попробуйте выполнить пошаговое выполнение медленнее.

## <a name="navigate-and-view-snapshots"></a>Перейдите и просмотреть моментальные снимки

1. Перемещаться между событиями с помощью **шаг назад (Alt + [)** и **шаг вперед (Alt +])** кнопки на панели инструментов отладки.

    Эти кнопки можно перейти к событиям, которые отображаются в **события** вкладке **окно средств диагностики**. Шаг с заходом назад или вперед к событию автоматически активируется [отладка с ведением журнала](../debugger/historical-debugging.md) для выбранного события.

    ![Шаг назад и вперед кнопки](../debugger/media/intellitrace-step-back-icons-description.png "кнопки шаг назад и шаг вперед")

    Когда шаг назад или перейти к следующему, Visual Studio переходит в режим журнала отладки. В этом режиме отладчика контекст переключается на время, когда был записан выбранного события. Visual Studio также перемещает указатель к соответствующей строке кода в окне исходного кода. 

    В этом представлении можно было проверить значения в **стек вызовов**, **"Локальные"**, **"Видимые"**, и **Watch** windows. Можно также навести переменные для просмотра подсказок по данным и выполнять вычисление выражений в **Интерпретация** окна. Данные, которые вы видите, из моментального снимка процесса приложения, сделанной в этот момент времени.

    Так, например, если вы в точку останова и шагом на пути (**F10**), **шаг назад** кнопку помещает Visual Studio в режиме журнала в строке кода, соответствующую до точки останова. 

    ![Активация исторических режим для событий с помощью моментального снимка](../debugger/media/intellitrace-historical-mode-with-snapshot.png "исторических режим Активация события с помощью моментального снимка")

2. Чтобы вернуться в реальном времени выполнения, выберите **продолжить (F5)** или нажмите кнопку **вернуться к динамической отладке** ссылку на информационной панели. 

3. Вы также можете просмотреть моментальный снимок из **события** вкладки. Чтобы сделать это, выберите событие с помощью моментального снимка и нажмите кнопку **Активировать отладку с ведением журнала**.

    ![Активировать отладку с ведением журнала для событий](../debugger/media/intellitrace-activate-historical-debugging.png "Активировать отладку с ведением журнала для событий")

    В отличие от **задать следующий оператор** команды, Просмотр моментального снимка не перезапускает кода; в ней можно использовать статическое представление состояния приложения в момент времени, что произошло в прошлом.

    ![Общие сведения о шаг назад в IntelliTrace](../debugger/media/intellitrace-step-back-overview.png "Обзор из шаг назад в IntelliTrace")

    Дополнительные сведения о том, как проверять значения переменных в Visual Studio, см. в разделе [Обзор функций отладчика](../debugger/debugger-feature-tour.md)  

## <a name="frequently-asked-questions"></a>Вопросы и ответы

#### <a name="how-is-intellitrace-step-back-different-from-intellitrace-events-only-mode"></a>Как шаг назад в IntelliTrace отличается от режима только события IntelliTrace?

IntelliTrace в режиме только для событий позволяют активировать отладку с ведением журнала на отладчик шагов и точек останова. Тем не менее IntelliTrace только записывает данные в **"Локальные"** и **"Видимые"** windows, если windows открыты, и оно только перехватывает данных, который будет расширен и в представлении. В режиме только для событий часто у вас получить полное представление о переменных и сложных объектов. Кроме того, оценки и просмотра данных выражения в **Watch** окно не поддерживается. 

В режиме события и моментальные снимки IntelliTrace записывает всего моментального снимка процесс приложения, включая сложные объекты. В строке кода вы увидите те же данные как в том случае, если были остановлены на точку останова (и не имеет ли вы ранее развернули сведения). Вычисление выражений поддерживается также в том случае, если Просмотр моментального снимка.  

#### <a name="what-is-the-performance-impact-of-this-feature"></a>Что такое влияние на производительность этого компонента? 

Влияние на общую производительность пошагового выполнения зависит от приложения. Затраты на создание снимка составляет около 30 мс. При создании моментального снимка, разделенными процесс приложения, и ее разветвления приостанавливается. При просмотре моментального снимка, Visual Studio присоединяется к разветвленного копия процесса. Для каждого моментального снимка Visual Studio копирует только таблицы страниц и задает для копирования при записи страницы. При изменении объектов в куче между шагами отладчика с связанные моментальные снимки в таблице на соответствующую страницу копируется, что стоимость минимальный объем памяти. Если Visual Studio обнаружит, что не хватает памяти, чтобы создать моментальный снимок, он выполняет только один.
 
## <a name="known-issues"></a>Известные проблемы  
* Если вы используете режим события и моментальные снимки IntelliTrace в версиях Windows старше, чем Windows 10 Fall Creators Update (RS3) и целевой платформы отладки приложения имеет значение x86, IntelliTrace не создает моментальные снимки.

    Обходные решения:
    * Если вы являетесь Юбилейное обновление Windows 10 (RS1) и более ранних версий версии 10.0.14393.2273, [установить KB4103720](https://support.microsoft.com/help/4103720/windows-10-update-kb4103720). 
    * Если вы являетесь в Windows 10 Creators Update (RS2) и ниже версии 10.0.15063.1112, [установить KB4103722](https://support.microsoft.com/help/4103722/windows-10-update-4103722).
    * Установка или обновление до Windows 10 Fall Creators Update (RS3). 
    * Кроме того: 
        1. Установите набор инструментов VC++ 2015.3 версии 140 для классического компонента (x86, x64) из установщика Visual Studio.
        2. Выполните сборку целевого приложения.
        3. Из командной строки, воспользуйтесь средством editbin присвоить `Largeaddressaware` флаг для целевой исполняемый файл. Например, можно использовать эту команду (после обновления путь): «C:\Program Files (x86) \Microsoft Visual Studio\Preview\Enterprise\VC\Tools\MSVC\14.12.25718\bin\Hostx86\x86\editbin.exe» / LARGEADDRESSAWARE «C:\Path\To\Application\app.exe».
        4. Чтобы начать отладку, нажмите клавишу **F5**. Теперь моментальные снимки на отладчик шагов и точек останова.

        > [!Note]
        > `Largeaddressaware` Должен быть установлен флаг при каждом перестроении исполняемого файла с изменениями.

* Времени процесс приложения снимка приложения, использующего сохраненный файл, размещенный в памяти, процесс с моментальным снимком накладывает монопольную блокировку на файл, размещенный в памяти (даже после родительский процесс выпустила его блокировки). Другие процессы, по-прежнему могут читать, но не записать в файл, размещенный в памяти.

    Решение
    * Удалить все моментальные снимки, завершение сеанса отладки. 

* При отладке приложения, процесс имеет большое количество уникальных памяти регионы, например приложение, которое загружает большое количество библиотек DLL, шаг с заходом производительности с помощью моментальных снимков включена может снизиться. Эта проблема будет устранена в будущих версиях Windows. При возникновении этой проблемы, обратитесь к нам по адресу stepback@microsoft.com. 

* При сохранении файла с **Отладка > IntelliTrace > сеанса IntelliTrace, Сохранить** в режиме события и моментальные снимки, дополнительные данные, полученные моментальные снимки, недоступны в ITRACE-файл. Для останова и событий те же данные так, как если бы вы сохранили файл в режиме только для событий IntelliTrace. 

## <a name="next-steps"></a>Следующие шаги

В этом руководстве вы узнали, как использовать шаг назад в IntelliTrace. Вы можете получить дополнительные сведения о других возможностях IntelliTrace.

> [!div class="nextstepaction"]
> [Возможности IntelliTrace](../debugger/intellitrace-features.md)
