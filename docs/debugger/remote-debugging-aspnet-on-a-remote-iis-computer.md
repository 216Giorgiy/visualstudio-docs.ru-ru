---
title: "Удаленная отладки ASP.NET Core на компьютере удаленного IIS | Документы Microsoft"
ms.custom: remotedebugging
ms.date: 08/14/2017
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-debug
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 573a3fc5-6901-41f1-bc87-557aa45d8858
caps.latest.revision: "6"
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.workload:
- aspnet
- dotnetcore
ms.openlocfilehash: f1938473a3a5e085e63b9b522bbc31678dedbbd4
ms.sourcegitcommit: 69b898d8d825c1a2d04777abf6d03e03fefcd6da
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/25/2018
---
# <a name="remote-debug-aspnet-core-on-a-remote-iis-computer-in-visual-studio-2017"></a>Удаленная отладка ASP.NET Core на компьютере удаленного IIS в Visual Studio 2017 г.
Для отладки приложений ASP.NET, IIS был развернут, установите и запустите инструменты удаленной отладки на компьютере, на котором развернуто приложение и прикрепите запущенного приложения из Visual Studio.

![Remote debugger components](../debugger/media/remote-debugger-aspnet.png "Remote_debugger_components")

В этом руководстве объясняется, как установить и настроить Visual Studio ASP.NET Core 2017 г., его развертывание в IIS и присоединить удаленный отладчик из Visual Studio. Удаленная отладка ASP.NET 4.5.2 разделе [удаленной отладки ASP.NET на сервере IIS](../debugger/remote-debugging-aspnet-on-a-remote-iis-7-5-computer.md). Кроме того, можно развернуть и отладить в IIS с помощью Azure. Для службы приложений Azure, можно легко развернуть и отладить на предварительно настроенный экземпляр IIS и удаленный отладчик с помощью [отладчик моментального снимка](../debugger/debug-live-azure-applications.md) или [присоединении отладчика из обозревателя серверов](../debugger/remote-debugging-azure.md).

Эти процедуры протестированы на эти конфигурации сервера:
* Windows Server 2012 R2 и служб IIS 8
* Windows Server 2016 и службы IIS 10

## <a name="requirements"></a>Требования

Отладка между двумя компьютерами, подключенными через прокси-сервер не поддерживается. Отладка в различных странах через высокой задержкой или низкой пропускной способностью, таких как удаленный доступ к Интернету, либо через Интернет не рекомендуется и может произойти сбой или медленную неприемлемо. Полный список требований см. в разделе [требования](../debugger/remote-debugging.md#requirements_msvsmon).

## <a name="create-the-aspnet-core-application-on-the-visual-studio-2017-computer"></a>Создание приложения ASP.NET Core на компьютере Visual Studio 2017 г. 

1. Создание нового приложения ASP.NET Core. (**Файл > Создать > проект**, а затем выберите **Visual C# > Web > веб-приложения ASP.NET Core**).

    В **ASP.NET Core** шаблонов выберите пункт **веб-приложение**.

2. Убедитесь, что **ASP.NET Core 2.0** выбран, **Включение поддержки Docker** — **не** выбранного и что **проверки подлинности** имеет значение **Без проверки подлинности**.

3. Назовите проект **MyASPApp** и нажмите кнопку **ОК** для создания нового решения.

4. Откройте файл About.cshtml.cs и установите точку останова в `OnGet` метода (в старые шаблоны откройте HomeController.cs вместо и задать точку останова в `About()` метода).

## <a name="bkmk_configureIIS"></a>Установка и настройка служб IIS в Windows Server

[!INCLUDE [remote-debugger-install-iis-role](../debugger/includes/remote-debugger-install-iis-role.md)]

## <a name="update-browser-security-settings-on-windows-server"></a>Обновить параметры безопасности браузера в Windows Server

В зависимости от настроек безопасности он может сэкономить время, чтобы добавить следующие надежные сайты в браузер, поэтому можно легко загрузить программное обеспечение, описанный в этом учебнике. Возможно, потребуется доступ к этим сайтам:

- microsoft.com
- go.microsoft.com
- download.microsoft.com
- visualstudio.com

При использовании Internet Explorer, можно добавить надежных сайтов, перейдя **свойства обозревателя > Безопасность > надежных узлов > сайтов**. Эти шаги для других браузеров различаются. (Если требуется загрузить более раннюю версию удаленного отладчика из my.visualstudio.com некоторые дополнительные надежные сайты необходимы для входа.)

При загрузке программного обеспечения, можно получить запросы на предоставление разрешения на загрузку различные сценарии веб-сайт и ресурсы. В большинстве случаев эти дополнительные ресурсы не требуется устанавливать программное обеспечение.

## <a name="install-aspnet-core-on-windows-server"></a>Установка ASP.NET Core в Windows Server

1. Установка [.NET Core Windows Server, где размещены](https://aka.ms/dotnetcore-2-windowshosting) пакета на хост-системы. Пакет установки среды выполнения .NET Core, основной библиотеке .NET и модуль ASP.NET Core. Более подробные инструкции см. в разделе [публикация в службах IIS](/aspnet/core/publishing/iis?tabs=aspnetcore2x#iis-configuration).

    > [!NOTE]
    > Если система не использует подключение к Интернету, загрузка и установка  *[Visual C++ 2015 распространяемый компонент Microsoft](https://www.microsoft.com/download/details.aspx?id=53840)*  перед установкой пакета .NET Core Windows Server, где размещены.

3. Перезагрузку системы (или выполните **net stop был /y** следуют **net start w3svc** из командной строки, чтобы отобразить изменение в системе путь).

## <a name="BKMK_install_webdeploy"></a>(Необязательно) Установка веб-развертывания 3.6 в Windows Server

[!INCLUDE [remote-debugger-install-web-deploy](../debugger/includes/remote-debugger-install-web-deploy.md)]

## <a name="BKMK_deploy_asp_net"></a>Настройка веб-сайта ASP.NET на сервере Windows Server

1. Откройте проводник Windows и создайте новую папку **C:\Publish**, где будут развернуты позднее проекта ASP.NET.

2. Откройте **Internet Information Services (IIS) Manager**. (В левой панели диспетчера серверов выберите **IIS**. Щелкните правой кнопкой мыши сервер и выберите **Диспетчер Internet Information Services (IIS)**.)

3. В разделе **подключений** в левой области выберите **узлы**.

4. Выберите **веб-сайт по умолчанию**, выберите **основные параметры**и задайте **физический путь** для **C:\Publish**.

4. Щелкните правой кнопкой мыши узел **Веб-сайт по умолчанию** и выберите команду **Добавить приложение**.

5. Задать **псевдоним** на **MyASPApp**, примите имя по умолчанию пула приложений (**DefaultAppPool**) и задайте **физический путь** для  **C:\Publish**.

6. В разделе **подключений**выберите **пулы приложений**. Откройте **DefaultAppPool** и задайте для поля пула приложений **без управляемого кода**.

7. Щелкните правой кнопкой мыши новый узел в диспетчере служб IIS, выберите **изменение разрешений**и убедитесь, что учетная запись IUSR, IIS_IUSRS или пользователя, настроенная для доступа к веб-приложению полномочному пользователю с правами на чтение и выполнение.

    Если вы не видите одному из этих пользователей с доступом, выполните действия, чтобы добавить IUSR в качестве пользователя с правами на чтение и выполнение.

## <a name="bkmk_webdeploy"></a>(Необязательно) Публикация и развертывание приложения с помощью веб-развертывание из Visual Studio

[!INCLUDE [remote-debugger-deploy-app-web-deploy](../debugger/includes/remote-debugger-deploy-app-web-deploy.md)]

## <a name="optional-publish-and-deploy-the-app-by-publishing-to-a-local-folder-from-visual-studio"></a>(Необязательно) Публикация и развертывание приложения путем публикации в локальную папку из Visual Studio

Можно также опубликовать и развертывание приложения с помощью файловой системы или других средств.

[!INCLUDE [remote-debugger-deploy-app-local](../debugger/includes/remote-debugger-deploy-app-local.md)]

## <a name="BKMK_msvsmon"></a>Загрузите и установите инструменты удаленной отладки на Windows Server

[!INCLUDE [remote-debugger-download](../debugger/includes/remote-debugger-download.md)]

> [!TIP]
> В некоторых сценариях может быть наиболее эффективным для запуска удаленного отладчика из общей папки. Дополнительные сведения см. в разделе [запуск удаленного отладчика из общей папки](../debugger/remote-debugging.md#fileshare_msvsmon).
  
## <a name="BKMK_setup"></a>Настройка удаленного отладчика на Windows Server

[!INCLUDE [remote-debugger-configuration](../debugger/includes/remote-debugger-configuration.md)]

> [!NOTE]
> Если необходимо добавить разрешения для других пользователей, изменение режима проверки подлинности, или номер порта удаленного отладчика, в разделе [настроить удаленный отладчик](../debugger/remote-debugging.md#configure_msvsmon).

Сведения на запуск удаленного отладчика в качестве службы см. в разделе [запуска удаленного отладчика в качестве службы](../debugger/remote-debugging.md#bkmk_configureService).

## <a name="BKMK_attach"></a> Подключение к приложению ASP.NET с компьютера с Visual Studio

1. На компьютере с Visual Studio, откройте **MyASPApp** решения.
2. В Visual Studio щелкните **Отладка > присоединить к процессу** (Ctrl + Alt + P).

    > [!TIP]
    > В Visual Studio 2017 г., можно подключить с тем же процессом, ранее присоединена к с помощью **Отладка > повторно присоединиться к процессу...** (Shift + Alt + P). 

3. Задайте для поля квалификатор  **\<имя удаленного компьютера >: 4022**.
4. Нажмите кнопку **Обновить**.
    В окне **Доступные процессы** должен появиться ряд процессов.

    Если вы не видите все процессы, попробуйте использовать IP-адрес вместо имени удаленного компьютера (порт является обязательным). Можно использовать `ipconfig` в командной строке, чтобы получить адрес IPv4.

    Если вы хотите использовать **найти** кнопки, может потребоваться [откройте порт UDP 3702](#bkmk_openports) на сервере.

5. Установите флажок  **Показать процессы, запущенные всеми пользователями**.
6. Введите имя процесса, чтобы быстро найти первую букву **dotnet.exe** (для ASP.NET Core).

    ![RemoteDBG_AttachToProcess](../debugger/media/remotedbg_attachtoprocess_aspnetcore.png "RemoteDBG_AttachToProcess")

7. Нажмите кнопку **Присоединить**.

8. Откройте веб-сайт удаленного компьютера. В браузере, перейдите к **http://\<имя удаленного компьютера >**.
    
    Должна открыться веб-страница ASP.NET.

9. В работающем приложении ASP.NET, щелкните ссылку, чтобы **о** страницы.

    В Visual Studio должна быть достигнута точка останова.

## <a name="bkmk_openports"></a>Устранение неполадок: Откройте требуемых портов в Windows Server

В большинстве установок необходимые порты открыты путем установки ASP.NET и удаленный отладчик. Тем не менее может потребоваться проверить, что открыты порты.

> [!NOTE]
> На виртуальной Машине Azure, необходимо открыть порты, через [сетевой группы безопасности](/azure/virtual-machines/virtual-machines-windows-hero-role#open-port-80). 

Необходимые порты:

- 80 - требуется для служб IIS
- 4022 - необходимых для удаленной отладки из Visual Studio 2017 г. (см. [назначение портов удаленного отладчика](../debugger/remote-debugger-port-assignments.md) подробные сведения.
- 8172 - (необязательно) является обязательным для веб-развертывания для развертывания приложения из Visual Studio.
- UDP 3702 - порта (необязательно) обнаружения позволяет **найти** кнопку при присоединении удаленного отладчика в Visual Studio.

1. Чтобы открыть порт на сервере Windows, откройте **запустить** меню, поиск **брандмауэр Windows в режиме повышенной безопасности**.

2. Выберите **правила для входящих подключений > новое правило > порт**, а затем нажмите кнопку **Далее**. (Порт UDP 3702 выберите **правила для исходящих подключений** вместо.)

3. В разделе **определенные локальные порты**, введите номер порта, нажмите кнопку **Далее**.

4. Нажмите кнопку **Разрешить соединение**, нажмите кнопку **Далее**.

5. Выберите один или несколько типов сетей для включения для порта и нажмите кнопку **Далее**.

    Выбранные типы должны включать сеть, к которой подключен удаленный компьютер.
6. Добавьте имя (например, **IIS**, **веб-развертывания**, или **msvsmon**) для правила входящего подключения и нажмите кнопку **Готово**.

    Вы увидите новое правило в списке правила для входящих подключений или правила для исходящих подключений.

    Если для получения дополнительных сведений о настройке брандмауэра Windows см. раздел [Настройка брандмауэра Windows для удаленной отладки](../debugger/configure-the-windows-firewall-for-remote-debugging.md).

3. Создайте дополнительные правила для требуемых портов.
