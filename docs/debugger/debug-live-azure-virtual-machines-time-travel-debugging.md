---
title: Время поездки отладки динамической ASP.NET виртуальных машинах Azure
description: Узнайте, как записывать и воспроизводить работающих приложений ASP.NET на виртуальных машинах Azure с помощью отладчика моментальных снимков.
ms.custom: ''
ms.date: 04/11/2019
ms.topic: conceptual
helpviewer_keywords:
- debugger
author: poppastring
ms.author: madownie
manager: andster
monikerRange: '>= vs-2019'
ms.workload:
- aspnet
- azure
ms.openlocfilehash: d392e19bb51cd981cc833535556eb083e8e5ba07
ms.sourcegitcommit: 53aa5a413717a1b62ca56a5983b6a50f7f0663b3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/17/2019
ms.locfileid: "59672508"
---
# <a name="record-and-replay-live-aspnet-apps-on-azure-virtual-machines-using-the-snapshot-debugger"></a>Запись и воспроизведение работающих приложений ASP.NET на виртуальных машинах Azure с помощью отладчика моментальных снимков

Просмотр времени Travel отладки (устранение проблем) в Visual Studio Enterprise предоставляет возможность записи веб-приложения, работающего на виртуальной машине Azure (ВМ) точно воссоздания и воспроизвести путь выполнения. Устранение проблем интегрируется с нашей отладчик моментальных снимков, предложения и позволяет rewind и воспроизводить каждую строку кода, однако зачастую требуется, помогая поиска и определения проблем, возникающих только в рабочих средах.

Захват записи обнаруживают проблему не остановит приложение, тем не менее, добавляет запись значительную нагрузку для запущенного процесса, замедляя его работу на основе факторов, включая размер процесса и количество активных потоков.

Эта функция доступна в предварительной версии для выпуска Visual Studio 2019 перейдите лицензия на реальном времени.

В этом руководстве рассмотрены следующие задачи:

> [!div class="checklist"]
> * Запуск отладчика моментальных снимков с включенной отладкой путешествия в времени
> * Задайте точки прикрепления и собирать записи Переход во времени
> * Начать отладку записи Переход во времени

## <a name="prerequisites"></a>Предварительные требования

* Время поездки отладки для виртуальных машин (ВМ) Azure только для Visual Studio Enterprise 2019 г. или более поздней версии с **рабочую нагрузку разработки Azure**. (На вкладке **Отдельные компоненты** его можно найти в разделе **Отладка и тестирование** > **Отладчик моментальных снимков**.)

    Если он еще не установлен, установите [Visual Studio 2019 Enterprise](https://visualstudio.microsoft.com/vs/).

* Отладка во время путешествия доступна для следующих веб-приложений виртуальной Машины Azure:
  * Приложения ASP.NET (AMD64) в .NET Framework 4.8 или более поздней версии.

## <a name="open-your-project-and-start-the-snapshot-debugger-with-time-travel-debugging-enabled"></a>Откройте свой проект и запустить отладчик моментальных снимков с включенной отладкой путешествия в времени

1. Откройте проект, который вы хотите собирать записи Переход во времени.

    > [!IMPORTANT]
    > Чтобы запустить обнаруживают проблему, необходимо открыть *же версию исходного кода* , опубликованный в службе виртуальных Машин Azure.

1. Выберите **Отладка > Подключить Snapshot Debugger...**. Выберите веб-приложение развертывается в виртуальной Машине Azure и учетную запись хранилища Azure. Выберите **включить отладка во время путешествия** Предварительный просмотр параметр и нажмите кнопку **Attach**.

      ![Выбор ресурса Azure](../debugger/media/time-travel-debugging-select-azure-resource-vm.png)

    > [!IMPORTANT]
    > Если впервые щелкнуть **Подключить Snapshot Debugger** для виртуальной машины, службы IIS автоматически перезагрузятся.

    Метаданные для **модулей** изначально не будут активированы, чтобы кнопка **Запуск коллекции** стала активной, перейдите к веб-приложению. Visual Studio теперь находится в режиме отладки моментальных снимков.

   ![Режим отладки моментальных снимков](../debugger/media/snapshot-message.png)

    > [!NOTE]
    > Расширение сайта Application Insights также поддерживает отладку моментальных снимков. При возникновении сообщения об ошибке из-за того, что расширение сайта устарело, ознакомьтесь со статьей [Устранение неполадок и известные проблемы для отладки моментальных снимков в Visual Studio](../debugger/debug-live-azure-apps-troubleshooting.md) для получения подробной информации об обновлении.

   **Модули** окне отображается, когда все модули, загруженные для виртуальной Машины Azure (выберите **Отладка > Windows > модули** чтобы открыть это окно).

   ![Проверка окна модулей](../debugger/media/snapshot-modules.png)

## <a name="set-a-snappoint-and-collect-a-time-travel-recording"></a>Задайте точки прикрепления и собирать записи Переход во времени

1. В редакторе кода щелкните левой внутренней области в методе, которые вас интересуют установить точки прикрепления. Убедитесь, что будет выполняться именно этот код.

   ![Настройка точки моментальных снимков](../debugger/media/time-travel-debugging-set-snappoint-settings.png)

1. Щелкните правой кнопкой мыши значок точка прикрепления (пустой шар) и выберите **действия**. В окне параметров моментального снимка щелкните **действие** "флажок". Нажмите кнопку **сбора трассировки время поездки до конца этого метода** "флажок".

   ![Собирать трассировки время поездки в конец метода](../debugger/media/time-travel-debugging-set-snappoint-action.png)

1. Нажмите кнопку **Запустить коллекцию**, чтобы включить точку моментальных снимков.

   ![Включение точки моментальных снимков](../debugger/media/snapshot-start-collection.png)

## <a name="take-a-snapshot"></a>Сделайте моментальный снимок

Когда точка моментальных снимков включена, она создает моментальный снимок при каждом выполнении строки кода, на которой она размещена. Это выполнение может быть вызвано реальным запросом на вашем сервере. Для принудительного выполнения точки моментальных снимков перейдите к представлению браузера на своем веб-сайте и выполните все необходимые действия, которые приведут к выполнению точки моментальных снимков.

## <a name="start-debugging-a-time-travel-recording"></a>Начать отладку записи Переход во времени

1. При выполнении точки моментальных снимков в окне "Средства диагностики" появляется снимок. Чтобы открыть это окно, выберите **Отладка > Windows > Показать средства диагностики**.

   ![Открытие точки моментальных снимков](../debugger/media/snapshot-diagsession-window.png)

1. Щелкните ссылку Просмотр моментального снимка, чтобы открыть Переход во времени, записи в редакторе кода.
  
   Можно выполнять каждую строку кода, записанных обнаруживают проблему с помощью **Продолжить** и **обратный по-прежнему** кнопки. Кроме того на панели инструментов отладки может быть использован для **Показать следующий оператор**, **шаг с заходом**, **шаг с обходом**, **шаг с выходом**,  **Шаг в**, **шаг с обходом обратно**, **обратно шаг**.

   ![Начало отладки](../debugger/media/time-travel-debugging-step-commands.png)

   Можно также использовать **"Локальные"**, **Watches**, и **стек вызовов** windows, а также оценивать выражения.

   ![Проверка данных моментальных снимков](../debugger/media/time-travel-debugging-start-debugging.png)

    На веб-узел по-прежнему активно и конечных пользователей не распространялось действие любого последующего действия обнаруживают проблему. По умолчанию создается только один моментальный снимок для каждой точки моментальных снимков. После создания моментального снимка точка моментальных снимков отключается. Если вы хотите сделать еще один снимок в одной точке, вы можете снова включить ее, нажав **Обновить коллекцию**.

**Нужна помощь?** См. статьи [Устранение неполадок и известные проблемы для отладки моментальных снимков в Visual Studio](../debugger/debug-live-azure-apps-troubleshooting.md) и [Часто задаваемые вопросы по отладке моментальных снимков в Visual Studio](../debugger/debug-live-azure-apps-faq.md).

## <a name="set-a-conditional-snappoint"></a>Настройка условной точки моментальных снимков

Если вам трудно воссоздать определенное состояние в своем приложении, подумайте, может ли помочь использование условной точки моментальных снимков. Условные точки прикрепления помогают избежать сбора записи Переход во времени, пока приложение входит в требуемое состояние, например, если переменная имеет определенное значение, которое требуется проверить. [Можно задать с помощью выражений, фильтров, условий или обращений](../debugger/debug-live-azure-apps-troubleshooting.md).

## <a name="next-steps"></a>Следующие шаги

В этом руководстве вы узнали, как собирать записи Переход во времени для виртуальных машин Azure. Вы можете прочитать дополнительные сведения об отладчике моментальных снимков.

> [!div class="nextstepaction"]
> [Ответы на часто задаваемые вопросы по отладке моментальных снимков](../debugger/debug-live-azure-apps-faq.md)