---
title: Отладка работающих приложений ASP.NET Azure
ms.description: Learn how to set snappoints and view snapshots with the Snapshot Debugger.
ms.custom: mvc
ms.date: 03/16/2018
ms.technology: vs-ide-debug
ms.topic: tutorial
helpviewer_keywords:
- debugger
ms.assetid: adb22512-4d4d-40e5-9564-1af421b7087e
author: mikejo5000
ms.author: mikejo
manager: douge
ms.workload:
- aspnet
- azure
ms.openlocfilehash: 5207af86d850dca3e4dfde515237452c293788ea
ms.sourcegitcommit: 4667e6ad223642bc4ac525f57281482c9894daf4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/20/2018
ms.locfileid: "36281554"
---
# <a name="debug-live-aspnet-azure-apps-using-the-snapshot-debugger"></a>Отладка работающих приложений ASP.NET Azure, с помощью отладчика моментальных снимков

Отладчик моментальных снимков создает моментальный снимок в рабочих приложениях, когда выполняется код, который вас интересует. Чтобы указать отладчику на необходимость создать моментальный снимок, следует установить точки прикрепления и точки ведения в коде. Отладчик позволяет увидеть источник ошибки, не затрагивая трафик рабочего приложения. Средство Snapshot Debugger позволяет значительно сократить затраты времени на устранение проблем, возникающих в рабочих средах.

Snappoints и logpoints похожи на точки останова, но в отличие от точки останова, snappoints не приостанавливает работу приложения при попадании. Как правило создается моментальный снимок в точка прикрепления занимает 10 – 20 миллисекунд.

В этом руководстве рассмотрены следующие задачи:

> [!div class="checklist"]
> * Запуск отладчика моментальных снимков
> * Задайте точки прикрепления и Просмотр моментального снимка
> * Задать точка ведения журнала

## <a name="prerequisites"></a>Предварительные требования

* Отладчик моментальных снимков доступно только для Visual Studio Enterprise 2017 версии 15.5 или более поздней версии с **рабочую нагрузку ASP.NET и веб-разработки**. Для ASP.NET Core, необходимо также. **Разработка NET Core** установленной рабочей нагрузкой.

    Если он еще не установлен, установите [Visual Studio Enterprise 2017 версии 15.5](https://visualstudio.microsoft.com/downloads/?utm_medium=microsoft&utm_source=docs.microsoft.com&utm_campaign=button+cta&utm_content=download+vs2017) или более поздней версии. Если при обновлении с предыдущей установки Visual Studio 2017, запустите установщик Visual Studio и проверьте компонент отладчика моментальных снимков **рабочую нагрузку ASP.NET и веб-разработки**.

* План службы приложений Azure Basic или более поздней версии.

* Коллекция моментальных снимков доступна для следующих веб-приложений, выполняющихся в службе приложений Azure App:

    * Приложения ASP.NET, выполняющиеся на платформе .NET Framework 4.6.1 или более поздней версии.
    * Приложения ASP.NET Core, выполняющиеся на платформе .NET Core 2.0 или более поздней версии под управлением Windows.

## <a name="open-your-project-and-start-the-snapshot-debugger"></a>Откройте свой проект и запустить отладчик моментальных снимков

1. Откройте проект, который вы хотите отладки моментальных снимков.

    > [!IMPORTANT]
    > Отладка моментальных снимков, необходимо открыть **же версию исходного кода** , опубликованный в службе приложений Azure.

1. В Cloud Explorer (**представление > Cloud Explorer**), щелкните правой кнопкой мыши ваш проект развернут в службе приложений Azure и выберите **подключить отладчик моментальных снимков**.

   ![Запустить отладчик моментальных снимков](../debugger/media/snapshot-launch.png)

    Когда вы впервые щелкаете **подключить отладчик моментальных снимков**, вам будет предложено установить расширение сайта Snapshot Debugger в вашей службе приложений Azure. Это требуется для установки службы приложений Azure.

   Visual Studio теперь находится в режиме отладки моментальных снимков.

    > [!NOTE]
    > Расширение сайта Application Insights также поддерживает отладка моментальных снимков. Если возникнет сообщение об ошибке «узла расширения, которые устарели», см. в разделе [Устранение неполадок, советов и известные проблемы для отладки моментальных снимков](../debugger/debug-live-azure-apps-troubleshooting.md) для обновления сведений.

   ![Режим отладки моментальных снимков](../debugger/media/snapshot-message.png)

   **Модули** окне отображается, когда все модули, загруженные для службы приложений Azure (выберите **отладка / Windows / модули** чтобы открыть это окно).

   ![Проверьте окно "Модули"](../debugger/media/snapshot-modules.png)

## <a name="set-a-snappoint"></a>Задайте точки прикрепления

1. В редакторе кода выберите левом поле рядом со строкой кода, которые вас интересуют задать точка прикрепления. Убедитесь, что это код, который вы знаете, будет выполняться.

   ![Задайте точки прикрепления](../debugger/media/snapshot-set-snappoint.png)

2. Нажмите кнопку **начать сбор** Включение точки прикрепления.

   ![Включите точки прикрепления](../debugger/media/snapshot-start-collection.png)

    > [!TIP]
    > Не удается шаг при просмотре моментального снимка, но можно разместить несколько точек прикрепления в коде для выполнения в строках кода. При наличии нескольких точек прикрепления в коде, отладчик моментальных снимков обеспечивает доступность соответствующих моментальных снимков из одного сеанса конечного пользователя. Отладчик моментальных снимков делает это, даже при наличии многих пользователей щелкают ссылку на приложение.

## <a name="take-a-snapshot"></a>Создайте моментальный снимок

При включении точка прикрепления соберет моментальный снимок, при каждом выполнении строку кода, где размещается точка прикрепления. Выполнение может быть вызвана реального запроса на сервере. Для принудительного вашей точки прикрепления для сбора, перейдите в представление браузера веб-узла и выполнять любые действия обязательные, привести к вашей точки прикрепления для проверки касания.

## <a name="inspect-snapshot-data"></a>Проверьте данные моментального снимка

1. При достижении snappoint моментальный снимок отображается в окне средств диагностики. Чтобы открыть это окно, выберите **отладка / Windows / Показать средства диагностики**.

   ![Откройте точка прикрепления](../debugger/media/snapshot-diagsession-window.png)

1. Дважды щелкните точки прикрепления для открытия моментального снимка в редакторе кода.

   ![Проверьте данные моментального снимка](../debugger/media/snapshot-inspect-data.png)

   В этом представлении наводите указатель мыши на переменные, чтобы просмотреть подсказки данных, используйте **"Локальные"**, **Watches**, и **стек вызовов** windows, а также оценивать выражения.

    На веб-узел по-прежнему активно и не влияет на конечных пользователей. Только один моментальный снимок фиксируется на точки прикрепления по умолчанию: отключает после захвата моментальный снимок точки прикрепления. Если вы хотите собирать другой снимок в точка прикрепления, можно включить точки прикрепления обратно на, щелкнув **обновить коллекцию**.

Можно также добавить дополнительные точки прикрепления для приложения и включить их с **обновить коллекцию** кнопки.

**Нужна помощь?** См. в разделе [Устранение неполадок и известные проблемы](../debugger/debug-live-azure-apps-troubleshooting.md) и [вопросы и ответы по отладке моментальных снимков](../debugger/debug-live-azure-apps-faq.md) страниц.

## <a name="set-a-conditional-snappoint"></a>Задайте условный точка прикрепления

Если сложно воссоздать определенном состоянии в приложении, следует ли помочь использование условной точки прикрепления. Условные точки прикрепления позволяет избежать создания моментального снимка, пока приложение входит в требуемое состояние, например, если переменная имеет определенное значение, которое требуется проверить. Можно задать с помощью выражений, фильтров, условий или числа попаданий.

#### <a name="to-create-a-conditional-snappoint"></a>Создание условной точки прикрепления

1. Щелкните правой кнопкой мыши значок в виде точка прикрепления (пустой шар) и выберите **параметры**.

   ![Выбор параметров](../debugger/media/snapshot-snappoint-settings.png)

1. В окне параметров точки прикрепления введите выражение.

   ![Введите выражение](../debugger/media/snapshot-snappoint-conditions.png)

   В предыдущем примере, создается моментальный снимок только для точки прикрепления при `visitor.FirstName == "Dan"`.

## <a name="set-a-logpoint"></a>Задать точка ведения журнала

Кроме создания моментального снимка, при достижении snappoint, можно также настроить точки прикрепления для регистрации сообщения (то есть создать точка ведения журнала). Точек ведения журнала можно задать без повторного развертывания приложения. Точек ведения журнала, выполняются практически в результате чего не влияние или побочные эффекты для запущенного приложения.

#### <a name="to-create-a-logpoint"></a>Чтобы создать точка ведения журнала

1. Щелкните правой кнопкой мыши значок в виде точка прикрепления (синий шестиугольник) и выберите **параметры**.

1. В окне параметров точки прикрепления выберите **действия**.

    ![Создание точка ведения журнала](../debugger/media/snapshot-logpoint.png)

1. В поле сообщения можно ввести новое сообщение журнала, которые будут использоваться для входа. Также можно оценить переменные в сообщении журнала, поместив их в фигурных скобках.

    Если вы выберете **отправить в окно вывода**, когда достигнута точка ведения журнала, сообщение будет отображаться в окне средств диагностики.

    ![Точка ведения журнала данных в окне сеансу diagsession](../debugger/media/snapshot-logpoint-output.png)

    Если вы выберете **отправить в журнал приложений**, когда будет достигнута точка ведения журнала, сообщение будет отображаться в любом месте, вы можете просмотреть сообщения из `System.Diagnostics.Trace` (или `ILogger` в .NET Core), такие как [App Insights](/azure/application-insights/app-insights-asp-net-trace-logs).

## <a name="next-steps"></a>Следующие шаги

В этом руководстве вы узнали, как использовать отладчик моментальных снимков. Вы можете прочитать дополнительные сведения об этой функции.

> [!div class="nextstepaction"]
> [Ответы на часто задаваемые вопросы по отладке моментальных снимков](../debugger/debug-live-azure-apps-faq.md)
