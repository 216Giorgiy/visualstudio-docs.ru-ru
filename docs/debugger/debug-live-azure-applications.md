---
title: "Отладка динамического приложения ASP.NET Azure - Visual Studio | Документы Microsoft"
ms.date: 12/06/2017
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-debug
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: debugger
ms.assetid: adb22512-4d4d-40e5-9564-1af421b7087e
caps.latest.revision: "1"
author: mikejo5000
ms.author: mikejo
manager: ghogen
ms.workload:
- aspnet
- azure
ms.openlocfilehash: 5317c06dc5ff6515627e562d576785c2ff25a98a
ms.sourcegitcommit: 5d43e9590e2246084670b79269cc9d99124bb3df
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/19/2018
---
# <a name="debug-live-aspnet-azure-apps-using-the-snapshot-debugger"></a>Отладка динамического приложения ASP.NET Azure, с помощью отладчика моментальных снимков

Отладчик моментальных снимков создает моментальный снимок в производственных приложений при выполнении кода, которые вас интересуют. Чтобы указать отладчику на необходимость создать моментальный снимок, следует установить точки прикрепления и точки ведения в коде. Отладчик позволяет увидеть источник ошибки, не затрагивая трафик рабочего приложения. Средство Snapshot Debugger позволяет значительно сократить затраты времени на устранение проблем, возникающих в рабочих средах.

Snappoints и logpoints похожи на точки останова. В отличие от точки останова, snappoints не остановки приложения при попадании. Как правило создается моментальный снимок на snappoint занимает 10-20 миллисекунд. 

Коллекция моментальных снимков доступна для следующих веб-приложений, выполняющихся в службе приложений Azure App:

- Приложения ASP.NET, выполняющиеся на платформе .NET Framework 4.6.1 или более поздней версии.
- Приложения ASP.NET Core, выполняющиеся на платформе .NET Core 2.0 или более поздней версии под управлением Windows.

Кроме того отладчик моментальный снимок доступен только для Visual Studio Enterprise 2017 г 15,5 или более поздней версии и планы служб приложений Basic или более поздней версии. 

## <a name="start-the-snapshot-debugger"></a>Запустите отладчик моментальных снимков

1. Установка [Visual Studio Enterprise 2017 г. версия 15,5](https://www.visualstudio.com/downloads/) или более поздней версии. При обновлении от предыдущей установки Visual Studio 2017 г. Запустите установщик Visual Studio и проверьте компонент отладчика моментального снимка в рабочей нагрузке ASP.NET и веб-разработки.

2. Откройте проект, который вы бы хотели отладки моментального снимка. 

    > [!IMPORTANT] 
    > Чтобы отладки моментального снимка, необходимо открыть **же версию исходного кода** , опубликованный в службе приложений Azure. 

3. В Cloud Explorer (выберите **представление > Cloud Explorer**), щелкните правой кнопкой мыши службы приложений Azure развертывается проект и выберите **подключить отладчик моментального снимка** для запуска отладчика моментального снимка.

   ![Запустить отладчик моментального снимка](../debugger/media/snapshot-launch.png "запустить отладчик моментальных снимков")

    При первом выборе **подключить отладчик моментального снимка**, вам будет предложено установить расширение сайта отладчик моментального снимка в службе приложений Azure. Это требуется для установки вашей службы приложения Azure. 

   Visual Studio теперь находится в режиме отладки моментального снимка.

    > [!NOTE]
    > Узел расширения Application Insights также поддерживает отладку моментального снимка. Если возникнет сообщение об ошибке «сайт старую версию расширения» см. в разделе [Устранение неполадок советы и известные проблемы для отладки моментального снимка](../debugger/debug-live-azure-apps-troubleshooting.md) для обновления сведений.

   ![Моментальный снимок в режиме отладки](../debugger/media/snapshot-message.png "режим отладки моментальных снимков")

   **Модули** окне отображается, когда все модули загружены за службы приложений Azure (выберите **отладка / Windows / модули** чтобы открыть это окно).

   ![Проверьте окно модулей](../debugger/media/snapshot-modules.png "Проверьте модули-окно")

## <a name="set-a-snappoint"></a>Задать snappoint

1. В редакторе кода щелкните левом поле рядом со строкой кода, которые вас интересуют задать snappoint. Убедитесь, что вы знаете, будет выполняться код.

   ![Задать snappoint](../debugger/media/snapshot-set-snappoint.png "задать snappoint")

2. Нажмите кнопку **начать сбор** Включение snappoint.  

   ![Включите snappoint](../debugger/media/snapshot-start-collection.png "включить snappoint")

    > [!TIP]
    > Невозможно шаг, если Просмотр моментального снимка, но несколько snappoints можно разместить в коде для выполнения в строках кода. При наличии нескольких snappoints в коде, отладчик моментальных снимков обеспечивает соответствующий моментальные снимки из одного сеанса конечного пользователя, даже при наличии нескольких пользователей, попадание приложения.

## <a name="take-a-snapshot"></a>Создание снимка

При включении snappoint соберет моментального снимка, всякий раз при выполнении в строку кода, где размещается snappoint. Выполнения этого может быть вызвано реального запроса на сервере. Чтобы заставить ваш snappoint нажатия, можно перейти в представление браузера веб-сайта и выполните требуемые каких-либо действий, которые приводят к snappoint будет пройдена.

## <a name="inspect-snapshot-data"></a>Проверить данные моментального снимка

1. При попадании snappoint моментальный снимок отображается в окне средства диагностики. Выберите **отладка / Windows / Показать средства диагностики** чтобы открыть это окно.

   ![Откройте snappoint](../debugger/media/snapshot-diagsession-window.png "откройте snappoint")

1. Дважды щелкните snappoint Открытие моментального снимка в редакторе кода.

   ![Проверить данные моментального снимка](../debugger/media/snapshot-inspect-data.png "проверки данных моментального снимка")

   В этом представлении можно навести на переменные, чтобы просмотреть подсказки данных, используйте **локальные**, **отслеживает**, и **стек вызовов** windows и также вычисления выражений.

    На веб-узел по-прежнему существуют и не влияет на конечных пользователей. Только один моментальный снимок фиксируется на snappoint по умолчанию: отключает после моментального снимка происходит snappoint. Если вы хотите записать другой снимок в snappoint, можно включить snappoint обратно, щелкнув **обновление коллекции**.

Можно также добавлять дополнительные snappoints в свое приложение и включить их с **обновление коллекции** кнопки.

**Нужна помощь?** В разделе [Устранение неполадок и известные проблемы](../debugger/debug-live-azure-apps-troubleshooting.md) и [часто задаваемые вопросы по отладке моментального снимка](../debugger/debug-live-azure-apps-faq.md) страниц.

## <a name="set-a-conditional-snappoint"></a>Задайте условный snappoint

Если сложно воссоздать одного определенного состояния в приложении, следует ли использование условной snappoint может помочь. Можно использовать условные snappoints во избежание создания моментального снимка, пока приложение входит в нужном состоянии, например, если переменная имеет определенное значение вас интересует. Можно задать с помощью выражений, фильтров, условий или числа попаданий.

#### <a name="to-create-a-conditional-snappoint"></a>Создание условной snappoint

1. Щелкните правой кнопкой мыши значок в виде snappoint (пустой шар) и выберите **параметры**.

   ![Выберите параметры](../debugger/media/snapshot-snappoint-settings.png "Выбор параметров")

1. В окне параметров snappoint введите выражение.

   ![Введите выражение](../debugger/media/snapshot-snappoint-conditions.png "введите выражение")

   На предыдущем рисунке только снимка для snappoint при `visitor.FirstName == "Dan"`.

## <a name="set-a-logpoint"></a>Задать logpoint

Кроме создания моментального снимка при попадании snappoint, можно также настроить snappoint для регистрации сообщения (то есть создание logpoint). Можно задать logpoints без необходимости повторного развертывания приложения. Logpoints, выполняются практически и вызвать без влияния или побочные эффекты для выполняющегося приложения.

#### <a name="to-create-a-logpoint"></a>Чтобы создать logpoint

1. Щелкните правой кнопкой мыши значок в виде snappoint (синий шестиугольник) и выберите **параметры**.

1. Выберите в окне параметров snappoint **действия**.

    ![Создание logpoint](../debugger/media/snapshot-logpoint.png "создать logpoint")

1. В поле «сообщение» можно ввести новое сообщение журнала, который вы хотите войти. Также можно оценить переменные в журнал сообщения, поместив их внутри фигурных скобок.

    При выборе **отправки в окне вывода**, при достижении logpoint сообщение в окно средств диагностики.

    ![Logpoint данных в окне diagsession](../debugger/media/snapshot-logpoint-output.png "Logpoint данных в окне diagsession")

    При выборе **отправки в журнал приложений**, помеченным logpoint сообщение появляется в любом месте, чтобы увидеть сообщения из `System.Diagnostics.Trace` (или `ILogger` в .NET Core), такие как [подробные сведения о приложении](/azure/application-insights/app-insights-asp-net-trace-logs).

## <a name="next-steps"></a>Следующие шаги

- Узнайте, как проверять значения переменных во время просмотра моментального снимка, в разделе [Обзор возможностей отладчика](../debugger/debugger-feature-tour.md).
- Представление [часто задаваемые вопросы по отладке моментального снимка](../debugger/debug-live-azure-apps-faq.md).
- Представление [Устранение неполадок советы и известные проблемы для отладки моментального снимка](../debugger/debug-live-azure-apps-troubleshooting.md).
- Если вы хотите просмотреть моментальные снимки в Application Insights, если приложение обнаруживает исключение, это можно сделать. Дополнительные сведения см. в разделе [отладки моментальные снимки на исключения в приложениях .NET](/azure/application-insights/app-insights-snapshot-debugger). Application Insights поддерживает приложения Service Fabric в дополнение к службе приложений Azure.
