---
title: "Ведение журнала в многопроцессорной среде | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- MSBuild, multi-processor logging
- MSBuild, logging
ms.assetid: dd4dae65-ed04-4883-b48d-59bcb891c4dc
caps.latest.revision: 9
author: kempb
ms.author: kempb
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: HT
ms.sourcegitcommit: 4a36302d80f4bc397128e3838c9abf858a0b5fe8
ms.openlocfilehash: e78d6c35fa294d2f1a39c91af5e278e9e4519d2d
ms.contentlocale: ru-ru
ms.lasthandoff: 09/26/2017

---
# <a name="logging-in-a-multi-processor-environment"></a>Ведение журнала в многопроцессорной среде
Возможность использования нескольких процессоров MSBuild может значительно сократить время построения проекта, но усложняет ведение журнала. В среде с одним процессором средство ведения журнала может обрабатывать входящие события, сообщения, предупреждения и ошибки прогнозируемый, последовательные способом. Тем не менее в многопроцессорной среде события из разных источников могут поступать одновременно или не по порядку. MSBuild предоставляет новое несколькими поддержкой средство ведения журнала и позволяет создавать пользовательские «средства ведения журнала переадресации».  
  
## <a name="logging-multiple-processor-builds"></a>Ведение журнала многопроцессорного построения  
 При создании одного или нескольких проектов в многопроцессорных или многоядерных системах события построения MSBuild для всех проектов, которые формируются одновременно. Множество данных о событиях может поступать в средство ведения журнала, в то же время или не по порядку. Это может произойти переполнение средства ведения журнала и вызвать увеличение времени построения, выходные данные неверные средства ведения журнала или даже повреждение построения. Для решения этих проблем, средства ведения журнала MSBuild можно обрабатывать события ожидания последовательности и сопоставлять события и их источники.  
  
 Чтобы повысить производительность ведения журнала, еще больше, путем создания пользовательского ведения журнала переадресации. Настраиваемый переадресации выступает в качестве фильтра, позволяя пользователю выбрать, перед построением, события, которые требуется отслеживать. При использовании пользовательских переадресации ненужные события не переполнить средство ведения журнала, загромождать журналов или замедление построения.  
  
### <a name="central-logging-model"></a>Централизованная модель ведения журнала  
 Для многопроцессорных построений в MSBuild используется «централизованную модель». В централизованную модель экземпляр MSBuild.exe выступает в качестве основного процесса построения, или «центрального узла». Дополнительные экземпляры MSBuild.exe, или «дополнительные узлы», присоединяются к центральному узлу. Либо на основе ILogger средством ведения журнала присоединенного к центральному узлу, называются «центральными средствами ведения журнала» и средств ведения журнала, подключенные к дополнительным узлам, называются «дополнительными средствами ведения журнала».  
  
 В процессе построения вторичной средства ведения журнала маршрутизации трафика их события центральных средств ведения журнала. Поскольку события исходят из нескольких дополнительных узлов, данные поступает на центральный узел одновременно, но с чередованием. Для разрешения ссылок на события для проекта и цели событий, аргументы события включают сведения о контексте события дополнительные сборки.  
  
 Несмотря на то что только <xref:Microsoft.Build.Framework.ILogger> — должен быть реализован центральное средство ведения журнала, рекомендуется также реализовать <xref:Microsoft.Build.Framework.INodeLogger> Если центра ведения журнала для инициализации с числом узлов, участвующих в сборке. Следующая перегрузка <xref:Microsoft.Build.Framework.ILogger.Initialize%2A> метод вызывается при инициализации средства ведения журнала в системе:  
  
```csharp
public interface INodeLogger: ILogger  
{  
    public void Initialize(IEventSource eventSource, int nodeCount);  
}  
```  
  
### <a name="distributed-logging-model"></a>Распределенная модель ведения журнала  
 В централизованную модель слишком большого объема входящих сообщений, например за один раз, построении множества проектов может произойти переполнение центрального узла, который увеличивается нагрузка на систему и снижается производительность построения.  
  
 Во избежание этой проблемы MSBuild также позволяет «распределенная модель ведения журнала», расширяет централизованную модель, позволяя создавать переадресации. Переадресации подключен на второй узел и принимает входящие события построения от этого узла. Средство ведения журнала переадресации — так же, как и обычный средства ведения журнала, за исключением того, что его можно фильтровать события и переадресовывать только нужные в центральный узел. Это сокращает трафик сообщений в центральном узле и таким образом, позволяет повысить производительность.  
  
 Можно создать переадресации, реализовав <xref:Microsoft.Build.Framework.IForwardingLogger> интерфейс, который является производным от <xref:Microsoft.Build.Framework.ILogger>. Интерфейс определяется как:  
  
```csharp
public interface IForwardingLogger: INodeLogger  
{  
    public IEventRedirector EventRedirector { get; set; }  
    public int NodeId { get; set; }  
}  
```  
  
 Чтобы переслать события в переадресации, вызовите <xref:Microsoft.Build.Framework.IEventRedirector.ForwardEvent%2A> метод <xref:Microsoft.Build.Framework.IEventRedirector> интерфейса. Передайте соответствующие <xref:Microsoft.Build.Framework.BuildEventArgs>, или производный класс, в качестве параметра.  
  
 Дополнительные сведения см. в разделе [средства ведения журнала переадресации создание](../msbuild/creating-forwarding-loggers.md).  
  
### <a name="attaching-a-distributed-logger"></a>Присоединение распределенное средство ведения журнала  
 Чтобы подключить распределенное средство ведения журнала на построение из командной строки, используйте `/distributedlogger` (или, `/dl` сокращенно) переключения. Формат для указания имен типов средства ведения журнала и классы используются те же для `/logger` переключиться, за исключением того, что распределенное средство ведения журнала включает в себя два класса: средство ведения журнала переадресации и центральное средство ведения журнала. Ниже приведен пример подключения распределенного средства ведения журнала:  
  
```  
msbuild.exe *.proj /distributedlogger:XMLCentralLogger,MyLogger,Version=1.0.2,  
Culture=neutral*XMLForwardingLogger,MyLogger,Version=1.0.2,  
Culture=neutral  
```  
  
 Символ звездочки (*) разделяет имена двух средств ведения журнала в `/dl` переключения.  
  
## <a name="see-also"></a>См. также  
 [Средства ведения журнала сборки](../msbuild/build-loggers.md)   
 [Создание средства ведения журнала переадресации](../msbuild/creating-forwarding-loggers.md)
