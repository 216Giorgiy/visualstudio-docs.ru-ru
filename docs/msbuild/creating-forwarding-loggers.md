---
title: "Создание средства ведения журнала переадресации | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "MSBuild, средства ведения журнала переадресации"
  - "MSBuild, ведение журналов"
ms.assetid: 3aebf9c8-b62c-4cb2-b2d6-8cdfcd369a24
caps.latest.revision: 9
caps.handback.revision: 9
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
---
# Создание средства ведения журнала переадресации
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Средства ведения журнала переадресации повышают эффективность ведения журналов, позволяя выбрать события для наблюдения при создании проектов в многопроцессорной системе.  Используя средства ведения журнала переадресации, можно предотвратить переполнение центрального средства ведения журналов, замедление построения и загромождение журнала нежелательными событиями.  
  
 Чтобы создать средство ведения журнала переадресации, можно либо реализовать интерфейс <xref:Microsoft.Build.Framework.IForwardingLogger>, а затем вручную применить его методы, либо использовать элемент <xref:Microsoft.Build.BuildEngine.ConfigurableForwardingLogger> и его предварительно настроенные методы.  \(Для большинства приложений вполне достаточно последнего метода.\)  
  
## Регистрация событий и ответ на них  
 Средство ведения журнала переадресации собирает сведения о событиях построения по мере того, как сообщения о них поступают от дополнительного обработчика построения, представляющего собой рабочий процесс, созданный основным процессом построения во время построения в многопроцессорной системе.  Затем средство ведения журнала переадресации выбирает события для переадресации в центральное средство ведения журнала на основании данных вами инструкций.  
  
 Необходимо регистрировать средства ведения журнала переадресации для обработки событий, за которыми нужно наблюдать.  Чтобы регистрировать события, средствам ведения журнала необходимо переопределить метод <xref:Microsoft.Build.Utilities.Logger.Initialize%2A>.  Этот метод теперь включает дополнительный параметр, `nodecount`, который можно задать для числа процессоров в системе.  \(По умолчанию для него задано значение 1.\)  
  
 Примерами событий, за которыми можно наблюдать, являются <xref:Microsoft.Build.Framework.IEventSource.TargetStarted>, <xref:Microsoft.Build.Framework.IEventSource.ProjectStarted> и <xref:Microsoft.Build.Framework.IEventSource.ProjectFinished>.  
  
 В многопроцессорной системе сообщения о событиях, вероятно, будут приниматься не по порядку.  Поэтому необходимо для оценки событий использовать обработчик событий в средстве ведения журнала переадресации и запрограммировать его на определение тех событий, которые следует передавать в перенаправитель для переадресации в центральное средство ведения журнала.  Для этого можно использовать класс <xref:Microsoft.Build.Framework.BuildEventContext>, прикрепленный к каждому сообщению, который поможет определить события для переадресации, а затем передать имена событий классу <xref:Microsoft.Build.BuildEngine.ConfigurableForwardingLogger> \(или его подклассу\).  При использовании этого метода не требуется специального кодирования для переадресации событий.  
  
## Указание средства ведения журнала переадресации  
 После того как средство ведения журнала переадресации скомпилировано в построение, необходимо сообщить [!INCLUDE[vstecmsbuild](../extensibility/internals/includes/vstecmsbuild_md.md)] о том, что нужно использовать это средство во время построений.  Для этого используйте вместе с MSBuild.exe ключи `/FileLogger`, `/FileLoggerParameters` и `/DistributedFileLogger`.  Ключ `/FileLogger` сообщает MSBuild.exe о прямом присоединении средства ведения журнала. Ключ `/DistributedFileLogger` означает наличие файла журнала в узле.  Чтобы задать параметры средства ведения журнала переадресации, используйте ключ `/FileLoggerParameters`.  Дополнительные сведения об этих и других ключах MSBuild.exe см. в разделе [Справочник по командной строке](../msbuild/msbuild-command-line-reference.md).  
  
## Средства ведения журнала, поддерживающие многопроцессорную среду  
 При создании проекта в многопроцессорной системе сообщения о построении от каждого процессора не чередуются автоматически в определенной последовательности.  Необходимо установить приоритет группирования сообщений с использованием класса <xref:Microsoft.Build.Framework.BuildEventContext>, прикрепленного к каждому сообщению.  Дополнительные сведения о многопроцессорном построении см. в разделе [Ведение журнала в многопроцессорной среде](../msbuild/logging-in-a-multi-processor-environment.md).  
  
## См. также  
 [Получение журналов построения](../msbuild/obtaining-build-logs-with-msbuild.md)   
 [Средства ведения журнала построения](../msbuild/build-loggers.md)   
 [Ведение журнала в многопроцессорной среде](../msbuild/logging-in-a-multi-processor-environment.md)