---
title: "Задача ResolveComReference | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "http://schemas.microsoft.com/developer/msbuild/2003#ResolveComReference"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "jsharp"
helpviewer_keywords: 
  - "MSBuild, ResolveCOMReference - задача"
  - "ResolveCOMReference - задача [MSBuild]"
ms.assetid: c9bf5fcf-6453-40ea-b50f-a212adc3e9b5
caps.latest.revision: 26
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 26
---
# Задача ResolveComReference
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Принимает список из одного или нескольких имен библиотек типов или TLB\-файлов и определяет местоположение этих библиотек типов на диске.  
  
## Параметры  
 В следующей таблице описаны параметры задачи `ResolveCOMReference`.  
  
|Параметр|Описание|  
|--------------|--------------|  
|`DelaySign`|Необязательный параметр типа `Boolean`.<br /><br /> Если значение равно `true`, в сборку добавляется открытый ключ.  Если значение равно `false`, сборка полностью подписывается.|  
|`EnvironmentVariables`|Необязательный параметр типа `String[]`.<br /><br /> Массив пар из переменных окружения, разделенных знаками равенства.  Эти переменные должны быть переданы файлам tlbimp.exe и aximp.exe в дополнение к обычному блоку среды \(или частично переопределяя его\).|  
|`ExecuteAsTool`|Необязательный параметр типа `Boolean`.<br /><br /> Если `true`, выполняет tlbimp.exe и aximp.exe из соответствующей требуемой версии .NET Framework из внешнего процесса для создания необходимых сборок\-оболочек.  Этот параметр позволяет настройку для различных версий.|  
|`IncludeVersionInInteropName`|Необязательный параметр типа `Boolean`.<br /><br /> Если `true`, версия библиотеки typelib включается в имя оболочки.  Значение по умолчанию: `false`.|  
|`KeyContainer`|Необязательный параметр типа `String`.<br /><br /> Задает контейнер, хранящий открытый\/закрытый<br /><br /> пара ключей.|  
|`KeyFile`|Необязательный параметр типа `String`.<br /><br /> Задает элемент, содержащий открытый\/закрытый<br /><br /> пара ключей.|  
|`NoClassMembers`|Необязательный параметр типа `Boolean`.|  
|`ResolvedAssemblyReferences`|Необязательный выходной параметр типа <xref:Microsoft.Build.Framework.ITaskItem>`[]`.<br /><br /> Задает разрешенные ссылки на сборки.|  
|`ResolvedFiles`|Необязательный выходной параметр типа <xref:Microsoft.Build.Framework.ITaskItem>`[]`.<br /><br /> Задает полные имена файлов на диске, соответствующие физическому местоположению библиотек типов, которые были указаны во входных данных задачи.|  
|`ResolvedModules`|Необязательный параметр <xref:Microsoft.Build.Framework.ITaskItem>`[]` .|  
|`SdkToolsPath`|Необязательный параметр типа [String](assetId:///String?qualifyHint=False&autoUpgrade=True).<br /><br /> Если для свойства `ExecuteAsTool` задано значение `true`, для данного параметра необходимо задать путь к инструментам SDK для целевой версии платформы.|  
|`StateFile`|Необязательный параметр типа assetId:///String?qualifyHint=False&autoUpgrade=True.<br /><br /> Задает Файл кэша для отметок времени COM\-компонентов.  Если не существует, при каждом запуске все оболочки будут создаваться заново.|  
|`TargetFrameworkVersion`|Необязательный параметр типа assetId:///String?qualifyHint=False&autoUpgrade=True.<br /><br /> Задает требуемую версию .NET Framework для проекта.<br /><br /> Значение по умолчанию: `String.Empty`.  что свидетельствует об отсутствии фильтрации ссылок по требуемой версии .NET Framework.|  
|`TargetProcessorArchitecture`|Необязательный параметр типа assetId:///String?qualifyHint=False&autoUpgrade=True.<br /><br /> Задает Предпочитаемая архитектура процессора.  Передан tlbimp.exe с флагом \/Machine после транзакции.<br /><br /> Значение параметра должно быть членом <xref:Microsoft.Build.Utilities.ProcessorArchitecture>.|  
|`TypeLibFiles`|Необязательный параметр <xref:Microsoft.Build.Framework.ITaskItem>`[]` .<br /><br /> Задает путь к файлу библиотеки типов для COM\-ссылок.  Элементы в этом параметре могут содержать метаданные.  Дополнительные сведения см. далее в разделе "Метаданные элементов TypeLibFiles".|  
|`TypeLibNames`|Необязательный параметр <xref:Microsoft.Build.Framework.ITaskItem>`[]` .<br /><br /> Задает имена библиотек типов, которые требуется разрешить.  Элементы в этом параметре должны содержать определенные метаданные.  Дополнительные сведения см. далее в разделе "Метаданные элементов TypeLibNames".|  
|`WrapperOutputDirectory`|Необязательный параметр типа `String`.<br /><br /> Расположение на диске, в которое помещается сгенерированная сборка взаимодействия.  Если метаданные для этого элемента не заданы, задача использует абсолютный путь к каталогу, где располагается файл проекта.|  
  
## Заметки  
  
## Метаданные элементов TypeLibNames  
 В следующей таблице описываются метаданные элементов, передаваемых параметру `TypeLibNames`.  
  
|Metadata|Описание|  
|--------------|--------------|  
|`GUID`|Обязательные метаданные элемента.<br /><br /> GUID библиотеки типов.  Если эти метаданные для элемента не заданы, происходит сбой выполнения задачи.|  
|`VersionMajor`|Обязательные метаданные элемента.<br /><br /> Основной номер версии библиотеки типов.  Если эти метаданные для элемента не заданы, происходит сбой выполнения задачи.|  
|`VersionMinor`|Обязательные метаданные элемента.<br /><br /> Дополнительный номер версии библиотеки типов.  Если эти метаданные для элемента не заданы, происходит сбой выполнения задачи.|  
|`LocaleIdentifier`|Необязательные метаданные элемента.<br /><br /> Идентификатор языкового стандарта \(LCID\) для библиотеки типов.  Задается в виде 32\-разрядного значения, идентифицирующего предпочтительный естественный язык для пользователя, области или приложения.  Если эти метаданные для элемента не заданы, задача использует заданный по умолчанию идентификатор языкового стандарта, равный "0".|  
|`WrapperTool`|Необязательные метаданные элемента.<br /><br /> Задает инструмент создания оболочек, при помощи которого генерируется оболочка сборки для данной библиотеки типов.  Если эти метаданные для элемента не заданы, задача использует заданный по умолчанию инструмент создания оболочек "tlbimp".  На выбор доступны следующие средства создания оболочек \(регистр символов не имеет значения\):<br /><br /> -   `Primary`: этот инструмент предназначен для случаев, когда требуется использовать уже сгенерированную основную сборку взаимодействия для COM\-компонента.  При использовании данного инструмента создания оболочек не следует задавать выходной каталог оболочки, иначе произойдет сбой выполнения задачи.<br />-   `TLBImp`: этот инструмент предназначен для случаев, когда требуется сгенерировать сборку взаимодействия для COM\-компонента.<br />-   `AXImp`: Используйте это средство программы\-оболочки, когда требуется создать сборку взаимодействия для элемента управления ActiveX.|  
  
## Метаданные элементов TypeLibFiles  
 В следующей таблице описываются метаданные элементов, передаваемых параметру `TypeLibFiles`.  
  
|Metadata|Описание|  
|--------------|--------------|  
|`WrapperTool`|Необязательные метаданные элемента.<br /><br /> Задает инструмент создания оболочек, при помощи которого генерируется оболочка сборки для данной библиотеки типов.  Если эти метаданные для элемента не заданы, задача использует заданный по умолчанию инструмент создания оболочек "tlbimp".  На выбор доступны следующие средства создания оболочек \(регистр символов не имеет значения\):<br /><br /> -   `Primary`: этот инструмент предназначен для случаев, когда требуется использовать уже сгенерированную основную сборку взаимодействия для COM\-компонента.  При использовании данного инструмента создания оболочек не следует задавать выходной каталог оболочки, иначе произойдет сбой выполнения задачи.<br />-   `TLBImp`: этот инструмент предназначен для случаев, когда требуется сгенерировать сборку взаимодействия для COM\-компонента.<br />-   `AXImp`: Используйте это средство программы\-оболочки, когда требуется создать сборку взаимодействия для элемента управления ActiveX.|  
  
> [!NOTE]
>  Чем больше информации вы предоставите для уникальной идентификации библиотеки типов, тем больше вероятности, что задачей будет выбран правильный файл на диске.  
  
## Заметки  
 Помимо параметров, которые перечислены выше, эта задача наследует параметры от класса <xref:Microsoft.Build.Utilities.Task>.  Чтобы получить список этих доп параметров и их описаний, см. [Базовый класс Task](../msbuild/task-base-class.md).  
  
## См. также  
 [Задачи](../msbuild/msbuild-tasks.md)   
 [Справочные сведения о задачах](../msbuild/msbuild-task-reference.md)