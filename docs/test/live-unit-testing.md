---
title: "Live Unit Testing в Visual Studio | Документация Майкрософт"
ms.date: 2017-03-07
ms.suite: 
ms.technology:
- vs-devops-test
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Visual Studio ALM
- Live Unit Testing
ms.assetid: 5b51fb96-94f4-4926-92b9-262156c05b85
author: rpetrusha
ms.author: ronpet
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Human Translation
ms.sourcegitcommit: 47057e9611b824c17077b9127f8d2f8b192d6eb8
ms.openlocfilehash: b699132bf1a31d3ef9dc3ba5af3f99c22890c632
ms.contentlocale: ru-ru
ms.lasthandoff: 05/13/2017

---

# <a name="live-unit-testing-with-visual-studio-2017"></a>Функция Live Unit Testing в Visual Studio 2017

В процессе разработки приложения функция Live Unit Testing автоматически выполняет все затронутые модульные тесты в фоновом режиме и отображает результаты и сведения о покрытии кода в интегрированной среде разработки Visual Studio в режиме реального времени. При изменении кода эта функция предоставляет отчет о том, как внесенные изменения повлияли на имеющиеся и покрывается ли новый добавленный код одним или несколькими имеющимися тестами. За счет этого вы не забудете написать модульные тесты при исправлении ошибок или добавлении новых функций.

> [!NOTE]
> Функция Live Unit Testing доступна в проектах C# и Visual Basic, предназначенных для .NET Framework, в выпуске Visual Studio 2017 Enterprise Edition. Сейчас эта функция недоступна для .NET Core.

## <a name="supported-test-frameworks"></a>Поддерживаемые тестовые платформы

Функция Live Unit Testing работает на трех известных платформах модульного тестирования, приведенных в таблице ниже. В этой таблице также приведены сведения о минимальной поддерживаемой версии адаптеров и платформ. Платформы модульного тестирования доступны на сайте NuGet.org.
 
<table> 
<tr>
   <th>Тестовая платформа</th>
   <th>Минимальная версия адаптера Visual Studio</th>
   <th>Минимальная версия платформы</th>
</tr>
<tr>
   <td>xUnit.net</td>
   <td> xunit.runner.visualstudio версии 2.2.0-beta3-build1187</td>
   <td>xunit 2.0</td> 
</tr>
<tr>
   <td>NUnit</td>
   <td>NUnit3TestAdapter версии 3.5.1</td>  
   <td>NUnit версии 3.5.0</td>
</tr>
<tr>
   <td>MSTest</td>
   <td>MSTest.TestAdapter 1.1.4-preview</td>
   <td>MSTest.TestFramework 1.0.5-preview</td>
</tr>
</table>

Если у вас есть более старые ссылки на адаптер и тестовую платформу из имеющихся проектов, удалите их. (При использовании MSTest обязательно удалите ссылку на `Microsoft.VisualStudio.QualityTools.UnitTestFramework`.) Если функция Live Unit Testing не работает, добавьте новые ссылки. 

В некоторых случаях, чтобы обеспечить работу Live Unit Testing, вам потребуется явным образом восстановить пакеты NuGet, на которые ссылается проект в решении. Это можно сделать, выполнив сборку решения явным образом (в меню верхнего уровня Visual Studio **Пересобрать решение** выберите **Cобрать**) или восстановив пакеты в решении (щелкните решение правой кнопкой мыши и выберите **Восстановить пакеты NuGet**) перед включением Living Unit Testing. 

#    <a name="configuring-live-unit-testing"></a>Настройка Live Unit Testing

Чтобы настроить Live Unit Testing, в меню верхнего уровня Visual Studio выберите **Инструменты**, **Параметры**, а затем в левой области диалогового окна **Параметры** щелкните **Live Unit Testing**. На следующем рисунке показаны параметры конфигурации Live Unit Testing, доступные в этом диалоговом окне.

  ![Изображение](./media/lut-options.png)

С помощью этих параметров вы можете настроить следующее:

- Будет ли функция Live Unit Testing запускаться автоматически после открытия решения.
- Будет ли функция Live Unit Testing приостанавливать выполнение во время сборки и отладки решения или если заряд батареи системы опустится ниже установленного порогового значения.
- Интервал, после которого истекает время ожидания тестового случая. По умолчанию — 30 секунд. 
- Число процессов тестирования, создаваемых Live Unit Testing. 
- Уровень информации, записываемой функцией Live Unit Testing в окно **Выходные данные**. Доступные значения: None (данные журналов не записываются), Error (записываются только сообщения об ошибках), Info (значение по умолчанию, записываются сообщения об ошибках и информационные сообщения) или Verbose (записываются все сведения).

Можно также отобразить подробные выходные данные в окне **Выходные данные**, задав для переменной среды уровня пользователя `VS_UTE_DIAGNOSTICS` значение 1 и перезапустив Visual Studio. 

Чтобы записывать подробные сообщения журнала MSBuild из Live Unit Testing в файл, в качестве значения переменной среды уровня пользователя `LiveUnitTesting_BuildLog` задайте имя файла для хранения журнала.

## <a name="starting-pausing-and-stopping-live-unit-testing"></a>Запуск, приостановка и остановка функции Live Unit Testing

Чтобы включить Live Unit Testing, в меню верхнего уровня Visual Studio выберите **Тестировать**, **Live Unit Testing**, **Запустить**. После включения Live Unit Testing в меню **Live Unit Testing** параметр **Запустить** можно изменить на следующие параметры: **Пауза**, **Остановить** и **Перезапустить**.

Вы можете в любой момент временно или полностью остановить работу этой функции. Это можно сделать, например, если вы выполняете рефакторинг и знаете, что тестирование будет нарушено на некоторое время. В меню Live Unit Testing доступны три следующих параметра:

- **Пауза**. Этот параметр временно приостанавливает работу функции Live Unit Testing. 
    В этом случае визуализация покрытия не отображается в редакторе, но все собранные данные сохраняются. Чтобы возобновить работу этой функции, в меню Live Unit Testing выберите "Продолжить". Функция Live Unit Testing выполнит необходимую работу с учетом всех внесенных во время приостановки изменений и обновит глиф должным образом. 
- **Остановить**. Этот параметр полностью останавливает работу функции Live Unit Testing. Все собранные данные в этом случае удаляются.
- **Перезапустить**. Этот параметр работает по тому же принципу, что и после выбора в меню **Live Unit Testing** параметра **Остановить**, а затем — **Запустить**.

##    <a name="viewing-coverage-visualization-in-the-editor-as-you-type"></a>Просмотр визуализации покрытия в редакторе при вводе

После включения функция Live Unit Testing обновляет каждую строку кода в редакторе Visual Studio, чтобы показать, покрывается ли написанный код модульными тестами и завершились ли эти тесты успешно.  На следующем рисунке показаны строки кода с выполненными тестами и тестами, завершившимися сбоем, а также строки кода, не покрытые тестами. Строки с зеленым символом "✓" прошли все тесты, строки с красным символом "🞩" не прошли один или несколько тестов, а строки с синим символом не покрыты ни одним из тестов.

  ![Изображение](./media/lut-codewindow.png)

Визуализация покрытия Live Unit Testing изменяется сразу же после изменения кода в редакторе. Во время обработки правок визуализация изменяется, указывая, что данные не обновлены. В этом случае под символами успешного выполнения, сбоя и символом непокрытых строк появляется значок круглого таймера.

  ![Изображение](./media/lut-codeupdating.png)
 
## <a name="getting-information-on-successful-or-failed-tests"></a>Получение сведений об удачных и неудачных тестах

Наведя указатель мыши на символ удачного или неудачного выполнения в окне кода, вы можете увидеть, сколько тестов выполнялось в этой строке. Если щелкнуть этот символ, отобразится состояние отдельных тестов, как показано на следующем рисунке.
 
  ![Изображение](./media/lut-failedinfo.png) 

Если навести указатель мыши на непройденный тест в подсказке, она развернется. Здесь вы можете просмотреть дополнительные сведения, как показано на рисунке ниже. Щелкнув непройденный тест в подсказке, вы перейдете непосредственно к нему.

  ![Изображение](./media/lut-failedmsg.png) 

## <a name="diagnosing-and-correcting-test-failures"></a>Диагностика и устранение сбоев тестов

В окне непройденного теста вы можете с легкостью отладить код продукта, внести изменения и продолжить разработку приложения. Так как функция Live Unit Testing выполняется в фоновом режиме, ее не нужно останавливать и перезаписывать во время отладки, внесения правок и продолжения цикла.

Например, сбой теста, показанный на предыдущем рисунке, вызван неверным предположением в методе теста о том, что при передаче в метод [Char.IsLower](xref:System.Char.IsLower(System.Char)) неалфавитных символов возвращается значение `true`. После исправления метода теста все тесты были пройдены. В ходе выполнения мы не приостанавливали и не останавливали работу функции Live Unit Testing.

## <a name="live-unit-testing-and-test-explorer"></a>Live Unit Testing и обозреватель тестов

Как правило, **обозреватель тестов** предоставляет интерфейс, позволяющий выполнять и отлаживать тесты, а также анализировать их результаты. Функция Live Unit Testing интегрируется с **обозревателем тестов**. Когда эта функция отключена или остановлена, **обозреватель тестов** отображает состояние модульных тестов во время последнего запуска тестирования. При изменении исходного кода тесты необходимо выполнить повторно. И напротив, если функция Live Unit Testing включена, состояние модульных тестов в **обозревателе тестов** сразу же обновляется. В этом случае модульные тесты не нужно выполнять явным образом. 

Однако между автоматическим выполнением и обновлением результатов теста с помощью функции Live Unit Testing и явным выполнением тестов в **обозревателе тестов** существуют некоторые различия. Сюда входит следующее.

- Во время выполнения и отладки тестов из окна обозревателя тестов используются обычные двоичные файлы, а при использовании функции Live Unit Testing — инструментированные двоичные файлы. 
- При выполнении тестов функция Live Unit Testing не создает домен приложения, а использует домен по умолчанию. При выполнении тестов в окне **обозревателя тестов** домен приложения создается.
- Функция Live Unit Testing выполняет тесты из разных сборок последовательно. Если вы выполняете несколько тестов в окне **обозревателя тестов**, а затем нажимаете кнопку **Запустить тесты параллельно**, тесты будут выполняться параллельно.

## <a name="including-and-excluding-test-projects-and-test-methods"></a>Добавление и исключение тестовых проектов и методов теста

В решениях с большим количеством тестовых проектов вы можете контролировать, какие проекты и отдельные методы в проекте могут использоваться в функции Live Unit Testing. 

Например, если у вас есть решение с сотнями тестовых проектов, вы можете выбрать только целевой набор, который будет использоваться с этой функцией. Чтобы выбрать отдельные проекты в модульных тестах, запустите Live Unit Testing и выполните следующие действия:

1.    В обозревателе решений щелкните решение правой кнопкой мыши и выберите **Live Tests** (Динамические тесты), **Исключить**, чтобы исключить все решение.
2.    Щелкните правой кнопкой мыши каждый тестовый проект, который вы хотите добавить в тесты, и выберите **Live Tests** (Динамические тесты), **Включить**.
 
Включение и исключение отдельных методов теста выполняется в окне редактора кода. В окне редактора кода щелкните подпись метода теста правой кнопкой мыши и выберите **Live Tests** (Динамические тесты), **Включить** или **Live Tests** (Динамические тесты), **Исключить**. 

Кроме того, вы также можете отменить создание отчетов о покрытии в Live Unit Testing для некоторых методов, классов или структур, применив к ним атрибут [<ExcludeFromCodeCoverage>](https://msdn.microsoft.com/library/system.diagnostics.codeanalysis.excludefromcodecoverageattribute.aspx).

Функция Live Unit Testing сохраняет состояние включения или исключения и запоминает его после закрытия и повторного открытия решения. 

## <a name="see-also"></a>См. также

[Блог о функции Live Unit Testing](https://go.microsoft.com/fwlink/?linkid=842514)   
[Функция Live Unit Testing: вопросы и ответы](live-unit-testing-faq.md)    
[Видео на Channel 9: Live Unit Testing в Visual Studio 2017](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T105)


