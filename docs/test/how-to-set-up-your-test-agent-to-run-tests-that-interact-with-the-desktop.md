---
title: Настройка агента тестирования Visual Studio для выполнения тестов, взаимодействующих с рабочим столом
ms.date: 10/20/2016
ms.topic: conceptual
helpviewer_keywords:
- agents, configuring for interaction with desktop
ms.assetid: 3a94dd07-6d17-402c-ae8f-7947143755c9
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.openlocfilehash: ee961a3f6fa62d46feebdedd10fb62ea8a9ee2a4
ms.sourcegitcommit: 495bba1d8029646653f99ad20df2f80faad8d58b
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 07/31/2018
ms.locfileid: "39381733"
---
# <a name="how-to-set-up-your-test-agent-to-run-tests-that-interact-with-the-desktop"></a>Практическое руководство. Настройка агента тестирования для выполнения тестов, взаимодействующих с рабочим столом

Если требуется выполнить автоматические тесты, которые взаимодействуют с рабочим столом, настройте свой агент для запуска в виде процесса, а не службы. Например, если необходимо выполнить закодированный тест пользовательского интерфейса удаленно с помощью контроллера и агента тестирования или выполнить тест с перенаправлением видеозаписи в процессе его выполнения, следует настроить агент как процесс. Если агенты назначаются ролям в параметрах тестирования с помощью Visual Studio или в среде с помощью Microsoft Test Manager, нужно изменить настройку агентов, назначенных ролям, которые должны взаимодействовать с рабочим столом.

> [!WARNING]
> При использовании Microsoft Test Manager для настройки лабораторной среды этот компонент устанавливает агент тестирования. В **мастере создания среды** можно указать, что необходимо настроить одну из ролей для выполнения закодированных тестов пользовательского интерфейса.

> [!IMPORTANT]
> Компьютер, на котором выполняется агент, для которого требуется запустить закодированные тесты пользовательского интерфейса, не может быть заблокирован и не может иметь активную заставку.

Если выполняемые закодированные тесты пользовательского интерфейса запускают браузер, для запуска используется учетная запись службы агента тестирования. Данная учетная запись службы должна совпадать с учетной записью активного пользователя этого компьютера. При использовании другой учетной записи пользователя браузер не будет запущен.

> [!IMPORTANT]
> Если выполняемые закодированные тесты пользовательского интерфейса запускают браузер как часть определения построения, для запуска используется учетная запись службы агента тестирования. Данная учетная запись службы должна совпадать с учетной записью активного пользователя этого компьютера. При использовании другой учетной записи пользователя браузер не будет запущен.

 Следующая процедура используется для настройки агентов, назначенных роли, выполняющей задачу, которая требует взаимодействия с рабочим столом.

## <a name="to-set-up-an-agent-to-run-as-a-process"></a>Настройка агента для выполнения в качестве процесса

1.  Чтобы настроить установленный агент тестирования для выполнения в качестве процесса, перейдите в меню **Пуск**, **Все программы**, **Microsoft Visual Studio**, **Средство настройки агента тестирования Microsoft Visual Studio**.

     Откроется диалоговое окно **Настройка агента тестирования**.

2.  Чтобы перейти на страницу выбора запуска в качестве процесса, выберите пункт **Параметры запуска**.

     Отобразится страница, на которой можно выбрать запуск агента в качестве процесса или службы.

3.  Выберите **Интерактивный процесс**. Агент тестирования будет запущен как процесс, а не как служба. Нажмите кнопку **Далее**.

     Теперь можно ввести дополнительные данные для пользователя, необходимые для запуска агента в качестве процесса, а также задать прочие параметры.

    > [!NOTE]
    > Пользователь, добавляемый для запуска процесса, также должен быть добавлен как член команды TeamTestAgentService на компьютере контроллера тестирования данного агента. Если этот пользователь является текущим пользователем, при добавлении его в компьютер контроллера тестирования необходимо выйти из системы и перезагрузить компьютер.

4.  Введите имя в поле **Имя пользователя**.

5.  Введите пароль в поле **Пароль**.

     **Важная информация об учетных записях пользователей:**

    -   Пароли NULL для учетных записей пользователей не поддерживаются.

    -   Если необходимо использовать IntelliTrace или адаптер данных и диагностики эмуляции сети, учетная запись должна принадлежать к группе администраторов. Если на компьютере, где выполняется агент тестирования, установлена ОС с учетной записью пользователя с минимальными правами, требуется работать от имени администратора (с повышенными правами). Если имя пользователя агента отсутствует в службе агента, будет предпринята попытка добавить его, для чего требуются соответствующие разрешения на контроллере тестирования.

    -   Пользователь, который пытается использовать контроллер тестирования, должен принадлежать к учетной записи пользователей контроллера тестирования; в противном случае ему не удастся запускать тесты с помощью этого контроллера.

6.  Чтобы убедиться, что компьютер, на котором размещен агент тестирования, может выполнять тесты после перезагрузки, можно настроить компьютер на автоматический вход в качестве пользователя агента тестирования. Выберите параметр **Автоматический вход**. Это позволит сохранить имя пользователя и пароль в зашифрованной форме в реестре.

    > [!NOTE]
    > При подключении к лабораторной среде с помощью удаленного рабочего стола или гостевого подключения могут часто возникать непредвиденные отсоединения. Одна из возможных причин потери соединения заключается в том, что машина может быть настроена на автоматический вход в сеть.

7.  Чтобы убедиться, что заставка выключена, поскольку может мешать автоматическим тестам, взаимодействующим с рабочим столом, выберите **Обеспечить отключение программы-заставки**.

    > [!WARNING]
    > При автоматическом входе или отключении заставки есть вероятность угрозы безопасности. Включая автоматический вход, вы разрешаете другим пользователям включать компьютер и использовать учетную запись автоматического входа. Если отключить заставку, компьютер может не отобразить запрос для ввода учетных данных для разблокирования компьютера. Это позволит любому, находящемуся рядом, получить доступ к компьютеру. Если эти возможности включаются, необходимо предотвратить возможный физический доступ посторонних к компьютеру. Например, расположите компьютеры в закрываемой лаборатории. Снятие флажка **Обеспечить отключение программы-заставки** не приводит к включению заставки.

     Чтобы вернуть запуск агента в качестве службы, воспользуйтесь тем же средством, но выберите **Служба**.

8.  Чтобы применить изменения, выберите **Применить параметры**.

     На экране появляется диалоговое окно **Сводка по конфигурации**, в котором приводятся сведения о состоянии каждого этапа настройки агента тестирования.

9. Чтобы закрыть диалоговое окно **Сводка по конфигурации**, нажмите кнопку **Закрыть**. Затем нажмите кнопку **Закрыть** еще раз, чтобы закрыть **средство настройки агента тестирования**.

    > [!NOTE]
    > Если агент тестирования выполняется как процесс, в области уведомлений отображается соответствующий значок. Он указывает на состояние агента тестирования. С помощью данного средства можно запустить, остановить или перезапустить агент, если он выполняется в качестве процесса. Если агент тестирования еще не запущен, для его запуска в качестве процесса нажмите кнопку **Пуск** и последовательно выберите пункты **Все программы**, **Microsoft Visual Studio** и **Агент тестирования Microsoft Visual Studio**.

     Если контроллер этого агента тестирования зарегистрирован в Team Foundation Server, состояние агента тестирования, выполняющегося в качестве интерактивного процесса, будет отображаться в представлении **Контроллеры** в **центре лабораторий** для Microsoft Test Manager. В списке перед именем этого агента будет стоять звездочка, обозначающая, что агент выполняется в качестве интерактивного процесса. Чтобы перезапустить этот агент тестирования, нужно использовать средство, работающее на компьютере агента тестирования, но не в представлении **Контроллеры**.

## <a name="see-also"></a>См. также

- [Установка и настройка агентов тестирования](../test/lab-management/install-configure-test-agents.md)