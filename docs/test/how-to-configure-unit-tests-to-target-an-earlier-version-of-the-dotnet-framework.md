---
title: Настройка модульных тестов для более ранней версии .NET Framework в Visual Studio
ms.date: 11/04/2016
ms.prod: visual-studio-dev15
ms.technology: vs-ide-test
ms.topic: conceptual
ms.author: gewarren
manager: douge
ms.workload:
- dotnet
author: gewarren
ms.openlocfilehash: 084ac617cb36fdf6f0d8067e82cb0c862665e244
ms.sourcegitcommit: 58052c29fc61c9a1ca55a64a63a7fdcde34668a4
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2018
ms.locfileid: "34750744"
---
# <a name="how-to-configure-unit-tests-to-target-an-earlier-version-of-the-net-framework"></a>Практическое руководство. Настройка модульных тестов для более ранней версии .NET Framework

При создании тестового проекта в Microsoft Visual Studio последняя версия платформы .NET Framework устанавливается в качестве целевой по умолчанию. Кроме того, при обновлении тестовых проектов, созданных в предыдущих версиях Visual Studio, они обновляются до последней версии платформы .NET Framework. Путем изменения свойств проекта можно явно изменить целевую версию .NET Framework для проекта на более раннюю.

Вы можете создавать проекты модульных тестов, предназначенные для определенных версий .NET Framework. Целевой версией может быть версия 3.5 или более поздняя и не может быть версия клиента. Visual Studio включает следующую базовую поддержку для модульных тестов, которые предназначены для определенных версий:

- Можно создать проекты модульных тестов и установить для них определенную версию платформы .NET Framework.

- Можно запускать модульные тесты, которые предназначены для определенной версии платформы .NET Framework, в Visual Studio на локальном компьютере.

- Можно запускать модульные тесты, которые предназначены для определенной версии платформы .NET Framework, с помощью программы MSTest.exe из командной строки.

- Можно выполнять модульные тесты в агенте сборки в рамках сборки.

**Тестирование приложений SharePoint**

Перечисленные выше возможности также позволяют с помощью Visual Studio создавать модульные тесты и тесты интеграции для приложений SharePoint. Дополнительные сведения о способах разработки приложений SharePoint в Visual Studio см. в разделах [Создание решений SharePoint](/office-dev/office-dev/create-sharepoint-solutions), [Построение и отладка решений SharePoint](/office-dev/office-dev/building-and-debugging-sharepoint-solutions) и [Проверка и отладка кода SharePoint](/office-dev/office-dev/verifying-and-debugging-sharepoint-code).

**Ограничения**

При изменении требуемой версии .NET Framework для тестовых проектов на более раннюю версию действуют указанные ниже ограничения.

- В .NET Framework 3.5 настройка для различных версий поддерживается для тестовых проектов, содержащих только модульные тесты. Версия .NET Framework 3.5 не поддерживает какие-либо другие типы тестов, например закодированные тесты пользовательского интерфейса или нагрузочные тесты. Изменение требуемой версии .NET Framework заблокировано для всех типов тестов, кроме модульных тестов.

- Выполнение тестов, которые предназначены для более ранних версий платформы .NET Framework, поддерживается только в адаптере по умолчанию. Оно не поддерживается для адаптера ASP.NET. Приложения ASP.NET, которые должны выполняться в контексте ASP.NET Development Server, должны быть совместимы с текущей версией .NET Framework.

- Поддержка сбора данных отключена при запуске тестов, поддерживающих настройку для различных версий, включая .NET Framework 3.5. Покрытие кода можно обеспечить с помощью программ командной строки Visual Studio.

- Модульные тесты, использующие .NET Framework 3.5, нельзя выполнять на удаленном компьютере.

- Невозможно назначить модульные тесты для более ранних клиентских версий платформы.

## <a name="re-targeting-to-a-specific-version-of-the-net-framework-for-visual-basic-unit-test-projects"></a>Назначение определенной версии платформы .NET Framework для проектов модульных тестов Visual Basic

1.  Создайте проект модульного теста Visual Basic. В меню **Файл** выберите команду **Создать**, а затем пункт **Проект**.

     Откроется диалоговое окно **Новый проект**.

2.  В области **Установленные шаблоны** разверните узел **Visual Basic**. Выберите **Тест**, а затем шаблон **Тестовый проект**.

3.  В текстовом поле **Имя** введите имя тестового проекта Visual Basic и нажмите кнопку **ОК**.

4.  В обозревателе решений выберите пункт **Свойства** в контекстном меню нового тестового проекта Visual Basic.

     Будут показаны свойства тестового проекта Visual Basic.

5.  На вкладке **Компиляция** выберите **Дополнительные параметры компиляции**, как показано на приведенной ниже иллюстрации.

     ![Дополнительные параметры компиляции](../test/media/howtoconfigureunittest35frameworka.png)

6.  С помощью раскрывающегося списка **Заданная исполняющая среда (все конфигурации)** измените требуемую версию на **.NET Framework 3.5** или на более позднюю, как показано в выноске В на рисунке ниже. Указывать версию клиента не следует.

     ![Раскрывающийся список целевых рабочих сред](../test/media/howtoconfigureunitest35frameworkstepb.png)

## <a name="re-targeting-to-a-specific-version-of-the-net-framework-for-visual-c-unit-test-projects"></a>Назначение определенной версии платформы .NET Framework для проектов модульных тестов Visual C#

1.  Создайте проект модульного теста Visual C#. В меню **Файл** выберите команду **Создать**, а затем пункт **Проект**.

     Откроется диалоговое окно **Новый проект**.

2.  В области **Установленные шаблоны** разверните узел **Visual C#**. Выберите **Тест**, а затем шаблон **Тестовый проект**.

3.  В текстовом поле **Имя** введите имя тестового проекта Visual C# и нажмите кнопку **ОК**.

4.  В обозревателе решений выберите пункт **Свойства** в контекстном меню нового тестового проекта Visual C#.

     Будут показаны свойства тестового проекта Visual C#.

5.  На вкладке **Приложение** выберите **Целевая платформа**. В раскрывающемся списке выберите **.NET Framework 3.5** или более поздней версии, как показано на следующем рисунке. Указывать версию клиента не следует.

     ![Раскрывающийся список целевых рабочих сред](../test/media/howtoconfigureunittest35frameworkcsharp.png)

## <a name="re-targeting-to-a-specific-version-of-the-net-framework-for-ccli-unit-test-projects"></a>Перенацеливание на определенную версию платформы .NET Framework для проектов модульного теста C++/CLI.

1.  Создайте проект модульного теста C++. В меню **Файл** последовательно выберите пункты **Создать** и **Проект**.

     Откроется диалоговое окно **Новый проект**.

    > [!WARNING]
    > Для сборки модульных тестов C++/CLI для предыдущей версии платформы .NET Framework для Visual C++ следует использовать соответствующую версию Visual Studio. Например, чтобы задать .NET Framework 3.5 в качестве целевой версии, необходимо установить Visual Studio 2008 и пакет обновления 1 (SP1) для Visual Studio 2008.

2.  В области **Установленные шаблоны** разверните узел **Visual C++**. Выберите **Тест**, а затем шаблон **Тестовый проект**.

3.  В текстовом поле **Имя** введите имя тестового проекта Visual C++ и нажмите кнопку **ОК**.

4.  В обозревателе решений выберите команду **Выгрузить проект** для нового тестового проекта Visual C++.

5.  В обозревателе решений выберите выгруженный тестовый проект Visual C++, а затем **Изменить \<имя проекта>.vcxproj**.

     VCXPROJ-файл откроется в редакторе.

6.  Задайте для `TargetFrameworkVersion` версию 3.5 или более позднюю в группе `PropertyGroup`, обозначенной как `"Globals"`. Указывать версию клиента не следует.

    ```xml
    <PropertyGroup Label="Globals">
        <TargetName>DefaultTest</TargetName>
        <ProjectTypes>{3AC096D0-A1C2-E12C-1390-A8335801FDAB};{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}</ProjectTypes>
        <ProjectGUID>{CE16D77A-E364-4ACD-948B-1EB6218B0EA3}</ProjectGUID>
        <TargetFrameworkVersion>3.5</TargetFrameworkVersion>
        <Keyword>ManagedCProj</Keyword>
        <RootNamespace>CPP_Test</RootNamespace>
      </PropertyGroup>
    ```

7.  Сохраните и закройте VCXPROJ-файл.

8.  В обозревателе решений выберите в контекстном меню нового тестового проекта Visual C++ пункт **Перезагрузить проект**.

## <a name="see-also"></a>См. также

- [Создание решений SharePoint](/office-dev/office-dev/create-sharepoint-solutions)
- [Построение и отладка решений SharePoint](/office-dev/office-dev/building-and-debugging-sharepoint-solutions)
- [Диалоговое окно "Дополнительные параметры компилятора" (Visual Basic)](../ide/reference/advanced-compiler-settings-dialog-box-visual-basic.md)
