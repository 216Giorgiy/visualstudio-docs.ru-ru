---
title: "Анализ качества кода Visual Basic и C# в приложениях Магазина с помощью функций анализа статического кода Visual Studio | Microsoft Docs"
ms.custom: ""
ms.date: "12/16/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-general"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vs.codeanalysis.propertypages.csvb.express"
ms.assetid: cab553fc-19a9-4cbf-858e-8200258ffe50
caps.latest.revision: 14
caps.handback.revision: 14
author: "erickson-doug"
ms.author: "douge"
manager: "douge"
---
# Анализ качества кода Visual Basic и C# в приложениях Магазина с помощью функций анализа статического кода Visual Studio
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

![Применимо к Windows и к Windows Phone](~/docs/debugger/media/windows_and_phone_content.png "windows\_and\_phone\_content")  
  
 Средство анализа кода в Visual Studio Express анализирует код с целью найти общие дефекты и нарушения рекомендаций программирования.  Предупреждения, возникающие в ходе анализа кода, отличаются от ошибок и предупреждений компилятора, потому что средство анализа кода выполняет поиск конкретных шаблонов кода, которые являются допустимыми, но, тем не менее, могут вызвать проблемы при использовании кода вами или другими специалистами.  Анализ кода позволяет находить дефекты в коде, которые невозможно обнаружить в процессе тестирования.  Регулярный запуск средства анализа кода в процессе разработки позволяет создать приложение более высокого качества.  
  
> [!NOTE]
>  В Visual Studio Ultimate, Visual Studio Premium и Visual Studio Professional можно пользоваться всеми функциональными возможностями анализа кода.  См. раздел [Анализ качества приложений с помощью средств анализа кода](http://msdn.microsoft.com/library/dd264897.aspx) в библиотеке MSDN.  
  
## Содержание раздела  
 Рассматриваются следующие вопросы:  
  
 [Запуск анализа кода](../test/analyze-visual-basic-and-csharp-code-quality-in-store-apps-using-visual-studio-static-code-analysis.md#BKMK_Run)  
  
 [Анализ и разрешение предупреждений анализа кода](../test/analyze-visual-basic-and-csharp-code-quality-in-store-apps-using-visual-studio-static-code-analysis.md#BKMK_Analyze)  
  
 [Подавление предупреждений анализа кода](../test/analyze-visual-basic-and-csharp-code-quality-in-store-apps-using-visual-studio-static-code-analysis.md#BKMK_Suppress)  
  
 [Поиск и фильтрация результатов анализа кода](../test/analyze-visual-basic-and-csharp-code-quality-in-store-apps-using-visual-studio-static-code-analysis.md#BKMK_Search)  
  
 [Предупреждения анализа кода Visual Basic и C#](../test/analyze-visual-basic-and-csharp-code-quality-in-store-apps-using-visual-studio-static-code-analysis.md#BKMK_Warnings)  
  
##  <a name="BKMK_Run"></a> Запуск анализа кода  
 Чтобы запустить анализ кода для решения Visual Studio, выполните следующие действия:  
  
-   В меню **Построение** выберите **Выполнить анализ кода в решении**.  
  
 Чтобы анализ кода автоматически запускался при каждом построении проекта, выполните следующие действия:  
  
1.  В обозревателе решений щелкните правой кнопкой мыши имя проекта и выберите **Свойства**.  
  
2.  На странице свойств проекта выберите **Анализ кода** и установите флажок **Включить анализ кода в построении \(определяет константу CODEANALYSIS\)**.  
  
 Решение компилируется, и запускается анализ кода.  Результаты выводятся в окне "Анализ кода".  
  
 ![Окно анализа кода](../test/media/ca_managed_collapsed.png "CA\_Managed\_Collapsed")  
  
##  <a name="BKMK_Analyze"></a> Анализ и разрешение предупреждений анализа кода  
 Чтобы проанализировать конкретное предупреждение, щелкните заголовок предупреждения в окне "Анализ кода".  Предупреждение разворачивается, позволяя просмотреть подробные сведения о проблеме.  
  
 ![Расширенное предупреждение анализа кода](../test/media/ca_managed_callouts.png "CA\_Managed\_Callouts")  
  
 При разворачивании предупреждения строка кода, которая вызвала предупреждение, выделяется в редакторе кода Visual Studio.  
  
 ![Выделение текста при анализе кода](~/docs/test/media/ca_managed_sourceline.png "CA\_Managed\_SourceLine")  
  
 Поняв, в чем заключается проблема, можно разрешить ее в коде.  После этого необходимо снова запустить анализ кода, чтобы убедиться, что предупреждение больше не отображается в окне "Анализ кода", и что исправление не привело к появлению новых предупреждений.  
  
> [!TIP]
>  Повторно запустить анализ кода можно из окна "Анализ кода".  Нажмите кнопку **Анализировать** и выберите область анализа.  Можно повторно запустить анализ для всего решения или для выбранного проекта.  
  
##  <a name="BKMK_Suppress"></a> Подавление предупреждений анализа кода  
 В некоторых случаях разработчик может принять решение не разрешать предупреждение анализа кода.  Возможно, разрешение предупреждения требует слишком значительного переписывания кода в сравнении с вероятностью того, что проблема проявит себя в какой\-либо реальной его реализации.  Или, например, разработчик может посчитать, что используемая в предупреждении логика анализа не соответствует данному контексту.  Можно подавить отдельные предупреждения, чтобы они больше не отображались в окне "Анализа кода".  
  
 Чтобы подавить предупреждение, выполните следующие действия.  
  
1.  Если подробные сведения не отображаются, щелкните заголовок предупреждения, чтобы развернуть его.  
  
2.  Выберите ссылку **Действия** внизу предупреждения.  
  
3.  Выберите **Подавить сообщение** и щелкните **В исходном** или **В файле блокируемых предупреждений**.  
  
    -   При выборе варианта **В исходном** атрибут `SuppressMessage` вставляется в файл исходного кода над методом, который создает предупреждение.  Это облегчает поиск подавления.  
  
    -   При выборе варианта **В файле блокируемых предупреждений** атрибут `SuppressMessage` добавляется в файл **GlobalSuppressions.cs** проекта.  Это упрощает управление подавлениями.  Обратите внимание, что атрибут `SuppressMessage`, добавленный в файл **GlobalSuppression.cs**, также направлен на метод, который создает предупреждение.  Он не подавляет предупреждение глобально.  
  
     Решение, где подавлять предупреждение — в файле исходного кода или в файле блокируемых предупреждений — зависит от стиля написания кода и потребностей разработчика.  
  
##  <a name="BKMK_Search"></a> Поиск и фильтрация результатов анализа кода  
 Можно выполнять поиск в длинных списках предупреждений, а также фильтровать предупреждения в решениях, состоящих из нескольких проектов.  
  
 ![Поиск и фильтрация в окне анализа кода](../test/media/ca_searchfilter.png "CA\_SearchFilter")  
  
 В [!INCLUDE[vs_dev11_expwin_long](../misc/includes/vs_dev11_expwin_long_md.md)] все предупреждения анализа кода имеют степень серьезности "Предупреждение".  
  
##  <a name="BKMK_Warnings"></a> Предупреждения анализа кода Visual Basic и C\#  
 Анализ кода вызывает следующие предупреждения:  
  
 [CA1001: типы, которым принадлежат высвобождаемые поля, должны быть высвобождаемыми](http://msdn.microsoft.com/library/ms182172.aspx)  
  
 [CA1821: удаление пустых методов завершения](http://msdn.microsoft.com/library/bb264476.aspx)  
  
 [CA2213: следует высвобождать высвобождаемые поля](http://msdn.microsoft.com/library/ms182328.aspx)  
  
 [CA2229: реализация конструкторов сериализации](http://msdn.microsoft.com/library/ms182343.aspx)  
  
 [CA2231: перегрузка оператора равенства на переопределяющем типе ValueType.Equals](http://msdn.microsoft.com/library/ms182359.aspx)