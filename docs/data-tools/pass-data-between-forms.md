---
title: "Пошаговое руководство. Передача данных между формами Windows Forms | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "данные [Visual Studio], передача данных между формами"
  - "формы, передача данных между"
  - "пошаговые руководства [Visual Studio], данные"
  - "пошаговые руководства [Windows Forms], данные"
  - "Windows Forms, пошаговые руководства"
ms.assetid: 78bf038b-9296-4fbf-b0e8-d881d1aff0df
caps.latest.revision: 14
caps.handback.revision: 11
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Пошаговое руководство. Передача данных между формами Windows Forms
Это пошаговое руководство содержит инструкции по передаче данных из одной формы в другую.  Использование таблиц заказов и клиентов из одной формы "Борей" позволяет пользователям выбрать клиента, а на второй форме отображаются заказы выбранного клиента.  Это пошаговое руководство описывает создание метода на одной форме, получающего данные из первой формы.  
  
> [!NOTE]
>  Здесь демонстрируется всего один способ передачи данных между формами.  Существуют и другие способы передать данные в форму, включая следующие: вы можете создать второй конструктор для приема данных или создать общее свойство, для которого можно задать данные из первой формы.  
  
 В данном пошаговом руководстве представлены следующие задачи.  
  
-   Создание нового проекта **Приложение Windows**.  
  
-   Создание и настройка набора данных с помощью [мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png).  
  
-   Выбор элемента управления, создаваемого на форме при перетаскивании элементов из окна **Источники данных**.  Для получения дополнительной информации см. [Задание поведения, при котором элемент управления создается при перетаскивании из окна "Источники данных"](../data-tools/set-the-control-to-be-created-when-dragging-from-the-data-sources-window.md).  
  
-   Создание элемента управления с привязкой к данным с помощью перетаскивания элементов из окна **Источники данных** на форму.  
  
-   Создание второй формы с сеткой для отображения данных.  
  
-   Создание запроса адаптера таблицы для получения заказов определенного клиента.  
  
-   Передача данных между формами.  
  
## Обязательные компоненты  
 Для выполнения данного пошагового руководства требуется:  
  
-   Доступ к примеру базы данных "Борей".  Для получения дополнительной информации см. [Практическое руководство. Установка образцов баз данных](../data-tools/how-to-install-sample-databases.md).  
  
## Создание приложения Windows  
  
#### Порядок создания нового проекта Windows  
  
1.  Перейдите в меню **Файл** и создайте новый проект.  
  
2.  Присвойте проекту имя `PassingDataBetweenForms`.  
  
3.  Выберите **Приложение Windows Forms** и нажмите кнопку **ОК**.  Для получения дополнительной информации см. [Клиентские приложения](../Topic/Developing%20Client%20Applications%20with%20the%20.NET%20Framework.md).  
  
     Создается проект **PassingDataBetweenForms**, который добавляется в **Обозреватель решений**.  
  
## Создание источника данных  
  
#### Создание источника данных  
  
1.  В меню **Данные** выберите команду **Показать источники данных**.  
  
2.  В окне **Источники данных** выберите **Добавить новый источник данных**, чтобы запустить **Мастер настройки источника данных**.  
  
3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.  
  
4.  На странице **Выбор модели базы данных** выберите **Набор данных** и нажмите кнопку **Далее**.  
  
5.  На странице **Выбор подключения к базе данных** выполните одно из следующих действий.  
  
    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.  
  
         \-или\-  
  
    -   Выберите **Новое подключение** для открытия диалогового окна **Добавить\/изменить подключение**.  
  
6.  Если базе данных требуется пароль и выбран параметр для включения конфиденциальных данных, выберите параметр и щелкните **Далее**.  
  
7.  На странице **Сохранение подключения в файле конфигурации приложения** нажмите кнопку **Далее**.  
  
8.  Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.  
  
9. Выберите таблицы **Customers** и **Orders** и нажмите **Готово**.  
  
     **NorthwindDataSet** добавляется в проект, и таблицы **Клиенты** и "Заказы" отображаются в окне **Источники данных**.  
  
## Создание первой формы \(Form1\)  
 Вы можете создать сетку с привязкой к данным \(элемент управления <xref:System.Windows.Forms.DataGridView>\) с помощью перетаскивания узла **Клиенты** из окна **Источники данных** на форму.  
  
#### Создание сетки с привязкой к данным на форме  
  
-   Перетащите главный узел **Клиенты** из окна **Источники данных** на **Form1**.  
  
     На форме **Form1** появляется <xref:System.Windows.Forms.DataGridView> и панель инструментов \(<xref:System.Windows.Forms.BindingNavigator>\) для перемещения по записям.  В области компонентов появляется [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), [CustomersTableAdapter](../data-tools/tableadapter-overview.md), <xref:System.Windows.Forms.BindingSource> и <xref:System.Windows.Forms.BindingNavigator>.  
  
## Создание второй формы \(Form2\)  
  
#### Порядок создания второй формы, предназначенной для передачи данных  
  
1.  В меню **Проект** выберите пункт **Добавить форму Windows**.  
  
2.  Оставьте имя по умолчанию **Form2** и щелкните **Добавить**.  
  
3.  Перетащите главный узел **Заказы** из окна **Источники данных** на **Form2**.  
  
     На форме **Form2** появляется <xref:System.Windows.Forms.DataGridView> и панель инструментов \(<xref:System.Windows.Forms.BindingNavigator>\) для перемещения по записям.  В области компонентов появляется [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), [CustomersTableAdapter](../data-tools/tableadapter-overview.md), <xref:System.Windows.Forms.BindingSource> и <xref:System.Windows.Forms.BindingNavigator>.  
  
4.  Удалите **OrdersBindingNavigator** из области компонентов.  
  
     **OrdersBindingNavigator** исчезает из **Form2**.  
  
## Добавление запроса адаптера таблицы на форму Form2 для загрузки заказов выбранного клиента на форме Form1  
  
#### Порядок создания запроса адаптера таблицы  
  
1.  Дважды щелкните файл **NorthwindDataSet.xsd** в **Обозревателе решений**.  
  
2.  Щелкните правой кнопкой мыши элемент **OrdersTableAdapter** и выберите пункт **Добавить запрос**.  
  
3.  Оставьте параметр по умолчанию **Использовать инструкции SQL** и нажмите кнопку **Далее**.  
  
4.  Оставьте параметр по умолчанию **Инструкция SELECT, возвращающая строки** и нажмите кнопку **Далее**.  
  
5.  Добавьте в запрос предложение WHERE, чтобы возвратить `Orders` на основании `CustomerID`.  Запрос должен выглядеть примерно следующим образом:  
  
    ```  
    SELECT OrderID, CustomerID, EmployeeID, OrderDate, RequiredDate, ShippedDate, ShipVia, Freight, ShipName, ShipAddress, ShipCity, ShipRegion, ShipPostalCode, ShipCountry  
    FROM Orders   
    WHERE CustomerID = @CustomerID  
    ```  
  
    > [!NOTE]
    >  Проверьте правильность синтаксиса параметров для своей базы данных.  Например, в Microsoft Access предложение WHERE должно выглядеть следующим образом: `WHERE CustomerID = ?`.  
  
6.  Нажмите кнопку **Далее**.  
  
7.  Для параметра **Имя метода Заполнить таблицу данных \(DataTable\)** введите `FillByCustomerID`.  
  
8.  Снимите флажок **Вернуть таблицу данных \(DataTable\)** и нажмите кнопку **Далее**.  
  
9. Нажмите кнопку **Готово**.  
  
## Создание метода на форме Form2 для передачи данных  
  
#### Порядок создания метода, предназначенного для передачи данных  
  
1.  Щелкните правой кнопкой мыши **Form2** и выберите пункт **Просмотреть код**, чтобы открыть **Form2** в **Редакторе кода**.  
  
2.  Добавьте следующий код в **Form2** после метода `Form2_Load`:  
  
     [!code-vb[VbRaddataDisplaying#1](../data-tools/codesnippet/VisualBasic/pass-data-between-forms_1.vb)]
     [!code-cs[VbRaddataDisplaying#1](../data-tools/codesnippet/CSharp/pass-data-between-forms_1.cs)]  
  
## Создание метода на форме Form1 для передачи данных и отображения формы Form2  
  
#### Порядок создания метода, предназначенного для передачи данных в Form2  
  
1.  В **Form1** щелкните правой кнопкой мыши сетку данных клиентов и выберите пункт **Свойства**.  
  
2.  В окне **Свойства** выберите **События**.  
  
3.  Дважды щелкните событие **CellDoubleClick**.  
  
     Откроется окно редактора кода.  
  
4.  Обновите определение метода в соответствии со следующим примером:  
  
     [!code-cs[VbRaddataDisplaying#2](../data-tools/codesnippet/CSharp/pass-data-between-forms_2.cs)]
     [!code-vb[VbRaddataDisplaying#2](../data-tools/codesnippet/VisualBasic/pass-data-between-forms_2.vb)]  
  
## Запуск приложения  
  
#### Запуск приложения  
  
-   Нажмите клавишу F5 для запуска приложения.  
  
-   Дважды щелкните запись клиента в форме **Form1**, чтобы открыть **Form2** с заказами этого клиента.  
  
## Следующие действия  
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после передачи данных между формами.  Ниже приводится перечень рекомендаций, позволяющих улучшить полученный результат.  
  
-   Изменение набора данных для добавления или удаления объектов базы данных.  Для получения дополнительной информации см. [Практическое руководство. Редактирование набора данных](../Topic/How%20to:%20Edit%20a%20Dataset.md).  
  
-   Добавление функциональности для сохранения данных в базу данных.  Для получения дополнительной информации см. [Практическое руководство. Сохранение изменений набора данных в базе данных](../Topic/How%20to:%20Save%20Dataset%20Changes%20to%20a%20Database.md).  
  
## См. также  
 [Пошаговые руководства работы с данными](../Topic/Data%20Walkthroughs.md)   
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)   
 [Общие сведения об источниках данных](../data-tools/add-new-data-sources.md)   
 [Общие сведения об адаптере таблиц](../data-tools/tableadapter-overview.md)   
 [Подключение к данным в Visual Studio](../data-tools/connecting-to-data-in-visual-studio.md)   
 [Подготовка приложения к получению данных](../Topic/Preparing%20Your%20Application%20to%20Receive%20Data.md)   
 [Выборка данных в приложение](../data-tools/fetching-data-into-your-application.md)   
 [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md)   
 [Редактирование данных в приложении](../data-tools/editing-data-in-your-application.md)   
 [Проверка данных](../Topic/Validating%20Data.md)   
 [Сохранение данных](../data-tools/saving-data.md)