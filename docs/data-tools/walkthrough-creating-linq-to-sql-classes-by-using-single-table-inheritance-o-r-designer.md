---
title: 'Пошаговое руководство: Создание классов LINQ to SQL, используя наследование одиночной таблицы (конструктор O-R)'
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
ms.assetid: 63bc6328-e0df-4655-9ce3-5ff74dbf69a4
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-data-tools
ms.workload:
- data-storage
ms.openlocfilehash: 8a21a84a9b8e96d771478415eae1a874d015572f
ms.sourcegitcommit: 58052c29fc61c9a1ca55a64a63a7fdcde34668a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2018
ms.locfileid: "34746290"
---
# <a name="walkthrough-creating-linq-to-sql-classes-by-using-single-table-inheritance-or-designer"></a>Пошаговое руководство. Создание классов LINQ to SQL с использованием наследования с одной таблицей (реляционный конструктор объектов)
[Средства LINQ to SQL в Visual Studio](../data-tools/linq-to-sql-tools-in-visual-studio2.md) поддерживает наследование одиночной таблицы, как именно она обычно осуществляется в реляционных системах. В этом пошаговом руководстве расширяется универсальным шагам, описанным в [как: Настройка наследования с помощью реляционного конструктора объектов](../data-tools/how-to-configure-inheritance-by-using-the-o-r-designer.md) раздела и предоставляет некоторые реальные данные, чтобы продемонстрировать наследование в [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)].

 В этом пошаговом руководстве вы будете выполнять следующие задачи:

-   Создайте таблицу базы данных и добавьте в нее данные.

-   Создайте приложение Windows Forms.

-   Добавление файла [!INCLUDE[vbtecdlinq](../data-tools/includes/vbtecdlinq_md.md)] в проект.

-   Создайте новые классы сущностей.

-   Конфигурируйте классы сущностей на использование наследования.

-   Выполните запрос унаследованного класса.

-   Отобразите данные на Windows Forms

## <a name="create-a-table-to-inherit-from"></a>Создайте таблицу в Наследовать из
 Чтобы увидеть, как работает наследование, надо создать небольшую таблицу Person, использовать ее как базовый класс, и затем создать объект Employee, который наследует из него.

#### <a name="to-create-a-base-table-to-demonstrate-inheritance"></a>Для создания базовой таблицы, чтобы продемонстрировать наследование

1.  В **обозревателя серверов**/**обозреватель баз данных**, щелкните правой кнопкой мыши **таблиц** и выберите команду **добавить новую таблицу**.

    > [!NOTE]
    >  Может быть использована база данных Northwind или любая другая, к которой можно добавить таблицу.

2.  В Конструкторе таблиц добавьте в таблицу следующие столбцы:

    |Имя столбца|Тип данных|Разрешить значения null|
    |-----------------|---------------|-----------------|
    |**ID**|**int**|**False**|
    |**Type**|**int**|**True**|
    |**FirstName**|**Nvarchar(200)**|**False**|
    |**Фамилия**|**Nvarchar(200)**|**False**|
    |**Диспетчер**|**int**|**True**|

3.  Задайте столбец ID в качестве первичного ключа

4.  Сохраните таблицу и назовите его **лицо**.

## <a name="add-data-to-the-table"></a>Добавление данных в таблицу
 Чтобы вы могли убедиться, что наследование конфигурировано правильно, в таблицу нужно ввести некоторые данные для каждого класса в наследовании единственной таблицы.

#### <a name="to-add-data-to-the-table"></a>Для добавления данных в таблицу

1.  Откройте таблицу в окне просмотра данных. (Щелкните правой кнопкой мыши **лицо** в таблицу **обозревателя серверов**/**обозреватель баз данных** и нажмите кнопку **Показать таблицу данных**.)

2.  Скопируйте в таблицу следующие данные. (Можно скопировать его и вставьте его в таблицу, выбрав строку целиком на панели результатов.)

    ||||||
    |-|-|-|-|-|
    |**ID**|**Type**|**FirstName**|**Фамилия**|**Диспетчер**|
    |**1**|**1**|**Anne**|**Wallace**|**NULL**|
    |**2**|**1**|**Карлос**|**Grilo**|**NULL**|
    |**3**|**1**|**Yael**|**Peled**|**NULL**|
    |**4**|**2**|**Gatis**|**Ozolins**|**1**|
    |**5**|**2**|**Андреаса**|**Hauser**|**1**|
    |**6**|**2**|**Tiffany**|**Phuvasate**|**1**|
    |**7**|**2**|**Алексей**|**Орехов**|**2**|
    |**8**|**2**|**Michał**|**Poliszkiewicz**|**2**|
    |**9**|**2**|**Конец**|**Сотрудников**|**2**|
    |**10**|**2**|**Fabricio**|**Noriega**|**3**|
    |**11**|**2**|**Анна**|**Мартин**|**3**|
    |**12**|**2**|**Алексей**|**Kwok**|**3**|

## <a name="create-a-new-project"></a>Создание нового проекта
 Теперь, когда таблица создана, создайте новый проект, чтобы продемонстрировать настройку наследования.

#### <a name="to-create-the-new-windows-forms-application"></a>Чтобы создать новое приложение Windows Forms

1. В Visual Studio на **файл** последовательно выберите пункты **New**, **проекта...** .

2. Разверните **Visual C#** или **Visual Basic** на левой панели, затем выберите **Windows Desktop**.

3. В средней области выберите **приложение Windows Forms** тип проекта.

4. Назовите проект **InheritanceWalkthrough**, а затем выберите **ОК**.

     **InheritanceWalkthrough** создается проект и добавить **обозревателе решений**.

## <a name="add-a-linq-to-sql-classes-file-to-the-project"></a>Добавление в проект файла LINQ to SQL Classes

#### <a name="to-add-a-linq-to-sql-file-to-the-project"></a>Для добавления файла LINQ to SQL в проект

1.  В меню **Проект** выберите пункт **Добавить новый элемент**.

2.  Нажмите кнопку **LINQ to SQL Classes** шаблона и нажмите кнопку **добавить**.

     DBML-файл добавляется в проект, и [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)] открывается.

## <a name="create-the-inheritance-by-using-the-or-designer"></a>Создание наследования с использованием реляционного конструктора объектов
 Сконфигурируйте наследование путем перетаскивания **наследования** объекта из **элементов** на поверхность разработки.

#### <a name="to-create-the-inheritance"></a>Чтобы создать наследование, выполните следующие действия

1.  В **обозревателя серверов**/**обозреватель баз данных**, перейдите к **лицо** таблицы, созданной ранее.

2.  Перетащите **лицо** таблицы [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)] область конструктора.

3.  Перетащите второй **лицо** таблицы [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)] и измените ее имя на **сотрудника**.

4.  Удалить **Manager** свойство из **лицо** объекта.

5.  Удалить **тип**, **идентификатор**, **FirstName**, и **LastName** свойства из **сотрудника** объекта. (Другими словами, удалите все свойства, за исключением **Manager**.)

6.  Из **реляционный конструктор объектов** вкладке **элементов**, создайте **наследования** между **лицо** и  **Сотрудник** объектов. Чтобы сделать это, нажмите кнопку **наследования** элемент **элементов** и отпустите кнопку мыши. Далее щелкните **сотрудника** объекта и затем **лицо** объекта в [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)]. Стрелка на линии наследования будет указывать на **лицо** объекта.

7.  Нажмите кнопку **наследования** строки в области конструктора.

8.  Задать **Свойство дискриминатора** свойства **типа**.

9. Задать **производного класса дискриминатора** свойства **2**.

10. Задать **значением дискриминатора для базового класса** свойства **1**.

11. Задать **наследование по умолчанию** свойства **лицо**.

12. Выполните построение проекта.

## <a name="query-the-inherited-class-and-display-the-data-on-the-form"></a>Выполнение запроса наследуемого класса и отображение данных на форме
 Теперь добавьте некоторый код в форму, которая делает запрос на определенный класс в модели объекта.

#### <a name="to-create-a-linq-query-and-display-the-results-on-the-form"></a>Для создания запроса LINQ и отображения результатов на форме

1.  Перетащите **ListBox** на форму Form1.

2.  Дважды щелкните форму, чтобы создать обработчик событий `Form1_Load`.

3.  Добавьте следующий код в обработчик событий `Form1_Load`.

    ```vb
    Dim dc As New DataClasses1DataContext
    Dim results = From emp In dc.Persons _
        Where TypeOf emp Is Employee _
        Select emp

    For Each Emp As Employee In results
        ListBox1.Items.Add(Emp.LastName)
    Next
    ```

    ```csharp
    NorthwindDataContext dc = new DataClasses1DataContext();
    var results = from emp in dc.Persons
                  where emp is Employee
                  select emp;

    foreach(Employee Emp in results)
    {
        listBox1.Items.Add(Emp.LastName)
    }
    ```

## <a name="test-the-application"></a>Выполните тестирование приложения
 Запустите приложение и убедитесь, что записи, отображенные в списке представляют всех работников (записи, которые имеют значение 2 в столбце Type).

#### <a name="to-test-the-application"></a>Тестирование приложения

1.  Нажмите клавишу F5.

2.  Убедитесь, что отображаются только записи со значением 2 в их столбце Type.

3.  Закройте форму. (На **отладки** меню, нажмите кнопку **остановить отладку**.)

## <a name="see-also"></a>См. также

- [Средства LINQ to SQL в Visual Studio](../data-tools/linq-to-sql-tools-in-visual-studio2.md)
- [Пошаговое руководство: Создание классов LINQ to SQL (конструктор O-R)](how-to-create-linq-to-sql-classes-mapped-to-tables-and-views-o-r-designer.md)
- [Как: назначение хранимых процедур для выполнения обновления, вставки и удаления (конструктор O/R)](../data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer.md)
- [LINQ to SQL](/dotnet/framework/data/adonet/sql/linq/index)
- [Практическое руководство. Создание модели объектов в Visual Basic или C#](/dotnet/framework/data/adonet/sql/linq/how-to-generate-the-object-model-in-visual-basic-or-csharp)