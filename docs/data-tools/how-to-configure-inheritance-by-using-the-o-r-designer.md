---
title: "Как настроить наследование с использованием реляционного конструктора объектов | Microsoft Docs"
ms.custom: ""
ms.date: "12/14/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: e594af12-e777-434a-bc08-7dd2dac84cdc
caps.latest.revision: 4
caps.handback.revision: 2
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Как настроить наследование с использованием реляционного конструктора объектов
[!INCLUDE[vs_ordesigner_long](../data-tools/includes/vs_ordesigner_long_md.md)] \([!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)]\) поддерживает концепцию наследования одиночных таблиц, так как именно она обычно реализуется в реляционных системах. При наследовании одиночных таблиц имеется одна таблица базы данных, которая содержит поля как для родительских данных, так и для дочерних.Для реляционных данных столбец дискриминатора содержит значение, которое определяет, какому классу принадлежит каждая запись.  
  
 Например, рассмотрим таблицу Persons, которая содержит данные всех сотрудников компании.Некоторые лица являются служащими, а некоторые — менеджерами.Таблица Persons содержит столбец с именем `EmployeeType`, который имеет значение 1 для менеджеров и значение 2 для служащих; это — столбец дискриминатора.В этом случае можно создать подкласс служащих и заполнить класс только записями, которые имеют в столбце `EmployeeType` значение 2.Кроме того, можно удалить из каждого класса неприменимые столбцы.  
  
 Создание модели объекта, который использует наследование \(и соответствует реляционным данным\), может быть несколько запутанным.В следующей процедуре описываются действия, необходимые для настройки наследования при помощи реляционного конструктора объектов.Выполнение этих универсальных действий без обращения к существующей таблице и столбцам может оказаться затруднительным, поэтому предоставляется пошаговое руководство, которое использует реальные данные.Подробные пошаговые инструкции по настройке наследования с помощью  [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)] см. в разделе [Пошаговое руководство. Создание классов LINQ to SQL с помощью однотабличного наследования \(реляционный конструктор объектов\)](../data-tools/walkthrough-creating-linq-to-sql-classes-by-using-single-table-inheritance-o-r-designer.md).  
  
### Чтобы создать наследуемые классы данных  
  
1.  Откройте [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)] путем добавления элемента **LINQ to SQL Classes** в существующий проект на Visual Basic или C\#.  
  
2.  Перетащите таблицу, которую вы хотите использовать как базовый класс, на [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)].  
  
3.  Перетащите второй экземпляр таблицы на [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)] и переименуйте ее.Это производный класс или подкласс.  
  
4.  Щелкните по **Наследование** на вкладке **Реляционный конструктор объектовПанели элементов**, после чего щелкните по подклассу \(по таблице, которую вы переименовали\) и подключите его к базовому классу.  
  
    > [!NOTE]
    >  Щелкните элемент **Наследование** в **области элементов** и, отпустив кнопку мыши, щелкните второй экземпляр класса, созданный на шаге 3, а затем щелкните первый класс, созданный на шаге 2.Стрелка на линии наследования укажет на первый класс.  
  
5.  Удалите в каждом классе свойства объектов, которые не должны выводиться и не используются для ассоциаций.Если попробовать удалить свойства объекта, используемые для ассоциаций, будет выдано сообщение об ошибке: [Нельзя удалить свойство \<имя свойства\>, поскольку оно участвует в ассоциации \<имя ассоциации\>](../data-tools/the-property-property-name-cannot-be-deleted-because-it-is-participating-in-the-association-association-name.md).  
  
    > [!NOTE]
    >  Поскольку производный класс наследует свойства, определенные в своем базовом классе, нельзя определить в каждом классе одинаковые столбцы.\(Столбцы внедряются как свойства.\) Можно разрешить создание столбцов в производном классе, устанавливая Модификатор наследования на свойство в базовом классе.Дополнительные сведения см. в разделе [NOT IN BUILD: Overriding Properties and Methods](http://msdn.microsoft.com/ru-ru/2167e8f5-1225-4b13-9ebd-02591ba90213).  
  
6.  Выберите линию наследования в конструкторе [!INCLUDE[vs_ordesigner_short](../data-tools/includes/vs_ordesigner_short_md.md)].  
  
7.  В окне **Свойства** задайте в **Свойстве дискриминатора** имя столбца, который используется для различения записей в классах.  
  
8.  Задайте в свойстве **Значение производного класса дискриминатора** значение в базе данных, которое обозначает запись в качестве наследуемого типа.\(Это значение хранится в столбце дискриминатора и используется для обозначения наследуемого класса.\)  
  
9. Задайте в свойстве **Дискриминатор базового класса** значение, которое обозначает запись в качестве базового типа.\(Это значение хранится в столбце дискриминатора и используется для обозначения базового класса.\)  
  
10. Дополнительно можно установить свойство **Наследование по умолчанию**, чтобы обозначить тип в иерархии наследования, который используется при загрузке строк, которые не соответствуют какому\-либо определенному коду наследования.Другими словами, если запись имеет в столбце дискриминатора значение, которое не соответствует значению ни в свойстве **Значение производного класса дискриминатора**, ни в свойстве **Дискриминатор базового класса**, то запись будет загружена в тип, обозначенный как **Наследование по умолчанию**.  
  
## См. также  
 [Общие сведения о реляционном конструкторе объектов](../Topic/LINQ%20to%20SQL%20Tools%20in%20Visual%20Studio1.md)   
 [Пошаговое руководство. Создание классов LINQ to SQL \(реляционный конструктор объектов\)](../Topic/Walkthrough:%20Creating%20LINQ%20to%20SQL%20Classes%20\(O-R%20Designer\).md)   
 [PAVE What's New for Data Application Development in Visual Studio 2012](http://msdn.microsoft.com/ru-ru/3d50d68f-5f44-4915-842f-6d42fce793f1)   
 [Доступ к данным в Visual Studio](../data-tools/accessing-data-in-visual-studio.md)   
 [LINQ to SQL](../Topic/LINQ%20to%20SQL.md)   
 [Пошаговое руководство. Создание классов LINQ to SQL с помощью однотабличного наследования \(реляционный конструктор объектов\)](../data-tools/walkthrough-creating-linq-to-sql-classes-by-using-single-table-inheritance-o-r-designer.md)   
 [NOT IN BUILD: Inheritance in Visual Basic](http://msdn.microsoft.com/ru-ru/e5e6e240-ed31-4657-820c-079b7c79313c)   
 [Наследование](/dotnet/csharp/programming-guide/classes-and-structs/inheritance)