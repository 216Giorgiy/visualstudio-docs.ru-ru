---
title: "Практическое руководство. Выполнение хранимой процедуры, не возвращающей значения | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "ExecuteNonQuery - метод"
  - "хранимые процедуры, создание"
  - "хранимые процедуры, выполнение"
ms.assetid: 8a929e96-2cf5-43a5-b5b7-c0a5a397bbc5
caps.latest.revision: 19
caps.handback.revision: 19
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
robots: noindex,nofollow
---
# Практическое руководство. Выполнение хранимой процедуры, не возвращающей значения
Для выполнения хранимой процедуры, не возвращающей значения, можно запустить запрос адаптера таблицы TableAdapter, настроенный для запуска хранимой процедуры \(например, `CustomersTableAdapter.UpdateTableData(CustomersDataTable)`\).  
  
 Если приложение не использует адаптеры таблиц, вызовите метод `ExecuteNonQuery` объекта команды, присвоив его свойству `CommandType` значение <xref:System.Data.CommandType>.  \("Объектом команды" называется определенная команда для [поставщика данных платформы .NET Framework](../Topic/.NET%20Framework%20Data%20Providers.md), используемого приложением.  Например, если приложение использует поставщик данных .NET Framework для SQL Server, то объект команды будет <xref:System.Data.SqlClient.SqlCommand>.\)  
  
 В следующих примерах показано выполнение хранимых процедур, не возвращающих значения из базы данных, с помощью адаптеров таблиц TableAdapter или объектов команд.  Дополнительные сведения о запросах с использованием адаптеров таблиц и команд содержатся в разделе [Заполнение набора данных](../data-tools/fill-datasets-by-using-tableadapters.md).  
  
 [!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]  
  
## Выполнение хранимых процедур, не возвращающих значений, с помощью адаптера таблицы TableAdapter  
 В этом примере показано создание запроса адаптера таблицы с помощью [мастер настройки запроса TableAdapter](../data-tools/editing-tableadapters.md), а также приводятся сведения об объявлении экземпляра адаптера таблицы и выполнении запроса.  
  
#### Чтобы создать хранимую процедуру, не возвращающую значение, с помощью адаптера таблицы TableAdapter  
  
1.  Откройте набор данных в **Конструкторе наборов данных**.  Дополнительные сведения см. в разделе [Практическое руководство. Открытие набора данных в конструкторе наборов данных](../Topic/How%20to:%20Open%20a%20Dataset%20in%20the%20Dataset%20Designer.md).  
  
2.  Создайте адаптер таблицы, если не сделали этого ранее.  Дополнительные сведения о создании адаптеров таблиц см. в разделе [Практическое руководство. Создание адаптера таблицы](../data-tools/create-and-configure-tableadapters.md).  
  
3.  Если для адаптера таблицы TableAdapter уже имеется запрос, использующий хранимую процедуру, которая не возвращает значение, переходите к процедуре "Объявление экземпляра адаптера таблицы TableAdapter и выполнение запроса". В противном случае необходимо продолжить выполнение шага 4, чтобы создать новый запрос, не возвращающий значение.  
  
4.  Щелкните требуемый адаптер таблиц правой кнопкой мыши и используйте контекстное меню для добавления запроса.  
  
     Откроется **Мастер настройки запроса адаптера таблицы**.  
  
5.  Выберите **Использовать существующую сохраненную процедуру** и нажмите кнопку **Далее**.  
  
6.  Выберите сохраненную процедуру из раскрывающегося списка, и затем нажмите **Далее**.  
  
7.  Выберите параметр **Нет значения** и нажмите кнопку **Далее**.  
  
8.  Введите имя для запроса.  
  
9. Нажмите кнопку **Далее** или **Готово**, чтобы завершить работу мастера; запрос добавляется в адаптер таблицы TableAdapter.  
  
10. Построить проект.  
  
#### Чтобы объявить экземпляр адаптера таблиц и выполнить запрос:  
  
1.  Объявите экземпляр адаптера таблицы TableAdapter, содержащий запрос, который требуется выполнить.  
  
    -   Для создания экземпляра с помощью средств времени проектирования, перетащите нужный адаптер таблицы TableAdapter с **Панели элементов**.  \(Компонент в проекте теперь отображается в **Панели элементов** под заголовком, совпадающим с именем проекта.\) Если адаптер таблиц не отображается в **Панели элементов**, может потребоваться скомпилировать проект.  
  
         \-или\-  
  
    -   Чтобы создать экземпляр в коде, подставьте в следующий код имена <xref:System.Data.DataSet> и адаптера таблиц.  
  
         `Dim tableAdapter As New DataSetTableAdapters.TableAdapter`  
  
        > [!NOTE]
        >  Адаптеры таблиц на самом деле не располагаются внутри связанных с ними классов наборов данных.  Каждый набор данных имеет соответствующую коллекцию адаптеров таблиц в своих собственных пространствах имен.  Например, если имеется набор данных с именем `SalesDataSet`, то пространство имен `SalesDataSetTableAdapters` будет содержать его адаптеры таблиц.  
  
2.  Вызовите запрос, как вызвали бы любой другой метод в коде.  Запрос представляет собой метод адаптера таблиц.  Подставьте в следующий код имя адаптера таблиц и имя запроса.  Кроме того, необходимо передать любые параметры, необходимые запросу.  Если вы не уверены в том, что запросу необходимы параметры, и какие именно параметры требуются, то проверьте в IntelliSense требуемую сигнатуру запроса.  В зависимости то того, принимает ли запрос параметры или нет, код будет выглядеть аналогично одному из следующих примеров:  
  
     `TableAdapter.Query()`  
  
     `TableAdapter.Query(Parameters)`  
  
     Полный код объявления экземпляра адаптера таблицы и выполнения запроса должен выглядеть примерно следующим образом:  
  
     [!code-cs[VbRaddataFillingAndExecuting#11](../data-tools/codesnippet/CSharp/how-to-execute-a-stored-procedure-that-returns-no-value_1.cs)]
     [!code-vb[VbRaddataFillingAndExecuting#11](../data-tools/codesnippet/VisualBasic/how-to-execute-a-stored-procedure-that-returns-no-value_1.vb)]  
  
## Выполнение хранимых процедур, не возвращающих значения, с помощью объекта команды  
 В следующем примере демонстрируется создание команды и выполнение хранимой процедуры, не возвращающей значения.  Сведения об установке и получении значений параметров для команды см. в разделе [Практическое руководство. Установка и получение параметров командных объектов](../Topic/How%20to:%20Set%20and%20Get%20Parameters%20for%20Command%20Objects.md).  
  
 Этот пример использует объект <xref:System.Data.SqlClient.SqlCommand> и требует:  
  
-   Ссылки на пространства имен <xref:System>, <xref:System.Data> и <xref:System.Xml>.  
  
#### Для выполнения хранимой процедуры, не возвращающей значения, с помощью DataCommand  
  
-   Добавьте следующий код к методу, из которого должна выполняться хранимая процедура.  Вызовите метод `ExecuteNonQuery` команды без возврата значения \(например <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>\).  
  
     [!code-cs[VbRaddataFillingAndExecuting#15](../data-tools/codesnippet/CSharp/how-to-execute-a-stored-procedure-that-returns-no-value_2.cs)]
     [!code-vb[VbRaddataFillingAndExecuting#15](../data-tools/codesnippet/VisualBasic/how-to-execute-a-stored-procedure-that-returns-no-value_2.vb)]  
  
## Безопасность платформы .NET Framework  
 Для доступа к базе данных и выполнения инструкции SQL приложению требуется разрешение.  
  
## См. также  
 <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A?displayProperty=fullName>   
 <xref:System.Data.OleDb.OleDbCommand.ExecuteNonQuery%2A?displayProperty=fullName>   
 <xref:System.Data.Odbc.OdbcCommand.ExecuteNonQuery%2A?displayProperty=fullName>   
 <xref:System.Data.OracleClient.OracleCommand.ExecuteNonQuery%2A?displayProperty=fullName>   
 [Практическое руководство. Создание запросов TableAdapter](../data-tools/how-to-create-tableadapter-queries.md)   
 [Практическое руководство. Изменение запросов TableAdapter](../data-tools/how-to-edit-tableadapter-queries.md)   
 [Практическое руководство. Заполнение данными набора данных](../data-tools/how-to-fill-a-dataset-with-data.md)   
 [Заполнение набора данных](../data-tools/fill-datasets-by-using-tableadapters.md)   
 [Практическое руководство. Установка и получение параметров командных объектов](../Topic/How%20to:%20Set%20and%20Get%20Parameters%20for%20Command%20Objects.md)