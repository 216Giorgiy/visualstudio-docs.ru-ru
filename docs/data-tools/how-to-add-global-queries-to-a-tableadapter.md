---
title: "Практическое руководство. Добавление глобальных запросов в набор данных | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "данные [Visual Studio], адаптеры таблиц TableAdapter"
  - "наборы данных [Visual Basic], глобальные функции"
  - "наборы данных [Visual Basic], скалярные функции"
  - "глобальные функции, наборы данных"
  - "запросы [Visual Studio], адаптеры таблиц TableAdapter"
  - "скалярные функции, наборы данных"
  - "запросы TableAdapter"
  - "мастер настройки запроса TableAdapter"
  - "адаптеры таблиц TableAdapter, глобальные запросы"
ms.assetid: 4abffd6b-2e9f-4ef3-99b2-6e9ae4ad4679
caps.latest.revision: 13
caps.handback.revision: 13
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
robots: noindex,nofollow
---
# Практическое руководство. Добавление глобальных запросов в набор данных
*Глобальные запросы* являются запросами SQL, которые либо возвращают одно \(скалярное\) значение, либо ничего не возвращают.  Как правило, глобальные функции выполняют операции базы данных, такие как вставка, обновление, удаление и сбор данных, например, возврат числа клиентов в таблице или общих издержек для всех элементов конкретного заказа.  
  
 Чтобы добавить глобальные запросы, запустите **Мастер настройки запросов адаптера таблицы**  из **Конструктора наборов данных**.  
  
 [!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]  
  
### Чтобы добавить глобальный запрос в набор данных.  
  
1.  Откройте набор данных в **Конструкторе наборов данных**.  Дополнительные сведения см. в разделе [Практическое руководство. Открытие набора данных в конструкторе наборов данных](../Topic/How%20to:%20Open%20a%20Dataset%20in%20the%20Dataset%20Designer.md).  
  
2.  Перетащите **Запрос** со вкладки **Набор данных** в **Панели элементов** в пустую область **Конструктора наборов данных**.  
  
     Откроется [мастер настройки запроса TableAdapter](../data-tools/editing-tableadapters.md).  
  
3.  Выберите используемое для запроса подключение.  Можно выбрать подключение из списка или создать новое подключение.  При создании нового подключения пользователь может сохранить его в файл конфигурации приложения.  Дополнительные сведения см. в разделе [Практическое руководство. Сохранение и изменение строк подключения](../Topic/How%20to:%20Save%20and%20Edit%20Connection%20Strings.md).  
  
4.  Выберите, следует ли использовать инструкции SQL или хранимые процедуры.  
  
5.  Выберите хранимую процедуру или, на странице мастера **Выберите тип запроса**, выберите тип запроса и нажмите кнопку **Далее**.  
  
6.  Введите запрос, выполняющий нужную задачу, например, `SELECT COUNT(*) AS CustomerCount FROM Customers`.  
  
    > [!NOTE]
    >  При перетаскивании запроса непосредственно в **Конструктор наборов данных** создается метод, который будет возвращать только скалярное \(одно\) значение.  Даже если выбранный запрос или хранимая процедура может возвращать более одного значения, созданный мастером метод будет возвращать только одно значение.  Например, запрос может возвращать первый столбец первой строки возвращенных данных.  
  
7.  Завершите работу мастера; запрос добавляется к **Конструктору наборов данных**.  Сведения о выполнении запроса содержатся в разделе [Практическое руководство. Выполнение запросов TableAdapter](../Topic/How%20to:%20Execute%20TableAdapter%20Queries.md).  
  
## См. также  
 [Практическое руководство. Создание адаптера таблицы](../data-tools/create-and-configure-tableadapters.md)   
 [Практическое руководство. Создание запросов TableAdapter](../data-tools/how-to-create-tableadapter-queries.md)   
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)   
 [Общие сведения об адаптере таблиц](../data-tools/tableadapter-overview.md)   
 [Создание и изменение типизированных наборов данных](../data-tools/creating-and-editing-typed-datasets.md)   
 [Общие сведения об источниках данных](../data-tools/add-new-data-sources.md)   
 [Практическое руководство. Подключение к данным в базе данных](../data-tools/how-to-connect-to-data-in-a-database.md)   
 [Проверка данных](../Topic/Validating%20Data.md)   
 [Практическое руководство. Переход между данными с помощью элемента управления BindingNavigator в Windows Forms](../Topic/How%20to:%20Navigate%20Data%20with%20the%20Windows%20Forms%20BindingNavigator%20Control.md)   
 [Пошаговое руководство. Отображение данных на форме в приложении Windows](../data-tools/walkthrough-displaying-data-on-a-windows-form.md)