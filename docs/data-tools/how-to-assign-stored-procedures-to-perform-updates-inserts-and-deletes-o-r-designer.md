---
title: "Как назначить хранимые процедуры для выполнения обновлений, вставок и удалений (реляционный конструктор объектов) | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
ms.assetid: e88224ab-ff61-4a3a-b6b8-6f3694546cac
caps.latest.revision: 2
caps.handback.revision: 2
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Как назначить хранимые процедуры для выполнения обновлений, вставок и удалений (реляционный конструктор объектов)
Сохраненные процедуры можно добавлять в реляционный конструктор объектов и выполнять как обычные методы <xref:System.Data.Linq.DataContext>.Сохраненные процедуры могут также использоваться для отмены поведения по умолчанию среды выполнения [!INCLUDE[vbtecdlinq](../data-tools/includes/vbtecdlinq_md.md)], которая выполняет операции Вставки, Обновления Удаления, когда изменения сохраняются из классов сущностей в базу данных \(например, при вызове метода <xref:System.Data.Linq.DataContext.SubmitChanges%2A>\).  
  
> [!NOTE]
>  Если хранимые процедуры возвращают значения, которые должны отправляться обратно на клиент \(например, значения, вычисляемые в хранимой процедуре\), создайте в хранимых процедурах выходные параметры.Если использовать выходные параметры невозможно, то вместо применения переопределений, созданных реляционным конструктором объектов, реализуйте разделяемый метод.Элементы, сопоставляемые со значениями, созданными базой данных, должны получать соответствующие значения после успешного завершения операций INSERT или UPDATE.Дополнительные сведения см. в разделе [Обязанности разработчика при переопределении поведения по умолчанию](../Topic/Responsibilities%20of%20the%20Developer%20In%20Overriding%20Default%20Behavior.md).  
  
> [!NOTE]
>  [!INCLUDE[vbtecdlinq](../data-tools/includes/vbtecdlinq_md.md)] автоматически обрабатывает значения, генерируемые в базе данных, на принадлежность к столбцам ключей \(автоприращение\), rowguidcol \(созданный базой данных уникальный идентификатор GUID\) и столбцам отметок времени.Генерируемые базой данных значения в других типах столбцов будут неожиданно давать нулевое значение.Для возврата генерируемых базой данных значений нужно вручную задать <xref:System.Data.Linq.Mapping.ColumnAttribute.IsDbGenerated%2A> в `true` и <xref:System.Data.Linq.Mapping.ColumnAttribute.AutoSync%2A> в одно из следующих: <xref:System.Data.Linq.Mapping.AutoSync>, <xref:System.Data.Linq.Mapping.AutoSync> или <xref:System.Data.Linq.Mapping.AutoSync>.  
  
## Настройка Поведения обновления Класса сущностей  
 По умолчанию, логика обновления базы данных \(Вставки, Обновления и Удаления\) с изменениями данных классов сущностей [!INCLUDE[vbtecdlinq](../data-tools/includes/vbtecdlinq_md.md)] обеспечивается средой выполнения [!INCLUDE[vbtecdlinq](../data-tools/includes/vbtecdlinq_md.md)].Среда выполнения по умолчанию создает команды Вставить, Обновить и Удалить, основываясь на схеме таблицы \(определения столбцов и информация о первичных ключах\).Если нужно изменить режим работы по умолчанию, порядок обновления вы можете настроить, назначая определенные хранимые процедуры для выполнения операций вставки, обновления и удаления, необходимых для работы с данными в таблице. Назначить процедуры также можно, если режим работы по умолчанию не определен \(например, когда классы сущностей сопоставляются с представлениями\).Наконец, можно отменить поведение обновления по умолчанию, когда база данных требует доступа к таблице через сохраненные процедуры.  
  
 [!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]  
  
#### Чтобы назначить сохраненные процедуры для переопределения заданного по умолчанию поведения класса сущностей  
  
1.  Откройте файл **LINQ to SQL** в конструкторе.\(Дважды щелкните по DBML\-файлу в **Обозревателе решений**.\)  
  
2.  В **Обозревателе серверов**\/**Обозревателе базы данных** разверните узел **Сохраненные процедуры** и найдите сохраненные процедуры, которые вы хотите использовать для команд Вставить, Обновить и\/или Удалить класса сущностей.  
  
3.  Перетащите сохраненную процедуру на реляционный конструктор объектов.  
  
     Сохраненная процедура добавляется в область методов как метод <xref:System.Data.Linq.DataContext>.Дополнительные сведения см. в разделе [Методы DataContext \(реляционный конструктор объектов\)](../data-tools/datacontext-methods-o-r-designer.md).  
  
4.  Выберите класс сущностей, для которого вы хотите использовать сохраненную процедуру для выполнения обновлений.  
  
5.  В окне **Свойства** выберите команду для переопределения \(**Вставить**, **Обновить** или **Удалить**\).  
  
6.  Нажмите кнопку с многоточием \(...\) рядом с полем **Использовать среду выполнения**, чтобы открыть диалоговое окно **Настройка поведения**.  
  
7.  Выберите **Customize**.  
  
8.  Выберите нужную сохраненную процедуру в списке **Customize**.  
  
9. Проверьте список **Аргументы метода** и **Свойства класса**, чтобы убедиться, что **Аргументы метода** сопоставляются соответствующим **Свойствам класса**.Сопоставьте аргументы исходного метода \(Original\_*ArgumentName*\) с исходными свойствами \(*PropertyName* \(Original\)\) для команд Update и Delete.  
  
    > [!NOTE]
    >  По умолчанию аргументы метода сопоставляются со свойствами класса, если их имена совпадают.Если имена свойств были изменены и больше не совпадают в таблице и в классе сущностей, то может потребоваться выбор эквивалентного свойства класса для сопоставления, если конструктор не сможет определить правильное сопоставление.  
  
10. Нажмите кнопку **OK** или кнопку **Применить**.  
  
    > [!NOTE]
    >  Можно продолжить настройку режима для каждого сочетания класса и режима при условии, что после каждого изменения будет производиться нажатие кнопки **Применить**.Если вы изменяете класс или поведения до нажатия кнопки **Применить**, то появляется предупреждающее диалоговое окно, предлагающее применить выполненные изменения.  
  
     Чтобы возвратиться к использованию заданной по умолчанию логики среды выполнения для обновлений, нажмите кнопку с многоточием рядом с командами Вставить, Обновить или Удалить в окне **Свойства** и потом выберите **Использовать среду выполнения** в диалоговом окне **Конфигурирование поведения**.  
  
## См. также  
 [Реляционный конструктор объектов](../data-tools/linq-to-sql-tools-in-visual-studio2.md)   
 [Методы DataContext \(реляционный конструктор объектов\)](../data-tools/datacontext-methods-o-r-designer.md)   
 [Пошаговое руководство. Создание классов LINQ to SQL \(реляционный конструктор объектов\)](../Topic/Walkthrough:%20Creating%20LINQ%20to%20SQL%20Classes%20\(O-R%20Designer\).md)   
 [Пошаговое руководство. Создание хранимых процедур обновления данных для таблицы Customers базы данных Northwind](../data-tools/walkthrough-creating-update-stored-procedures-for-the-northwind-customers-table.md)   
 [LINQ to SQL](../Topic/LINQ%20to%20SQL.md)   
 [Операции вставки, обновления и удаления](../Topic/Insert,%20Update,%20and%20Delete%20Operations.md)