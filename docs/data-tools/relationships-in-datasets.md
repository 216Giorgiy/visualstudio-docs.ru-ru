---
title: "Позволяет создавать связи между наборами данных DataRelation | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- vbData.Microsoft.VSDesigner.DataSource.DesignRelation
- vbdata.Microsoft.VSDesigner.DataSource.DesignRelation
helpviewer_keywords:
- relationships, about relationships
- datasets [Visual Basic], relationships
- relationships, datasets
ms.assetid: cfe274f0-71fe-40f6-994e-7c7f6273c9ba
caps.latest.revision: "15"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.technology: vs-data-tools
ms.openlocfilehash: bfc537118f6c1769ec98893099daa0c61d1b5b1d
ms.sourcegitcommit: ee42a8771f0248db93fd2e017a22e2506e0f9404
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/09/2017
---
# <a name="create-relationships-between-datasets"></a>Создать связи между наборами данных
Наборы данных, содержащие связанные данные таблиц, используют <xref:System.Data.DataRelation> объектов для представления иерархическое отношение между таблицами и возврата связанных записей друг от друга. Добавление связанных таблиц к наборам данных с помощью **мастер настройки источника данных**, или **конструктора наборов данных**, создает и настраивает <xref:System.Data.DataRelation> объект.  
  
<xref:System.Data.DataRelation> Объект выполняет две функции:  
  
-   Его можно сделать доступным записи, относящиеся к записи, которой вы работаете. Предоставляет дочерние записи, если вы находитесь в родительскую запись (<xref:System.Data.DataRow.GetChildRows%2A>) и при работе с дочерними родительскую запись (<xref:System.Data.DataRow.GetParentRow%2A>).  
  
-   Вводит ограничения для обеспечения целостности данных, например удаление связанной дочерней записи при удалении родительской записи.  
  
Важно понимать разницу между реальным объединением и функция <xref:System.Data.DataRelation> объекта. В реальном объединении записи берутся из родительской и дочерней таблицами и поместить в один плоский набор записей. При использовании <xref:System.Data.DataRelation> объекта, создается новый набор записей. Вместо этого DataRelation отслеживает связи между таблицами и отслеживает родительских и дочерних записей синхронизированными.  
  
## <a name="datarelation-objects-and-constraints"></a>DataRelation объектов и ограничений  
Объект <xref:System.Data.DataRelation> объект также используется для создания и введения следующих ограничений:  
  
-   Ограничение уникальности, которое гарантирует, что столбец таблицы не содержит дублирующихся значений.  
  
-   Ограничение foreign key, который может использоваться для поддержки ссылочной целостности между родительской и дочерней таблицы в наборе данных.  
  
Ограничения, заданные в <xref:System.Data.DataRelation> , реализуются посредством автоматического создания соответствующих объектов или настройки свойств. При создании ограничения foreign key с помощью <xref:System.Data.DataRelation> объект, экземпляры <xref:System.Data.ForeignKeyConstraint> добавлен класс <xref:System.Data.DataRelation> объекта <xref:System.Data.DataRelation.ChildKeyConstraint%2A> свойство.  
  
Ограничение уникальности реализуется либо присвоением <xref:System.Data.DataColumn.Unique%2A> свойство столбца данных, чтобы `true` или путем добавления экземпляра <xref:System.Data.UniqueConstraint> класса <xref:System.Data.DataRelation> объекта <xref:System.Data.DataRelation.ParentKeyConstraint%2A> свойство. Сведения о приостановке ограничений в наборе данных см. в разделе [отключения ограничений при заполнении набора данных](../data-tools/turn-off-constraints-while-filling-a-dataset.md).  
  
### <a name="referential-integrity-rules"></a>Правила целостности данных  
В рамках ограничения внешнего ключа можно указать правила целостности данных, которые применяются в трех местах:  
  
-   При обновлении родительской записи  
  
-   При удалении родительской записи  
  
-   При изменении приняты или отклонены  
  
Правила, которые можно внести, определены в <xref:System.Data.Rule> перечисления и включаются, перечисленные в следующей таблице.  
  
|Правило ограничения внешнего ключа|Действие|  
|----------------------------------|------------|  
|<xref:System.Data.Rule.Cascade>|Изменения (обновления или удаления) в родительскую запись также внесены в связанных записей в дочерней таблице.|  
|<xref:System.Data.Rule.SetNull>|Дочерние записи не удаляются, но внешний ключ в дочерних записях равно <xref:System.DBNull>. Этот параметр, можно оставить дочерние записи, как «потерянные», то есть они имеют не связано с родительские записи. **Примечание:** с помощью этого правила может привести к недопустимые данные в дочерней таблице.|  
|<xref:System.Data.Rule.SetDefault>|Внешний ключ в связанной дочерней записи устанавливается значение по умолчанию (в соответствии с параметром столбца <xref:System.Data.DataColumn.DefaultValue%2A> свойство).|  
|<xref:System.Data.Rule.None>|В дочернюю запись не вносятся никакие изменения. С этим параметром дочерние записи может содержать ссылки на неверные родительские записи.|  
  
Дополнительные сведения об обновлениях в таблицах набора данных см. в разделе [сохранить данные в базе данных](../data-tools/save-data-back-to-the-database.md).  
  
### <a name="constraint-only-relations"></a>Связи, используемые только для ограничений  
При создании <xref:System.Data.DataRelation> объекта, у вас есть возможность указать, что отношение будет использоваться только для принудительного применения ограничений — то есть, он будет не также использоваться для доступа к связанных записей. Этот параметр можно использовать для создания набора данных, является несколько более эффективна, и содержит меньшее число методов, чем с возможностью связанных записей. Тем не менее вы не сможете доступ к связанным записям. Например отношение только для ограничений позволяет удалять родительскую запись, имеющую дочерние записи и дочерние записи недоступен в результате изменения родительского.  
  
## <a name="manually-creating-a-data-relation-in-the-dataset-designer"></a>Вручную создание отношения данных в конструкторе наборов данных  
При создании таблиц данных с помощью средств проектирования данных в Visual Studio, связи создаются автоматически, если можно собрать сведения из источника данных. Если вручную добавить таблицы данных из **DataSet** вкладке **элементов**, может потребоваться создать связи вручную. Дополнительные сведения о создании <xref:System.Data.DataRelation> объектов программным способом см. [Добавление отношений DataRelation](/dotnet/framework/data/adonet/dataset-datatable-dataview/adding-datarelations).  
  
Связи между таблицами данных отображаются в виде линий **конструктора наборов данных**, с ключом и символом бесконечности отображения один ко многим аспектом связи. По умолчанию имя связи не отображается в области конструктора.  
  
[!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]  
  
#### <a name="to-create-a-relationship-between-two-data-tables"></a>Чтобы создать связь между таблицами данных  
  
1.  Откройте свой набор данных в **конструктора наборов данных**. Дополнительные сведения см. в разделе [Пошаговое руководство: Создание набора данных в конструкторе наборов данных](walkthrough-creating-a-dataset-with-the-dataset-designer.md).  
  
2.  Перетащите **отношения** объекта из **DataSet** элементов на дочернюю таблицу данных в отношении.  
  
     **Отношения** откроется диалоговое окно, заполнение **дочерней таблицы** поле с таблицей, которую пользователь перетащил **отношения** объекта на.  
  
3.  Выберите родительскую таблицу из **родительской таблицы** поле. В родительской таблице содержатся записи на стороне «один» связи «один ко многим».  
  
4.  Убедитесь, что отображается нужная таблица в **дочерней таблицы** поле. В родительской таблице содержатся записи на стороне «многие» связи «один ко многим».  
  
5.  Введите имя для связи в **имя** поле, либо оставьте имя по умолчанию на основе выбранных таблиц. Это имя фактического <xref:System.Data.DataRelation> объекта в коде.  
  
6.  Выберите столбцы, соединяющие таблицы в **ключевые столбцы** и **столбцы внешнего ключа** перечислены.  
  
7.  Выберите, следует ли создавать отношения и ограничения.   
  
8.  Установите или снимите **вложенное отношение** поле. Выбор этого параметра задает <xref:System.Data.DataRelation.Nested%2A> свойства `true`, и в этом случае дочерние строки связи вкладываются в родительский столбец записан как XML-данных или синхронизированы с этих строк <xref:System.Xml.XmlDataDocument>. Дополнительные сведения см. в разделе [вложение отношений DataRelation](/dotnet/framework/data/adonet/dataset-datatable-dataview/nesting-datarelations).  
  
9. Задайте правила, которые будут применяться при внесении изменений в записи в этих таблицах. Для получения дополнительной информации см. <xref:System.Data.Rule>.  
  
10. Нажмите кнопку **ОК** для создания связи. Появится линия связи между двумя таблицами в конструкторе.  
  
#### <a name="to-display-a-relation-name-in-the-dataset-designer"></a>Чтобы отобразить имя отношения в конструкторе наборов данных  
  
1.  Откройте свой набор данных в **конструктора наборов данных**. Дополнительные сведения см. в разделе [Пошаговое руководство: Создание набора данных в конструкторе наборов данных](walkthrough-creating-a-dataset-with-the-dataset-designer.md).  
  
2.  Из **данные** последовательно выберите пункты **Показать подписи отношений** команду, чтобы отобразить имя отношения. Снимите этой команды, чтобы скрыть имя отношения.

## <a name="see-also"></a>См. также
[Создание и настройка наборов данных в Visual Studio](../data-tools/create-and-configure-datasets-in-visual-studio.md)