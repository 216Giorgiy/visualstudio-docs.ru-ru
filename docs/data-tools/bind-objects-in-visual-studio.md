---
title: "Привязка объектов в Visual Studio | Microsoft Docs"
ms.custom: ""
ms.date: "12/14/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "привязка, к объектам"
  - "данные [Visual Studio], связывание с объектами"
  - "данные [Visual Studio], привязка объектов"
  - "привязка объектов"
ms.assetid: ed743ce6-73af-45e5-a8ff-045eddaccc86
caps.latest.revision: 20
caps.handback.revision: 15
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Привязка объектов в Visual Studio
Visual Studio предоставляет средства разработки для работы с пользовательскими объектами \(в отличие от других источников данных, например сущностей, наборов данных и служб\) в качестве источников данных в приложении.  
  
## Требования к объектам  
 Единственное требование для пользовательских объектов для работы с средствами разработки данных в Visual Studio – то, что объекту требуется по крайней мере одно общее свойство.  
  
 В целом пользовательские объекты не нуждаются в определенных интерфейсах, конструкторах или атрибутах, чтобы служить источником данных для приложения.  Однако если необходимо перетащить объект из окна **Источники данных** в рабочую область конструирования для создания элемента управления, связанного с данными, и если этот объект реализует интерфейс <xref:System.ComponentModel.ITypedList> или <xref:System.ComponentModel.IListSource>, то он должен иметь конструктор по умолчанию \(то есть конструктор без параметров\).  В противном случае Visual Studio не сможет создать экземпляр объекта источника данных и отобразит ошибку при перетаскивании элемента в рабочую область конструирования.  
  
## Примеры использования пользовательских объектов в качестве источников данных  
 Хотя есть множество способов реализовать логику приложения при работе с объектами в качестве источников данных, существует несколько стандартных операций, которые можно упростить с помощью создаваемых Visual Studio объектов [TableAdapter](../data-tools/tableadapter-overview.md).  На этой странице обсуждаются способы реализации этих стандартных процессов с помощью объектов адаптеров таблиц; страница не является руководством для создания пользовательских объектов.  Например, вы можете выполнять следующие стандартные операции независимо от конкретной реализации объектов или логики приложения:  
  
-   Загрузка данных в объекты \(обычно из базы данных\).  
  
-   Создание типизированных коллекций объектов.  
  
-   Добавление объектов в коллекцию и их удаление.  
  
-   Отображение данных объектов для пользователей на форме.  
  
-   Изменение\/редактирование данных в объекте.  
  
-   Сохранение данных из объектов обратно в базу данных.  
  
> [!NOTE]
>  Чтобы лучше понять и предоставить контекст для примеров на этой странице, рекомендуется выполнить следующее: [Пошаговое руководство. Подключение к данным в объектах \(Windows Forms\)](../Topic/Walkthrough:%20Connecting%20to%20Data%20in%20Objects%20\(Windows%20Forms\).md).  В данном пошаговом руководстве создаются объекты, обсуждаемые на этой странице справки.  
  
### Загрузка данных в объекты  
 В этом пошаговом руководстве происходит загрузка данных в объекты с помощью адаптера таблиц.  По умолчанию адаптеры таблиц создаются с двумя видами методов: методом выборки данных из базы данных и методом заполнения таблиц данных.  
  
-   Метод `TableAdapter.Fill` позволяет заполнять существующие таблицы данных возвращаемыми данными.  
  
-   Метод `TableAdapter.GetData` позволяет возвращать новую таблицу данных, заполненную данными.  
  
 Наиболее простой метод загрузки данных в объект — вызов метода `TableAdapter.GetData`, цикл по коллекции строк в таблице возвращаемых данных и заполнение каждого объекта значениями каждой строки.  Можно создать метод `GetData`, возвращающий заполненные таблицы данных для любого запроса, добавленного в адаптер таблиц.  
  
> [!NOTE]
>  По умолчанию Visual Studio именует запросы адаптера таблиц `Fill` и `GetData`, однако эти имена могут быть изменены.  
  
 В следующем пошаговом руководстве демонстрируется цикл по строкам в таблице данных и заполнение объекта данными:  
  
 Более полный пример кода содержится в разделе [Пошаговое руководство. Подключение к данным в объектах \(Windows Forms\)](../Topic/Walkthrough:%20Connecting%20to%20Data%20in%20Objects%20\(Windows%20Forms\).md).  
  
 [!code-cs[VbRaddataConnecting#4](../data-tools/codesnippet/CSharp/bind-objects-in-visual-studio_1.cs)]
 [!code-vb[VbRaddataConnecting#4](../data-tools/codesnippet/VisualBasic/bind-objects-in-visual-studio_1.vb)]  
  
### Создание типизированных коллекций объектов  
 Можно создать классы коллекций для объектов или использовать типизированные коллекции, автоматически предоставляемые [Компонент BindingSource](../Topic/BindingSource%20Component.md).  
  
 При создании пользовательского класса коллекции объектов рекомендуется наследование из <xref:System.ComponentModel.BindingList%601>.  Этот универсальный класс предоставляет функциональные возможности для администрирования коллекции, а также возможность вызывать события, отправлять уведомления в инфраструктуру привязки данных в формах Windows Forms.  
  
 Автоматически созданная коллекция в <xref:System.Windows.Forms.BindingSource> использует <xref:System.ComponentModel.BindingList%601> для своей типизированной коллекции.  Если приложение не требует дополнительных функциональных возможностей, можно поддерживать в коллекцию в <xref:System.Windows.Forms.BindingSource>.  Для получения дополнительных сведений см. свойство <xref:System.Windows.Forms.BindingSource.List%2A> класса <xref:System.Windows.Forms.BindingSource>.  
  
> [!NOTE]
>  Если ваша коллекция потребует функциональных возможностей, не поддерживаемых базовой реализацией <xref:System.ComponentModel.BindingList%601>, следует создать пользовательскую коллекцию, которую можно будет добавить в класс при необходимости.  
  
 В следующем коде показано, как создать класс строго типизированной коллекции объектов `Order`:  
  
 [!code-cs[VbRaddataConnecting#8](../data-tools/codesnippet/CSharp/bind-objects-in-visual-studio_2.cs)]
 [!code-vb[VbRaddataConnecting#8](../data-tools/codesnippet/VisualBasic/bind-objects-in-visual-studio_2.vb)]  
  
### Добавление элементов в коллекцию  
 Добавить объекты в коллекцию можно, вызвав метод `Add` класса пользовательской коллекции или <xref:System.Windows.Forms.BindingSource>.  
  
 В качестве примера добавления в коллекцию с помощью <xref:System.Windows.Forms.BindingSource> рассмотрите метод `LoadCustomers` в [Пошаговое руководство. Подключение к данным в объектах \(Windows Forms\)](../Topic/Walkthrough:%20Connecting%20to%20Data%20in%20Objects%20\(Windows%20Forms\).md).  
  
 В качестве примера добавления объектов в пользовательскую коллекцию рассмотрите метод `LoadOrders` в [Пошаговое руководство. Подключение к данным в объектах \(Windows Forms\)](../Topic/Walkthrough:%20Connecting%20to%20Data%20in%20Objects%20\(Windows%20Forms\).md).  
  
> [!NOTE]
>  Метод `Add` автоматически предоставляется для пользовательской коллекции при наследовании от <xref:System.ComponentModel.BindingList%601>.  
  
 В следующем коде показано, как добавлять объекты в типизированную коллекцию в <xref:System.Windows.Forms.BindingSource>:  
  
 [!code-cs[VbRaddataConnecting#5](../data-tools/codesnippet/CSharp/bind-objects-in-visual-studio_3.cs)]
 [!code-vb[VbRaddataConnecting#5](../data-tools/codesnippet/VisualBasic/bind-objects-in-visual-studio_3.vb)]  
  
 В следующем коде показано, как добавлять объекты в типизированную коллекцию, наследуемую от <xref:System.ComponentModel.BindingList%601>:  
  
> [!NOTE]
>  В этом пошаговом руководстве коллекция `Orders` является свойством объекта `Customer`.  
  
 [!code-cs[VbRaddataConnecting#6](../data-tools/codesnippet/CSharp/bind-objects-in-visual-studio_4.cs)]
 [!code-vb[VbRaddataConnecting#6](../data-tools/codesnippet/VisualBasic/bind-objects-in-visual-studio_4.vb)]  
  
### Удаление объектов из коллекции  
 Удалить объекты из коллекции можно, вызвав метод `Remove` или метод `RemoveAt` класса пользовательской коллекции или <xref:System.Windows.Forms.BindingSource>.  
  
> [!NOTE]
>  Методы `Remove` и `RemoveAt` автоматически предоставляются для пользовательской коллекции при наследовании от <xref:System.ComponentModel.BindingList%601>.  
  
 Следующий фрагмент кода иллюстрирует поиск и удаление объектов из типизированной коллекции в <xref:System.Windows.Forms.BindingSource> с помощью метода <xref:System.Windows.Forms.BindingSource.RemoveAt%2A>:  
  
 [!code-cs[VbRaddataConnecting#7](../data-tools/codesnippet/CSharp/bind-objects-in-visual-studio_5.cs)]
 [!code-vb[VbRaddataConnecting#7](../data-tools/codesnippet/VisualBasic/bind-objects-in-visual-studio_5.vb)]  
  
### Отображение данных объектов для пользователей  
 Для отображения данных объектов для пользователей создайте источник данных объекта с помощью мастера [мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png), а затем перетащите весь объект или отдельные свойства на форму из окна **Источники данных**.  
  
 Дополнительные сведения о создании источников данных на основе объектов, см. в разделе [Практическое руководство. Подключение к данным в объектах](../Topic/How%20to:%20Connect%20to%20Data%20in%20Objects.md).  
  
 Дополнительные сведения по отображению данных из объектов в формах Windows Forms содержатся в разделе [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md).  
  
### Изменение данных в объектах  
 Чтобы изменить данные в пользовательских объектах, которые привязаны к элементам управления Windows Forms, просто измените данные в связанном элементе управления \(или прямо в свойствах объекта\).  Архитектура связывания данных обновит данные в объекте.  
  
 Если приложение требует отслеживания изменений и отката произошедших изменений, необходимо реализовать эту функциональную возможность в модели объекта.  Примерами слежения таблиц данных за произошедшими изменениями могут служить <xref:System.Data.DataRowState> <xref:System.Data.DataSet.HasChanges%2A> и <xref:System.Data.DataTable.GetChanges%2A>.  
  
### Сохранение данных из объектов в базе данных  
 Данные сохраняются в базе данных путем передачи значений из объектов в методы DBDirect адаптера таблиц.  
  
 Visual Studio создает методы DBDirect, которые могут выполняться прямо в базе данных.  Эти методы не требуют объектов DataSet или DataTable.  
  
|Метод DBDirect адаптера таблиц|Описание|  
|------------------------------------|--------------|  
|`TableAdapter.Insert`|Добавляет новые записи в базу данных, позволяя передать отдельные значения столбцов в качестве параметров метода.|  
|`TableAdapter.Update`|Обновляет в базе данных существующие записи.  Метод Update принимает исходные и новые значения столбцов в качестве параметров метода.  Исходные значения используются для обнаружения исходной записи, а новые значения используются для обновления этой записи.<br /><br /> Метод `TableAdapter.Update` также используется для согласования изменений в наборе данных с базой данных путем принятия в качестве параметров метода <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, <xref:System.Data.DataRow> или массива <xref:System.Data.DataRow>.|  
|`TableAdapter.Delete`|Удаляет существующие записи из базы данных на основе исходных значений столбца, переданных как параметры метода.|  
  
 Чтобы сохранить данные из коллекции объектов, просмотрите всю коллекцию объектов \(например, циклом for\-next\) и отправьте значения каждого объекта в базу данных с помощью методов DBDirect адаптера таблиц.  
  
 В следующем пошаговом руководстве показано использование DBDirect метода `TableAdapter.Insert` для добавления нового клиента прямо в базу данных:  
  
 [!code-cs[VbRaddataSaving#23](../data-tools/codesnippet/CSharp/bind-objects-in-visual-studio_6.cs)]
 [!code-vb[VbRaddataSaving#23](../data-tools/codesnippet/VisualBasic/bind-objects-in-visual-studio_6.vb)]  
  
## См. также  
 [Практическое руководство. Подключение к данным в объектах](../Topic/How%20to:%20Connect%20to%20Data%20in%20Objects.md)   
 [Пошаговое руководство. Подключение к данным в объектах \(Windows Forms\)](../Topic/Walkthrough:%20Connecting%20to%20Data%20in%20Objects%20\(Windows%20Forms\).md)   
 [Практическое руководство. Сохранение данных из объекта в базе данных](../data-tools/save-data-from-an-object-to-a-database.md)   
 [Практическое руководство. Непосредственный доступ к базе данных с помощью адаптера таблицы](../data-tools/directly-access-the-database-with-a-tableadapter.md)   
 [Пошаговое руководство. Сохранение данных с помощью методов DBDirect адаптера таблицы](../data-tools/save-data-with-the-tableadapter-dbdirect-methods.md)   
 [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md)   
 [адаптеры таблиц TableAdapter](../Topic/TableAdapters.md)   
 [Сохранение данных](../data-tools/saving-data.md)