---
title: "Проверка данных в наборах данных | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "DataTable.ColumnChanging"
  - "System.Data.DataTable.ColumnChanging"
  - "System.Data.DataTable.RowChanging"
  - "DataTable.RowChanging"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "проверка данных"
  - "проверка данных, наборы данных"
  - "обновление наборов данных, проверка данных"
  - "проверка данных, наборы данных"
ms.assetid: 79500596-1e4d-478e-a991-a636fd73a622
caps.latest.revision: 24
caps.handback.revision: 17
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Проверка данных в наборах данных
Проверка данных представляет собой процесс подтверждения того, что значения, вводимые в объекты данных, соответствуют ограничениям в схемах наборов данных, а также правилам, установленным для приложения.  Проверка данных до отправки обновлений в основную базу данных является хорошей практикой, которая уменьшает вероятность появления ошибок, а также ожидаемое количество циклов обработки между приложением и базой данных.  Чтобы подтвердить, что данные, записываемые в набор данных, верны, можно выполнить проверки в самом наборе данных.  Набор данных может проверить данные независимо от того, как производится обновление: напрямую, элементами управления в форме, внутри компонента или каким\-либо другим способом.  Поскольку набор данных является частью приложения, логично именно в нем реализовать проверку, учитывающую особенности данного приложения \(в отличие от аналогичных проверок в самой базе данных\).  
  
 Добавить проверки в приложение предлагается в файл частичного класса набора данных.  В [!INCLUDE[vbprvb](../code-quality/includes/vbprvb_md.md)] или [!INCLUDE[csprcs](../data-tools/includes/csprcs_md.md)] откройте **Конструктор наборов данных** и дважды щелкните столбец или таблицу, для которых необходимо создать проверку.  Это действие автоматически создает обработчик событий <xref:System.Data.DataTable.ColumnChanging> или <xref:System.Data.DataTable.RowChanging>.  Дополнительные сведения см. в разделе [Практическое руководство. Проверка данных в ходе изменения столбцов](../Topic/How%20to:%20Validate%20Data%20During%20Column%20Changes.md) или [Практическое руководство. Проверка данных в ходе изменения строк](../Topic/How%20to:%20Validate%20Data%20During%20Row%20Changes.md).  Полный пример содержится в разделе [Пошаговое руководство. Добавление проверки в набор данных](../Topic/Walkthrough:%20Adding%20Validation%20to%20a%20Dataset.md).  
  
## Проверка данных  
 Проверка в наборе данных может быть выполнена следующим образом:  
  
-   Путем создания для приложения собственных проверок, которые могут проверять данные во время изменения значений в отдельных столбцах.  Дополнительные сведения см. в разделе [Практическое руководство. Проверка данных в ходе изменения столбцов](../Topic/How%20to:%20Validate%20Data%20During%20Column%20Changes.md).  
  
-   Путем создания для приложения собственных проверок, которые могут проверять данные во время изменения значений при изменении строки данных целиком.  Дополнительные сведения см. в разделе [Практическое руководство. Проверка данных в ходе изменения строк](../Topic/How%20to:%20Validate%20Data%20During%20Row%20Changes.md).  
  
-   Путем создания ключей, ограничений уникальности и т. д. как части определения действительной схемы набора данных.  Дополнительные сведения о проверке в том числе определение схемы см. в разделе [Ограничения DataColumn содержал уникальные значения](../Topic/How%20to:%20Add%20Columns%20to%20a%20DataTable.md#SpecifyUniqueConstraint).  
  
-   Путем задания свойств объекта <xref:System.Data.DataColumn>, например <xref:System.Data.DataColumn.MaxLength%2A>, <xref:System.Data.DataColumn.AllowDBNull%2A> и <xref:System.Data.DataColumn.Unique%2A>.  
  
 Есть несколько событий, инициируемых объектом <xref:System.Data.DataTable> при внесении изменений в запись:  
  
-   События <xref:System.Data.DataTable.ColumnChanging> и <xref:System.Data.DataTable.ColumnChanged> вызываются во время и после каждого изменения отдельных столбцов.  Событие <xref:System.Data.DataTable.ColumnChanging> полезно, когда нужно проверить изменения в отдельных столбцах.  Сведения о предлагаемом изменении передаются как аргумент с событием.  Дополнительные сведения см. в разделе [Практическое руководство. Проверка данных в ходе изменения столбцов](../Topic/How%20to:%20Validate%20Data%20During%20Column%20Changes.md).  
  
-   События <xref:System.Data.DataTable.RowChanging> <xref:System.Data.DataTable.RowChanged> вызываются во время и после любого изменения в строке.  Событие <xref:System.Data.DataTable.RowChanging> является более общим в том смысле, что оно лишь указывает, что где\-то в строке происходит изменение, не указывая на столбец.  Дополнительные сведения см. в разделе [Практическое руководство. Проверка данных в ходе изменения строк](../Topic/How%20to:%20Validate%20Data%20During%20Row%20Changes.md).  
  
 По умолчанию каждое изменение столбца инициирует четыре события: сначала события <xref:System.Data.DataTable.ColumnChanging> и <xref:System.Data.DataTable.ColumnChanged> для отдельного столбца, который в данный момент изменяется, а затем события <xref:System.Data.DataTable.RowChanging> и <xref:System.Data.DataTable.RowChanged>.  Если в строку вносится несколько изменений, события будут инициироваться для каждого изменения.  
  
> [!NOTE]
>  Метод <xref:System.Data.DataRow.BeginEdit%2A> строки данных отключает события <xref:System.Data.DataTable.RowChanging> и <xref:System.Data.DataTable.RowChanged> после каждого изменения отдельных столбцов.  В этом случае событие не инициируется до вызова метода <xref:System.Data.DataRow.EndEdit%2A>, когда события <xref:System.Data.DataTable.RowChanging> и <xref:System.Data.DataTable.RowChanged> инициируются только один раз.  Дополнительные сведения см. в разделе [Практическое руководство. Отключение ограничений при заполнении набора данных](../data-tools/turn-off-constraints-while-filling-a-dataset.md).  
  
 Выбор события зависит от желаемой степени детализации проверки.  Если важно перехватить ошибку непосредственно при изменении столбца, создайте проверку с помощью события <xref:System.Data.DataTable.ColumnChanging>.  В противном случае используйте событие <xref:System.Data.DataTable.RowChanging>, которое может перехватывать сразу несколько ошибок.  Кроме того, если данные структурированы таким образом, что значение одного столбца проверяется на основе содержимого другого столбца, необходимо выполнять проверку во время события <xref:System.Data.DataTable.RowChanging>.  
  
 По окончании обновления записей объект <xref:System.Data.DataTable> инициирует события, на которые можно отвечать по мере того, как появляются изменения, и после того, как все изменения уже сделаны.  
  
 Если приложение использует типизированный набор данных, можно создавать строго типизированные обработчики событий.  Это добавит четыре дополнительных типизированных события, для которых можно создать обработчики; `dataTableNameRowChanging`, `dataTableNameRowChanged`, `dataTableNameRowDeleting` и `dataTableNameRowDeleted`.  Эти обработчики типизированных событий передают аргумент, который включает имена столбцов пользовательской таблицы, упрощающий написание и чтение кода.  
  
## События обновления данных  
  
|Событие|Описание|  
|-------------|--------------|  
|<xref:System.Data.DataTable.ColumnChanging>|Значение в столбце изменяется.  Событие передает строку и столбец, а также предлагаемое новое значение.|  
|<xref:System.Data.DataTable.ColumnChanged>|Значение в столбце изменено.  Событие передает строку и столбец, а также предлагаемое значение.|  
|<xref:System.Data.DataTable.RowChanging>|Изменения, внесенные в объект <xref:System.Data.DataRow>, будут зафиксированы в наборе данных.  Если метод <xref:System.Data.DataRow.BeginEdit%2A> не вызывался, событие <xref:System.Data.DataTable.RowChanging> инициируется для каждого изменения в столбце сразу после инициирования события <xref:System.Data.DataTable.ColumnChanging>.  Если же метод <xref:System.Data.DataRow.BeginEdit%2A> вызывался до внесения изменений, событие <xref:System.Data.DataTable.RowChanging> инициируется только при вызове метода <xref:System.Data.DataRow.EndEdit%2A>.<br /><br /> Событие передает строку и значение, указывающее, какое действие выполняется \(изменение, вставка и т. д.\).|  
|<xref:System.Data.DataTable.RowChanged>|Строка изменена.  Событие передает строку и значение, указывающее, какое действие выполняется \(изменение, вставка и т. д.\).|  
|<xref:System.Data.DataTable.RowDeleting>|Строка удаляется.  Событие передает строку и значение, указывающее, какое действие выполняется \(удаление\).|  
|<xref:System.Data.DataTable.RowDeleted>|Строка удалена.  Событие передает строку и значение, указывающее, какое действие выполняется \(удаление\).|  
  
 События <xref:System.Data.DataTable.ColumnChanging>, <xref:System.Data.DataTable.RowChanging> и <xref:System.Data.DataTable.RowDeleting> вызываются во время процесса обновления.  Эти события могут быть использованы для проверки данных или выполнения других операций по обработке данных.  Поскольку обновления выполняются во время работы этих событий, можно отменить обновление с помощью создания исключения, что не позволит изменениям выполниться до конца.  
  
 События <xref:System.Data.DataTable.ColumnChanged>, <xref:System.Data.DataTable.RowChanged> и <xref:System.Data.DataTable.RowDeleted> являются уведомляющими событиями, инициируемыми после успешного окончания обновления.  Эти события очень полезны, если в дальнейшем требуется продолжать работу, используя выполненное обновление.  
  
## См. также  
 [Создание и изменение типизированных наборов данных](../data-tools/creating-and-editing-typed-datasets.md)   
 [Практическое руководство. Подключение к данным в базе данных](../data-tools/how-to-connect-to-data-in-a-database.md)   
 [Практическое руководство. Проверка данных элемента управления DataGridView в Windows Forms](../Topic/How%20to:%20Validate%20Data%20in%20the%20Windows%20Forms%20DataGridView%20Control.md)   
 [Практическое руководство. Отображение значков ошибок при проверке введенных в форму данных с помощью компонента ErrorProvider в Windows Forms](../Topic/How%20to:%20Display%20Error%20Icons%20for%20Form%20Validation%20with%20the%20Windows%20Forms%20ErrorProvider%20Component.md)