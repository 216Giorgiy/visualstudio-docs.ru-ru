---
title: "Пошаговое руководство. Создание адаптера таблицы с несколькими запросами | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "данные [Visual Studio], адаптеры таблиц TableAdapter"
  - "данные [Visual Studio], пошаговые руководства"
  - "запросы [Visual Studio], адаптеры таблиц TableAdapter"
  - "запросы TableAdapter, создание"
  - "адаптеры таблиц TableAdapter, создание"
ms.assetid: f784dc4d-d514-4ade-8226-f8271c5b1ed8
caps.latest.revision: 18
caps.handback.revision: 18
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
robots: noindex,nofollow
---
# Пошаговое руководство. Создание адаптера таблицы с несколькими запросами
В данном пошаговом руководстве вы создадите адаптер таблицы в наборе данных с помощью [мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png).  В данном пошаговом руководстве рассматривается процесс создания второго запроса в [Адаптере таблицы](../data-tools/tableadapter-overview.md) с использованием [мастер настройки запроса TableAdapter](../data-tools/editing-tableadapters.md) в [Конструкторе наборов данных](../data-tools/creating-and-editing-typed-datasets.md).  
  
 В данном пошаговом руководстве представлены следующие задачи.  
  
-   Создание нового проекта **Приложение Windows**.  
  
-   Создание и настройка источника данных в приложении посредством формирования набора данных с помощью **Мастера настройки источника данных**.  
  
-   Открытие нового набора данных в **Конструкторе наборов данных**.  
  
-   Добавление запросов в адаптер таблицы с помощью **Мастера настройки запроса адаптера таблицы**.  
  
## Обязательные компоненты  
 Для выполнения данного пошагового руководства требуется:  
  
-   Доступ к учебной базе данных "Борей" \(версия SQL Server или Access\).  Для получения дополнительной информации см. [Практическое руководство. Установка образцов баз данных](../data-tools/how-to-install-sample-databases.md).  
  
## Создание нового приложения Windows  
 Первым шагом является создание приложения Windows.  
  
#### Порядок создания нового проекта приложения Windows  
  
1.  В меню **Файл** [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] создайте новый проект.  
  
2.  Выберите язык программирования в области **Типы проектов**.  
  
3.  Щелкните **Приложение Windows** в области **Шаблоны**.  
  
4.  Присвойте проекту имя `TableAdapterQueriesWalkthrough` и нажмите кнопку **ОК**.  
  
     Visual Studio добавляет проект в **Обозреватель решений** и отображает новую форму в конструкторе.  
  
## Создание источника данных в виде базы данных с помощью адаптера таблицы  
 В этом шаге **Мастер настройки источника данных** используется для создания источника данных на основе таблицы `Customers` в учебной базе данных "Борей".  Для создания подключения необходимо иметь доступ к учебной базе данных "Борей".  Дополнительные сведения о настройке учебной базы данных "Борей" см. в разделе [Практическое руководство. Установка образцов баз данных](../data-tools/how-to-install-sample-databases.md).  
  
#### Создание источника данных  
  
1.  В меню **Данные** выберите команду **Показать источники данных**.  
  
2.  В окне **Источники данных** выберите **Добавить новый источник данных**, чтобы запустить **Мастер настройки источника данных**.  
  
3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.  
  
4.  На странице **Выбор подключения к базе данных** выполните одно из следующих действий.  
  
    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.  
  
         \-или\-  
  
    -   Выберите **Новое подключение** для открытия диалогового окна **Добавить\/изменить подключение**.  
  
5.  Если базе данных требуется пароль, выберите параметр для включения конфиденциальных данных и щелкните **Далее**.  
  
6.  На странице **Сохранение подключения в файле конфигурации приложения** нажмите кнопку **Далее**.  
  
7.  Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.  
  
8.  Выберите таблицу **Клиенты** и нажмите **Готово**.  
  
     Объект **NorthwindDataSet** добавляется в проект, и таблица **Клиенты** отображается в окне **Источники данных**.  
  
## Открытие набора данных в Конструкторе наборов данных  
  
#### Порядок открытия набора данных в Конструкторе наборов данных  
  
1.  Щелкните правой кнопкой мыши **NorthwindDataset** в окне **Источники данных**.  
  
2.  В контекстном меню выберите **Изменить набор данных в конструкторе**.  
  
     NorthwindDataset открывается в **Конструкторе наборов данных**.  
  
## Добавление второго запроса в CustomersTableAdapter  
 Мастер создал набор данных с помощью таблицы данных **Клиенты** и **CustomersTableAdapter**.  В этом разделе пошагового руководства осуществляется добавление второго запроса в **CustomersTableAdapter**.  
  
#### Порядок добавления запроса в CustomersTableAdapter  
  
1.  Перетащите **Запрос** со вкладки **Набор данных Области элементов** на таблицу **Клиенты**.  
  
     Открывается [мастер настройки запроса TableAdapter](../data-tools/editing-tableadapters.md).  
  
2.  Выберите **Использовать инструкции SQL** и нажмите кнопку **Далее**.  
  
3.  Выберите **Инструкция SELECT, возвращающая строки** и нажмите кнопку **Далее**.  
  
4.  Добавьте в запрос предложение WHERE, чтобы он имел следующий вид:  
  
    ```  
    SELECT CustomerID, CompanyName, ContactName, ContactTitle, Address, City, Region, PostalCode, Country, Phone, Fax   
    FROM Customers   
    WHERE City = @City  
    ```  
  
    > [!NOTE]
    >  Если вы используете версию базы данных "Борей" для Access, замените параметр @City вопросительным знаком.  \(`SELECT CustomerID, CompanyName, ContactName, ContactTitle, Address, City, Region, PostalCode, Country, Phone, Fax FROM Customers WHERE City = ?`\)  
  
5.  На странице **Выбор методов для автоматического создания** присвойте методу **Заполнить таблицу данных \(DataTable\)** имя `FillByCity`.  
  
    > [!NOTE]
    >  Метод **Вернуть таблицу данных \(DataTable\)** в данном пошаговом руководстве не используется, поэтому вы можете снять этот флажок или оставить имя по умолчанию.  
  
6.  Нажмите кнопку **Далее** и завершите работу мастера.  
  
     Запрос **FillByCity** добавляется в **CustomersTableAdapter**.  
  
## Добавление кода для выполнения дополнительного запроса на форме  
  
#### Порядок выполнения запроса  
  
1.  Выберите **Form1** в **Обозревателе решений** и щелкните **Открыть в конструкторе**.  
  
2.  Перетащите узел **Клиенты** из окна **Источники данных** на **Form1**.  
  
3.  Переключитесь в представление кода, выбрав **Код** в меню **Вид**.  
  
4.  Замените код в обработчике событий `Form1_Load` на следующий код для выполнения запроса `FillByCity`:  
  
     [!CODE [VbRaddataTableAdapters#1](../CodeSnippet/VS_Snippets_VBCSharp/VbRaddataTableAdapters#1)]  
  
## Запуск приложения  
  
#### Запуск приложения  
  
-   Нажмите клавишу F5.  
  
-   Сетка заполняется клиентами, у которых `City` имеет значение `Seattle`.  
  
## Следующие действия  
  
### Добавление функциональности в приложение  
  
-   Добавьте элементы управления <xref:System.Windows.Forms.TextBox> и <xref:System.Windows.Forms.Button> и передайте значение из текстового поля в запрос.  \(`CustomersTableAdapter.FillByCity(NorthwindDataSet.Customers, TextBox1.Text)`\).  
  
-   Добавьте логику проверки данных в событие <xref:System.Data.DataTable.ColumnChanging> или <xref:System.Data.DataTable.RowChanging> таблиц данных в наборе данных.  Для получения дополнительной информации см. [Проверка данных в наборах данных](../data-tools/validate-data-in-datasets.md).  
  
## См. также  
 [Общие сведения об адаптере таблиц](../data-tools/tableadapter-overview.md)   
 [Практическое руководство. Создание адаптера таблицы](../data-tools/create-and-configure-tableadapters.md)   
 [Практическое руководство. Создание запросов TableAdapter](../data-tools/how-to-create-tableadapter-queries.md)   
 [Пошаговые руководства работы с данными](../Topic/Data%20Walkthroughs.md)   
 [Подключение к данным в Visual Studio](../data-tools/connecting-to-data-in-visual-studio.md)   
 [Подготовка приложения к получению данных](../Topic/Preparing%20Your%20Application%20to%20Receive%20Data.md)   
 [Выборка данных в приложение](../data-tools/fetching-data-into-your-application.md)   
 [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md)   
 [Редактирование данных в приложении](../data-tools/editing-data-in-your-application.md)