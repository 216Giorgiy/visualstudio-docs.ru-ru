---
title: "Работа с наборами данных в Visual Studio | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vs.data.DataSet"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "кэш [Visual Studio], наборы данных"
  - "учет регистра, наборы данных"
  - "дочерние записи"
  - "ограничения [Visual Basic], наборы данных"
  - "текущая запись в наборе данных"
  - "адаптеры данных, заполнение наборов данных"
  - "кэширование данных, наборы данных"
  - "отношения между данными"
  - "базы данных [Visual Basic], обновление"
  - "DataRelation - объект, наборы данных"
  - "DataSet - класс"
  - "DataSet - класс, сведения о наборах данных"
  - "наборы данных [Visual Basic]"
  - "наборы данных [Visual Basic], расширенные свойства"
  - "наборы данных [Visual Basic], заполнение"
  - "наборы данных [Visual Basic], msprop"
  - "наборы данных [Visual Basic], namespace"
  - "наборы данных [Visual Basic], заполнение"
  - "наборы данных [Visual Basic], связи"
  - "расширенные свойства, в типизированных наборах данных"
  - "внешние ключи, наборы данных"
  - "главные и подчиненные таблицы, наборы данных"
  - "msprop"
  - "родительские записи в наборе данных"
  - "связанные таблицы"
  - "связанные таблицы, наборы данных"
  - "связи, наборы данных"
  - "схемы [Visual Basic], наборы данных"
  - "типизированные наборы данных"
  - "типизированные наборы данных, в сравнении с нетипизированными наборами данных"
  - "уникальные ограничения (наборы данных)"
  - "нетипизированные наборы данных"
  - "нетипизированные наборы данных, в сравнении с типизированными наборами данных"
  - "обновление наборов данных, сведения об обновлении набора данных"
  - "XML [Visual Basic], наборы данных"
  - "схемы XML, сведения о схемах XML и наборах данных"
ms.assetid: ee57f4f6-9fe1-4e0a-be9a-955c486ff427
caps.latest.revision: 49
caps.handback.revision: 25
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Работа с наборами данных в Visual Studio
Наборы данных представляют собой объекты, содержащие таблицы данных, в которых можно временно хранить данные для их использования в приложении.  Если ваше приложение требует работы с данными, можно загрузить их в набор данных. Данные для работы приложения в этом случае будут храниться в локальной памяти.  Можно работать с данными в наборе данных, даже если приложение отключается от базы данных.  Набор данных хранит информацию об изменениях своих данных. Так что обновления можно отслеживать и отправлять обратно в базу данных, когда ваше приложение вновь подключится к ней.  
  
 В следующих разделах содержатся сведения о работе с наборами данных в Visual Studio:  
  
|Раздел|Описание|  
|------------|--------------|  
|[Создание и изменение типизированных наборов данных](../data-tools/creating-and-editing-typed-datasets.md)|Предоставляет описание средств разработки для создания наборов данных.|  
|[Практическое руководство. Создание типизированного набора данных](../data-tools/create-and-configure-datasets-in-visual-studio.md)|Описывает способы создания типизированного набора данных с помощью средств разработки в [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].|  
|[Практическое руководство. Расширение функциональных возможностей набора данных](../Topic/How%20to:%20Extend%20the%20Functionality%20of%20a%20Dataset.md)|Предоставляет пошаговые инструкции по созданию разделяемого класса для набора данных, где можно добавить код в дополнение к коду, сгенерированному конструктором.|  
|[Практическое руководство. Открытие набора данных в конструкторе наборов данных](../Topic/How%20to:%20Open%20a%20Dataset%20in%20the%20Dataset%20Designer.md)|Объясняет способы открытия наборов данных из окна **Источники данных** и **Обозреватель решений**.|  
|[Практическое руководство. Редактирование набора данных](../Topic/How%20to:%20Edit%20a%20Dataset.md)|Рассматривает способы редактирования объектов в наборе данных с помощью **Конструктора наборов данных**.|  
|[Пошаговое руководство. Создание набора данных с помощью конструктора наборов данных](../data-tools/walkthrough-creating-a-dataset-with-the-dataset-designer.md)|Предоставляет пошаговые инструкции по созданию типизированного набора данных без использования **Мастера настройки источника данных**.|  
|[Разработка объектов DataTable](../data-tools/designing-datatables.md)|Предоставляет ссылки на разделы, в которых объясняется, как создавать и редактировать таблицы данных с помощью средств разработки.|  
|[Отношения в наборах данных](../data-tools/relationships-in-datasets.md)|Предоставляет ссылки на разделы, в которых объясняется, как создавать и редактировать отношения с помощью средств разработки.|  
|[адаптеры таблиц TableAdapter](../Topic/TableAdapters.md)|Предоставляет ссылки на разделы, в которых объясняется, как создавать и редактировать адаптеры таблиц с помощью средств разработки.|  
|[Работа с наборами данных в N\-уровневых приложениях](../data-tools/work-with-datasets-in-n-tier-applications.md)|Описание многоуровневых приложений и функций, доступных в этих приложениях для работы с наборами данных.|  
  
 Структура <xref:System.Data.DataSet> схожа со структурой реляционной базы данных; она предоставляет собой иерархическую объектную модель таблиц, строк, столбцов, ограничений и связей.  
  
 Наборы данных могут быть типизированными или нетипизированными.  \(Дополнительную информацию см. ниже в разделе "Типизированные и нетипизированные наборы данных".\) Типизированные наборы данных получают свою схему \(таблицу и структуру столбцов\) из файлов XSD и проще программируются.  В своих приложениях можно использовать как типизированные, так и нетипизированные наборы данных.  Однако для поддержки типизированных наборов данных в Visual Studio предусмотрено больше инструментов, которые упрощают процесс программирования наборов данных и уменьшают вероятность возникновения ошибки.  
  
 Создать типизированный набор данных можно, запустив мастер [мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png), или путем добавления элемента  DataSet с помощью **команды "Добавить новый элемент"**  в меню "Проект".  Дополнительные сведения см. в разделе [Практическое руководство. Создание типизированного набора данных](../data-tools/create-and-configure-datasets-in-visual-studio.md).  
  
 Создать нетипизированный набор данных можно, перетаскивая элементы объекта DataSet **из панели элементов на** [Windows Forms Designer](http://msdn.microsoft.com/ru-ru/3c3d61f8-f36c-4d41-b9c3-398376fabb15) или [Component Designer](../Topic/Component%20Designer.md).  
  
 После создания набора данных его можно редактировать в [Создание и изменение типизированных наборов данных](../data-tools/creating-and-editing-typed-datasets.md).  
  
 Создавать типизированные и нетипизированные наборы данных и работать с ними можно с помощью следующих разделов [!INCLUDE[dnprdnshort](../code-quality/includes/dnprdnshort_md.md)] пространства имен:  
  
 ![Пространство имен Dataset системы данных](../data-tools/media/vbdatasetnamspace.png "vbDataSetNamspace")  
Наборы данных находятся в пространстве имен System.Data  
  
 Объекты набора данных доступны разработчику посредством стандартных программных конструкций, таких как свойства и коллекции.  Примеры.  
  
-   Класс <xref:System.Data.DataSet> содержит коллекцию таблиц данных <xref:System.Data.DataTableCollection> и <xref:System.Data.DataRelationCollection>, а также коллекцию объектов <xref:System.Data.DataRelation>.  
  
-   Класс<xref:System.Data.DataTable> включает коллекцию строк таблицы <xref:System.Data.DataRowCollection>, коллекцию столбцов таблицы и <xref:System.Data.DataColumnCollection> и коллекции отношений <xref:System.Data.DataTable.ChildRelations%2A> и <xref:System.Data.DataTable.ParentRelations%2A>.  
  
-   Класс <xref:System.Data.DataRow> содержит свойство <xref:System.Data.DataRow.RowState%2A>, показывающее, изменилась ли строка с момента первой ее загрузки из базы данных и как.  Возможны следующие значения свойства <xref:System.Data.DataRow.RowState%2A>: <xref:System.Data.DataRowState>, <xref:System.Data.DataRowState> <xref:System.Data.DataRowState> и <xref:System.Data.DataRowState>.  
  
## Заполнение набора данных  
 По умолчанию набор данных не содержит данных.  Заполнение набора данных фактически означает загрузку данных в отдельные объекты<xref:System.Data.DataTable>, составляющие набор данных.  Таблицы данных заполняются путем выполнения запросов адаптера таблиц или выполнением команд адаптера данных \(например <xref:System.Data.SqlClient.SqlDataAdapter>\).  При заполнении набора данных возникают различные события, проверяются ограничения, и т. д.  Дополнительные сведения о загрузке данных в набор данных содержатся в разделе [Выборка данных в приложение](../data-tools/fetching-data-into-your-application.md).  
  
 Код для заполнения набора данных автоматически добавляется в обработчик событий загрузки формы при перетаскивании элементов из [окно "Источники данных"](../Topic/Data%20Sources%20Window.md) на форму в приложении Windows.  Для получения дополнительных сведений выполните следующий пример: [Пошаговое руководство. Отображение данных на форме в приложении Windows](../data-tools/walkthrough-displaying-data-on-a-windows-form.md).  
  
 Пример заполнения набора данных с помощью адаптера таблиц  
  
 [!CODE [VbRaddataDatasets#1](../CodeSnippet/VS_Snippets_VBCSharp/VbRaddataDatasets#1)]  
  
 Заполнять наборы данных можно различными способами:  
  
-   Если вы создали набор данных с использованием средств проектирования, например с помощью мастера данных, вызовите метод `Fill` адаптера таблиц.  \(Адаптеры таблиц создаются при помощи используемого по умолчанию метода `Fill`, но у вас есть возможность изменить имя метода, поэтому фактическое имя может быть иным.\) Для получения дополнительных сведений см. "Заполнение набора данных с использованием адаптеров таблиц", раздел в [Практическое руководство. Заполнение данными набора данных](../data-tools/how-to-fill-a-dataset-with-data.md).  
  
-   Вызовите метод `Fill` объекта <xref:System.Data.Common.DataAdapter>.  Дополнительные сведения см. в разделе [Заполнение DataSet из адаптера данных DataAdapter](../Topic/Populating%20a%20DataSet%20from%20a%20DataAdapter.md).  
  
-   Вручную таблицы набора данных можно заполнить, создавая объекты <xref:System.Data.DataRow> и добавляя их в коллекцию таблицы <xref:System.Data.DataRowCollection>.  \(Это можно делать только во время выполнения программы; во время разработки задавать элементы коллекции <xref:System.Data.DataRowCollection> нельзя.\) Дополнительные сведения см. в разделе [Добавление данных в DataTable](../Topic/Adding%20Data%20to%20a%20DataTable.md).  
  
-   Считывание XML\-документа или потока в набор данных.  Дополнительные сведения см. в описании метода <xref:System.Data.DataSet.ReadXml%2A>.  Пример см. в разделе [Пошаговое руководство. Считывание XML\-данных в набор данных](../data-tools/read-xml-data-into-a-dataset.md).  
  
-   Слияние \(копирование\) содержимое одного набора данных с другим.  Данный сценарий полезен тогда, когда приложение получает наборы данных из различных источников \(например из различных веб\-служб XML\), но при этом требуется объединить их в один набор данных.  Дополнительные сведения см. в разделе [Объединение содержимого DataSet](../Topic/Merging%20DataSet%20Contents.md).  
  
-   Слияние \(копирование\) содержимого одной таблицы <xref:System.Data.DataTable> с другой.  
  
## Сохранение данных из набора данных обратно в базу данных  
 При внесении изменений в записи набора данных эти изменения должны быть записаны в базу данных.  Для записи изменений из набора данных в базу данных необходимо вызвать метод `Update` адаптера таблицы или адаптера данных<xref:System.Data.Common.DataAdapter>, который выполняет обмен данными между набором данных и соответствующей базой данных.  
  
 При использовании средств проектирования работы с данными в Visual Studio пересылайте данные обратно в базу данных с помощью метода Update объекта адаптера таблиц для сохраняемых таблиц данных.  Примеры.  
  
 [!CODE [VbRaddataDatasets#2](../CodeSnippet/VS_Snippets_VBCSharp/VbRaddataDatasets#2)]  
  
 Для более четкого управления процессом обновления вызовите один из методов DBDirect адаптера таблиц, с помощью которого можно передать отдельные значения для каждой строки данных.  Дополнительные сведения см. в разделах [Практическое руководство. Обновление данных с помощью адаптера таблицы](../data-tools/update-data-by-using-a-tableadapter.md) и [Пошаговое руководство. Сохранение данных с помощью методов DBDirect адаптера таблицы](../data-tools/save-data-with-the-tableadapter-dbdirect-methods.md).  
  
 Класс  <xref:System.Data.DataRow>, используемый для работы с отдельными записями, содержит свойство <xref:System.Data.DataRow.RowState%2A>, значение которого указывает, была ли изменена строка с момента первой загрузки таблицы из базы данных.  Возможные значения — [, F:System.Data.DataRowState.Deleted и](assetId:///, F:System.Data.DataRowState.Deleted и?qualifyHint=False&autoUpgrade=True), <xref:System.Data.DataRowState>, <xref:System.Data.DataRowState>, и <xref:System.Data.DataRowState>.  Методы обновления `Update` адаптера таблиц и адаптера данных <xref:System.Data.Common.DataAdapter> проверяют значение свойства <xref:System.Data.DataRow.RowState%2A>, чтобы определить, какие записи необходимо записать в базу данных и какие конкретно команды указанной базы данных \(`InsertCommand`, `UpdateCommand` и `DeleteCommand`\) должны вызываться.  
  
 Дополнительные сведения об обновлении данных см. в разделе [Сохранение данных](../data-tools/saving-data.md).  
  
## Навигация по записям в наборах данных  
 Так как наборы данных представляют собой полностью отсоединенные от базы данных контейнеры данных, то они \(в отличие от наборов записей ADO\) не поддерживают понятие текущей записи.  Вместо этого доступны все записи в наборе DataSet в любой момент.  
  
 Так как не существует текущей записи, то не существует и специального свойства, которое бы указывало на текущую запись, а также методов и свойств для перемещения от одной записи к другой \(см. замечание ниже\).  Можно осуществлять доступ к отдельным таблицам из набора данных как к объектам; каждая таблица представляет собой коллекцию строк.  С ней можно работать как с любой другой коллекцией, т. е. обращаться к строкам с помощью индексов коллекции или операторов, определенных для коллекций в используемом языке программирования.  
  
 Например, можно получить четвертую строку таблицы `Customers` с помощью следующего кода:  
  
 [!CODE [VbRaddataDatasets#3](../CodeSnippet/VS_Snippets_VBCSharp/VbRaddataDatasets#3)]  
  
> [!NOTE]
>  При привязке элементов управления на форме к набору данных, можно использовать компонент <xref:System.Windows.Forms.BindingNavigator> для упрощения доступа к отдельным записям.  Дополнительные сведения см. в разделе [Практическое руководство. Навигация по набору данных, отображаемых в форме Windows Forms](../Topic/How%20to:%20Navigate%20Data%20in%20Windows%20Forms.md).  
  
## LINQ to DataSet  
 [!INCLUDE[linq_dataset](../data-tools/includes/linq_dataset_md.md)] позволяет использовать запрос [LINQ \(Language\-Integrated Query\)](../Topic/LINQ%20\(Language-Integrated%20Query\).md) для данных в объекте <xref:System.Data.DataSet>.  Дополнительные сведения см. в разделе [LINQ to DataSet](../Topic/LINQ%20to%20DataSet.md).  
  
## Наборы данных и XML  
 Набор данных – это реляционное представление данных, которое в свою очередь может быть представлено в виде XML.  Тесная связь между наборами данных и XML позволяет получить следующие преимущества:  
  
-   Структура набора данных – его таблицы, столбцы, отношения и ограничения – может быть определена в виде схемы XML.  Наборы данных могут читать и записывать схемы, хранящие структурированную информацию, с помощью методов<xref:System.Data.DataSet.ReadXmlSchema%2A> и <xref:System.Data.DataSet.WriteXmlSchema%2A>.  Если нет доступной схемы, набор данных может попробовать получить такую \(с помощью своего метода <xref:System.Data.DataSet.InferXmlSchema%2A>\) из данных в XML\-документе, имеющем реляционную структуру.  Дополнительные сведения о схемах XML см. [Построение XML\-схем](../Topic/Building%20XML%20Schemas.md).  
  
-   Можно создать класс набора данных, включающий в себя информацию о схеме, для определения структуры данных.  Такой класс называется *типизированным* набором данных.  Сведения о создании типизированных наборов данных содержатся в разделе [Практическое руководство. Создание типизированного набора данных](../data-tools/create-and-configure-datasets-in-visual-studio.md).  
  
-   Можно прочесть документ или поток XML в набор данных с помощью метода <xref:System.Data.DataSet.ReadXml%2A> набора данных и записать набор данных в виде XML с помощью метода <xref:System.Data.DataSet.WriteXml%2A>.  Так как XML – это стандартный формат обмена данными между приложениями, то это означает, что можно загрузить набор данных XML\-форматированными данными, полученными от других приложений.  Аналогичным образом набор данных может сохранить свои данные в виде XML\-потока или документа для того, чтобы предоставить их другим приложениям для совместного использования, или просто для того, чтобы сохранить данные в стандартном формате.  
  
-   Можно создать XML\-представление \(объект <xref:System.Xml.XmlDataDocument>\) содержимого набора данных или таблиц данных, а затем просматривать и обрабатывать данные, используя как реляционные методы \(набора данных\), так и методы работы с XML.  Оба представления автоматически синхронизируются при их изменении.  
  
## Сравнение типизированных и нетипизированных наборов данных  
 Типизированный набор данных извлекается из базового класса <xref:System.Data.DataSet> и затем использует сведения из **Конструктора наборов данных**, которые хранятся в XSD\-файле, для создания нового строго типизированного класса набора данных.  Сведения, указанные в схеме \(таблицы, столбцы и т. д.\), создаются и компилируются в этот новый класс набора данных как набор объектов и свойств первичного класса.  Так как типизированные наборы данных наследуются от базового класса <xref:System.Data.DataSet>, типизированный класс обладает всеми функциональными возможностями класса <xref:System.Data.DataSet> и может использоваться с методами, принимающими экземпляр класса <xref:System.Data.DataSet> в качестве параметра.  
  
 Нетипизированный набор данных, в отличие от типизированного, не имеет соответствующей встроенной схемы.  Как и типизированный набор данных, нетипизированный набор содержит такие структуры, как таблицы, столбцы и др., однако они доступны только как коллекции.  \(Однако после создания вручную таблиц и других элементов данных нетипизированного набора данных можно экспортировать структуру набора данных в качестве схемы с помощью метода <xref:System.Data.DataSet.WriteXmlSchema%2A> набора данных.\)  
  
### Доступ к данным в типизированных и нетипизированных наборах данных  
 Класс для типизированного набора данных имеет объектную модель, в которой его свойства принимают действительные имена таблиц и столбцов.  Например, при работе с типизированными наборами данных можно ссылаться на столбцы с помощью следующего кода:  
  
 [!CODE [VbRaddataDatasets#4](../CodeSnippet/VS_Snippets_VBCSharp/VbRaddataDatasets#4)]  
  
 В то же время при работе с нетипизированным набором данных эквивалентный код будет выглядеть так:  
  
 [!CODE [VbRaddataDatasets#5](../CodeSnippet/VS_Snippets_VBCSharp/VbRaddataDatasets#5)]  
  
 Типизированный доступ не только отличается большей удобочитаемостью, но и полностью поддерживается технологией IntelliSense в [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] **Редакторе кода**.  Помимо того, что с таким кодом проще работать, синтаксис для типизированного набора данных позволяет проверять типы во время компиляции, что существенно уменьшает вероятность ошибок при присвоении значений элементам набора данных.  Если изменить имя столбца в <xref:System.Data.DataSet> и затем скомпилировать приложение, будет получена ошибка построения.  Двойным щелчком клавишей мыши по ошибке построения в **Списке задач** можно перейти непосредственно к строке\(\-ам\) кода, ссылающейся на старое имя столбца.  Кроме того, доступ к таблицам и столбцам в типизированном наборе данных во время выполнения происходит несколько быстрее, так как доступ определяется на этапе компиляции, а не с помощью коллекций во время выполнения.  
  
 Хотя типизированные наборы данных обладают рядом преимуществ, во многих случаях целесообразно применять нетипизированные наборы.  Самый очевидный сценарий – когда для набора данных нет доступной схемы.  Такое может произойти, например, если приложение взаимодействует с компонентом, который возвращает набор данных, но при этом его структура заранее не известна.  Иногда приходится работать с данными, не имеющими статической предопределенной структуры; в этом случае работать с типизированным набором данных нецелесообразно, так как приходится заново создавать класс типизированного набора данных при каждом изменении структуры данных.  
  
 Довольно часто приходится создавать наборы данных динамически, не имея доступной схемы.  В этом случае набор данных является просто удобной структурой, в которой можно хранить данные до тех пор, пока они не будут представлены в виде реляционной структуры.  В то же время можно использовать такие дополнительные возможности набора данных, как сериализация данных для передачи их в другой процесс или для сохранения в виде XML\-файла.  
  
## Зависимость от регистра в наборе данных  
 По умолчанию имена таблиц и столбцов в наборе данных не зависят от регистра. Это означает, что к таблице Customers в наборе данных можно также обратиться и по имени customers. Такой подход соответствует соглашениям о присвоении имен, принятым во многих СУБД, включая SQL Server, где имена элементов данных не должны отличаться друг от друга только регистром букв.  
  
> [!NOTE]
>  В отличие от наборов данных, XML\-документы зависят от регистра, следовательно, имена элементов данных, определенные в схемах, также зависят от регистра.  Например, протокол схемы позволяет определить одну таблицу как "Customers", а другую таблицу как "customers". Это может привести к конфликту имен, если для создания набора данных используется схема, содержащая элементы, различающиеся только регистром.  
  
 Однако чувствительность к регистру может быть фактором, определяющим способ интерпретации данных в наборе.  Например, при фильтрации данных в таблице набора данных критерий поиска может возвращать различные результаты в зависимости от того, учитывается при сравнении регистр или нет.  Можно управлять чувствительностью к регистру при фильтрации, поиске и сортировке, устанавливая свойство <xref:System.Data.DataSet.CaseSensitive%2A> набора данных.  По умолчанию все таблицы набора данных наследуют это свойство.  \(Можно переопределить это свойство для каждой отдельной таблицы, установив свойство <xref:System.Data.DataTable.CaseSensitive%2A> таблицы.\)  
  
## Связанные таблицы и объекты DataRelation  
 Если в наборе данных имеется несколько таблиц, то данные, содержащиеся в них, могут быть взаимосвязаны.  Набор данных не имеет встроенных сведений о таких отношениях, поэтому для работы с данными в связанных таблицах необходимо создать объекты <xref:System.Data.DataRelation>, которые описывают отношения между таблицами в наборе данных.  Дополнительные сведения см. в разделе [Практическое руководство. Получение доступа к записям в связанных объектах DataTable](../Topic/How%20to:%20Access%20Records%20in%20Related%20DataTables.md).  Объекты <xref:System.Data.DataRelation> могут использоваться для программного извлечения дочерних записей для указанной родительской и наоборот.  Дополнительные сведения см. в разделе [Отношения в наборах данных](../data-tools/relationships-in-datasets.md).  Если база данных содержит отношения между двумя и более таблицами, средства разработки автоматически создадут объекты <xref:System.Data.DataRelation>.  
  
 Пусть, например, данные о клиентах и заказах организованы так, как в базе данных Northwind.  Таблица `Customers` может содержать записи следующего вида:  
  
```  
CustomerID   CompanyName               City  
ALFKI        Alfreds Futterkiste       Berlin  
ANTON        Antonio Moreno Taquerias  Mexico D.F.  
AROUT        Around the Horn           London  
```  
  
 Набор данных может также содержать другую таблицу, содержащую сведения о заказах.  В таблице `Orders` столбец "Идентификатор заказчика" является внешним ключом.  Если выбрать лишь несколько столбцов из таблицы `Orders`, можно получить следующее:  
  
```  
OrderId    CustomerID    OrderDate  
10692      ALFKI         10/03/1997  
10702      ALFKI         10/13/1997  
10365      ANTON         11/27/1996  
10507      ANTON         4/15/1997  
```  
  
 Так как каждый клиент может сделать более одного заказа, то связь между клиентами и заказами будет иметь тип "один\-ко\-многим".  Например, в приведенной выше таблице клиент ALFKI имеет два заказа.  
  
 Можно использовать объект <xref:System.Data.DataRelation> для получения связанных записей из дочерней или родительской таблицы.  Например, при работе с записью, описывающей клиента ANTON, можно получить коллекцию записей, описывающих сделанные им заказы.  Дополнительные сведения см. в разделе <xref:System.Data.DataRow.GetChildRows%2A>.  Аналогичным образом, при работе с дочерней записью, описывающей заказ с кодом 10507, можно с помощью объекта отношения добраться до родительской записи клиента с кодом ANTON.  Дополнительные сведения см. в разделе <xref:System.Data.DataRow.GetParentRow%2A>.  
  
## Ограничения  
 Как и в большинстве баз данных, наборы данных поддерживают ограничения в качестве способа обеспечения целостности данных.  Ограничения представляют собой правила, применяемые при вставке, обновлении или удалении строк, содержащихся в таблице.  Можно определить два типа ограничений:  
  
-   *Уникальное* ограничение: новые значения в столбце должны быть уникальными в пределах таблицы.  
  
-   Ограничение  *внешнего ключа*, которое определяет правила обновления дочерних записей в связанной таблице при обновлении или удалении соответствующих записей в основной таблице.  Например, ограничение внешнего ключа проверяет существование родительской записи перед разрешением на создание любых дочерних записей.  
  
 В наборе данных ограничения ассоциируются с отдельными таблицами \(ограничения внешнего ключа\) или столбцами \(ограничение уникальности, гарантирующее уникальность значений в столбце\).  Ограничения реализуются как объекты типа <xref:System.Data.UniqueConstraint> или <xref:System.Data.ForeignKeyConstraint>.  Затем они добавляются к коллекции <xref:System.Data.DataTable.Constraints%2A> объекта класса <xref:System.Data.DataTable>.  Ограничение уникальности можно указать, установив свойство <xref:System.Data.DataColumn.Unique%2A> объекта класса <xref:System.Data.DataColumn>в `true`.  
  
 Набор данных сам по себе поддерживает свойство <xref:System.Data.DataSet.EnforceConstraints%2A> булева типа, которое указывает, требуется ли выполнять ограничение.  По умолчанию для свойства задано значение `true`.  Однако бывают случаи, когда целесообразно временно отключить ограничения.  Чаще всего это происходит при изменении записи таким образом, что на некоторое время возникает недопустимое состояние.  После того как все изменения будут внесены \(следовательно, состояние снова станет допустимым\), ограничения можно опять включить.  
  
 В [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] ограничения создаются неявно при определении набора данных.  При добавлении к набору данных первичного ключа неявно создается ограничение уникальности для столбца первичного ключа.  Можно указать уникальное ограничение для других столбцов, установив их свойство <xref:System.Data.DataColumn.Unique%2A> в `true`.  
  
 Ограничения по внешнему ключу создаются созданием объекта <xref:System.Data.DataRelation> в наборе данных.   Объект <xref:System.Data.DataRelation> позволяет разработчику не только получать сведения о связанных записях программным путем, но и определять правила ограничений по внешнему ключу.  
  
## Расширенные свойства наборов данных  
 Расширенные свойства предоставляют возможность сопоставления имен при возникновении конфликтов именования в процессе создания набора данных из XSD\-файла.  Если идентификатор в XSD\-файле отличается от имени, созданного генератором набора данных, расширенное свойство добавляется к набору данных в пространстве имен `msprop`.  В следующей таблице показаны возможные расширенные свойства, которые могут быть сгенерированы:  
  
|Объект.|Расширенное свойство|  
|-------------|--------------------------|  
|<xref:System.Data.DataSet>|msprop:Generator\_UserDSName|  
||msprop:Generator\_DataSetName|  
|<xref:System.Data.DataTable>|msprop:Generator\_UserTableName|  
||msprop:Generator\_TablePropName|  
||msprop:Generator\_TableVarName|  
||msprop:Generator\_TableClassName|  
||msprop:Generator\_RowClassName|  
||msprop:Generator\_RowEvHandlerName|  
||msprop:Generator\_RowEvArgName|  
|<xref:System.Data.DataColumn>|msprop:Generator\_UserColumnName|  
||msprop:Generator\_ColumnPropNameInTable|  
||msprop:Generator\_ColumnPropNameInTable|  
||msprop:Generator\_ColumnPropNameInRow|  
  
## См. также  
 [Подготовка приложения к получению данных](../Topic/Preparing%20Your%20Application%20to%20Receive%20Data.md)   
 [Общие сведения о приложениях для работы с данными в Visual Studio](../data-tools/overview-of-data-applications-in-visual-studio.md)   
 [Подключение к данным в Visual Studio](../data-tools/connecting-to-data-in-visual-studio.md)   
 [Выборка данных в приложение](../data-tools/fetching-data-into-your-application.md)   
 [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md)   
 [Редактирование данных в приложении](../data-tools/editing-data-in-your-application.md)   
 [Проверка данных](../Topic/Validating%20Data.md)   
 [Сохранение данных](../data-tools/saving-data.md)