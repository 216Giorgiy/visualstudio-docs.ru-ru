---
title: Заполнения набора данных с помощью адаптера таблицы
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- datasets [Visual Basic]
- datasets [Visual Basic], loading data
- data retrieval
- retrieving data
- datasets [Visual Basic], filling
- data [Visual Studio], retrieving
- data [Visual Studio], datasets
ms.assetid: 55f3bfbe-db78-4486-add3-c62f49e6b9a0
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-data-tools
ms.workload:
- data-storage
ms.openlocfilehash: 87639a4ebb123415014994dcc1bfa7af1d7fb301
ms.sourcegitcommit: e13e61ddea6032a8282abe16131d9e136a927984
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
---
# <a name="fill-datasets-by-using-tableadapters"></a>Заполнения набора данных с помощью адаптера таблицы
Компонент адаптера таблицы заполняет набор данных данными из базы данных, на основе одного или нескольких запросов или хранимых процедур, указанных вами. Адаптеры таблиц можно также выполнить добавляет, обновления и удаления в базе данных, чтобы сохранить изменения, внесенные в набор данных. Можно также выдать глобальные команды, которые не связаны с любой конкретной таблицы.

> [!NOTE]
>  Адаптеры таблиц TableAdapter создаются конструкторах Visual Studio. Если вы создаете наборы данных программным образом, используйте DataAdapter, который представляет собой класс .NET Framework.

 Подробные сведения об операциях адаптера таблицы можно пропустить непосредственно на один из следующих разделов:

|Раздел|Описание|
|-----------|-----------------|
|[Создание и настройка адаптеров таблиц](../data-tools/create-and-configure-tableadapters.md)|Использование конструкторов для создания и настройки адаптеров таблиц|
|[Создание параметризованных запросов адаптера таблицы](../data-tools/create-parameterized-tableadapter-queries.md)|Как разрешить пользователям аргументы процедуры TableAdapter или запросов|
|[Непосредственный доступ к базе данных с помощью адаптера таблицы](../data-tools/directly-access-the-database-with-a-tableadapter.md)|Как использовать методы Dbdirect адаптеры таблиц TableAdapter|
|[Отключение ограничений при заполнении набора данных](../data-tools/turn-off-constraints-while-filling-a-dataset.md)|Работа с ограничениями внешнего ключа при обновлении данных|
|[Как для расширения функциональных возможностей адаптера таблицы](../data-tools/fill-datasets-by-using-tableadapters.md)|Добавление пользовательского кода для объектов TableAdapter|
|[Считывание XML-данных в набор данных](../data-tools/read-xml-data-into-a-dataset.md)|Работа с XML|

<a name="tableadapter-overview"></a>

## <a name="tableadapter-overview"></a>Общие сведения о TableAdapter
 Адаптеры таблиц TableAdapter, автоматически созданный конструктором компонентов подключения к базе данных, выполнения запросов или хранимых процедур, которые заполнения своей таблицы данных возвращенными данными. Адаптеры таблиц TableAdapter также отправлять обновленные данные из приложения в базе данных. Можно запустить столько запросов требуется в TableAdapter, при условии, что они возвращают данные, которые соответствуют схеме таблицы, с которой связан адаптера таблицы. На следующей диаграмме показан как адаптеры таблиц TableAdapter взаимодействовать с базами данных и других объектов в памяти:

 ![Поток данных в клиентском приложении](../data-tools/media/clientdatadiagram.gif "ClientDataDiagram")

 Если адаптеры таблиц создаются с помощью **конструктора наборов данных**, классы адаптеров таблиц не создаются как вложенные классы <xref:System.Data.DataSet>. Они находятся в отдельных пространствах имен, характерные для каждого набора данных. Например, если у вас есть набор данных с именем `NorthwindDataSet`, адаптеры таблиц, связанных с <xref:System.Data.DataTable>s в `NorthwindDataSet` будут находиться в `NorthwindDataSetTableAdapters` пространства имен. Для программного доступа к конкретному адаптеру таблиц необходимо объявить экземпляр нового адаптера таблицы. Пример:

 [!code-csharp[VbRaddataTableAdapters#7](../data-tools/codesnippet/CSharp/fill-datasets-by-using-tableadapters_1.cs)]
 [!code-vb[VbRaddataTableAdapters#7](../data-tools/codesnippet/VisualBasic/fill-datasets-by-using-tableadapters_1.vb)]

## <a name="associated-datatable-schema"></a>Связанную схему таблицы данных
 При создании адаптера таблицы, начального запроса или хранимой процедуры для определения схемы TableAdapter, связанного с <xref:System.Data.DataTable>. Выполните этот исходный запрос или хранимую процедуру, вызвав его `Fill` метод (который заполняет TableAdapter, связанного с <xref:System.Data.DataTable>). Любые изменения, внесенные в основном запросе TableAdapter, отражаются в схему связанной таблицы данных. Например удаление столбца из основного запроса также удаляется столбец из связанной таблицы данных. Если любые дополнительные запросы адаптера таблицы использует инструкции SQL, возвращающие столбцы, которые не находятся в основном запросе, конструктор пытается синхронизировать изменения столбцов между основным и дополнительных запросов.

## <a name="tableadapter-update-commands"></a>Команды обновления адаптера таблицы
 Возможность обновления адаптера таблицы зависит от того, какой объем данных доступен в основном запросе в мастере адаптера таблицы. Например адаптеры таблиц, настроенные для выборки значений из нескольких таблиц (JOIN), скалярные значения, представления или результаты агрегатных функций изначально создаются с возможностью для отправки обновлений в основную базу данных. Тем не менее, можно настроить вручную в команд INSERT, UPDATE и DELETE **свойства** окна.

## <a name="tableadapter-queries"></a>запросы TableAdapter
 ![TableAdapter с несколькими запросами](../data-tools/media/tableadapter.gif "адаптера таблицы")

 Адаптеры таблиц могут содержать несколько запросов для заполнения связанных таблиц. Можно определить столько запросов для TableAdapter приложения требуется, при условии, что каждый запрос возвращает данные, которые соответствуют по той же схеме, связанную таблицу данных. Эта возможность позволяет адаптера таблицы для загрузки разные результаты на основе различных критериев.

 Например если приложение содержит таблицу с именами клиентов, можно создать запрос, заполняет таблицу с каждого клиента имя, которое начинается с определенных букв, а другой который заполняет таблицу со всех клиентов, расположенных в том же состоянии. Для заполнения `Customers` таблицы с клиентами в заданном состоянии, можно создать `FillByState` запрос, который принимает параметр для значения состояния следующим образом: `SELECT * FROM Customers WHERE State = @State`. Запустите запрос, вызвав `FillByState` метода и передача в значении параметра следующим образом: `CustomerTableAdapter.FillByState("WA")`.

 Помимо добавления запросы, которые возвращают данные из той же схеме, таблицы данных адаптера таблицы, можно добавить запросы, возвращающие скалярные значения (один). Например, запрос, возвращающий число клиентов (`SELECT Count(*) From Customers`) является допустимым для `CustomersTableAdapter,` несмотря на то, что данные, возвращаемые не соответствуют схеме таблицы.

## <a name="clearbeforefill-property"></a>Свойство ClearBeforeFill
 По умолчанию каждый раз при выполнении запроса для заполнения таблицы данных адаптера таблицы, очистить существующие данные и в таблицу загружаются только результаты запроса. Задайте `ClearBeforeFill` свойства `false` следует ли добавлять или объединять данные, возвращенные запросом к существующим данным в таблице данных. Независимо от того, снят ли данные необходимо явно отправлять обновления обратно в базу данных, если вы хотите сохранить их. Поэтому не забудьте сохранить все изменения данных в таблице перед выполнения другого запроса, который заполняет таблицу. Дополнительные сведения см. в разделе [обновления данных с помощью адаптера таблицы](../data-tools/update-data-by-using-a-tableadapter.md).

## <a name="tableadapter-inheritance"></a>Наследование адаптера таблицы
 Адаптеры таблиц TableAdapter расширить функциональные возможности стандартных адаптеров данных, инкапсулируя настроенного <xref:System.Data.Common.DataAdapter> класса. По умолчанию TableAdapter наследует <xref:System.ComponentModel.Component> класса и не может быть приведен к <xref:System.Data.Common.DataAdapter> класса. Приведение адаптера таблицы для <xref:System.Data.Common.DataAdapter> класса результаты в <xref:System.InvalidCastException> ошибки. Чтобы изменить базовый класс адаптера таблицы, можно указать класс, производный от <xref:System.ComponentModel.Component> в **базового класса** свойство TableAdapter в **конструктора наборов данных**.

## <a name="tableadapter-methods-and-properties"></a>Свойства и методы адаптера таблицы
 Класс TableAdapter не является частью [!INCLUDE[dnprdnshort](../code-quality/includes/dnprdnshort_md.md)]. Это означает, что вы не может найти в документации или **обозревателя объектов**. Он создается во время разработки, при использовании одного из мастеров, упомянутых выше. Имя, присвоенное TableAdapter при его создании основан на имя таблицы, в которой вы работаете. Например, при создании адаптера таблицы на основе таблицы в базе данных с именем `Orders`, называется TableAdapter `OrdersTableAdapter`. Имя класса адаптера таблицы можно изменить с помощью **имя** свойство в **конструктора наборов данных**.

 Ниже перечислены часто используемые методы и свойства TableAdapters:

|Член|Описание|
|------------|-----------------|
|`TableAdapter.Fill`|Заполняет таблицу результатов команды SELECT адаптера таблицы TableAdapter связанные данные.|
|`TableAdapter.Update`|Отправляет изменения в базу данных и возвращает целое число, представляющее число строк, затронутых при обновлении. Дополнительные сведения см. в разделе [обновления данных с помощью адаптера таблицы](../data-tools/update-data-by-using-a-tableadapter.md).|
|`TableAdapter.GetData`|Возвращает новый <xref:System.Data.DataTable> заполняется данными.|
|`TableAdapter.Insert`|Создает новую строку в таблице данных. Дополнительные сведения см. в разделе [вставки новых записей в базе данных](../data-tools/insert-new-records-into-a-database.md).|
|`TableAdapter.ClearBeforeFill`|Определяет, является ли таблица данных очищается перед вызовом одного из `Fill` методы.|

## <a name="tableadapter-update-method"></a>Метод обновления адаптера таблицы
 Адаптеры таблиц TableAdapter команды данных для чтения и записи из базы данных. TableAdapter начальной `Fill` (основной) запрос используется в качестве основы для создания схемы связанной таблицы данных, а также `InsertCommand`, `UpdateCommand`, и `DeleteCommand` команд, которые связаны с `TableAdapter.Update` метод. Вызов адаптера `Update` работает метод инструкции, которые были созданы при TableAdapter изначально был настроен, ни один из дополнительных запросов, которые был добавлен с **мастер настройки запроса адаптера таблицы**.

 При использовании адаптера таблицы, он фактически выполняет операции с помощью команд, которые обычно выполняются. Например, при вызове адаптера `Fill` метод, адаптер выполняет команду данных в его `SelectCommand` свойства и использует модуль чтения данных (например, <xref:System.Data.SqlClient.SqlDataReader>) для загрузки результирующего набора в таблице данных. Аналогично, при вызове адаптера `Update` метода, он выполняет соответствующую команду (в `UpdateCommand`, `InsertCommand`, и `DeleteCommand` свойства) для каждой измененной записи в таблице данных.

> [!NOTE]
>  Если имеется достаточно сведений в главном запросе `InsertCommand`, `UpdateCommand`, и `DeleteCommand` команды создаются по умолчанию при создании адаптера таблицы. Если основной запрос адаптера таблицы больше, чем инструкции SELECT для одной таблицы, все равно возможно, конструктор не сможет создать `InsertCommand`, `UpdateCommand`, и `DeleteCommand`. Если эти команды не созданы, может возникнуть ошибка при выполнении `TableAdapter.Update` метод.

## <a name="tableadapter-generatedbdirectmethods"></a>GenerateDbDirectMethods адаптера таблицы
 В дополнение к `InsertCommand`, `UpdateCommand`, и `DeleteCommand`, адаптеры таблиц создаются с помощью методов, которые могут быть запущены напрямую с базой данных. Эти методы (`TableAdapter.Insert`, `TableAdapter.Update`, и `TableAdapter.Delete`) можно вызывать непосредственно для работы с данными в базе данных. Это означает, что эти отдельные методы можно вызывать из кода вместо вызова метода `TableAdapter.Update` для обработки вставок, обновлений и удалений, ожидающих для связанной таблицы данных.

 Если вы не хотите создавать эти непосредственные методы, задайте **GenerateDbDirectMethods** свойства `false` (в **свойства** окна). Дополнительные запросы, которые добавляются в адаптер таблицы являются автономными, они не создают эти методы.

## <a name="tableadapter-support-for-nullable-types"></a>Поддержка адаптера таблицы для типов, допускающих значение NULL
 Адаптеры таблиц поддерживает типы nullable `Nullable(Of T)` и `T?`. Дополнительные сведения о типах, допускающих значение NULL, в Visual Basic см. в разделе [Типы значений, допускающие значение NULL](/dotnet/visual-basic/programming-guide/language-features/data-types/nullable-value-types). Дополнительные сведения о типах, допускающих значение NULL в C# см. в разделе [Использование допускающих значение NULL типов](/dotnet/csharp/programming-guide/nullable-types/using-nullable-types).

<a name="tableadaptermanager-reference"></a>

## <a name="tableadaptermanager-reference"></a>Справочник по TableAdapterManager
 По умолчанию `TableAdapterManager` класс создается при создании набора данных, содержащего связанные таблицы. Чтобы предотвратить создаваемого класса, измените значение `Hierarchical Update` свойства набора данных в значение false. При перетаскивании таблицы, имеющей связь на поверхность разработки формы Windows Forms или страницы WPF Visual Studio объявляет переменную-член класса. Если вы не используете привязки данных, необходимо вручную объявить переменную.

 `TableAdapterManager` Класс не является частью [!INCLUDE[dnprdnshort](../code-quality/includes/dnprdnshort_md.md)]. Таким образом вам не удается найти в документации. Он создается во время разработки, как часть процесса создания набора данных.

 Ниже перечислены часто используемые методы и свойства `TableAdapterManager` класса:

|Член|Описание|
|------------|-----------------|
|Метод `UpdateAll`|Сохраняет все данные из всех таблиц данных.|
|Свойство `BackUpDataSetBeforeUpdate`|Определяет, следует ли создавать резервную копию набора данных перед выполнением `TableAdapterManager.UpdateAll` метод. Логическое значение.|
|*tableName* `TableAdapter` свойство|Представляет `TableAdapter`. Созданный `TableAdapterManager` содержит свойство для каждого `TableAdapter` он управляет. Например, создан набор данных с таблицей Customers и Orders с `TableAdapterManager` , содержащий `CustomersTableAdapter` и `OrdersTableAdapter` свойства.|
|Свойство `UpdateOrder`|Управляет порядком отдельные инструкции insert, update и delete команды. Задайте одно из значений в `TableAdapterManager.UpdateOrderOption` перечисления.<br /><br /> По умолчанию `UpdateOrder` равно **InsertUpdateDelete**. Это означает, что операции вставки, а затем обновляет, а затем удаляет выполняются для всех таблиц в наборе данных.|

## <a name="security"></a>Безопасность
При использовании команды обработки данных со свойством CommandType, равным <xref:System.Data.CommandType.Text>, тщательно проверьте сведения, которые отправляются от клиента до его передачи в базу данных. Пользователи-злоумышленники могут попытаться отправить (Вставить) измененные или Дополнительные инструкции SQL с целью получения несанкционированного доступа или повреждения базы данных. Прежде чем передавать входные данные пользователя в базе данных, всегда проверяйте, что информация верна. Рекомендуется всегда использовать параметризованные запросы или хранимые процедуры, если это возможно.

## <a name="see-also"></a>См. также

- [Средства набора данных](../data-tools/dataset-tools-in-visual-studio.md)