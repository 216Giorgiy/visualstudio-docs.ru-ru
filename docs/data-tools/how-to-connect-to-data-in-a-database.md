---
title: "Практическое руководство. Подключение к данным в базе данных | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "данные [Visual Studio], подключение к базам данных"
  - "источники данных, создание"
  - "источники данных, базы данных"
  - "подключения к базам данных"
  - "базы данных, подключение к"
ms.assetid: 6c56e54e-8834-4297-85aa-cc1a443ba556
caps.latest.revision: 55
caps.handback.revision: 55
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
robots: noindex,nofollow
---
# Практическое руководство. Подключение к данным в базе данных
Visual Studio можно использовать для подключения приложения к базе данных.  После создания подключения к данным Visual Studio создает модель данных, которые используется приложением для взаимодействия с данными в базе данных.  Объекты в этой модели данных отображаются в окне [окно "Источники данных"](../Topic/Data%20Sources%20Window.md).  Затем можно создать элементы управления с привязкой к данным путем перетаскивания элементов из окна **Источники данных** в рабочую область конструирования.  Для получения дополнительной информации см. [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md).  
  
 В этом разделе представлены инструкции по подключению к базе данных и созданию следующих типов моделей данных:  
  
-   Набор данных  
  
-   Модель EDM  
  
> [!NOTE]
>  Visual Studio можно также использовать для создания классов LINQ to SQL из базы данных.  Однако классы LINQ to SQL не отображаются в окне **Источники данных**, поэтому их невозможно перетащить напрямую в конструктор для создания элементов управления с привязкой к данным.  Дополнительные сведения о создании классов LINQ to SQL из базы данных см. в разделе [Как создать классы LINQ to SQL, сопоставленные с таблицами и представлениями \(реляционный конструктор объектов\)](../Topic/How%20to:%20Create%20LINQ%20to%20SQL%20classes%20mapped%20to%20tables%20and%20views%20\(O-R%20Designer\).md).  
  
 [!INCLUDE[note_settings_general](../data-tools/includes/note_settings_general_md.md)]  
  
##  <a name="dataset"></a> Подключение к базе данных и создание набора данных  
 При создании набора данных, основанного на базе данных, Visual Studio создает набор классов, которые являются программируемым представлением этих данных.  Основной класс называется *типизированным набором данных*.  Типизированный набор данных содержит объекты таблицы данных, которые представляют таблицы в базе данных.  Дополнительные сведения о типизированных наборах данных см. в разделе [Работа с наборами данных в Visual Studio](../data-tools/dataset-tools-in-visual-studio.md).  
  
 После создания набора данных можно создать элементы управления WPF или Windows Forms с привязкой к данным посредством перетаскивания объектов базы данных из окна источников данных в конструктор WPF или Windows Forms.  
  
#### Чтобы подключить приложение к базе данных и создать набор данных  
  
1.  Откройте существующий проект в Visual Studio или создайте новый проект.  
  
2.  В меню **Данные** выберите команду **Добавить новый источник данных**.  
  
     Появится **мастер настройки источника данных**.  
  
3.  На странице **Выбор типа источника данных** выберите **База данных** и нажмите кнопку **Далее**.  
  
4.  На странице **Выбор модели базы данных** выберите **Набор данных** и нажмите кнопку **Далее**.  
  
5.  На странице **Выбор подключения базы данных** выберите подключение к данным в списке доступных подключений и нажмите кнопку **Next**.  
  
     Если необходимое подключение данных недоступно, создайте новое подключение, выполнив действия, приведенные в разделе [Создание нового подключения к базе данных](#CreatingDataConnection).  
  
6.  На странице **Сохранение подключения в файле конфигурации приложения** можно снять флажок **Да, сохранить подключение как**, если следует сохранить строку подключения напрямую в скомпилированном приложении.  По умолчанию подключение сохраняется в файле конфигурации приложения.  Для получения дополнительной информации см. [Практическое руководство. Сохранение и изменение строк подключения](../Topic/How%20to:%20Save%20and%20Edit%20Connection%20Strings.md).  
  
7.  На странице **Выбор объектов базы данных** выберите объекты базы данных, которые будут использоваться в приложении.  Также имеется возможность замены **имени набора данных** по умолчанию.  
  
8.  Нажмите кнопку **Готово**.  Только что созданный набор данных станет доступным в окне **Источники данных**.  
  
    > [!NOTE]
    >  Если окно **Источники данных** не открыто, щелкните пункт **Показать источники данных** в меню **Данные**.  
  
9. Теперь для создания элементов управления с привязкой к данным можно перетаскивать элементы из окна **Источники данных** в конструктор WPF, конструктор Windows Forms или [Component Designer](../Topic/Component%20Designer.md).  Для получения дополнительной информации см. [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md).  
  
##  <a name="edm"></a> Подключение к базе данных и создание модели EDM  
 При создании модели EDM, основанной на базе данных, Visual Studio создает набор классов, которые являются программируемым представлением этих данных.  Дополнительные сведения о моделях данных с использованием сущностей \(EDM\) и ADO.NET Entity Framework см. в разделе [Общие сведения о платформе Entity Framework](../Topic/Entity%20Framework%20Overview.md).  
  
 После создания модели EDM элементы управления WPF с привязкой к данным можно создавать путем перетаскивания объектов сущностей из окна "Источники данных" в конструктор WPF.  
  
#### Чтобы подключить приложение к базе данных и создать модель EDM  
  
1.  Откройте существующий проект в Visual Studio или создайте новый проект.  
  
2.  Выполните все действия, указанные в **мастере модели EDM** для подключения к базе данных и указания содержимого модели.  Для получения дополнительной информации см. [How to: Create a New .edmx File](http://msdn.microsoft.com/ru-ru/beb8189e-e51c-4051-839c-9902c224abf2).  
  
3.  После завершения работы **мастера модели EDM** созданная модель EDM открывается в конструкторе моделей EDM, а объекты данных становятся доступными в окне **Источники данных**.  
  
    > [!NOTE]
    >  Если окно **Источники данных** не открыто, щелкните пункт **Показать источники данных** в меню **Данные**.  
  
4.  Если открыт конструктор WPF, можно перетаскивать элементы из окна **Источники данных** в конструктор для создания элементов управления, привязанных к модели EDM.  Для получения дополнительной информации см. [Практическое руководство. Привязка элементов управления WPF к данным в Visual Studio](../data-tools/bind-wpf-controls-to-data-in-visual-studio2.md).  
  
     Если открыт конструктор Windows Forms, невозможно будет перетаскивать элементы из окна **Источники данных** в конструктор.  Чтобы создать элементы управления, привязанные к модели EDM, необходимо построить проект, добавить новый источник данных объектов, основанный на этой модели EDM, и перетащить новые объекты в конструктор.  
  
##  <a name="CreatingDataConnection"></a> Создание нового подключения к базе данных  
 При использовании **мастера настройки источника данных** или **мастера моделей EDM** необходимо указать подключения к нужной базе данных.  Если подключение к базе данных отсутствует, выполните следующие действия для создания такого подключения.  
  
 Предполагается, что перед выполнением этих инструкций был открыт **мастер настройки источника данных** или **мастер моделей EDM**, как описано в разделах [Подключение к базе данных и создание набора данных](#dataset) и [Подключение к базе данных и создание модели EDM](#edm).  
  
#### Чтобы создать новое подключение к базе данных  
  
1.  На странице **Выбор подключения к базе данных мастера настройки источника данных** или **мастера моделей EDM** выберите пункт **Создать подключение**.  
  
     Будет выполнено одно из перечисленных ниже действий.  
  
    -   Если в Visual Studio уже было создано подключение к данным, будет открыто диалоговое окно **Добавить подключение**  
  
    -   Если это первое подключение к данным, созданное в Visual Studio, будет открыто диалоговое окно **Выбрать источник данных** Выберите источник данных, к котором следует подключиться и нажмите кнопку **ОК**, чтобы открыть диалоговое окно **Добавить подключение**.  
  
2.  В диалоговом окне **Добавить подключение** введите требуемую информацию.  Диалоговое окно **Добавить подключение** отличается для каждого типа поставщика данных.  
  
    > [!NOTE]
    >  Если выбранный в диалоговом окне **Добавить подключение источник данных** не является нужным источником данных, нажмите кнопку **Изменить**, чтобы открыть диалоговое окно **Сменить источник данных** и выбрать другой источник данных.  
  
3.  В диалоговом окне **Добавить подключение** нажмите кнопку **ОК**.  
  
     Будет вновь открыта страница **Выбор подключения к базе данных мастера настройки источника данных** или **мастера моделей EDM**.  
  
4.  На странице **Выбор подключения базы данных** убедитесь, что выбрано новое подключение к данным, затем нажмите кнопку **Далее**.  
  
5.  Выполните оставшиеся действия в **мастере настройки источника данных** или в **мастере моделей EDM**.  
  
## Безопасность платформы .NET Framework  
 Хранение конфиденциальных сведений \(например, пароля\) может повлиять на безопасность приложений.  Использование проверки подлинности Windows \(также называемой встроенными средствами безопасности\) — более безопасный способ управления доступом к базе данных.  Для получения дополнительной информации см. [Защита сведений о соединении](../Topic/Protecting%20Connection%20Information.md).  
  
## См. также  
 [Общие сведения об источниках данных](../data-tools/add-new-data-sources.md)   
 [Пошаговые руководства работы с данными](../Topic/Data%20Walkthroughs.md)   
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)   
 [Подключение к данным в Visual Studio](../data-tools/connecting-to-data-in-visual-studio.md)   
 [Подключение к источнику данных](../Topic/Connecting%20to%20a%20Data%20Source%20in%20ADO.NET.md)