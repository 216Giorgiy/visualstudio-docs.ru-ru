---
title: Создание пользовательского элемента управления с простой привязкой данных
ms.date: 11/04/2016
ms.topic: conceptual
dev_langs:
- VB
- CSharp
helpviewer_keywords:
- custom controls [Visual Studio], Data Sources Window
- Data Sources Window, controls
ms.assetid: b1488366-6dfb-454e-9751-f42fd3f3ddfb
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-data-tools
ms.workload:
- data-storage
ms.openlocfilehash: c27316cbee2ebdb1d0000d2564891e69294ec292
ms.sourcegitcommit: 58052c29fc61c9a1ca55a64a63a7fdcde34668a4
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 06/04/2018
ms.locfileid: "34747301"
---
# <a name="create-a-windows-forms-user-control-that-supports-simple-data-binding"></a>Создать пользовательский элемент управления Windows Forms, который поддерживает простую привязку данных
При отображении данных на формах в приложениях Windows, можно выбрать существующие элементы управления из **элементов**, или можно создать пользовательские элементы управления, если приложение требует функциональные возможности, недоступные в стандартных элементах управления. В этом пошаговом руководстве демонстрируется создание элемента управления, реализующего <xref:System.ComponentModel.DefaultBindingPropertyAttribute>. Элементы управления, реализующие <xref:System.ComponentModel.DefaultBindingPropertyAttribute>, могут содержать одно свойство, которое можно привязать к данным. Такие элементы управления похожи на <xref:System.Windows.Forms.TextBox> или <xref:System.Windows.Forms.CheckBox>.

 Дополнительные сведения о разработке элементов управления см. в разделе [разработке элементов управления Windows Forms во время разработки](/dotnet/framework/winforms/controls/developing-windows-forms-controls-at-design-time).

 При создании элементов управления для использования в сценариях привязки данных, должны реализовывать один из следующих атрибутов привязки к данным:

|Использование атрибута привязки к данным|
|-----------------------------------|
|Реализуйте <xref:System.ComponentModel.DefaultBindingPropertyAttribute> на простых элементах управления, таких как <xref:System.Windows.Forms.TextBox>, которые отображают отдельный столбец (или свойство) данных. (Этот процесс описан в данном пошаговом руководстве.)|
|Реализуйте <xref:System.ComponentModel.ComplexBindingPropertiesAttribute> на элементах управления, таких как <xref:System.Windows.Forms.DataGridView>, которые отображают списки (или таблицы) данных. Дополнительные сведения см. в разделе [создать пользовательский элемент управления Windows Forms, который поддерживает сложную привязку данных](../data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding.md).|
|Реализуйте <xref:System.ComponentModel.LookupBindingPropertiesAttribute> на элементах управления, таких как <xref:System.Windows.Forms.ComboBox>, которые отображают списки (или таблицы) данных, но также должны представлять отдельный столбец или отдельное свойство. Дополнительные сведения см. в разделе [создать пользовательский элемент управления Windows Forms, поддерживающих привязку данных подстановки](../data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding.md).|

 В этом пошаговом руководстве создается простой элемент управления, отображающий данные из одного столбца в таблице. В данном примере используется столбец `Phone` таблицы `Customers` из учебной базы данных "Борей". Простой пользовательский элемент управления отображает номера телефонов клиентов в стандартном формате номер телефона, с помощью <xref:System.Windows.Forms.MaskedTextBox> и задавая маску для номера телефона.

 В этом пошаговом руководстве описаны следующие процедуры.

-   Создайте новый **приложение Windows Forms**.

-   Добавьте новый **пользовательский элемент управления** в проект.

-   Визуальное проектирование пользовательского элемента управления.

-   Реализация атрибута `DefaultBindingProperty`.

-   Создать набор данных с **конфигурации источника данных** мастера.

-   Задать **Phone** столбца в **источники данных** на использование нового элемента управления.

-   Создание формы для отображения данных в новом элементе управления.

## <a name="prerequisites"></a>Предварительные требования
В этом пошаговом руководстве используется SQL Server Express LocalDB и базе данных Northwind.

1.  Если у вас нет SQL Server Express LocalDB, установите его из [страницы загрузки SQL Server Express](https://www.microsoft.com/sql-server/sql-server-editions-express), либо с помощью **установщик Visual Studio**. Установщик Visual Studio можно установить SQL Server Express LocalDB в рамках **хранения и обработки данных** рабочей нагрузки, или в отдельных компонентов.

2.  Установка образца базы данных Northwind, выполните следующие действия:

    1. В Visual Studio откройте **обозреватель объектов SQL Server** окна. (Обозреватель объектов SQL Server устанавливается как часть **хранения и обработки данных** рабочей нагрузки в установщик Visual Studio.) Разверните **SQL Server** узла. Щелкните правой кнопкой мыши на экземпляре LocalDB и выберите **нового запроса...** .

       Откроется окно редактора запросов.

    2. Копировать [сценарий Northwind Transact-SQL](https://github.com/MicrosoftDocs/visualstudio-docs/blob/master/docs/data-tools/samples/northwind.sql?raw=true) в буфер обмена. Этот скрипт T-SQL создает базу данных Northwind с нуля и заполняет ее данными.

    3. Вставьте скрипт T-SQL в редакторе запросов, а затем выберите **Execute** кнопки.

       Через некоторое время завершения выполнения запроса и создания базы данных "Борей".

## <a name="create-a-windows-forms-application"></a>Создайте приложение Windows Forms
 Первым шагом является создание **приложение Windows Forms**.

#### <a name="to-create-the-new-windows-project"></a>Порядок создания нового проекта Windows

1. В Visual Studio на **файл** последовательно выберите пункты **New**, **проекта...** .

2. Разверните **Visual C#** или **Visual Basic** на левой панели, затем выберите **Windows Desktop**.

3. В средней области выберите **приложение Windows Forms** тип проекта.

4. Назовите проект **SimpleControlWalkthrough**, а затем выберите **ОК**.

     **SimpleControlWalkthrough** создается проект и добавить **обозревателе решений**.

## <a name="add-a-user-control-to-the-project"></a>Добавьте в проект пользовательский элемент управления
 В этом пошаговом руководстве создается простой элемент управления можно привязать к данным из **пользовательский элемент управления**, поэтому добавьте **пользовательский элемент управления** элемент **SimpleControlWalkthrough** проекта.

#### <a name="to-add-a-user-control-to-the-project"></a>Добавление пользовательского элемента управления в проект

1.  Из **проекта** меню, выберите **добавить пользовательский элемент управления**.

2.  Тип `PhoneNumberBox` в имя области, а затем выберите **добавить**.

     **PhoneNumberBox** добавления элемента управления **обозревателе решений**и откроется в конструкторе.

## <a name="design-the-phonenumberbox-control"></a>Конструктор элемента управления PhoneNumberBox
 В этом пошаговом руководстве расширяется существующий <xref:System.Windows.Forms.MaskedTextBox> для создания элемента управления `PhoneNumberBox`.

#### <a name="to-design-the-phonenumberbox-control"></a>Порядок проектирования элемента управления PhoneNumberBox

1.  Перетащите <xref:System.Windows.Forms.MaskedTextBox> из **элементов** рабочую область конструирования пользовательского элемента управления.

2.  Выберите смарт-тег на <xref:System.Windows.Forms.MaskedTextBox> можно просто перетащить и выберите **Установка маски**.

3.  Выберите **номер телефона** в **маска ввода** диалоговое окно и нажмите кнопку **ОК** для задания маски.

## <a name="add-the-required-data-binding-attribute"></a>Добавление необходимого атрибута привязки данных
 Для простых элементов управления, поддерживающих привязку к данным, реализуйте <xref:System.ComponentModel.DefaultBindingPropertyAttribute>.

#### <a name="to-implement-the-defaultbindingproperty-attribute"></a>Реализация атрибута DefaultBindingProperty

1.  Переключите элемент управления `PhoneNumberBox` в представление кода. (На **представление** меню, выберите **кода**.)

2.  Замените код в `PhoneNumberBox` следующим кодом:

     [!code-csharp[VbRaddataDisplaying#3](../data-tools/codesnippet/CSharp/create-a-windows-forms-user-control-that-supports-simple-data-binding_1.cs)]
     [!code-vb[VbRaddataDisplaying#3](../data-tools/codesnippet/VisualBasic/create-a-windows-forms-user-control-that-supports-simple-data-binding_1.vb)]

3.  В меню **Построение** выберите пункт **Построить решение**.

## <a name="create-a-data-source-from-your-database"></a>Создать источник данных из базы данных
 Этот шаг использует **конфигурации источника данных**мастер для создания источника данных на основе `Customers` таблицы в базе данных Northwind. Для создания подключения необходимо иметь доступ к учебной базе данных "Борей". Сведения о настройке образца базы данных "Борей" см. в разделе [как: установить образцы баз данных](../data-tools/installing-database-systems-tools-and-samples.md).

#### <a name="to-create-the-data-source"></a>Создание источника данных

1.  В меню **Данные** выберите команду **Показать источники данных**.

2.  В **источники данных** выберите **добавить новый источник данных** запуск **конфигурации источника данных** мастера.

3.  На **Выбор типа источника данных** выберите **базы данных**, а затем нажмите кнопку **Далее**.

4.  На **Выбор подключения базы данных** выполните одно из следующих действий:

    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.

    -   Выберите **новое подключение** для запуска **Добавить/изменить подключение** диалоговое окно.

5.  Если базе данных требуется пароль, выберите параметр для включения конфиденциальных данных и нажмите кнопку **Далее**.

6.  На **Сохранение строки подключения в файле конфигурации приложения** щелкните **Далее**.

7.  На **Выбор объектов базы данных** разверните **таблиц** узла.

8.  Выберите `Customers` , а затем выберите пункт **Готово**.

     **NorthwindDataSet** добавляется в проект и `Customers` таблица появляется в **источники данных** окна.

## <a name="set-the-phone-column-to-use-the-phonenumberbox-control"></a>Значение столбца телефона на использование элемента управления PhoneNumberBox
 В пределах **источники данных** окна, можно задать для элемента управления перед перетаскиванием элементов на форму.

#### <a name="to-set-the-phone-column-to-bind-to-the-phonenumberbox-control"></a>Порядок настройки столбца телефона на привязку к элементу управления PhoneNumberBox

1.  Откройте **Form1** в конструкторе.

2.  Разверните **клиентов** узел в **источники данных** окна.

3.  Щелкните стрелку раскрывающегося списка в **клиентов** узел и выберите **сведений** в списке элементов управления.

4.  Щелкните стрелку раскрывающегося списка в **Phone** столбец и выберите **Настройка**.

5.  Выберите **PhoneNumberBox** из списка **связанные элементы управления** в **Настройка данных интерфейса** диалоговое окно.

6.  Щелкните стрелку раскрывающегося списка в **Phone** столбец и выберите **PhoneNumberBox**.

## <a name="add-controls-to-the-form"></a>Добавление элементов управления в форму
 Можно создать элементы управления с привязкой к данным путем перетаскивания элементов из **источники данных** на форму.

#### <a name="to-create-data-bound-controls-on-the-form"></a>Создание элементов управления с привязкой к данным на форме

-   Перетащите главный **клиентов** узел из **источники данных** окна в форму и убедитесь, что `PhoneNumberBox` управления используется для отображения данных в `Phone` столбца.

     Привязанные к данным элементы управления с метками описания отображаются на форме вместе с панелью инструментов (<xref:System.Windows.Forms.BindingNavigator>) для перемещения по записям. Объект [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), CustomersTableAdapter, <xref:System.Windows.Forms.BindingSource>, и <xref:System.Windows.Forms.BindingNavigator> отображаются в области компонентов.

## <a name="run-the-application"></a>Запуск приложения

#### <a name="to-run-the-application"></a>Запуск приложения

-   Нажмите клавишу F5 для запуска приложения.

## <a name="next-steps"></a>Следующие шаги
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания элемента управления, поддерживающего привязку к данным. Некоторые типичные дальнейшие действия.

-   Помещение пользовательских элементов управления в библиотеку элементов управления, чтобы их можно было повторно использовать в других приложениях.

-   Создание элементов управления, поддерживающих более сложных сценариев привязки к данным. Дополнительные сведения см. в разделе [создать пользовательский элемент управления Windows Forms, который поддерживает сложную привязку данных](../data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding.md) и [создать пользовательский элемент управления Windows Forms, поддерживающих привязку данных подстановки](../data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding.md).

## <a name="see-also"></a>См. также

- [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)
- [Задание поведения, при котором элемент управления создается при перетаскивании из окна "Источники данных"](../data-tools/set-the-control-to-be-created-when-dragging-from-the-data-sources-window.md)