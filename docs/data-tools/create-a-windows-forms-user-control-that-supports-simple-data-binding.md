---
title: "Пошаговое руководство. Создание пользовательского элемента управления Windows Forms с простой привязкой данных | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "пользовательские элементы управления [Visual Studio], окно "Источники данных""
  - "окно "Источники данных", элементы управления"
ms.assetid: b1488366-6dfb-454e-9751-f42fd3f3ddfb
caps.latest.revision: 14
caps.handback.revision: 11
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Пошаговое руководство. Создание пользовательского элемента управления Windows Forms с простой привязкой данных
При отображении данных на формах в приложениях Windows вы можете выбрать имеющиеся элементы управления в **Области элементов** или создать пользовательские элементы управления, если вашему приложению требуется функциональность, отсутствующая в стандартных элементах управления.  В этом пошаговом руководстве демонстрируется создание элемента управления, реализующего <xref:System.ComponentModel.DefaultBindingPropertyAttribute>.  Элементы управления, реализующие <xref:System.ComponentModel.DefaultBindingPropertyAttribute>, могут содержать одно свойство, которое можно привязать к данным.  Такие элементы управления похожи на <xref:System.Windows.Forms.TextBox> или <xref:System.Windows.Forms.CheckBox>.  
  
 Дополнительные сведения о создании элементов управления см. в разделе [Создание элементов управления Windows Forms во время разработки](../Topic/Developing%20Windows%20Forms%20Controls%20at%20Design%20Time.md).  
  
 При создании элементов управления для использования в сценариях привязки к данным необходимо реализовать один из следующих атрибутов привязки к данным.  
  
|Использование атрибута привязки к данным|  
|----------------------------------------------|  
|Реализуйте <xref:System.ComponentModel.DefaultBindingPropertyAttribute> на простых элементах управления, таких как <xref:System.Windows.Forms.TextBox>, которые отображают отдельный столбец \(или свойство\) данных.  \(Этот процесс описан в данном пошаговом руководстве.\)|  
|Реализуйте <xref:System.ComponentModel.ComplexBindingPropertiesAttribute> на элементах управления, таких как <xref:System.Windows.Forms.DataGridView>, которые отображают списки \(или таблицы\) данных.  Для получения дополнительной информации см. [Пошаговое руководство. Создание пользовательского элемента управления Windows Forms со сложной привязкой данных](../data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding.md).|  
|Реализуйте <xref:System.ComponentModel.LookupBindingPropertiesAttribute> на элементах управления, таких как <xref:System.Windows.Forms.ComboBox>, которые отображают списки \(или таблицы\) данных, но также должны представлять отдельный столбец или отдельное свойство.  Для получения дополнительной информации см. [Пошаговое руководство. Создание пользовательского элемента управления Windows Forms с подстановочной привязкой данных](../data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding.md).|  
  
 В этом пошаговом руководстве создается простой элемент управления, отображающий данные из одного столбца в таблице.  В данном примере используется столбец `Phone` таблицы `Customers` из учебной базы данных "Борей".  Этот простой элемент управления будет отображать номера телефона клиента в стандартном формате, используя <xref:System.Windows.Forms.MaskedTextBox> и задавая маску для номера телефона.  
  
 В этом пошаговом руководстве описаны следующие процедуры.  
  
-   Создание нового проекта **Приложение Windows**.  
  
-   Добавление нового **Пользовательского элемента управления** в проект.  
  
-   Визуальное проектирование пользовательского элемента управления.  
  
-   Реализация атрибута `DefaultBindingProperty`.  
  
-   Создание набора данных с помощью [мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png).  
  
-   Настройка столбца **Телефон** в окне **Источники данных** на использование нового элемента управления.  
  
-   Создание формы для отображения данных в новом элементе управления.  
  
## Обязательные компоненты  
 Для выполнения данного пошагового руководства требуется:  
  
-   Доступ к примеру базы данных "Борей".  Для получения дополнительной информации см. [Практическое руководство. Установка образцов баз данных](../data-tools/how-to-install-sample-databases.md).  
  
## Создание приложения Windows  
 Первым шагом является создание **Приложения Windows**.  
  
#### Порядок создания нового проекта Windows  
  
1.  В меню **Файл** Visual Studio создайте новый **Проект**.  
  
2.  Присвойте проекту имя **SimpleControlWalkthrough**.  
  
3.  Выберите **Приложение Windows** и нажмите кнопку **ОК**.  Для получения дополнительной информации см. [Клиентские приложения](../Topic/Developing%20Client%20Applications%20with%20the%20.NET%20Framework.md).  
  
     Создается проект **SimpleControlWalkthrough**, который добавляется в **Обозреватель решений**.  
  
## Добавление пользовательского элемента управления в проект  
 В данном руководстве простой элемент управления с возможностью привязки к данным создается из **Пользовательского элемента управления**, поэтому добавьте в проект **SimpleControlWalkthrough** элемент **Пользовательский элемент управления**.  
  
#### Добавление пользовательского элемента управления в проект  
  
1.  В меню **Проект** выберите пункт **Добавить пользовательский элемент управления**.  
  
2.  Введите `PhoneNumberBox` в области "Имя" и нажмите кнопку **Добавить**.  
  
     Элемент управления **PhoneNumberBox** добавляется в **Обозреватель решений** и открывается в конструкторе.  
  
## Проектирование элемента управления PhoneNumberBox  
 В этом пошаговом руководстве расширяется существующий <xref:System.Windows.Forms.MaskedTextBox> для создания элемента управления `PhoneNumberBox`.  
  
#### Порядок проектирования элемента управления PhoneNumberBox  
  
1.  Перетащите <xref:System.Windows.Forms.MaskedTextBox> из **Области элементов** на рабочую область конструирования пользовательского элемента управления.  
  
2.  Выберите смарт\-тег на только что перетащенном <xref:System.Windows.Forms.MaskedTextBox> и выберите **Установка маски**.  
  
3.  Выберите **Номер телефона** в диалоговом окне **Маска ввода** и нажмите кнопку **ОК** для задания маски.  
  
## Добавление необходимого атрибута привязки к данным  
 Для простых элементов управления, поддерживающих привязку к данным, реализуйте <xref:System.ComponentModel.DefaultBindingPropertyAttribute>.  
  
#### Реализация атрибута DefaultBindingProperty  
  
1.  Переключите элемент управления `PhoneNumberBox` в представление кода.  \(В меню **Вид** выберите **Код**.\)  
  
2.  Замените код в `PhoneNumberBox` следующим кодом:  
  
     [!code-cs[VbRaddataDisplaying#3](../data-tools/codesnippet/CSharp/create-a-windows-forms-user-control-that-supports-simple-data-binding_1.cs)]
     [!code-vb[VbRaddataDisplaying#3](../data-tools/codesnippet/VisualBasic/create-a-windows-forms-user-control-that-supports-simple-data-binding_1.vb)]  
  
3.  В меню **Построение** выберите пункт **Построить решение**.  
  
## Создание источника данных из вашей базы данных  
 В этом шаге **Мастер настройки источника данных** используется для создания источника данных на основе таблицы `Customers` в учебной базе данных "Борей".  Для создания подключения необходимо иметь доступ к учебной базе данных "Борей".  Дополнительные сведения о настройке учебной базы данных "Борей" см. в разделе [Практическое руководство. Установка образцов баз данных](../data-tools/how-to-install-sample-databases.md).  
  
#### Создание источника данных  
  
1.  В меню **Данные** выберите команду **Показать источники данных**.  
  
2.  В окне **Источники данных** выберите **Добавить новый источник данных**, чтобы запустить **Мастер настройки источника данных**.  
  
3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.  
  
4.  На странице **Выбор подключения к базе данных** выполните одно из следующих действий.  
  
    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.  
  
         Или  
  
    -   Выберите **Новое подключение** для открытия диалогового окна **Добавить\/изменить подключение**.  
  
5.  Если базе данных требуется пароль, выберите параметр для включения конфиденциальных данных и щелкните **Далее**.  
  
6.  На странице **Сохранение подключения в файле конфигурации приложения** нажмите кнопку **Далее**.  
  
7.  Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.  
  
8.  Выберите таблицу `Customers` и нажмите **Готово**.  
  
     Объект **NorthwindDataSet** добавляется в проект, и таблица `Customers` отображается в окне **Источники данных**.  
  
## Настройка столбца телефона на использование элемента управления PhoneNumberBox  
 Вы можете задать создаваемый элемент управления в окне **Источники данных** перед перетаскиванием элементов на форму.  
  
#### Порядок настройки столбца телефона на привязку к элементу управления PhoneNumberBox  
  
1.  Откройте **Form1** в конструкторе.  
  
2.  Разверните узел **Клиенты** в окне **Источники данных**.  
  
3.  Щелкните стрелку раскрывающегося списка в узле **Клиенты** и выберите **Сведения** в списке элементов управления.  
  
4.  Щелкните стрелку раскрывающегося списка в столбце **Телефон** и выберите **Настройка**.  
  
5.  Выберите **PhoneNumberBox** в списке **Связанные элементы управления** диалогового окна **Настройка данных интерфейса пользователя**.  
  
6.  Щелкните стрелку раскрывающегося списка в столбце **Телефон** и выберите **PhoneNumberBox**.  
  
## Добавление элементов управления на форму  
 Вы можете создавать элементы управления с привязкой к данным с помощью перетаскивания элементов из окна **Источники данных** на форму.  
  
#### Создание элементов управления с привязкой к данным на форме  
  
-   Перетащите главный узел **Клиенты** из окна **Источники данных** на форму и убедитесь, что элемент управления `PhoneNumberBox` используется для отображения данных в столбце `Phone`.  
  
     Привязанные к данным элементы управления с метками описания отображаются на форме вместе с панелью инструментов \(<xref:System.Windows.Forms.BindingNavigator>\) для перемещения по записям.  В области компонентов появляется [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), [CustomersTableAdapter](../data-tools/tableadapter-overview.md), <xref:System.Windows.Forms.BindingSource> и <xref:System.Windows.Forms.BindingNavigator>.  
  
## Запуск приложения  
  
#### Запуск приложения  
  
-   Нажмите клавишу F5 для запуска приложения.  
  
## Следующие действия  
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания элемента управления, поддерживающего привязку к данным.  Некоторые типичные дальнейшие действия.  
  
-   Помещение пользовательских элементов управления в библиотеку элементов управления, чтобы их можно было повторно использовать в других приложениях.  
  
-   Создание элементов управления, поддерживающих более сложных сценариев привязки к данным.  Дополнительные сведения см. в разделах [Пошаговое руководство. Создание пользовательского элемента управления Windows Forms со сложной привязкой данных](../data-tools/create-a-windows-forms-user-control-that-supports-complex-data-binding.md) и [Пошаговое руководство. Создание пользовательского элемента управления Windows Forms с подстановочной привязкой данных](../data-tools/create-a-windows-forms-user-control-that-supports-lookup-data-binding.md).  
  
## См. также  
 [Задание поведения, при котором элемент управления создается при перетаскивании из окна "Источники данных"](../data-tools/set-the-control-to-be-created-when-dragging-from-the-data-sources-window.md)   
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)   
 [Общие сведения о приложениях для работы с данными в Visual Studio](../data-tools/overview-of-data-applications-in-visual-studio.md)   
 [Подключение к данным в Visual Studio](../data-tools/connecting-to-data-in-visual-studio.md)   
 [Подготовка приложения к получению данных](../Topic/Preparing%20Your%20Application%20to%20Receive%20Data.md)   
 [Выборка данных в приложение](../data-tools/fetching-data-into-your-application.md)   
 [Привязка элементов управления к данным в Visual Studio](../data-tools/bind-controls-to-data-in-visual-studio.md)   
 [Редактирование данных в приложении](../data-tools/editing-data-in-your-application.md)   
 [Проверка данных](../Topic/Validating%20Data.md)   
 [Сохранение данных](../data-tools/saving-data.md)