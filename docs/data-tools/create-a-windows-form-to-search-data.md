---
title: Создание формы Windows Forms для поиска данных
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Windows Forms, searching data
- Windows Forms, displaying data
- parameters, displaying filtered data
- data [Visual Studio], parameterizing queries
- data [Visual Studio], searching
ms.assetid: 65ca79a9-7458-466c-af55-978cd24c549e
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-data-tools
ms.workload:
- data-storage
ms.openlocfilehash: 7b2a72306a3636bb5bca601f600afdaa175b4dd1
ms.sourcegitcommit: 3a11feebad45a0dd4ac45efcbfdf172fce46e1de
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 08/07/2018
ms.locfileid: "39582425"
---
# <a name="create-a-windows-form-to-search-data"></a>Создание формы Windows Forms для поиска данных

Довольно распространенным сценарием приложения является отображение выбранных данных на форме. Например, вам может потребоваться отобразить заказы для определенного клиента или сведения о конкретном заказе. В таком сценарии пользователь вводит в форму информацию, после чего выполняется запрос, включающий в себя эти введенные пользователем данные в качестве параметра; таким образом, данные выбираются на основе параметризированного запроса. Запрос возвращает только те данные, которые удовлетворяют введенным пользователем условиям. Это пошаговое руководство показывает, как создать запрос, возвращающий клиентов из определенного города, и изменить пользовательский интерфейс, чтобы пользователи могли ввести название города и нажать кнопку для выполнения запроса.

Использование параметризованных запросов помогает сделать приложение эффективным, так как позволяет базе данных заниматься своей непосредственной задачей — быстрой фильтрацией записей. Напротив Если запросить всю таблицу базы данных, передается по сети и использовать логику приложения для поиска нужных записей, ваше приложение станет медленным и неэффективным.

Параметризованные запросы можно добавить любой адаптер таблицы (и элементы управления для приема значений параметров и выполнения запроса), с помощью **Построитель условий поиска** диалоговое окно. Открыть диалоговое окно, выбрав **добавить запрос** команды **данных** меню (или на любом смарт-теге адаптера таблицы).

В данном пошаговом руководстве представлены следующие задачи.

-   Создание нового **приложение Windows Forms** проекта.

-   Создание и настройка источника данных в приложении с помощью **конфигурации источника данных** мастера.

-   Настройка типа удаления элементов в **источников данных** окна.

-   Создание элементов управления, отображающие данные путем перетаскивания элементов из **источников данных** окна в форму.

-   Добавление элементов управления для отображения данных на форме.

-   Завершение работы **Построитель условий поиска** диалоговое окно.

-   Ввод параметров в форму и выполнение параметризованного запроса.

## <a name="prerequisites"></a>Предварительные требования

В этом пошаговом руководстве используется SQL Server Express LocalDB и базе данных Northwind.

1.  Если у вас нет SQL Server Express LocalDB, установите его из [странице загрузки SQL Server Express](https://www.microsoft.com/sql-server/sql-server-editions-express), либо с помощью **установщик Visual Studio**. В **установщик Visual Studio**, установите SQL Server Express LocalDB вы можете как часть **хранение и обработка данных** рабочей нагрузки, или в качестве отдельного компонента.

2.  Установка образца базы данных "Борей", выполнив следующие действия:

    1. В Visual Studio откройте **обозреватель объектов SQL Server** окна. (Обозреватель объектов SQL Server устанавливается как часть **хранение и обработка данных** рабочей нагрузки в **установщик Visual Studio**.) Разверните **SQL Server** узла. Щелкните правой кнопкой мыши на локальном экземпляре LocalDB и выберите **новый запрос**.

       Откроется окно редактора запросов.

    2. Копировать [скрипт Northwind Transact-SQL](https://github.com/MicrosoftDocs/visualstudio-docs/blob/master/docs/data-tools/samples/northwind.sql?raw=true) в буфер обмена. Этот сценарий T-SQL создает базу данных "Борей" с нуля и заполняет ее данными.

    3. Вставьте сценарий T-SQL в редакторе запросов, а затем выберите **Execute** кнопки.

       Через некоторое время выполнения запроса отобразятся и создания базы данных Northwind.

## <a name="create-the-windows-forms-application"></a>Создание приложения Windows Forms

Первым шагом является создание приложения Windows Forms. Присвоение имени проекту на данном этапе, но вы дадите его имя, так как вы сэкономите проект позже:

1. В Visual Studio на **файл** меню, выберите **New** > **проекта**.

2. Разверните **Visual C#** или **Visual Basic** левой панели, а затем выберите **Windows Desktop**.

3. В средней области выберите **приложения Windows Forms** тип проекта.

4. Назовите проект **WindowsSearchForm**, а затем выберите **ОК**.

     **WindowsSearchForm** проекта создается и добавляется к **обозревателе решений**.

## <a name="create-the-data-source"></a>Создание источника данных

Этот шаг создает источник данных из базы данных с помощью **конфигурации источника данных** мастера:

1.  В меню **Данные** выберите команду **Показать источники данных**.

2.  В **источников данных** выберите **добавить новый источник данных** запустить **конфигурации источника данных** мастера.

3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.

4.  На **Выбор подключения базы данных** странице выполните одно из следующих:

    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.

    -   Выберите **новое подключение** для запуска **Добавить/изменить подключение** диалоговое окно.

5.  Если для базы данных требуется пароль, выберите параметр для включения конфиденциальных данных и нажмите кнопку **Далее**.

6.  На **сохранение подключения в файле конфигурации приложения** щелкните **Далее**.

7.  На **Выбор объектов базы данных** странице, разверните узел **таблиц** узла.

8.  Выберите **клиентов** таблицы, а затем нажмите кнопку **Готово**.

     **NorthwindDataSet** добавляется в проект и **клиентов** таблица появится в **источников данных** окна.

## <a name="create-the-form"></a>Создание формы

Созданием элементов управления с привязкой к данным путем перетаскивания элементов из **источников данных** окна на формы:

1.  Разверните **клиентов** узел в **источников данных** окна.

2.  Перетащите **клиентов** узел из **источников данных** окна в форму.

     На форме появляются <xref:System.Windows.Forms.DataGridView> и полоса инструментов (<xref:System.Windows.Forms.BindingNavigator>) для перемещения по записям. Объект [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), CustomersTableAdapter, <xref:System.Windows.Forms.BindingSource>, и <xref:System.Windows.Forms.BindingNavigator> отображаются в области компонентов.

## <a name="add-parameterization-search-functionality-to-the-query"></a>Добавление параметризации (функциональности поиска) в запрос

Можно добавить предложение WHERE в исходный запрос с помощью **Построитель условий поиска** диалоговое окно:

1.  Выберите <xref:System.Windows.Forms.DataGridView> управления, а затем выберите **добавить запрос** на **данных** меню.

2.  Тип **FillByCity** в **имя нового запроса** область **Построитель условий поиска** диалоговое окно.

3.  Добавить `WHERE City = @City` в запрос на **текст запроса** области.

     Запрос должен выглядеть примерно следующим образом:

     ```sql
     SELECT CustomerID, CompanyName, ContactName, ContactTitle,
          Address, City, Region, PostalCode, Country, Phone, Fax
     FROM Customers
     WHERE City = @City
     ```

    > [!NOTE]
    > Источники данных Access и OLE DB используют вопросительный знак ("?") для обозначения параметров, поэтому предложение WHERE может выглядеть следующим образом: `WHERE City = ?`.

4.  Нажмите кнопку **ОК** закрыть **Построитель условий поиска** диалоговое окно.

     Объект **FillByCityToolStrip** добавляется в форму.

## <a name="test-the-application"></a>Тестирование приложения

Запуск приложения открывается ваша форма и делает его готовый к приему параметра:

1.  Нажмите клавишу **F5** для запуска приложения.

2.  Тип **Лондон** в **Город** текстовое поле, а затем нажмите кнопку **FillByCity**.

     Сетка данных заполняется клиентов, соответствующих критериям. В этом примере сетка данных отображает только клиентов, имеющих значение **Лондон** в их **Город** столбца.

## <a name="next-steps"></a>Следующие шаги

В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания параметризованной формы. Ниже приводится перечень рекомендаций, позволяющих улучшить полученный результат.

-   Добавление элементов управления, отображающих связанные данные. Дополнительные сведения см. в разделе [отношения в наборах данных](relationships-in-datasets.md).

-   Изменение набора данных для добавления или удаления объектов базы данных. Дополнительные сведения см. в разделе, посвященном [созданию и настройке наборов данных](../data-tools/create-and-configure-datasets-in-visual-studio.md).

## <a name="see-also"></a>См. также

- [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)