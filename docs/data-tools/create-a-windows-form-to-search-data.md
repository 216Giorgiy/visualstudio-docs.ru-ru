---
title: Создайте форму Windows Form для поиска данных
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- Windows Forms, searching data
- Windows Forms, displaying data
- parameters, displaying filtered data
- data [Visual Studio], parameterizing queries
- data [Visual Studio], searching
ms.assetid: 65ca79a9-7458-466c-af55-978cd24c549e
author: gewarren
ms.author: gewarren
manager: douge
ms.technology: vs-data-tools
ms.workload:
- data-storage
ms.openlocfilehash: d868002d2749dba2be378723a51560fc3c42c354
ms.sourcegitcommit: 42ea834b446ac65c679fa1043f853bea5f1c9c95
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/19/2018
---
# <a name="create-a-windows-form-to-search-data"></a>Создайте форму Windows Form для поиска данных
Довольно распространенным сценарием приложения является отображение выбранных данных на форме. Например, вам может потребоваться отобразить заказы для определенного клиента или сведения о конкретном заказе. В таком сценарии пользователь вводит в форму информацию, после чего выполняется запрос, включающий в себя эти введенные пользователем данные в качестве параметра; таким образом, данные выбираются на основе параметризированного запроса. Запрос возвращает только те данные, которые удовлетворяют введенным пользователем условиям. Это пошаговое руководство показывает, как создать запрос, возвращающий клиентов из определенного города, и изменить пользовательский интерфейс, чтобы пользователи могли ввести название города и нажать кнопку для выполнения запроса.

 Использование параметризованных запросов помогает сделать приложение эффективным, так как позволяет базе данных заниматься своей непосредственной задачей — быстрой фильтрацией записей. Напротив Если запросить всю таблицу базы данных, передается по сети и использовать логику приложения для поиска нужных записей, приложение станет медленным и неэффективным.

 Параметризованные запросы можно добавить любой TableAdapter (и элементы управления для принятия значений параметров и выполнения запроса), с помощью **Построитель условий поиска** диалоговое окно. Откройте диалоговое окно, выбрав **добавить запрос** на **данные** меню (или на любом смарт-теге адаптера таблицы).

 В данном пошаговом руководстве представлены следующие задачи.

-   Создание нового проекта приложения Windows Forms.

-   Создание и настройка источника данных в приложении с **конфигурации источника данных** мастера.

-   Задание типа удаления элементов в **источники данных**окна.

-   Создание элементов управления, отображающих данные путем перетаскивания элементов из **источники данных** окна в форму.

-   Добавление элементов управления для отображения данных на форме.

-   Завершение работы **Построитель условий поиска** диалоговое окно.

-   Ввод параметров в форму и выполнение параметризованного запроса.

## <a name="prerequisites"></a>Предварительные требования

В этом пошаговом руководстве используется SQL Server Express LocalDB и базе данных Northwind.

1.  Если у вас нет SQL Server Express LocalDB, установите его из [страницы загрузки SQL Server Express](https://www.microsoft.com/sql-server/sql-server-editions-express), либо с помощью **установщик Visual Studio**. Установщик Visual Studio можно установить SQL Server Express LocalDB в рамках **хранения и обработки данных** рабочей нагрузки, или в отдельных компонентов.

2.  Установка образца базы данных Northwind, выполните следующие действия:

    1. В Visual Studio откройте **обозреватель объектов SQL Server** окна. (Обозреватель объектов SQL Server устанавливается как часть **хранения и обработки данных** рабочей нагрузки в установщик Visual Studio.) Разверните **SQL Server** узла. Щелкните правой кнопкой мыши на экземпляре LocalDB и выберите **нового запроса...** .

       Откроется окно редактора запросов.

    2. Копировать [сценарий Northwind Transact-SQL](https://github.com/MicrosoftDocs/visualstudio-docs/blob/master/docs/data-tools/samples/northwind.sql?raw=true) в буфер обмена. Этот скрипт T-SQL создает базу данных Northwind с нуля и заполняет ее данными.

    3. Вставьте скрипт T-SQL в редакторе запросов, а затем выберите **Execute** кнопки.

       Через некоторое время завершения выполнения запроса и создания базы данных "Борей".

## <a name="create-the-windows-forms-application"></a>Создайте приложение Windows Forms
 Первым шагом является создание **приложение Windows Forms**. Присвоение имени проекту на данном этапе, но вы дадите его имя, так как вы сэкономите проект позже.

#### <a name="to-create-the-new-windows-forms-application-project"></a>Для создания нового проекта приложения Windows Forms

1. В Visual Studio на **файл** последовательно выберите пункты **New**, **проекта...** .

2. Разверните **Visual C#** или **Visual Basic** на левой панели, затем выберите **классического Windows**.

3. В средней области выберите **приложение Windows Forms** тип проекта.

4. Назовите проект **WindowsSearchForm**, а затем выберите **ОК**.

     **WindowsSearchForm** создается и добавляется в проект **обозревателе решений**.

## <a name="create-the-data-source"></a>Создание источника данных
Этот шаг создает источник данных из базы данных с помощью **конфигурации источника данных** мастера.

#### <a name="to-create-the-data-source"></a>Создание источника данных

1.  В меню **Данные** выберите команду **Показать источники данных**.

2.  В **источники данных** выберите **добавить новый источник данных** запуск **конфигурации источника данных** мастера.

3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.

4.  На **Выбор подключения базы данных** выполните одно из следующих действий:

    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.

    -   Выберите **новое подключение** для запуска **Добавить/изменить подключение** диалоговое окно.

5.  Если базе данных требуется пароль, выберите параметр для включения конфиденциальных данных и нажмите кнопку **Далее**.

6.  На **Сохранение строки подключения в файле конфигурации приложения** щелкните **Далее**.

7.  На **Выбор объектов базы данных** разверните **таблиц** узла.

8.  Выберите **клиентов** , а затем выберите пункт **Готово**.

     **NorthwindDataSet** добавляется в проект и **клиентов** таблица появляется в **источники данных** окна.

## <a name="create-the-form"></a>Создание формы
 Можно создать элементы управления с привязкой к данным путем перетаскивания элементов из **источники данных** на форму.

#### <a name="to-create-data-bound-controls-on-the-form"></a>Создание элементов управления с привязкой к данным на форме

1.  Разверните **клиентов** узел в **источники данных** окна.

2.  Перетащите **клиентов** узел из **источники данных** на свою форму.

     На форме появляются <xref:System.Windows.Forms.DataGridView> и полоса инструментов (<xref:System.Windows.Forms.BindingNavigator>) для перемещения по записям. Объект [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), CustomersTableAdapter, <xref:System.Windows.Forms.BindingSource>, и <xref:System.Windows.Forms.BindingNavigator> отображаются в области компонентов.

## <a name="add-parameterization-search-functionality-to-the-query"></a>Добавление параметризации (функциональности поиска) в запрос
 Можно добавить предложение WHERE для исходного запроса с помощью **Построитель условий поиска** диалоговое окно.

#### <a name="to-create-a-parameterized-query-and-controls-to-enter-the-parameters"></a>Порядок создания параметризованного запроса и элементов управления для ввода параметров

1.  Выберите <xref:System.Windows.Forms.DataGridView> управления, а затем выберите **добавить запрос** на **данные** меню.

2.  Тип `FillByCity` в **имя нового запроса** область на **Построитель условий поиска** диалоговое окно.

3.  Добавить `WHERE City = @City` в запрос на **текст запроса** области.

     Запрос должен выглядеть примерно следующим образом:

     ```sql
     SELECT CustomerID, CompanyName, ContactName, ContactTitle,
          Address, City, Region, PostalCode, Country, Phone, Fax
     FROM Customers
     WHERE City = @City
     ```

    > [!NOTE]
    >  Источники данных Access и OLE DB используют вопросительный знак ("?") для обозначения параметров, поэтому предложение WHERE может выглядеть следующим образом: `WHERE City = ?`.

4.  Нажмите кнопку **ОК** закрыть **Построитель условий поиска** диалоговое окно.

     Объект **FillByCityToolStrip** добавляется в форму.

## <a name="testing-the-application"></a>Тестирование приложения
 При запуске приложения открывается ваша форма, готовая к получению входных данных в качестве параметра.

#### <a name="to-test-the-application"></a>Тестирование приложения

1.  Нажмите клавишу F5 для запуска приложения.

2.  Тип **Лондоне** в **Город** текстовое поле и нажмите кнопку **FillByCity**.

     Сетка данных заполняется клиентами, соответствующих условиям. В этом примере сетка данных отображает только клиентов, имеющих значение **Лондоне** в их **Город** столбца.

## <a name="next-steps"></a>Следующие шаги
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания параметризованной формы. Ниже приводится перечень рекомендаций, позволяющих улучшить полученный результат.

-   Добавление элементов управления, отображающих связанные данные. Дополнительные сведения см. в разделе [отношения в наборах данных](relationships-in-datasets.md).

-   Изменение набора данных для добавления или удаления объектов базы данных. Дополнительные сведения см. в разделе, посвященном [созданию и настройке наборов данных](../data-tools/create-and-configure-datasets-in-visual-studio.md).

## <a name="see-also"></a>См. также

- [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)