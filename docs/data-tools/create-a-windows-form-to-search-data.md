---
title: "Практическое руководство. Создание формы Windows Forms для поиска данных | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "VB"
  - "CSharp"
  - "C++"
  - "aspx"
helpviewer_keywords: 
  - "данные [Visual Studio], параметризированные запросы"
  - "данные [Visual Studio], поиск"
  - "параметры, отображение отфильтрованных данных"
  - "Windows Forms, отображение данных"
  - "Windows Forms, поиск данных"
ms.assetid: 65ca79a9-7458-466c-af55-978cd24c549e
caps.latest.revision: 28
caps.handback.revision: 25
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
---
# Практическое руководство. Создание формы Windows Forms для поиска данных
Довольно распространенным сценарием приложения является отображение выбранных данных на форме.  Например, вам может потребоваться отобразить заказы для определенного клиента или сведения о конкретном заказе.  В таком сценарии пользователь вводит в форму информацию, после чего выполняется запрос, включающий в себя эти введенные пользователем данные в качестве параметра; таким образом, данные выбираются на основе параметризированного запроса.  Запрос возвращает только те данные, которые удовлетворяют введенным пользователем условиям.  Это пошаговое руководство показывает, как создать запрос, возвращающий клиентов из определенного города, и изменить пользовательский интерфейс, чтобы пользователи могли ввести название города и нажать кнопку для выполнения запроса.  
  
 Использование параметризованных запросов помогает сделать приложение эффективным, так как позволяет базе данных заниматься своей непосредственной задачей — быстрой фильтрацией записей.  И наоборот, если запросить всю таблицу базы данных, передать ее по сети и использовать логику приложения для поиска записей, ваше приложение станет медленным и неэффективным.  
  
 Вы можете добавить параметризованные запросы в любой адаптер таблицы \(и элементы управления для приема значений параметров и выполнения запроса\) с помощью [Диалоговое окно "Построитель условий поиска"](../Topic/Search%20Criteria%20Builder%20Dialog%20Box.md).  Откройте диалоговое окно, выбрав команду **Добавить запрос** в меню **Данные** \(или на любом смарт\-теге адаптера таблицы\).  
  
 В данном пошаговом руководстве представлены следующие задачи.  
  
-   Создание нового проекта **Приложение Windows**.  
  
-   Создание и настройка источника данных в приложении с помощью [мастер настройки источника данных](../data-tools/media/data-source-configuration-wizard.png).  
  
-   Настройка типа удаления для элементов в [окно "Источники данных"](../Topic/Data%20Sources%20Window.md).  Для получения дополнительной информации см. [Задание поведения, при котором элемент управления создается при перетаскивании из окна "Источники данных"](../data-tools/set-the-control-to-be-created-when-dragging-from-the-data-sources-window.md).  
  
-   Создание отображающих данные элементов управления с помощью перетаскивания элементов из окна **Источники данных** на форму.  
  
-   Добавление элементов управления для отображения данных на форме.  
  
-   Заполнение окна [Диалоговое окно "Построитель условий поиска"](../Topic/Search%20Criteria%20Builder%20Dialog%20Box.md).  
  
-   Ввод параметров в форму и выполнение параметризованного запроса.  
  
## Обязательные компоненты  
 Для выполнения данного пошагового руководства требуется:  
  
-   Доступ к примеру базы данных "Борей".  Для получения дополнительной информации см. [Практическое руководство. Установка образцов баз данных](../data-tools/how-to-install-sample-databases.md).  
  
## Создание приложения Windows  
 Первым шагом является создание **Приложения Windows**.  На данном этапе имя проекту можно не назначать, однако мы зададим его, так как позднее планируем сохранить проект.  
  
#### Порядок создания нового проекта приложения Windows  
  
1.  Перейдите в меню **Файл** и создайте новый проект.  
  
2.  Присвойте проекту имя `WindowsSearchForm`.  
  
3.  Выберите **Приложение Windows** и нажмите кнопку **ОК**.  Для получения дополнительной информации см. [Клиентские приложения](../Topic/Developing%20Client%20Applications%20with%20the%20.NET%20Framework.md).  
  
     Создается проект **WindowsSearchForm**, который добавляется в **Обозреватель решений**.  
  
## Создание источника данных  
 На этом шаге **Мастер настройки источника данных** используется для создания источника данных из базы данных.  Для создания подключения необходимо иметь доступ к учебной базе данных "Борей".  Дополнительные сведения о настройке учебной базы данных "Борей" см. в разделе [Практическое руководство. Установка образцов баз данных](../data-tools/how-to-install-sample-databases.md).  
  
#### Создание источника данных  
  
1.  В меню **Данные** выберите команду **Показать источники данных**.  
  
2.  В окне **Источники данных** выберите **Добавить новый источник данных**, чтобы запустить **Мастер настройки источника данных**.  
  
3.  На странице **Выбор типа источника данных** выберите элемент **База данных** и нажмите **Далее**.  
  
4.  На странице **Выбор подключения к базе данных** выполните одно из следующих действий.  
  
    -   Если подключение к учебной базе данных Northwind доступно в раскрывающемся списке, то выберите его.  
  
         \-или\-  
  
    -   Выберите **Новое подключение** для открытия диалогового окна **Добавить\/изменить подключение**.  
  
5.  Если базе данных требуется пароль, выберите параметр для включения конфиденциальных данных и щелкните **Далее**.  
  
6.  На странице **Сохранение подключения в файле конфигурации приложения** нажмите кнопку **Далее**.  
  
7.  Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.  
  
8.  Выберите таблицу **Клиенты** и нажмите **Готово**.  
  
     Объект **NorthwindDataSet** добавляется в проект, и таблица **Клиенты** отображается в окне **Источники данных**.  
  
## Создание формы  
 Вы можете создавать элементы управления с привязкой к данным с помощью перетаскивания элементов из окна **Источники данных** на форму.  
  
#### Создание элементов управления с привязкой к данным на форме  
  
1.  Разверните узел **Клиенты** в окне **Источники данных**.  
  
2.  Перетащите узел **Клиенты** из окна **Источники данных** на свою форму.  
  
     На форме появляются <xref:System.Windows.Forms.DataGridView> и полоса инструментов \(<xref:System.Windows.Forms.BindingNavigator>\) для перемещения по записям.  В области компонентов появляется [NorthwindDataSet](../data-tools/dataset-tools-in-visual-studio.md), [CustomersTableAdapter](../data-tools/tableadapter-overview.md), <xref:System.Windows.Forms.BindingSource> и <xref:System.Windows.Forms.BindingNavigator>.  
  
## Добавление параметризации \(функциональности поиска\) в запрос  
 Вы можете добавить предложение WHERE в исходный запрос с помощью [Диалоговое окно "Построитель условий поиска"](../Topic/Search%20Criteria%20Builder%20Dialog%20Box.md).  
  
#### Порядок создания параметризованного запроса и элементов управления для ввода параметров  
  
1.  Выберите элемент управления <xref:System.Windows.Forms.DataGridView> и щелкните **Добавить запрос** в меню **Данные**.  
  
2.  Введите `FillByCity` в области **Имя нового запроса** окна [Диалоговое окно "Построитель условий поиска"](../Topic/Search%20Criteria%20Builder%20Dialog%20Box.md).  
  
3.  Добавьте `WHERE City = @City` в запрос в области **Текст запроса**.  
  
     Запрос должен выглядеть примерно следующим образом:  
  
     `SELECT CustomerID, CompanyName, ContactName, ContactTitle, Address, City, Region, PostalCode, Country, Phone, Fax`  
  
     `FROM Customers`  
  
     `WHERE City = @City`  
  
    > [!NOTE]
    >  Источники данных Access и OleDb используют вопросительный знак "?" для обозначения параметров, поэтому предложение WHERE должно иметь следующий вид: `WHERE City = ?`.  
  
4.  Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Построитель условий поиска**.  
  
     На форму добавляется **FillByCityToolStrip**.  
  
## Тестирование приложения  
 При запуске приложения открывается ваша форма, готовая к получению входных данных в качестве параметра.  
  
#### Тестирование приложения  
  
1.  Нажмите клавишу F5 для запуска приложения.  
  
2.  Введите "Лондон" в текстовом поле **Город** и щелкните **FillByCity**.  
  
     Сетка данных заполняется клиентами, соответствующими условию параметризации.  В этом примере сетка данных отображает только клиентов, для которых в столбце **Город** задано значение **Лондон**.  
  
## Следующие действия  
 В зависимости от требований приложения существуют несколько шагов, которые, возможно, потребуется выполнить после создания параметризованной формы.  Ниже приводится перечень рекомендаций, позволяющих улучшить полученный результат.  
  
-   Добавление элементов управления, отображающих связанные данные.  Для получения дополнительной информации см. [Практическое руководство. Отображение связанных данные в приложении Windows Forms](../Topic/How%20to:%20Display%20Related%20Data%20in%20a%20Windows%20Forms%20Application.md).  
  
-   Изменение набора данных для добавления или удаления объектов базы данных.  Для получения дополнительной информации см. [Практическое руководство. Редактирование набора данных](../Topic/How%20to:%20Edit%20a%20Dataset.md).  
  
## См. также  
 [Пошаговые руководства работы с данными](../Topic/Data%20Walkthroughs.md)   
 [Привязка элементов управления Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)   
 [Общие сведения об источниках данных](../data-tools/add-new-data-sources.md)   
 [Общие сведения об адаптере таблиц](../data-tools/tableadapter-overview.md)   
 [Общие сведения о компоненте BindingSource](../Topic/BindingSource%20Component%20Overview.md)   
 [Общие сведения об элементе управления BindingNavigator](../Topic/BindingNavigator%20Control%20Overview%20\(Windows%20Forms\).md)