---
title: Подключение к данным в базе данных Access (Windows Forms)
ms.date: 09/15/2017
ms.topic: conceptual
helpviewer_keywords:
- databases, connecting to
- databases, Access
- data [Visual Studio], connecting
- connecting to data, from Access databases
- Access databases, connecting
ms.assetid: 4159e815-d430-4ad0-a234-e4125fcbef18
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- data-storage
ms.openlocfilehash: efad211c5807aa4a018ede3c9018cf69f4668747
ms.sourcegitcommit: 21d667104199c2493accec20c2388cf674b195c3
ms.translationtype: MTE95
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2019
ms.locfileid: "55933786"
---
# <a name="connect-to-data-in-an-access-database-windows-forms"></a>Подключение к данным в базе данных Access (Windows Forms)

Можно подключиться к базе данных Access (либо *.mdf* файл или *.accdb* файл) с помощью Visual Studio. После того как определено подключение, источник данных отображается в окне **Источник данных**. Здесь можно перетаскивать таблицы и представления на формы.

## <a name="prerequisites"></a>Предварительные требования

Для работы с этими процедурами требуется проект приложения Windows Forms и база данных Access (*ACCDB*-файл) или база данных Access 2000–2003 (*MDB*-файл). Выполните процедуру, соответствующую типу файла.

## <a name="creating-the-dataset-for-an-accdb-file"></a>Создание набора данных для ACCDB-файла

Можно подключиться к базам данных, созданных с помощью Access 2013, Office 365, Access 2010 или Access 2007, используя следующую процедуру.

### <a name="to-create-the-dataset"></a>Создание набора данных

1.  Откройте приложение Windows Forms, к которому требуется подключить данные.

2.  Чтобы открыть **источников данных** окна на **представление** меню, выберите **Other Windows** > **источников данных**.

     ![Просмотр других окон "Источники данных"](../data-tools/media/viewdatasources.png)

3.  В окне **Источники данных** выберите **Добавить новый источник данных**.

     Открывается **мастер настройки источника данных**.

4.  Выберите **базы данных** на **Выбор типа источника данных** странице, а затем выберите **Далее**.

5.  Выберите **набора данных** на **Выбор модели базы данных** странице, а затем выберите **Далее**.

6.  На странице **Выбор подключения базы данных** выберите **Новое подключение** для настройки нового подключения к данным.

     Откроется диалоговое окно **Добавление соединения**.

7.  Выберите **изменение** рядом с пунктом **источника данных** текстовое поле.

     **Изменение источника данных** откроется диалоговое окно.

8.  В списке источников данных, выберите  **\<других\>**. В **поставщик данных** раскрывающегося списка, выберите **поставщик данных .NET Framework для OLE DB**, затем выберите **ОК**.

9. Вернитесь в **добавить подключение** выберите **поставщик Microsoft Office 12.0 Access базы данных ядра OLE DB** из **поставщик OLE DB** раскрывающегося списка.

     ![Поставщик OLE DB Microsoft Office 12.0 Access](../data-tools/media/dataoledbprovideroffice12access.png)

     > [!NOTE]
     > Если вы не видите **поставщик Microsoft Office 12.0 Access базы данных ядра OLE DB** в поставщике OLE DB для раскрывающегося списка, может потребоваться установить [системный драйвер Office 2007: компоненты подключения к данным](https://www.microsoft.com/download/confirmation.aspx?id=23734).

9. В **имя сервера или файла** текстовое поле, укажите путь и имя файла *.accdb* вы хотите подключиться, а затем выберите файл **ОК**. (Если файл базы данных имя пользователя и пароль, укажите их, прежде чем выбрать **ОК**.)

10. Выберите **Далее** на **Выбор подключения базы данных** страницы.

     Может появиться диалоговое окно, предлагающее файле данных не в текущем проекте. Выберите **Да** или **Нет**.

11. Выберите **Далее** на **сохранение подключения в файле конфигурации приложения** страницы.

12. Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.

13. Выберите любой таблицы или представления в наборе данных и затем выберите **Готово**.

     Объект DataSet добавляется в проект, и таблицы и представления отображаются в окне **Источники данных**.

## <a name="create-the-dataset-for-an-mdb-file"></a>Создание набора данных для MDB-файл

Набор данных создается при помощи **Мастера настройки источника данных**.

### <a name="to-create-the-dataset"></a>Создание набора данных

1.  Откройте приложение Windows Forms, к которому требуется подключить данные.

2.  На **представление** меню, выберите **Other Windows** > **источников данных**.

     ![Просмотр других окон "Источники данных"](../data-tools/media/viewdatasources.png)

3.  В окне **Источники данных** выберите **Добавить новый источник данных**.

     Открывается **мастер настройки источника данных**.

4.  Выберите **базы данных** на **Выбор типа источника данных** странице, а затем выберите **Далее**.

5.  Выберите **набора данных** на **Выбор модели базы данных** странице, а затем выберите **Далее**.

6.  На странице **Выбор подключения базы данных** выберите **Новое подключение** для настройки нового подключения к данным.

7.  Если источник данных не является **файл базы данных Microsoft Access (OLE DB)** выберите **изменение** открыть **изменение источника данных** и установите **Microsoft Доступ к файлу базы данных**, а затем выберите **ОК**.

8.  В **имя файла базы данных**, укажите путь и имя *.mdb* вы хотите подключиться, а затем выберите файл **ОК**.

     ![Добавление файла базы данных Access для подключения](../data-tools/media/dataaddconnectionaccessmdb.png)

9. Выберите **Далее** на **Выбор подключения базы данных** страницы.

10. Выберите **Далее** на **сохранение подключения в файле конфигурации приложения** страницы.

11. Разверните узел **Таблицы** на странице **Выбор объектов базы данных**.

12. Выберите любой таблицы или представления в наборе данных и затем выберите **Готово**.

     Объект DataSet добавляется в проект, и таблицы и представления отображаются в окне **Источники данных**.

## <a name="security"></a>Безопасность

Хранение конфиденциальных сведений (например, пароля) может повлиять на безопасность приложений. Использование проверки подлинности Windows (также называемой встроенными средствами безопасности) — более безопасный способ управления доступом к базе данных. Дополнительные сведения см. в разделе [Защита сведений о подключении](/dotnet/framework/data/adonet/protecting-connection-information).

## <a name="next-steps"></a>Следующие шаги

Набор данных, который вы только что создали, теперь доступна в **источников данных** окна. Теперь можно выполнить любую из следующих задач:

-   Выберите элементы из **источников данных** окно и перетащите их на форму (см. в разделе [управляет привязки Windows Forms к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)).

-   Откройте источник данных в **Конструкторе набора данных** для добавления или изменения объектов, составляющих набор данных.

-   Добавьте логику проверки <xref:System.Data.DataTable.ColumnChanging> или <xref:System.Data.DataTable.RowChanging> событий таблиц данных в наборе данных (см. в разделе [проверки данных в наборах данных](../data-tools/validate-data-in-datasets.md)).

## <a name="see-also"></a>См. также

- [Добавление подключений](../data-tools/add-new-connections.md)