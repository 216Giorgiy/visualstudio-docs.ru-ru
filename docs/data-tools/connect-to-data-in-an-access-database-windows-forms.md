---
title: Подключение к данным в базе данных Microsoft Access (Windows Forms)
ms.date: 09/15/2017
ms.topic: conceptual
helpviewer_keywords:
- databases, connecting to
- databases, Access
- data [Visual Studio], connecting
- connecting to data, from Access databases
- Access databases, connecting
ms.assetid: 4159e815-d430-4ad0-a234-e4125fcbef18
author: gewarren
ms.author: gewarren
manager: douge
ms.prod: visual-studio-dev15
ms.technology: vs-data-tools
ms.workload:
- data-storage
ms.openlocfilehash: d15cf1d8e2d7a7178b6ffc423319fcadd8e00cad
ms.sourcegitcommit: e13e61ddea6032a8282abe16131d9e136a927984
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
---
# <a name="connect-to-data-in-an-access-database-windows-forms"></a>Подключение к данным в базе данных Microsoft Access (Windows Forms)
Можно подключиться к базе данных (MDF-файла или ACCDB-файла) с помощью Visual Studio. После определения соединения, данные отображаются в **источники данных** окна. Здесь можно перетаскивать таблицы и представления на формы.

## <a name="prerequisites"></a>Предварительные требования
 Для работы с этими процедурами требуется проект приложения Windows Forms и база данных Access (ACCDB-файл) или базе данных Access 2000 — 2003 (MDB-файл). Выполните процедуру, соответствующую типу файла.

## <a name="creating-the-dataset-for-an-accdb-file"></a>Создание набора данных для ACCDB-файла
 Можно подключиться к базам данных, созданные с помощью Access 2013, Office 365, Access 2010 или Access 2007, используя следующую процедуру.

#### <a name="to-create-the-dataset"></a>Создание набора данных

1.  Откройте приложение Windows Forms, к которому требуется подключить данные.

2.  На **представление** последовательно выберите пункты **другие окна** > **источники данных**.

     ![Просмотр других источников данных Windows](../data-tools/media/viewdatasources.png "ViewDataSources")

3.  В окне **Источники данных** выберите **Добавить новый источник данных**.

     **Мастер настройки источника данных** открывается.

4.  Выберите **базы данных** на **Выбор типа источника данных** страницы, а затем выберите **Далее**.

5.  Выберите **Dataset** на **Выбор модели базы данных** страницы, а затем выберите **Далее**.

6.  На **Выбор подключения базы данных** выберите **новое подключение** для настройки нового подключения к данным.

     **Добавить подключение** откроется диалоговое окно.

7.  Выберите **изменений** рядом с **источника данных** текстовое поле.

     **Сменить источник данных** откроется диалоговое окно.

8.  В списке источников данных выберите  **\<других\>**. В **поставщик данных** раскрывающийся список, выберите **поставщик данных .NET Framework для OLE DB**, затем выберите **ОК**.

9. В **добавить подключение** выберите **поставщик Microsoft Office 12.0 Access базы данных ядра OLE DB** из **поставщик OLE DB** раскрывающегося списка.

     ![OLE DB поставщик Microsoft Office 12.0 Access](../data-tools/media/dataoledbprovideroffice12access.png "dataOLEDBProviderOffice12Access")

     > [!NOTE]
     >  Если вы не видите **поставщик Microsoft Office 12.0 Access базы данных ядра OLE DB** в поставщике OLE DB раскрывающийся список, может потребоваться установить [системный драйвер Office 2007: компоненты подключения к данным](https://www.microsoft.com/download/confirmation.aspx?id=23734).

9. В **имя сервера или файла** текстовое поле, укажите путь и имя ACCDB-файла вы хотите подключиться, а затем выберите **ОК**. (Если файл базы данных имя пользователя и пароль, укажите их, прежде чем выбрать **ОК**.)

10. Выберите **Далее** на **Выбор подключения базы данных** страницы.

     Может появиться диалоговое окно, предлагающее файл данных не находится в текущем проекте. Выберите **Да** или **Нет**.

11. Выберите **Далее** на **Сохранение строки подключения в файле конфигурации приложения** страницы.

12. Разверните **таблиц** узел на **Выбор объектов базы данных** страницы.

13. Выберите любой таблицы или представления в набор данных, а затем выберите **Готово**.

     Объект dataset добавляется в проект, и таблицы и представления отображаются в **источники данных** окна.

## <a name="creating-the-dataset-for-an-mdb-file"></a>Создание набора данных для MDB-файл
 Создать набор данных, выполнив **мастер настройки источника данных**.

#### <a name="to-create-the-dataset"></a>Создание набора данных

1.  Откройте приложение Windows Forms, к которому требуется подключить данные.

2.  На **представление** последовательно выберите пункты **другие окна** > **источники данных**.

     ![Просмотр других источников данных Windows](../data-tools/media/viewdatasources.png "ViewDataSources")

3.  В окне **Источники данных** выберите **Добавить новый источник данных**.

     **Мастер настройки источника данных** открывается.

4.  Выберите **базы данных** на **Выбор типа источника данных** страницы, а затем выберите **Далее**.

5.  Выберите **Dataset** на **Выбор модели базы данных** страницы, а затем выберите **Далее**.

6.  На **Выбор подключения базы данных** выберите **новое подключение** для настройки нового подключения к данным.

7.  Если источник данных не **файл базы данных Microsoft Access (OLE DB)** выберите **изменений** Открытие **сменить источник данных** и установите **Microsoft Доступ к файлу базы данных**, а затем выберите **ОК**.

8.  В **имя файла базы данных**, укажите путь и имя MDB-файлу требуется подключиться, а затем выберите **ОК**.

     ![Добавление файла базы данных Access подключения](../data-tools/media/dataaddconnectionaccessmdb.png "dataAddConnectionAccessMDB")

9. Выберите **Далее** на **Выбор подключения базы данных** страницы.

10. Выберите **Далее** на **Сохранение строки подключения в файле конфигурации приложения** страницы.

11. Разверните **таблиц** узел на **Выбор объектов базы данных** страницы.

12. Выберите любой таблицы или представления в набор данных, а затем выберите **Готово**.

     Объект dataset добавляется в проект, и таблицы и представления отображаются в **источники данных** окна.

## <a name="security"></a>Безопасность
 Хранение конфиденциальных сведений (например, пароля) может повлиять на безопасность приложений. Использование проверки подлинности Windows (также называемой встроенными средствами безопасности) — более безопасный способ управления доступом к базе данных. Дополнительные сведения см. в разделе [Защита сведений о подключении](/dotnet/framework/data/adonet/protecting-connection-information).

## <a name="next-steps"></a>Следующие шаги
 Только что созданный набор данных станет доступным в **источники данных** окна. Теперь можно выполнить любую из следующих задач:

-   Выберите элементы в **источники данных** окна и перетащите их на форму (см. [элементы управления Windows Forms, привязка к данным в Visual Studio](../data-tools/bind-windows-forms-controls-to-data-in-visual-studio.md)).

-   Откройте источник данных в **конструктора наборов данных** для добавления или изменения объектов, составляющих набор данных.

-   Добавьте логику проверки в <xref:System.Data.DataTable.ColumnChanging> или <xref:System.Data.DataTable.RowChanging> событий таблиц данных в наборе данных (в разделе [проверка данных в наборах данных](../data-tools/validate-data-in-datasets.md)).

## <a name="see-also"></a>См. также

- [Добавление подключений](../data-tools/add-new-connections.md)