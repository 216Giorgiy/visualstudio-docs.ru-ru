---
title: 'Конструктор рабочих процессов - как: определение и использование делегатов действий'
ms.date: 11/04/2016
ms.topic: conceptual
ms.prod: visual-studio-dev15
ms.technology: vs-workflow-designer
ms.assetid: c68e42ad-3ec0-4c2d-b104-fe36c6d83b5e
ms.author: gewarren
manager: douge
ms.workload:
- multiple
author: gewarren
ms.openlocfilehash: 32546f551972cf97779e0828d8c47c9c892d39bf
ms.sourcegitcommit: 240c8b34e80952d00e90c52dcb1a077b9aff47f6
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/23/2018
ms.locfileid: "49916366"
---
# <a name="how-to-define-and-consume-activity-delegates-in-the-workflow-designer"></a>Как определить и использовать делегатов действий в конструкторе рабочих процессов

.NET framework 4.5 предоставляет конструктора out-of-box для <xref:System.Activities.Statements.InvokeDelegate> действия. Данный конструктор можно использовать в целях назначения делегатов для действия, производного от <xref:System.Activities.ActivityDelegate>, такого как <xref:System.Activities.ActivityAction> или <xref:System.Activities.ActivityFunc%601>.

## <a name="define-an-activity-delegate"></a>Укажите делегат действия

1. В Visual Studio выберите **файл** > **New** > **проекта**.

2. В **новый проект** выберите **рабочего процесса** категории с левой стороны экрана, а затем выберите **консольное приложение рабочего процесса** шаблона проекта. Имя проекта (при необходимости) и нажмите кнопку **ОК**.

   > [!NOTE]
   > Если вы не видите **рабочего процесса** категории, сначала установить **Windows Workflow Foundation** компонент Visual Studio 2017. Подробные инструкции см. в разделе [установки Windows Workflow Foundation](developing-applications-with-the-workflow-designer.md#install-windows-workflow-foundation).

3. Щелкните правой кнопкой мыши проект в **обозревателе решений** и выберите **добавить** > **новый элемент**. Выберите **рабочего процесса** категории, а затем выберите **действия** шаблона элемента. Назовите новое действие **MyForEach.xaml** , а затем выберите **ОК**.

   Действие откроется в конструкторе рабочих процессов.

4. В конструкторе рабочих процессов, нажмите кнопку **аргументы** вкладки.

5. Нажмите кнопку **создать аргумент**. Назовите новый аргумент **элементы**.

6. В **тип аргумента** столбец, выберите **массив [T]**.

7. В браузере типов выберите **объект** , а затем выберите **ОК**.

8. Нажмите кнопку **создать аргумент** еще раз. Назовите новый аргумент **текст**. В **направление** столбец для нового аргумента выберите **свойство**.

9. В столбце типа аргумента выберите **поиск типов**

10. В браузере типов введите **ActivityAction** в **имя типа** поля. Выберите **ActivityAction\<T >** в представлении в виде дерева. Выберите **объект** в раскрывающемся списке, который появляется в целях присваивания типа **ActivityAction\<объекта >** к аргументу.

11. Перетащите <xref:System.Activities.Statements.While> действия из **поток управления** разделе области элементов в область конструктора.

12. Выберите <xref:System.Activities.Statements.While> действие и выберите **переменных** вкладки.

13. Выберите **создать переменную**. Присвойте имя новой переменной **индекс**.

14. В **тип переменной** столбец, выберите **Int32**. Оставьте **область** как **хотя**и **по умолчанию** пустой столбец.

15. Задайте **условие** свойство <xref:System.Activities.Statements.While> действие **индекс < Items.Length;**.

16. Перетащите <xref:System.Activities.Statements.InvokeDelegate> действия из **примитивы** панели элементов для **текст** из <xref:System.Activities.Statements.While> действия.

17. Выберите **текст** в раскрывающемся списке делегата.

18. В **свойства** сетки для <xref:System.Activities.Statements.InvokeDelegate> действия, нажмите кнопку **...**  кнопку **аргументов делегата** свойство.

19. В **значение** столбец с именем аргумента **аргумент**, введите **Items [Index]**. Нажмите кнопку **ОК** закрыть **DelegateArguments** диалоговое окно.

20. Перетащите действие <xref:System.Activities.Statements.Assign> на горизонтальную линию под действием <xref:System.Activities.Statements.InvokeDelegate>. <xref:System.Activities.Statements.Assign> Создается действие и <xref:System.Activities.Statements.Sequence> должен содержать два действия автоматически создается действие **текст** раздел **MyForEach** действия. Требуется последовательность, так как **текст** раздел может содержать только одно действие. Автоматическое создание нового <xref:System.Activities.Statements.Sequence> действие — это новая функция платформы .NET Framework 4.5.

21. Задайте **для** свойство <xref:System.Activities.Statements.Assign> действие **индекс**. Задайте **значение** свойство **назначить** действие **индекс + 1**.

    Пользовательский **MyForEach** действие вызывает произвольное действие один раз для каждого значения, переданного с помощью **элементы** коллекции со значениями в коллекцию в качестве входных данных для действия.

## <a name="use-the-custom-activity-in-a-workflow"></a>Использование настраиваемого действия в рабочем процессе

1.  Постройте проект, нажав клавишу **Ctrl**+**Shift**+**B**.

2.  В **обозревателе решений**откройте **Workflow1.xaml** в конструкторе.

3.  Перетащите **MyForEach** действия из области элементов в область конструктора. Действие находится в разделе области элементов с тем же именем, что и проект.

4.  Задайте **элементы** свойство **MyForEach** действие **new Object [] {1, «abc»}**.

5.  Перетащите <xref:System.Activities.Statements.WriteLine> действия из **примитивы** панели элементов для **Delegate: текст** раздел **MyForEach** действия.

6.  Задайте **текст** свойство <xref:System.Activities.Statements.WriteLine> действие **Argument.ToString()**.

При выполнении рабочего процесса, в консоли отображаются следующие выходные данные:

**1**
**abc**