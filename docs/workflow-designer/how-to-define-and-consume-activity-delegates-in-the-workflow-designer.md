---
title: "Как определить и использовать делегатов действий в конструкторе рабочих процессов | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.tgt_pltfrm: ""
ms.topic: "reference"
ms.assetid: c68e42ad-3ec0-4c2d-b104-fe36c6d83b5e
caps.latest.revision: 3
ms.author: "sdanie"
manager: "erikre"
caps.handback.revision: 3
---
# Как определить и использовать делегатов действий в конструкторе рабочих процессов
[!INCLUDE[net_v45](../ide/includes/net_v45_md.md)] включает новый готовый конструктор для действия <xref:System.Activities.Statements.InvokeDelegate>.Данный конструктор можно использовать в целях назначения делегатов для действия, производного от <xref:System.Activities.ActivityDelegate>, такого как <xref:System.Activities.ActivityAction> или <xref:System.Activities.ActivityFunc%601>.  
  
### Укажите делегат действия  
  
1.  В [!INCLUDE[vs_current_short](../code-quality/includes/vs_current_short_md.md)] выберите **Файл**, **Создать**, **Проект**.Выберите узел **Рабочий процесс** слева, а справа — шаблон **Консольное приложение рабочего процесса**.Задайте имя проекта \(в случае необходимости\) и нажмите кнопку **ОК**.  
  
2.  В **Обозревателе решений** щелкните правой кнопкой мыши проект и выберите команду **Добавить**, **Новый элемент...**.Выберите узел **Рабочий процесс** слева, а справа шаблон **Действие**.Задайте для нового действия имя **MyForEach.xaml** и нажмите кнопку **ОК**.Действие откроется в конструкторе рабочих процессов.  
  
3.  В конструкторе рабочих процессов перейдите на вкладку **Аргументы**.  
  
4.  Нажмите кнопку **Создать аргумент**.Назовите новый аргумент **Элементы**.  
  
5.  В столбце **Тип аргумента** выберите **Массив \[T\]**.  
  
6.  В браузере типов выберите **Объект**.Нажмите кнопку **ОК**.  
  
7.  Снова нажмите кнопку **Создать аргумент**.Назовите новый аргумент **Текст**.В столбце **Направление** для нового аргумента выберите **Свойство**.  
  
8.  В столбце типа аргумента выберите **Поиск типов…**  
  
9. В браузере типов введите **ActivityAction** в поле **Имя типа**.Выберите **ActivityAction\<T\>** в представлении в виде дерева.Выберите **Объект** в раскрывающемся списке, который появляется в целях присваивания типа **ActivityAction\<Object\>** аргументу.  
  
10. Перетащите действие <xref:System.Activities.Statements.While> из раздела **Поток управления** в область элементов области конструктора.  
  
11. Выберите действие <xref:System.Activities.Statements.While> и откройте вкладку **Переменные**.  
  
12. Выберите **Создать переменную**.Задайте для новой переменной имя **Индекс**.  
  
13. В столбце **Тип переменной** выберите **Int32**.Оставьте значение **Область** равным **Пока**, а столбец **По умолчанию** оставьте пустым.  
  
14. Задайте свойство **Условие** действия <xref:System.Activities.Statements.While> равным **index \< Items.Length;**.  
  
15. Перетащите действие <xref:System.Activities.Statements.InvokeDelegate> из раздела **Примитивы** области инструментов в область **Текст** действия <xref:System.Activities.Statements.While>.  
  
16. Выберите **Текст** в раскрывающемся списке делегата.  
  
17. В сетке **Свойства** для действия <xref:System.Activities.Statements.InvokeDelegate> нажмите кнопку **…** в свойстве **Аргументы делегата**.  
  
18. В столбце **Значение** аргумента с именем **Аргумент** введите **Items\[Index\]**.Нажмите кнопку **ОК**, чтобы закрыть диалоговое окно **Свойства матрицы**.  
  
19. Перетащите действие <xref:System.Activities.Statements.Assign> на горизонтальную линию под действием <xref:System.Activities.Statements.InvokeDelegate>.Будет создано действие <xref:System.Activities.Statements.Assign>, а также автоматически создано действие <xref:System.Activities.Statements.Sequence>, содержащее два действия из раздела **Текст** действия **MyForEach**.Необходима последовательность, поскольку раздел **Текст** может содержать только одно действие.Автоматическое создание нового действия <xref:System.Activities.Statements.Sequence> — это новая функция [!INCLUDE[net_v45](../ide/includes/net_v45_md.md)].  
  
20. Задайте свойство **Кому** диалогового окна <xref:System.Activities.Statements.Assign> равным **Индекс**.Задайте свойство **Значение** действия **Присваивание** равным **index\+1**.  
  
 Настраиваемое действие **MyForEach** теперь будет вызывать по одному произвольному действию для каждого значения, переданного с помощью коллекции **Items**, значениями в которой являются входные данные для действия.  
  
### Использование настраиваемого действия в рабочем процессе  
  
1.  Постройте проект, нажав клавиши **CTRL\+SHIFT\+B**.  
  
2.  В **Обозревателе решений** откройте **Workflow1.xaml** в конструкторе.  
  
3.  Перетащите действие **MyForEach** из области элементов в область конструктора.Действие находится в разделе области элементов с тем же именем, что и проект.  
  
4.  Задайте свойство **Элементы** действия **MyForEach** равным **new Object\[\] {1, "abc"}**.  
  
5.  Перетащите действие <xref:System.Activities.Statements.WriteLine> из раздела **Примитивы** области элементов в раздел **Delegate:Текст** действия **MyForEach**.  
  
6.  Задайте для свойства **Текст** действия <xref:System.Activities.Statements.WriteLine> значение **Argument.ToString\(\)**.  
  
 При выполнении рабочего процесса в консоли отобразится следующее:  
  
 **1**   
**abc**