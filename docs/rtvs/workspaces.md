---
title: "Рабочие области в инструментах R для Visual Studio | Документация Майкрософт"
ms.custom: 
ms.date: 4/27/2017
ms.prod: visual-studio-dev15
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-r
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: d610279c-d6c3-4084-939a-bf042f64d4dd
caps.latest.revision: 1
author: kraigb
ms.author: kraigb
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Human Translation
ms.sourcegitcommit: 7a873df77756e5a957d327049566c8e0db1f3a8a
ms.openlocfilehash: 8ac025a9da5c07cbc9efff416d07c93b91aa2c14
ms.contentlocale: ru-ru
ms.lasthandoff: 05/12/2017

---


## <a name="controlling-where-r-code-runs-with-workspaces"></a>Управление выполнением кода R с помощью рабочих областей

Рабочая область в инструментах R для Visual Studio (RTVS) позволяет указать, где выполняется сеанс R (на локальном и удаленном компьютерах). Цель этого — позволить работать на обоих компьютерах без каких-либо серьезных различий, что дает возможность воспользоваться преимуществами потенциально более производительных облачных компьютеров.

Чтобы открыть окно **Рабочие области**, выберите команду **Инструменты R > Окна > Рабочие области** или нажмите клавиши CTRL + 9.

![Окно "Рабочие области" в инструментах R для Visual Studio (VS2017)](~/docs/rtvs/media/workspaces-window.png)

В этом окне зеленым флажком обозначается активная рабочая область, к которой привязаны RTVS. Выберите синюю стрелку, чтобы задать рабочую область в качестве активной. Щелкните значок параметров (шестеренки) справа от каждой рабочей области, чтобы переименовать рабочую область, изменить ее расположение и аргументы командной строки. Красный значок X позволяет удалить рабочую область, добавленную вручную.

Содержание раздела

- [Сохранение и сброс рабочей области](#saving-and-resetting-a-workspace)
- [Локальные рабочие области](#local-workspaces)
- [Удаленные рабочие области](#remote-workspaces)
- [Переключение между рабочими областями](#switching-between-workspaces)
- [Каталоги на локальных и удаленных компьютерах](#directories-on-local-and-remote-computers)
- [Копирование файлов проекта в удаленные рабочие области](#copying-project-files-to-remote-workspaces)
- [Копирование файлов из удаленной рабочей области](#copying-files-from-a-remote-workspace)

## <a name="saving-and-resetting-a-workspace"></a>Сохранение и сброс рабочей области

По умолчанию RTVS не сохраняет состояние рабочей области при закрытии и повторном открытии проекта. Однако это поведение можно изменить в разделе [Параметры рабочей области](options.md#workspace).

Чтобы в любое время сбросить состояние рабочей области, можно воспользоваться командой **Инструменты R > Сеанса > Сброс** и кнопкой сброса в интерактивном окне. В случае с удаленными рабочими областями сброс приводит к удалению профиля пользователя, созданного при первом подключении к удаленному серверу, который фактически удаляет все накопленные в профиле файлы.

## <a name="local-workspaces"></a>Локальные рабочие области

В списке локальных рабочих областей отображаются все интерпретаторы R, которые установлены на компьютере. 

RTVS пытается автоматически определить все версии R, которые установлены, обращаясь к разделу реестра `HKEY_LOCAL_MACHINE\Software\R-Core\` при запуске Visual Studio. Поскольку проверка выполняется только при запуске, после установки нового интерпретатора R необходимо перезапустить Visual Studio.

RTVS может не обнаружить интерпретатор R, установленный нестандартным способом (например, путем простого копирования файлов в папку вместо запуска установщика). В этом случае вручную создайте новую локальную рабочую область R следующим образом.

1. В окне "Рабочие области" нажмите кнопку **Добавить**.
1. Присвойте имя новой рабочей области.
1. Введите путь к корневой папке R (в которой находится папка `bin` с интерпретатором) и любые дополнительные аргументы командной строки, передаваемые интерпретатору при запуске RTVS.
1. По завершении нажмите **Сохранить**.

![Добавление новой рабочей области](~/docs/rtvs/media/workspaces-add-new.png)

## <a name="remote-workspaces"></a>Удаленные рабочие области

Удаленные рабочие области позволяют подключаться к сеансу R на удаленном компьютере. (Сведения о настройке компьютера для этой цели см.в разделе [Настройка удаленных рабочих областей](workspaces-remote-setup.md).)

Удаленные рабочие области не определяются автоматически инструментами RTVS, поэтому необходимо добавить их вручную с помощью кнопки **Добавить** в окне "Рабочие области", как описано в предыдущем разделе. В этом случае введите URI удаленного компьютера, а не локальный путь.

> [!Important]
> Для идентификации удаленных рабочих областей используются URI, которые *должны использовать протокол HTTPS* для обеспечения конфиденциальности и целостности связи с удаленным компьютером. RTVS не будет подключаться к удаленному компьютеру, который не поддерживает протокол HTTPS.

> [!Note]
> Удаленные рабочие области позволяют организовать эффективный предварительный просмотр. Мы работаем над более эффективной синхронизацией файлов, которая будет реализована в будущих выпусках, и с радостью рассмотрим ваши отзывы о том, как сделать эту функцию наиболее удобной для пользователей.


## <a name="switching-between-workspaces"></a>Переключение между рабочими областями

Одновременно RTVS можно привязать только к одной рабочей области, которая обозначается небольшим зеленым флажком в окне "Рабочие области". По умолчанию RTVS привязывается к последней открытой в предыдущем сеансе локальной рабочей области.

Чтобы изменить активную рабочую область, щелкните синюю стрелку рядом с требуемой рабочей областью. При этом появится запрос на сохранение сеанса, работа с текущей рабочей областью будет прекращена, а затем вы переключитесь на новую рабочую область.

> [!Tip]
> Чтобы отключить запрос на сохранение, выберите команду **Инструменты R > Параметры**, а затем задайте для параметра **Показать диалоговое окно подтверждения перед переключением рабочих областей** значение `No`. См. раздел [Параметры рабочей области](options.md#workspace).

При попытке переключиться на локальную рабочую область, которая была удалена, или на удаленную рабочую область, которая недоступна, могут возникать ситуации, когда проект RTVS не привязан ни к одной рабочей области. В результате при вводе кода в интерактивном окне или при попытке иным образом выполнить код может появиться сообщение об ошибке, аналогичное указанному ниже. Чтобы исправить это, просто переключитесь на другую рабочую область в окне "Рабочие области". Если не доступна ни одна из рабочих областей, необходимо установить интерпретатор R. Можно также попытаться перезапустить программу Visual Studio, для которой установлен интерпретатор, во время запуска Visual Studio.

![Сообщение об ошибке при отсутствии рабочих областей, привязанных к RTVS](~/docs/rtvs/media/workspaces-disconnected-interactive-window.png)

### <a name="switching-to-a-remote-workspace"></a>Переключение на удаленную рабочую область

При первом подключении к удаленной рабочей области RTVS запрашивает учетные данные, а затем кэширует их (с помощью безопасного хранилища учетных данных Windows) для последующих сеансов. Подключение к удаленному серверу осуществляется защищенным способом по протоколу HTTPS (который является обязательным).

В зависимости от конфигурации сервера при подключении может появиться предупреждение о сертификате: "Сертификат безопасности, предоставленный удаленными службами R Services, не позволяет нам удостовериться, что вы действительно подключаетесь к компьютеру (имя компьютера)".

![Предупреждение о самозаверяющем сертификате при подключении к удаленной рабочей области](~/docs/rtvs/media/workspaces-remote-self-signed-certificate-warning.png)

Сертификат — это документ, который представляется RTVS компьютером, на котором вы пытаетесь подключиться. В этом документе имеется поле, в котором указан URI этого компьютера. Предупреждение появляется в случае, когда RTVS обнаруживает несоответствие между URI в сертификате и URI, который используется для подключения к компьютеру, что указывает на потенциальный взлом системы безопасности сервера.

Однако это предупреждение также отображается в случае, когда для включения протокола HTTPS на удаленном компьютере вместо сертификата от одного из доверенных поставщиков использовался *самозаверяющий сертификат*. Дополнительные сведения см. в разделе [Настройка удаленных рабочих областей](workspaces-remote-setup.md).

## <a name="directories-on-local-and-remote-computers"></a>Каталоги на локальных и удаленных компьютерах

По умолчанию при запуске нового интерпретатора R в локальной рабочей области текущим рабочим каталогом становится папка `%userprofile%\Documents`. Это значение можно в любое время изменить, воспользовавшись командами в меню **Инструменты R > Рабочий каталог** или щелкнув правой кнопкой мыши проект в обозревателе решений Visual Studio и выбрав команду **Задать текущий каталог в качестве рабочего**.

На удаленных компьютерах RTVS автоматически создает профиль пользователя на основе учетных данных, указанных при первом подключении к серверу, поэтому рабочим каталогом будет папка `Documents` в этом профиле. Она будет использоваться для всех последующих сеансов удаленного доступа, в которых используются те же учетные данные. 

В результате точное расположение, где выполняется код, может различаться для локальных и удаленных рабочих областей. Избегайте использования в коде абсолютных путей к файлам данных и т. п., поскольку в этом случае код скорее всего не удастся перенести в другие рабочие области. Вместо этого используйте относительные пути.

Обратите внимание, что в удаленных рабочих областях все файлы в рабочем каталоге остаются во всех сеансах для одного профиля пользователя. Как отмечалось ранее, эти файлы можно удалить с помощью команды **Инструменты R > Сеанс > Сброс** (или кнопки сброса в интерактивном окне) при использовании удаленной рабочей области. При этом профиль пользователя будет удален с сервера; при повторном подключении он создается заново.

## <a name="copying-project-files-to-remote-workspaces"></a>Копирование файлов проекта в удаленные рабочие области

При работе с проектами R в Visual Studio на локальном компьютере всегда имеются актуальные версий файлов проекта, даже при использовании удаленной рабочей области. То есть при открытии проекта в Visual Studio (что обычно означает открытие решения, содержащего проект) RTVS предполагает, что содержимое проекта находится на локальном компьютере. По сути, удаленная рабочая область является только временным хранилищем для файлов проекта и всех выходных данных в коде. Это означает, например, что при загрузке файла с помощью `source` в интерактивном окне этот файл должен уже находиться на удаленном компьютере по указанному вами пути или он должен находиться в текущем рабочем каталоге удаленного интерпретатора R (задается с помощью функции `setwd()`).

Файлы копируются на удаленный сервер следующим образом.

- Для удаленной работы с файлами в интерактивном окне их необходимо сначала скопировать вручную, щелкнув эти файлы (или проект) правой кнопкой мыши в обозревателе решений и выбрав **Использовать выбранные файлы в качестве источника**. Отдельные файлы будут скопированы в рабочий каталог на сервере; при копировании проекта RTVS создаст папку для проекта.

- Также можно скопировать файлы, выделив их в обозревателе решений и выбрав **Использовать выбранные файлы в качестве источника**. После этого они будут загружены в интерактивное окно, где и будут выполнены. Если сеанс подключен к удаленному компьютеру, файлы первым делом копируются туда.

- Когда RTVS привязан к удаленной рабочей области, при нажатии клавиши F5, выборе команды **Отладка > Начать отладку** или запуске кода иным способом RTVS по умолчанию автоматически скопирует файл проекта в удаленную рабочую область (способ управления этим указан ниже).

- Все файлы, которые уже существуют на сервере, будут перезаписаны.

> [!Note]
> Поскольку RTVS не обеспечивает надежный перехват всех вызовов функций R, вызов таких функций, как `source()` или `runApp()` (для приложений Shiny) из интерактивного окна, *не* приводит к копированию файлов в удаленную рабочую область.

Настройка того, следует ли RTVS копировать файлы при выполнения проекта, а также точное указание того, какие файлы являются копиями, осуществляется с помощью [свойств проекта](projects.md#project-properties). Чтобы открыть страницу свойств, выберите команду **Проект > Свойства (название проекта)** или щелкните проект в обозревателе решений правой кнопкой мыши и выберите **Свойства**.

![Окно свойств проекта со вкладкой "Выполнение" и настройками передачи файлов](~/docs/rtvs/media/workspaces-remote-file-transfer-filter-settings.png)

Здесь параметр **Передать файлы при выполнении** определяет, следует ли RTVS автоматически копировать файлы проекта. В поле **Файлы для передачи** указываются типы файлов для передачи. По умолчанию копируются только файлы `.R`, `.Rmd`, `.sql`, `.md` и `.cpp`. Это позволяет избежать случайного копирования на сервер больших файлов данных при каждом выполнении. 

## <a name="copying-files-from-a-remote-workspace"></a>Копирование файлов из удаленной рабочей области

Если ваш скрипт R создает файлы на сервере, эти файлы можно скопировать обратно на клиент с помощью функции `rtvs::fetch_file`. В этой функции необходимо как минимум указать удаленный путь к файлу, который требуется скопировать на компьютер, и при необходимости путь к расположению на компьютере, куда требуется скопировать в этот файл. Если путь не указан, файл будет скопирован в папку `%userprofile%\Downloads`.

