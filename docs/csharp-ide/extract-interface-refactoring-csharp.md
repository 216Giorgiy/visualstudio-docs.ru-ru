---
redirect_url: /visualstudio/csharp-ide/refactoring/extract-interface
title: "Рефакторинг (C#) для извлечения интерфейса | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-general
ms.tgt_pltfrm: 
ms.topic: article
dev_langs: CSharp
helpviewer_keywords:
- refactoring [C#], Extract Interface
- Extract Interface refactoring operation [C#]
ms.assetid: 7d0aa225-3b33-4331-9652-5a67cac6f3d0
caps.latest.revision: "25"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.openlocfilehash: 4ed81f6f0fbcc2e72fd57d7706b051dcdf7bea75
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="extract-interface-refactoring-c"></a>Рефакторинг для извлечения интерфейса (C#)
Извлечение интерфейса — это операция оптимизации, который предоставляет простой способ создать новый интерфейс с членами, которые создаются из существующего класса, структуры или интерфейса.  
  
 Если несколько клиентов используют один и тот же поднабор элементов из класса, структуры или интерфейса или несколько классов, структур или интерфейсов имеют подмножество элементов Общие, может быть полезно создать подмножества членов интерфейс их. Дополнительные сведения об использовании интерфейсов см. в разделе [интерфейсы](/dotnet/csharp/programming-guide/interfaces/index).  
  
 Извлечение интерфейса создает интерфейс, в новый файл и помещает курсор в начале нового файла. Можно указать члены, которые нужно извлечь в новый интерфейс, имя нового интерфейса и имя создаваемого файла с помощью **извлечение интерфейса** диалоговое окно.  
  
### <a name="to-use-extract-interface"></a>Чтобы использовать извлечение интерфейса  
  
1.  Создайте консольное приложение с именем `ExtractInterface`, а затем замените `Program` с помощью следующего кода  
  
    ```csharp  
    // Invoke Extract Interface on ProtoA.  
    // Note:  the extracted interface will be created in a new file.  
    class ProtoA  
    {  
        public void MethodB(string s) { }  
    }  
    ```  
  
2.  Когда курсор находится в `MethodB`и нажмите кнопку **извлечение интерфейса** на **рефакторинг** меню.  
  
     **Извлечение интерфейса** откроется диалоговое окно.  
  
     Можно также ввести сочетание клавиш CTRL + R, I, чтобы отобразить **извлечение интерфейса** диалоговое окно.  
  
     Также можно щелкнуть правой кнопкой мыши, выберите пункт **рефакторинг**и нажмите кнопку **извлечение интерфейса** для отображения **извлечение интерфейса** диалоговое окно.  
  
3.  Нажмите кнопку **выбрать все**.  
  
4.  Нажмите кнопку **ОК**.  
  
     Появится новый файл, IProtoA.cs и следующий код:  
  
    ```csharp  
    using System;  
    namespace TopThreeRefactorings  
    {  
        interface IProtoA  
        {  
            void MethodB(string s);  
        }  
    }  
    ```  
  
## <a name="remarks"></a>Примечания  
 Этот компонент доступен только в случае, когда курсор помещается в класс, структура или интерфейс, который содержит элементы, которые требуется извлечь. Если курсор находится в этой позиции, вызывайте извлечение интерфейса-операция рефакторинга.  
  
 При вызове извлечение интерфейса для класса или структуры, список базовых классов и интерфейсов изменяется для включите новое имя интерфейса. При вызове извлечение интерфейса для интерфейса список базовых классов и интерфейсов не изменяется.  
  
## <a name="see-also"></a>См. также  
 [Рефакторинг (C#)](refactoring-csharp.md)