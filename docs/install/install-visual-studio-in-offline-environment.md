---
title: "Особые рекомендации по установке Visual Studio в автономной среде | Документация Майкрософт"
description: "{{ЗАПОЛНИТЕЛЬ}}"
ms.date: 06/05/2017
ms.reviewer: tims
ms.suite: 
ms.technology:
- vs-ide-install
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- '{{PLACEHOLDER}}'
- '{{PLACEHOLDER}}'
ms.assetid: 9750A3F3-89C7-4A8F-BA75-B0B06BD772C2
author: timsneath
ms.author: tims
manager: ghogen
translation.priority.ht:
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- ru-ru
- zh-cn
- zh-tw
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: Human Translation
ms.sourcegitcommit: 8ce85525f6af336682f6f8547c2f6c13dde73c8c
ms.openlocfilehash: 1ce2f854d1c8e4a184446fb07c66a6fad9ca9ae1
ms.contentlocale: ru-ru
ms.lasthandoff: 06/23/2017

---
# <a name="special-considerations-for-installing-visual-studio-in-an-offline-environment"></a>Особые рекомендации по установке Visual Studio в автономной среде

Visual Studio рассчитана в основном на установку с компьютера, подключенного к Интернету, поскольку многие ее компоненты регулярно обновляются. Но вы можете, выполнив несколько дополнительных действий, создать развертывание Visual Studio и в среде без подключения к Интернету.

## <a name="install-certificates-needed-for-visual-studio-offline-installation"></a>Установка сертификатов, необходимых для установки Visual Studio в автономном режиме
Программа установки Visual Studio устанавливает только то содержимое, который считается доверенным. Перед установкой она проверяет наличие сигнатур Authenticode для скачиваемого содержимого и наличие доверия для всего содержимого. Это позволяет обезопасить среду от атак, направленных на расположение загрузки. Таким образом, программа установки Visual Studio требует наличия и актуального состояния различных стандартных корневых и промежуточных сертификатов на компьютере пользователя. Если компьютер периодически обновляется с помощью центра обновления Windows, сертификаты для подписи обновляются автоматически, и во время установки Visual Studio будет обновлять сертификаты по мере необходимости для проверки сигнатур файлов. 

Что касается предприятий с автономными компьютерами, на которых нет последних корневых сертификатов, администратор может использовать [инструкции в этой статье](https://technet.microsoft.com/en-us/library/dn265983.aspx) для их обновления. Кроме того, во время создания структуры сети необходимые сертификаты скачиваются в папку `certificates` и могут быть установлены вручную. Для этого дважды щелкните файл сертификата и выполните шаги, предлагаемые мастером диспетчера сертификатов. Если он предложит ввести пароль, оставьте это поле пустым.

При настройке развертывания Visual Studio в автономной среде на клиентских рабочих станциях с помощью сценариев необходимо выполнить следующие действия.

1. Скопируйте [диспетчер сертификатов](https://msdn.microsoft.com/en-us/library/e78byta0.aspx) (`certmgr.exe`) в общую папку установки (например, `\\server\share\vs2017`). `certmgr.exe` не является компонентом Windows, но доступен как часть пакета [Windows SDK](https://developer.microsoft.com/en-US/windows/downloads/windows-10-sdk). 

2. С помощью следующих команд создайте пакетный файл сценария:

   ```cmd
   certmgr.exe -add -c certificates\manifestSignCertificates.p12 -n "Microsoft Code Signing PCA 2011" -s -r LocalMachine CA
   
   certmgr.exe -add -c certificates\manifestSignCertificates.p12 -n "Microsoft Root Certificate Authority" -s -r LocalMachine root
   
   certmgr.exe -add -c certificates\manifestCounterSignCertificates.p12 -n "Microsoft Time-Stamp PCA 2010" -s -r LocalMachine CA
   
   certmgr.exe -add -c certificates\manifestCounterSignCertificates.p12 -n "Microsoft Root Certificate Authority" -s -r LocalMachine root
   
   certmgr.exe -add -c certificates\vs_installer_opc.SignCertificates.p12 -n "Microsoft Code Signing PCA" -s -r LocalMachine CA
   
   certmgr.exe -add -c certificates\vs_installer_opc.SignCertificates.p12 -n "Microsoft Root Certificate Authority" -s -r LocalMachine root
   ```

3. Разверните пакетный файл на клиенте. Эту команду необходимо выполнить из процесса с повышенными правами.

### <a name="what-are-the-certificates-files-in-the-certificates-folder"></a>Какие файлы сертификатов содержатся в папке `certificates`?
Три файла `.p12` в этой папке содержат промежуточный сертификат и корневой сертификат. В большинстве систем, обновляемых с помощью Центра обновления Windows, эти сертификаты должны быть уже установлены.

1. `ManifestSignCertificates.p12` содержит
    * Промежуточный сертификат: **Microsoft Code Signing PCA 2011**
        * Не требуется. При наличии повышает производительность в некоторых сценариях.
    * Корневой сертификат: **Microsoft Root Certificate Authority 2011**
        * Требуется в системах Windows 7 с пакетом обновления 1 (SP1), в которых не установлены последние обновления Центра обновления Windows.
2. `ManifestCounterSignCertificates.p12`
    * Промежуточный сертификат: **Microsoft Time-Stamp PCA 2010**
        * Не требуется. При наличии повышает производительность в некоторых сценариях.
    * Корневой сертификат: **Microsoft Root Certificate Authority 2010**
        * Требуется в системах Windows 7 с пакетом обновления 1 (SP1), в которых не установлены последние обновления Центра обновления Windows.
3. `vs_installer_opc.SignCertificates.p12`
    * Промежуточный сертификат: **Microsoft Code Signing PCA**
        * Является обязательным для всех систем. Примечание. В системах, которые постоянно обновляются с помощью Центра обновления Windows, этот сертификат может отсутствовать.
    * Корневой сертификат: **Microsoft Root Certificate Authority**
        * Обязательный. Этот сертификат поставляется с системами под управлением Windows 7 или более поздней версии.

### <a name="why-are-the-certificates-from-the-certificates-folder-not-installed-automatically"></a>Почему сертификаты из папки `certificates` не устанавливаются автоматически?
В среде с подключением к Интернету в процессе проверки подписи используются Windows API для загрузки и добавления сертификатов. Этот процесс включает проверку того, что сертификат является доверенным и допустимым в соответствии с настройками администрирования. В большинстве случаев процесс проверки невозможно выполнить в автономных средах. Установив сертификаты вручную, вы предоставите администраторам предприятия возможность убедиться в том, что сертификаты являются надежными и соответствуют требованиям политики безопасности организации.

### <a name="checking-if-certificates-are-already-installed"></a>Проверка наличия необходимых сертификатов
Чтобы проверить установку системы, можно выполнить следующие действия.
* Запустите mmc.exe.
* В меню "Файл" выберите "Добавить или удалить оснастку".
  * Дважды щелкните **Сертификаты**, выберите **Учетная запись компьютера** и нажмите кнопку **Далее**.
  * Выберите **Локальный компьютер**, нажмите кнопку **Готово**, а затем **ОК**.
  * Разверните узел **Сертификаты (локальный компьютер)**.
  * Разверните узел **Доверенные корневые центры сертификации** и выберите **Сертификаты**.
    * Убедитесь, что в этом списке содержатся необходимые корневые сертификаты.
  * Разверните узел **Промежуточные центры сертификации** и выберите **Сертификаты**.
    * Убедитесь, что в этом списке содержатся необходимые промежуточные сертификаты.
* В меню "Файл" выберите "Добавить или удалить оснастку".
  * Дважды щелкните **Сертификаты** выберите **моей учетной записи пользователя**, нажмите кнопку **Готово** и **ОК**.
  * Разверните узел **Сертификаты — текущий пользователь**.
  * Разверните узел **Промежуточные центры сертификации** и выберите **Сертификаты**.
    * Убедитесь, что в этом списке содержатся необходимые промежуточные сертификаты.
    
Если имена сертификатов не содержатся в столбцах **Кому выдан**, их необходимо установить.  Если промежуточный сертификат находился только в хранилище промежуточных сертификатов **текущего пользователя**, значит он доступен только для пользователя, выполнившего вход в систему. Следовательно, его может потребоваться установить для других пользователей.

## <a name="install-visual-studio"></a>Установка Visual Studio
Когда сертификаты будут установлены, развертывание Visual Studio можно выполнять в автономном режиме как обычно, без каких-либо дополнительных действий, в соответствии с [приведенными здесь инструкциями](create-a-network-installation-of-visual-studio.md#deploying-from-a-network-installation).


## <a name="see-also"></a>См. также
* [Установка Visual Studio](install-visual-studio.md)
* [Руководство администратора Visual Studio](visual-studio-administrator-guide.md)
* [Использование параметров командной строки для установки Visual Studio](use-command-line-parameters-to-install-visual-studio.md)
* [Идентификаторы рабочих нагрузок и компонентов Visual Studio](workload-and-component-ids.md)

