---
title: "Функция SccGetProjPath | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords: SccGetProjPath
helpviewer_keywords: SccGetProjPath function
ms.assetid: 1079847e-d45f-4cb8-9d92-1e01ce5d08f6
caps.latest.revision: "15"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.workload: vssdk
ms.openlocfilehash: 2ce41826a3a0d778c5a417496d47f290e97806fb
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="sccgetprojpath-function"></a>Функция SccGetProjPath
Эта функция пользователю путь проекта, который является строкой, которая имеет значение только для подключаемого модуля системы управления версиями. Вызывается, когда пользователь становится:  
  
-   Создание нового проекта  
  
-   При добавлении существующего проекта в систему управления версиями  
  
-   Предпринимается попытка найти существующий проект управления версиями  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
SCCRTN SccGetProjPath (  
   LPVOID pvContext,  
   HWND   hWnd,  
   LPSTR  lpUser,  
   LPSTR  lpProjName,  
   LPSTR  lpLocalPath,  
   LPSTR  lpAuxProjPath,  
   BOOL   bAllowChangePath,  
   LPBOOL pbNew  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Исходная структура подключаемого модуля контекста элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpUser  
 [in, out] Имя пользователя (не должна превышать SCC_USER_SIZE, включая символ конца строки)  
  
 lpProjName  
 [in, out] Имя проекта IDE, рабочую область проекта или файла makefile (не должна превышать SCC_PRJPATH_SIZE, включая символ конца строки).  
  
 lpLocalPath  
 [in, out] Путь рабочей проекта. Если `bAllowChangePath` — `TRUE`, подключаемый модуль системы управления версиями можно изменить эту строку (не должна превышать _MAX_PATH, включая символ конца строки).  
  
 lpAuxProjPath  
 [in, out] Буфер для путь возвращаемой проекта (не должна превышать SCC_PRJPATH_SIZE, включая символ конца строки).  
  
 bAllowChangePath  
 [in] Если это `TRUE`, подключаемый модуль системы управления версиями можно запрашивать и изменять `lpLocalPath` строки.  
  
 pbNew  
 [in, out] Значение, поступающих в указывает, следует ли создать новый проект. Возвращаемое значение указывает на успешное завершение создания проекта:  
  
|Входящие|Интерпретация|  
|--------------|--------------------|  
|true|Пользователь может создать новый проект.|  
|false|Пользователь не может создать новый проект.|  
  
|Исходящий|Интерпретация|  
|--------------|--------------------|  
|true|Был создан новый проект.|  
|false|Был выбран существующий проект.|  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализация подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание:|  
|-----------|-----------------|  
|SCC_OK|Проект был успешно создан или извлечь.|  
|SCC_I_OPERATIONCANCELED|Операция была отменена.|  
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления версиями, возможно, из-за проблемы с сетью или конфликтов.|  
|SCC_E_CONNECTIONFAILURE|Ошибка при попытке подключения к системе управления версиями.|  
|SCC_E_NONSPECIFICERROR|Произошла неизвестная ошибка.|  
  
## <a name="remarks"></a>Примечания  
 Эта функция предназначена для интегрированной среды разработки для получения параметров `lpProjName` и `lpAuxProjPath`. После этой информации с приглашением подключаемый модуль системы управления версиями, он передает эти две строки обратно в Интегрированной среде разработки. Среда разработки сохраняет эти строки в файле решения и передает их [SccOpenProject](../extensibility/sccopenproject-function.md) каждый раз, когда пользователь открывает этот проект. Эти строки включить подключаемого модуля для отслеживания сведений, связанных с проектом.  
  
 При вызове функции `lpAuxProjPath` устанавливается равным пустой строке. `lProjName`также может быть пустым, или он может содержать имя проекта интегрированной среды разработки, которое может использовать или игнорировать подключаемый модуль системы управления версиями. После успешного возврата функции, подключаемый модуль возвращает два соответствующих строк. IDE не дает представления о эти строки, не будет использовать их и не позволит пользователю изменять их. Если пользователь хочет изменить параметры, интегрированной среды разработки будет вызывать `SccGetProjPath` еще раз, передавая в те же значения получала предыдущее время. Это дает подключаемого модуля полностью контролировать эти две строки.  
  
 Для `lpUser`, интегрированной среды разработки может передать имя пользователя или он может просто передать указатель на пустую строку. Если имя пользователя, подключаемый модуль системы управления версиями следует использовать как значение по умолчанию. Тем не менее, если имя не было передано или Ошибка входа в систему с заданным именем, подключаемый модуль должен запрашивать у пользователя имя входа и передайте имя обратно в `lpUser` при получении действительного имени входа. Так как подключаемый модуль может изменить эту строку, интегрированной среды разработки всегда будет выделить буфер размером (`SCC_USER_LEN`+ 1).  
  
> [!NOTE]
>  Первое действие, выполняющий интегрированной среды разработки может быть либо вызов `SccOpenProject` функции или `SccGetProjPath` функции. Таким образом, у них одинаковые `lpUser` параметр, позволяющий системы управления версиями для входа пользователя в или во время. Даже при возврате из функции указывает на сбой, подключаемый модуль, необходимо указать эту строку с недопустимым именем для входа.  
  
 `lpLocalPath`— Это каталог, где пользователь сохраняет проект. Он может быть пустой строкой. Если нет каталога, определенных в настоящий момент (как в случае попытки загрузить проект из системы управления версиями пользователем) и `bAllowChangePath` — `TRUE`, подключаемый модуль системы управления версиями можно запрашивать у пользователя ввод или другим методом разместить его владельцем строки в `lpLocalPath`. Если `bAllowChangePath` — `FALSE`, подключаемый модуль не следует изменять строки, так как пользователь уже работает в указанном каталоге.  
  
 Если пользователь создает новый проект, чтобы поместить в системе управления версиями, подключаемый модуль системы управления версиями может не создать фактически в системе управления версиями во время `SccGetProjPath` вызывается. Вместо этого он передает обратно строку вместе с ненулевое значение для `pbNew`, указывает, что проект будут созданы в системе управления версиями.  
  
 Например, если пользователь в **новый проект** мастер в Visual Studio добавляет свой проект в систему управления версиями, Visual Studio вызывает эту функцию и подключаемый модуль определяет, можно создать новый проект в системе управления версиями для содержат проект Visual Studio. Если пользователь нажимает кнопку **отменить** перед завершением мастера, проект не будет создаться никогда. Если пользователь нажимает кнопку **ОК**, Visual Studio вызывает `SccOpenProject`, передавая `SCC_OPT_CREATEIFNEW`, и в это время создается проект системы управления версиями.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [SccOpenProject](../extensibility/sccopenproject-function.md)