---
title: "Функция SccGetProjPath | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- SccGetProjPath
helpviewer_keywords:
- SccGetProjPath function
ms.assetid: 1079847e-d45f-4cb8-9d92-1e01ce5d08f6
caps.latest.revision: 15
ms.author: gregvanl
manager: ghogen
translation.priority.mt:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 5db97d19b1b823388a465bba15d057b30ff0b3ce
ms.openlocfilehash: 551fe26fe20da62d6892a8c7e807cf6c22600fc8
ms.lasthandoff: 02/22/2017

---
# <a name="sccgetprojpath-function"></a>Функция SccGetProjPath
Эта функция пользователю путь проекта, который является строкой, имеет смысл только для подключаемого модуля системы управления версиями. Вызывается, когда пользователь является:  
  
-   Создание нового проекта  
  
-   При добавлении существующего проекта в систему управления версиями  
  
-   Попытка найти существующий проект контроля версий  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp#  
SCCRTN SccGetProjPath (  
   LPVOID pvContext,  
   HWND   hWnd,  
   LPSTR  lpUser,  
   LPSTR  lpProjName,  
   LPSTR  lpLocalPath,  
   LPSTR  lpAuxProjPath,  
   BOOL   bAllowChangePath,  
   LPBOOL pbNew  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Структура подключаемого модуля контекста исходного элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpUser  
 [in, out] Имя пользователя (не должна превышать SCC_USER_SIZE, включая символ конца строки NULL)  
  
 lpProjName  
 [in, out] Имя проекта интегрированной среды разработки, рабочей области проекта или файла makefile (не должна превышать SCC_PRJPATH_SIZE, включая символ конца строки NULL).  
  
 lpLocalPath  
 [in, out] Путь рабочего проекта. Если `bAllowChangePath` — `TRUE`, подключаемый модуль системы управления версиями можно изменить эту строку (не превышает _MAX_PATH, включая символ конца строки).  
  
 lpAuxProjPath  
 [in, out] Буфер для пути возвращаемый проекта (не должна превышать SCC_PRJPATH_SIZE, включая символ конца строки NULL).  
  
 bAllowChangePath  
 [in] Если это `TRUE`, подключаемый модуль системы управления версиями можно запрашивать и изменять `lpLocalPath` строку.  
  
 pbNew  
 [in, out] В значение указывает, следует ли создать новый проект. Возвращаемое значение указывает на успешное завершение создания проекта:  
  
|Входящие|Интерпретация|  
|--------------|--------------------|  
|TRUE|Пользователь может создать новый проект.|  
|FALSE|Пользователь не может создать новый проект.|  
  
|Исходящий|Интерпретация|  
|--------------|--------------------|  
|TRUE|Был создан новый проект.|  
|FALSE|Был выбран существующий проект.|  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|-----------|-----------------|  
|SCC_OK|Проект был успешно создан или получить.|  
|SCC_I_OPERATIONCANCELED|Операция была отменена.|  
|SCC_E_ACCESSFAILURE|Произошла ошибка при доступе к системе управления версиями, вероятно, из-за проблемы с сетью или конфликтов.|  
|SCC_E_CONNECTIONFAILURE|Ошибка при попытке подключения к системе управления версиями.|  
|SCC_E_NONSPECIFICERROR|Произошла неизвестная ошибка.|  
  
## <a name="remarks"></a>Примечания  
 Эта функция предназначена для получения параметров IDE `lpProjName` и `lpAuxProjPath`. После подключаемый модуль системы управления версиями предлагает пользователю ввести эти сведения, он передает эти две строки в Интегрированной среде разработки. Среда разработки сохраняет эти строки в файле решения и передает их [SccOpenProject](../extensibility/sccopenproject-function.md) каждый раз, когда пользователь открывает этот проект. Эти строки включить подключаемый модуль для отслеживания сведений, связанных с проектом.  
  
 При вызове функции `lpAuxProjPath` установлено равным пустой строке. `lProjName`также может быть пустым, или он может содержать имя проекта интегрированной среды разработки, которое может использовать или игнорировать подключаемый модуль системы управления версиями. Если функция успешно возвращает значение, подключаемый модуль возвращает два соответствующих строк. IDE не делаются никакие предположения о эти строки, не используйте их и не позволит пользователю изменять их. Если пользователь хочет изменить параметры, будет вызывать IDE `SccGetProjPath` снова, передавая в те же значения получала предыдущее время. Это дает подключаемый модуль полный контроль над этими двумя строками.  
  
 Для `lpUser`, интегрированной среды разработки может передать имя пользователя, или он может просто передать указатель на пустую строку. Если имя пользователя, подключаемый модуль системы управления версиями следует использовать как значение по умолчанию. Тем не менее, если имя не было передано или Ошибка входа в систему с заданным именем, подключаемый модуль должен запросить пользователя для входа в систему и передайте имя обратно в `lpUser` при получении действительного имени входа. Так как подключаемый модуль может изменить эту строку, IDE всегда будет выделить буфер размером (`SCC_USER_LEN`+&1;).  
  
> [!NOTE]
>  Первая выполняет действие, которое интегрированной среды разработки может быть либо вызов `SccOpenProject` функции или `SccGetProjPath` функции. Следовательно, у них одинаковые `lpUser` параметр, позволяющий модуль для входа пользователя в или во время управления версиями. Даже если возврат из функции указывает на сбой, подключаемый модуль необходимо ввести эту строку с недопустимым именем для входа.  
  
 `lpLocalPath`— Это каталог, где пользователь сохраняет проект. Он может быть пустой строкой. Если не существует каталога в настоящее время определены (как в случае пользователь, пытающийся загрузить проект из системы управления версиями) и `bAllowChangePath` — `TRUE`, подключаемый модуль системы управления версиями может запросить у пользователя ввод или другого метода разместить свои строки в `lpLocalPath`. Если `bAllowChangePath` — `FALSE`, подключаемый модуль не следует менять строку, поскольку пользователь уже работает в указанном каталоге.  
  
 Если пользователь создает новый проект, чтобы поместить в системе управления версиями, подключаемый модуль системы управления версиями может не создать на самом деле он в системе управления версиями во время `SccGetProjPath` вызывается. Вместо этого он передает строку вместе с ненулевое значение для `pbNew`, указывает, что проект будут созданы в системе управления версиями.  
  
 Например, если пользователь в **новый проект** мастера в Visual Studio добавляет свой проект в систему управления версиями, вызывает данную функцию, Visual Studio и подключаемый модуль определяет, является ли необходимо создать новый проект в системе управления версиями для проекта Visual Studio. Если пользователь нажимает кнопку **отменить** перед завершением мастера, проект не создается. Если пользователь нажимает кнопку **ОК**, Visual Studio вызывает `SccOpenProject`, передавая `SCC_OPT_CREATEIFNEW`, и в этот момент создается проект системы управления версиями.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [SccOpenProject](../extensibility/sccopenproject-function.md)
