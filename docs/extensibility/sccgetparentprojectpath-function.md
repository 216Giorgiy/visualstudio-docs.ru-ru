---
title: "Функция SccGetParentProjectPath | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SccGetParentProjectPath"
helpviewer_keywords: 
  - "Функция SccGetParentProjectPath"
ms.assetid: 62a71579-36b3-48b9-a1c8-04ab100efa08
caps.latest.revision: 17
caps.handback.revision: 17
ms.author: "gregvanl"
manager: "ghogen"
---
# Функция SccGetParentProjectPath
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Эта функция определяет родительский путь проекта из указанного проекта. Эта функция вызывается, когда пользователь добавляет проект Visual Studio для системы управления версиями.  
  
## Синтаксис  
  
```cpp#  
SCCRTN SccGetParentProjectPath(  
   LPVOID pContext,  
   HWND   hWnd,  
   LPSTR  lpUser,  
   LPCSTR lpProjPath,  
   LPSTR  lpAuxProjPath,  
   LPSTR  lpParentProjPath  
);  
```  
  
#### Параметры  
 pContext  
 \[in\] Подключаемый модуль Контекстный указатель исходного элемента управления.  
  
 hWnd  
 \[in\] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpUser  
 \[in, out\] Имя пользователя \(до SCC\_USER\_SIZE, включая символ конца строки NULL\).  
  
 lpProjPath  
 \[in\] Строка, идентифицирующая путь проекта \(до SCC\_PRJPATH\_SIZE, включая символ конца строки NULL\).  
  
 lpAuxProjPath  
 \[in, out\] Вспомогательный строка, определяющая проекта \(до SCC\_PRJPATH\_SIZE, включая символ конца строки NULL\).  
  
 lpParentProjPath  
 \[in, out\] Выходная строка идентификации родительский путь проекта \(до SCC\_PRJPATH\_SIZE, включая символ конца строки NULL\).  
  
## Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|--------------|--------------|  
|SCC\_OK|Родительский путь проекта был успешно получен.|  
|SCC\_E\_INITIALIZEFAILED|Не удалось инициализировать проект.|  
|SCC\_E\_INVALIDUSER|Пользователю не удалось выполнить вход модуль управления версиями.|  
|SCC\_E\_UNKNOWNPROJECT|Подключаемый модуль системы управления версиями проекта неизвестен.|  
|SCC\_E\_INVALIDFILEPATH|Путь к файлу недопустим или непригодным для использования.|  
|SCC\_E\_NOTAUTHORIZED|Для выполнения этой операции не разрешено пользователю.|  
|SCC\_E\_ACCESSFAILURE|Произошла ошибка при доступе к системе управления версиями, вероятно, из\-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC\_E\_PROJSYNTAXERR|Проект недопустимый синтаксис.|  
|SCC\_E\_CONNECTIONFAILURE|Проблема подключения хранилища.|  
|SCC\_E\_NONSPECIFICERROR<br /><br /> SCC\_E\_UNKNOWNERROR|Неспецифическая ошибка.|  
  
## Заметки  
 Эта функция возвращает успех или неудачу код и, в случае успешного выполнения заполняет переменную `lpParentProjPath` путь полный проект в указанный проект.  
  
 Эта функция возвращает родительский путь проекта из существующего проекта. Для корневой проект, функция возвращает путь к проекту, который был передан в \(то есть тот же корневой проект путь\). Обратите внимание, что путь проекта строка, которая имеет смысл только для подключаемого модуля системы управления версиями.  
  
 IDE готова к принятию изменений `lpUser` и `lpAuxProjPath` также параметры. Среда IDE будет сохранять эти строки и передать их в [SccOpenProject](../extensibility/sccopenproject-function.md) при открытии этого проекта в будущем. Эти строки таким образом, представляют собой способ для системы управления версиями, подключаемый модуль для данных отслеживания, который необходимо связать с проектом.  
  
 Эта функция аналогична [SccGetProjPath](../extensibility/sccgetprojpath-function.md), за исключением того, что он не предлагать пользователю выбрать проект. Он также не создает новый проект, но работает только с существующим проектом.  
  
 При `SccGetParentProjectPath` вызове `lpProjPath` и `lpAuxProjPath` не будет пустым и будет соответствовать допустимым проектом. Эти строки обычно принимаются IDE из предыдущего вызова `SccGetProjPath` функции.  
  
 `lpUser` Аргумент представляет собой имя пользователя. IDE передаст тем же именем пользователя, он ранее получен от `SccGetProjPath` функции и подключаемый модуль системы управления версиями следует использовать имя по умолчанию. Если пользователь уже открытое соединение с помощью подключаемого модуля, подключаемый модуль должен попытайтесь устранить каких\-либо запросов, чтобы убедиться в том, что функция будет работать без вмешательства пользователя. Тем не менее, если имя входа не удается, подключаемый модуль должен запросить пользователя для входа и, получив является допустимым именем входа, передайте имя обратно в `lpUser`. Так как подключаемый модуль может изменить эту строку, IDE всегда будет выделить буфер размером \(`SCC_USER_LEN`\+ 1\). Если строка изменяется, новая строка необходимо допустимое имя входа \(по крайней мере как допустимый как старая строка\).  
  
## Технические примечания для SccCreateSubProject и SccGetParentProjectPath  
 Добавление решений и проектов в систему управления версиями, был упрощен в Visual Studio, чтобы свести к минимуму количество раз, когда пользователь будет предложено выбрать расположения в системе управления версиями. Эти изменения активируются по Visual Studio, если подключаемый модуль системы управления версиями поддерживает несколько новых функций [SccCreateSubProject](../extensibility/scccreatesubproject-function.md) и `SccGetParentProjectPath` функции. Однако следующий параметр реестра можно отключить эти изменения и вернуться к предыдущему поведению Visual Studio \(исходный элемент управления Plug\-in API версии 1.1\).  
  
 \[HKEY\_CURRENT\_USER\\Software\\Microsoft\\VisualStudio\\8.0\\SourceControl\] «DoNotCreateSolutionRootFolderInSourceControl» \= DWORD: 00000001  
  
 Если этот параметр реестра не существует или имеет значение DWORD: 00000000, пытается использовать новые функции Visual Studio `SccCreateSubProject`и`SccGetParentProjectPath`.  
  
 Если параметр реестра DWORD: 00000001, Visual Studio не будет пытаться использовать эти новые функции и операции добавления в систему управления версиями работают так, как было в предыдущих версиях Visual Studio.  
  
## См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [SccCreateSubProject](../extensibility/scccreatesubproject-function.md)   
 [SccGetProjPath](../extensibility/sccgetprojpath-function.md)