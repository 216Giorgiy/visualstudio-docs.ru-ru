---
title: Функция SccGetParentProjectPath | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
f1_keywords:
- SccGetParentProjectPath
helpviewer_keywords:
- SccGetParentProjectPath function
ms.assetid: 62a71579-36b3-48b9-a1c8-04ab100efa08
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: ea52e0d4c6242c57447cd47d41b716ba5e93a2f6
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="sccgetparentprojectpath-function"></a>Функция SccGetParentProjectPath
Эта функция определяет родительский путь проекта из указанного проекта. Эта функция вызывается, когда пользователь добавляет проект Visual Studio для системы управления версиями.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
SCCRTN SccGetParentProjectPath(  
   LPVOID pContext,  
   HWND   hWnd,  
   LPSTR  lpUser,  
   LPCSTR lpProjPath,  
   LPSTR  lpAuxProjPath,  
   LPSTR  lpParentProjPath  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pContext  
 [in] Подключаемый модуль Контекстный указатель исходного элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpUser  
 [in, out] Имя пользователя (до SCC_USER_SIZE, включая символ конца строки).  
  
 lpProjPath  
 [in] Строка, определяющая путь к проекту (до SCC_PRJPATH_SIZE, включая символ конца строки).  
  
 lpAuxProjPath  
 [in, out] Вспомогательный строка, определяющая проекта (до SCC_PRJPATH_SIZE, включая символ конца строки).  
  
 lpParentProjPath  
 [in, out] Выходная строка идентификации родительский путь проекта (до SCC_PRJPATH_SIZE, включая символ конца строки).  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализация подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|-----------|-----------------|  
|SCC_OK|Родительский путь проекта был успешно получен.|  
|SCC_E_INITIALIZEFAILED|Не удается инициализировать проект.|  
|SCC_E_INVALIDUSER|Пользователь не может войти подключаемый модуль системы управления версиями.|  
|SCC_E_UNKNOWNPROJECT|Проект неизвестен подключаемый модуль системы управления версиями.|  
|SCC_E_INVALIDFILEPATH|Путь к файлу недопустим или недоступным для использования.|  
|SCC_E_NOTAUTHORIZED|Для выполнения этой операции не разрешено пользователю.|  
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления версиями, возможно, из-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC_E_PROJSYNTAXERR|Проект недопустимый синтаксис.|  
|SCC_E_CONNECTIONFAILURE|Проблема подключения хранилища.|  
|SCC_E_NONSPECIFICERROR<br /><br /> SCC_E_UNKNOWNERROR|Неспецифичную сбоя.|  
  
## <a name="remarks"></a>Примечания  
 Эта функция возвращает код успешное выполнение или сбой и в случае успешного выполнения заполняет переменной `lpParentProjPath` путем полного проекта в указанный проект.  
  
 Эта функция возвращает родительский путь к проекту существующего проекта. Корень проекта, функция возвращает путь к проекту, который был передан в (то есть одинаковый корневой путь проекта). Обратите внимание, что путь проекта — это строка, имеет значение только для подключаемого модуля системы управления версиями.  
  
 IDE подготовлена для сохранения изменений в `lpUser` и `lpAuxProjPath` также параметры. Интегрированной среды разработки будут сохраняться эти строки и передавать их [SccOpenProject](../extensibility/sccopenproject-function.md) при открытии этого проекта в будущем. Эти строки таким образом, представляют собой способ для системы управления версиями для данных отслеживания, его необходимо связать с проектом.  
  
 Эта функция аналогична [SccGetProjPath](../extensibility/sccgetprojpath-function.md), за исключением того, что он не запрашивает пользователя, чтобы выбрать проект. Он также не создает новый проект, но работает только с существующим проектом.  
  
 Когда `SccGetParentProjectPath` вызове `lpProjPath` и `lpAuxProjPath` не может быть пустой и будет соответствовать допустимый проект. Эти строки, обычно полученных IDE из предыдущего вызова `SccGetProjPath` функции.  
  
 `lpUser` Аргумент — имя пользователя. Передает интегрированной среды разработки в том же имени пользователя, он ранее получен от `SccGetProjPath` функции и подключаемый модуль системы управления версиями следует использовать имя по умолчанию. Если у пользователя уже есть открытое соединение с помощью подключаемого модуля, подключаемый модуль должен повторите во избежание каких-либо запросов, чтобы убедиться в том, что функция будет работать без вмешательства пользователя. Тем не менее, если вход не выполняется, подключаемый модуль должен запросить пользователя для имени входа, и, при получении действительного имени входа, передайте имя обратно в `lpUser`. Так как подключаемый модуль может изменить эту строку, интегрированной среды разработки всегда будет выделить буфер размером (`SCC_USER_LEN`+ 1). Если строка изменяется, новую строку необходимо допустимое имя входа (по крайней мере допустимым значением старые строки).  
  
## <a name="technical-notes-for-scccreatesubproject-and-sccgetparentprojectpath"></a>Технические примечания для SccCreateSubProject и SccGetParentProjectPath  
 Добавление решений и проектов в систему управления версиями, был упрощен в Visual Studio, чтобы свести к минимуму количество раз, когда пользователю предлагается выбрать расположения в системе управления версиями. Эти изменения активируются по Visual Studio, если подключаемый модуль системы управления версиями поддерживает несколько новых функций, [SccCreateSubProject](../extensibility/scccreatesubproject-function.md) и `SccGetParentProjectPath` функции. Однако следующий параметр реестра можно использовать для отключения этих изменений и возврата к предыдущему поведению Visual Studio (источник управления Plug-in API версии 1.1):  
  
 [HKEY_CURRENT_USER\Software\Microsoft\VisualStudio\8.0\SourceControl] «DoNotCreateSolutionRootFolderInSourceControl» = DWORD: 00000001  
  
 Если этот параметр реестра не существует или имеет значение DWORD: 00000000, пытается использовать новые функции Visual Studio `SccCreateSubProject`и`SccGetParentProjectPath`.  
  
 Если параметр имеет значение DWORD: 00000001, Visual Studio не будет пытаться использовать эти новые функции и операции добавления в систему управления версиями работать, как и в предыдущих версиях Visual Studio.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [SccCreateSubProject](../extensibility/scccreatesubproject-function.md)   
 [SccGetProjPath](../extensibility/sccgetprojpath-function.md)