---
title: Рабочие области и языковых служб в Visual Studio | Документация Майкрософт
ms.custom: ''
ms.date: 02/21/2018
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
ms.assetid: 8631ffea-83c8-4fd4-a01e-c59772e89c84
author: vukelich
ms.author: svukel
manager: viveis
ms.workload:
- vssdk
ms.openlocfilehash: be9fb8c1e3ae363898e0438bdd1ec34c9fd23727
ms.sourcegitcommit: af428c7ccd007e668ec0dd8697c88fc5d8bca1e2
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 11/16/2018
ms.locfileid: "51735453"
---
# <a name="workspaces-and-language-services"></a>Рабочие области и языковых служб

Языковые службы может предоставить [открыть папку](../ide/develop-code-in-visual-studio-without-projects-or-solutions.md) пользователям те же функции широкие возможности языковой они используются для при работе с решениями и проектами. Служба языка может самостоятельной активации на основе расширения файла или содержимое открытого документа на то, что эта служба языка «свободного файла» ограничен выделение синтаксиса. Требуются дополнительные сведения для предоставления более широкие возможности при редактировании или просмотре исходного кода. Каждая языковая служба имеет свой собственный API для инициализации с этими данными дополнительную контекстную для документа. Обычно это осуществляется системой проекта, который тесно связан как для службы языка, так и в системе построения.

## <a name="initialization"></a>Инициализация

В [рабочей области](workspaces.md), языковые службы, инициализируются конструкцией <xref:Microsoft.VisualStudio.Workspace.Intellisense.ILanguageServiceProvider> точку расширения, который специализирует только в этой службе языка и ничего не знает о создания сборки. Таким образом владелец службы языка можно поддерживать единый открыть папку, расширение, независимо от того, какое количество шаблонов, существует внутри папки и файлы для выполнения их компилятора во время сборки (например MSBuild, файлы makefile т. д.). При изменении файлов, из которых был создан контекста файла на диске и обновлении контекста файла, поставщик службы языка уведомляется об обновленный набор контексты файла. Поставщик службы языка можно обновить его модель.

Если документ открыт в редакторе, Visual Studio учитывает только язык поставщиков услуг, требующих контекста типы файлов, для которых можно найти соответствующий поставщик контекст файла. Затем он передает файл контексты из сопоставления поставщиков поставщик услуг выбранный язык с помощью `ILanguageServiceProvider.InitializeAsync`. Поставщик службы языка назначение с помощью файла контекст данных является задачей оптимизации и поставщика службы языка, что ожидаемый пользовательский интерфейс остается более широкие языковой службы для этого открыть документ.

## <a name="using-ilanguageserviceprovider"></a>С помощью ILanguageServiceProvider

Служба языка будет уведомлен о контекста файла создается с `ContextType` , соответствующий одному из `SupportedContextTypes` значения языка сервера экспорта атрибута.

Чтобы обеспечить поддержку языковой службы, потребуется расширения:

- Уникальный `Guid`. Он будет использоваться для `SupportedContextTypes` атрибут аргументов и в `FileContext` объекта.
- Контекст файла языка
  - Фабрика поставщиков
    - `ExportFileContextProviderAttribute` атрибут с указанными выше создан `Guid` в `SupportedContextTypes`
    - Реализует `IWorkspaceProviderFactory<IFileContextProvider>`
  - Реализация поставщика `IFileContextProvider.GetContextsForFileAsync`
    - Создать новый `FileContext` с `contextType` аргумент конструктора как однозначно созданный `Guid`
    - Используйте `Context` свойство `FileContext` для предоставления дополнительных данных `ILanguageServiceProvider`
- языковая служба
  - Фабрика поставщиков
    - `ExportLanguageServiceProvider` атрибут с указанными выше создан `Guid` в `SupportedContextTypes`
    - Реализует `IWorkspaceProviderFactory<ILanguageServiceProvider>`
  - Поставщик
    - Реализует `ILanguageServiceProvider`
    - Используйте `ILanguageServiceProvider.InitializeAsync` для включения службы языка для указанных аргументов при открытии файла
    - Используйте `ILanguageServiceProvider.UninitializeAsync` отключение службы языка для указанных аргументов при закрытии файла

>[!WARNING]
>`ILanguageServiceProvider` Методы могут вызываться в рабочей области, в основном потоке. Поэтому рекомендуется запланировать работы в потоке, чтобы избежать задержек пользовательского интерфейса.

## <a name="language-server-protocol"></a>Протокол языкового сервера

`Microsoft.VisualStudio.Workspace.*` API-интерфейсы не единственный способ включить службы вашего языка в открытой папке. Другой вариант — использование языка сервера. Дополнительные сведения в статье о [протоколом языкового сервера](language-server-protocol.md).

## <a name="related-interfaces"></a>Связанные интерфейсы

- <xref:Microsoft.VisualStudio.Workspace.Intellisense.ILanguageServiceProvider> вызывается при открытии или закрытии для редактирования файл сопоставления типов файлов.

## <a name="next-steps"></a>Следующие шаги

* [Рабочая область построения](workspace-build.md) — открыть папку поддерживает построение систем, таких как MSBuild и файлы makefile. 