---
title: "Добавление меню в строке меню Visual Studio | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "меню, Создание верхнего уровня"
  - "меню верхнего уровня"
ms.assetid: 58fc1a31-2aeb-441c-8e48-c7d5cbcfe501
caps.latest.revision: 51
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 51
---
# Добавление меню в строке меню Visual Studio
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

В этом пошаговом руководстве показано, как добавлять меню в строку меню среды разработки Visual Studio \(IDE\). Интегрированная среда разработки меню содержит меню категории, такие как **файл**, **Изменить**, **представление**, **окна**, и **помочь**.  
  
 Перед добавлением нового меню в строке меню Visual Studio, рекомендуется ли команды должен помещаться в существующее меню. Дополнительные сведения о размещении команды в разделе [Меню и команд для Visual Studio](../extensibility/ux-guidelines/menus-and-commands-for-visual-studio.md).  
  
 Меню объявляются в файле .vsct проекте. Дополнительные сведения о меню и vsct\-файлах см. в разделе [Команды, меню и панелей инструментов](../extensibility/internals/commands-menus-and-toolbars.md).  
  
 Выполняя данное пошаговое руководство, можно создать меню с именем **TestMenu** содержащий одну команду.  
  
## Обязательные компоненты  
 Начиная с Visual Studio 2015, не установить пакет SDK для Visual Studio из центра загрузки. Она будет включена в качестве дополнительного компонента в установку Visual Studio. VS SDK также можно установить позже. Для получения дополнительной информации см. [Установка Visual Studio SDK](../extensibility/installing-the-visual-studio-sdk.md).  
  
## Создание проекта VSIX с шаблоном элемента настраиваемой команды  
  
1.  Создайте проект VSIX с именем `TopLevelMenu`. Можно найти шаблон проекта VSIX в **Новый проект** диалоговом окне под **Visual C\#** или **расширения**.  Дополнительные сведения см. в разделе [Создание расширения с помощью команды меню](../extensibility/creating-an-extension-with-a-menu-command.md).  
  
2.  При открытии проекта, Добавление пользовательской команды элемента шаблона с именем **TestCommand**. В **обозревателе решений**, щелкните правой кнопкой мыши узел проекта и выберите **Добавить или создать элемент**. В **Добавление нового элемента** диалоговое окно, последовательно выберите пункты **Visual C\# и расширяемость** и выберите **настраиваемой команды**. В **имя** в нижней части окна, измените имя файла команд для **TestCommand.cs**.  
  
## Создание меню в строке меню интегрированной среды разработки  
  
#### Создание меню  
  
1.  В **обозревателе решений**, откройте TestCommandPackage.vsct.  
  
     В конце файла имеется узел \< символы \>, который содержит несколько узлов \< GuidSymbol \>. В узле с именем guidTestCommandPackageCmdSet добавьте новый символ, следующим образом.  
  
    ```xml  
    <IDSymbol name="TopLevelMenu" value="0x1021"/>  
    ```  
  
2.  Создайте пустой узел \< меню \> узле \< команды \> непосредственно перед \< группы \>. В узле \< меню \> добавьте узел \< меню \> следующим образом:  
  
    ```xml  
    <Menus>  
          <Menu guid="guidTestCommandPackageCmdSet" id="TopLevelMenu" priority="0x700" type="Menu">  
            <Parent guid="guidSHLMainMenu"  
                    id="IDG_VS_MM_TOOLSADDINS" />  
            <Strings>  
              <ButtonText>TestMenu</ButtonText>  
              <CommandName>TestMenu</CommandName>  
            </Strings>  
        </Menu>  
    </Menus>  
    ```  
  
     `guid` И `id` значения меню указать набор команд и меню в набор команд.  
  
     `guid` И `id` значения родительского объекта размещения меню в разделе меню Visual Studio, содержащий меню средства и надстройки.  
  
     Значение `CommandName` строка указывает, что текст должен отображаться в элементе меню.  
  
3.  В разделе \< группы \> найдите \< группы \> и измените элемент \< родительского \> пункты меню, который мы только что добавили.  
  
    ```c#  
    <Groups>  
          <Group guid="guidTestCommandPackageCmdSet" id="MyMenuGroup" priority="0x0600">  
            <Parent guid="guidTestCommandPackageCmdSet" id="TopLevelMenu"/>  
          </Group>  
        </Groups>  
    ```  
  
     Это делает группу часть новое меню.  
  
4.  Найти `Buttons` раздел. Обратите внимание, что [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] создала шаблон пакета `Button` элемент, имеющий родительского равным `MyMenuGroup`. В результате этой команды появится в меню.  
  
## Построение и тестирование расширения  
  
1.  Выполните сборку решения и запустите отладку. Экземпляр экспериментальный экземпляр должен отображаться.  
  
2.  Меню в экспериментальном экземпляре должен содержать **TestMenu** меню.  
  
3.  На **TestMenu** меню, щелкните **вызвать команду проверки**.  
  
     Окно сообщения должен присутствовать и отображения сообщения «TestCommand пакет внутри TopLevelMenu.TestCommand.MenuItemCallback\(\)». Это означает, что новая команда работает.  
  
## См. также  
 [Команды, меню и панелей инструментов](../extensibility/internals/commands-menus-and-toolbars.md)