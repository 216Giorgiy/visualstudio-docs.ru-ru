---
title: "Расширение изолированной оболочки | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Оболочка Visual Studio, в изолированном режиме"
ms.assetid: 9a641d8f-211e-4486-a1b1-4a89fafe7ee8
caps.latest.revision: 10
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 10
---
# Расширение изолированной оболочки
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Оболочке Visual Studio изолированного можно расширить, добавив VSPackage, в компоненте Managed Extensibility Framework \(MEF\) или общий проект VSIX в приложении изолированной оболочки.  
  
> [!NOTE]
>  Следующие шаги при наличии в системе, что создано приложение основные изолированной оболочки с помощью изолированной оболочки Visual Studio шаблона проекта. Дополнительные сведения об этом шаблоне проекта см. в разделе [Пошаговое руководство: Создание приложения основные изолированной среды](../extensibility/walkthrough-creating-a-basic-isolated-shell-application.md).  
  
## Расположения для шаблона Visual Studio Package  
 Шаблон проекта пакета Visual Studio можно найти в трех разных местах диалогового окна **Создание проекта**.  
  
1.  В разделе **Visual Basic**, **расширения**. Язык проекта по умолчанию — Visual Basic.  
  
2.  В разделе **Visual C\#**, **расширения**. Язык проекта по умолчанию — C\#.  
  
3.  В разделе **других типов проектов**, **расширения**. Язык проекта по умолчанию — C\+\+.  
  
## Добавление VSPackage  
 В приложении изолированной оболочки можно добавить VSPackage. Следующие шаги показывают, как создать ключ, добавляющий команды меню.  
  
#### Чтобы добавить новый VSPackage  
  
1.  Добавьте проект пакета Visual Studio с именем `MenuCommandsPackage`.  
  
2.  На **Основная информация VSPackage** мастера, установите **название компании** для `Fabrikam` и **VSPackage имя** для `FabrikamMenuCommands`. Нажмите кнопку **Далее**.  
  
3.  На следующей странице выберите **команды меню** и выберите **Далее**.  
  
4.  На следующей странице, задайте **имя команды** в `Fabrikam Command` и **идентификатор команды** в `cmdidFabrikamCommand`, и нажмите кнопку **Далее**.  
  
5.  На **Выберите параметры тестирования проекта** снимите параметры тестирования и нажмите кнопку **Готово** кнопки.  
  
6.  Откройте файл source.extension.vsixmanifest в проекте ShellExtensionsVSIX.  
  
     **Активы** раздел должен содержать запись для проекта VSShellStub.AboutBoxPackage.  
  
7.  Нажмите кнопку **Создать**.  
  
8.  В **Добавить новый актив** окна в **тип** выберите **Microsoft.VisualStudio.VsPackage**.  
  
9. В **источника** списка, убедитесь, что **проекта в текущем решении** выбран. В **проекта** выберите **MenuCommandsPackage**.  
  
10. Сохраните и закройте файл.  
  
11. Перестройте решение и запустить отладку изолированной оболочки.  
  
12. В строке меню выберите **средства** меню, затем **команда Fabrikam**.  
  
     Появится окно сообщения.  
  
13. Остановите отладку приложения.  
  
## Добавление в компоненте MEF  
 Следующие шаги показывают, как добавление в компоненте MEF в приложении изолированной оболочки.  
  
#### Чтобы добавить компонент MEF  
  
1.  В **Добавление нового проекта** диалогового **Visual C\#**, **расширения**, используйте **края редактора** шаблона для добавления в проект. Присвойте обработчику события имя `ShellEditorMargin`.  
  
2.  В проекте ShellExtensionsVSIX откройте файл Source.extension.vsixmanifest в режиме конструктора, а не в представлении кода.  
  
3.  В `Asset` выберите **Добавить содержимое**.  
  
4.  В **Добавить новый актив** окна в **тип** выберите **Microsoft.VisualStudio.MefComponent**.  
  
5.  В **источника** списка, убедитесь, что **проекта в текущем решении** выбран. В **проекта** выберите **ShellEditorMargin**.  
  
6.  Сохраните и закройте файл.  
  
7.  Перестройте решение и запустить отладку изолированной оболочки.  
  
8.  Откройте текстовый файл.  
  
     Зеленую границу, которая содержит слова «Hello world\!» должны отображаться в нижней части файла в текстовом окне.  
  
9. Остановите отладку приложения.  
  
## Добавление проекта VSIX универсального  
  
#### Добавление общего проекта VSIX  
  
1.  В **Добавление нового проекта** диалогового **Visual C\#**, **расширения**, используйте **VSIXProject** шаблона для добавления в проект. Присвойте обработчику события имя `EmptyVSIX`.  
  
2.  В проекте ShellExtensionsVSIX откройте файл Source.extensions.vsixmanifest в режиме конструктора, а не в представлении кода.  
  
3.  В `Assets` выберите **New**.  
  
4.  В **Добавить новый актив** окна в **тип** выберите тип содержимого, нужно добавить.  
  
5.  В **источника**, убедитесь, что **проект в текущем решении** параметр выбран. В окне списка выберите имя проекта VSIX.  
  
6.  Сохраните и закройте файл.  
  
7.  Если этот проект содержит скомпилированный код, необходимо изменить проект, чтобы сборка включается в выходные данные.  
  
    1.  Выгрузить проект VSIX и откройте файл проекта.  
  
    2.  В первом `<PropertyGroup>` блока, измените значение `<CopyBuildOutputToOutputDirectory>` для `true`.  
  
    3.  Сохраните и перезагрузить проект.  
  
8.  Постройте и запустите это решение.  
  
## См. также  
 [Пошаговое руководство: Создание приложения основные изолированной среды](../extensibility/walkthrough-creating-a-basic-isolated-shell-application.md)