---
title: "Функция SccSetOption | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SccSetOption"
helpviewer_keywords: 
  - "Функция SccSetOption"
ms.assetid: 4b5e6666-c24c-438a-a9df-9c52f58f8175
caps.latest.revision: 13
caps.handback.revision: 13
ms.author: "gregvanl"
manager: "ghogen"
---
# Функция SccSetOption
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Эта функция задает параметры, которые управляют поведением подключаемый модуль системы управления версиями.  
  
## Синтаксис  
  
```cpp#  
SCCRTN SccSetOption(  
   LPVOID pvContext,  
   LONG   nOption,  
   LONG   dwVal  
);  
```  
  
#### Параметры  
 pvContext  
 \[in\] Структура подключаемого модуля контекста исходного элемента управления.  
  
 nOption  
 \[in\] Параметр, который устанавливается.  
  
 dwVal  
 \[in\] Настройки для параметра.  
  
## Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|--------------|--------------|  
|SCC\_OK|Параметр был успешно установлен.|  
|SCC\_I\_SHARESUBPROJOK|Если возвращенный `nOption` был `SCC_OPT_SHARESUBPROJ` и подключаемый модуль системы управления версиями обеспечивает интегрированную среду разработки задать папку назначения.|  
|SCC\_E\_OPNOTSUPPORTED|Параметр не установлен и не следует полагаться на.|  
  
## Заметки  
 IDE вызывает эту функцию для управления поведением подключаемый модуль системы управления версиями. Первый параметр, `nOption`, указывает значение, которое задается, а для второго `dwVal`, указывает, что делать с этим значением. Подключаемый модуль сохраняет эти сведения, связанные с `pvContext``,` эту функцию необходимо вызывать в Интегрированной среде разработки после вызова метода [SccInitialize](../extensibility/sccinitialize-function.md) \(но не обязательно после каждого вызова [SccOpenProject](../extensibility/sccopenproject-function.md)\).  
  
 Сводка параметров и их значений.  
  
|`nOption`|`dwValue`|Описание|  
|---------------|---------------|--------------|  
|`SCC_OPT_EVENTQUEUE`|`SCC_OPT_EQ_DISABLE`<br /><br /> `SCC_OPT_EQ_ENABLE`|Включает или отключает фоновую очереди событий.|  
|`SCC_OPT_USERDATA`|Произвольное значение|Указывает значение пользователя должны быть переданы [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md) функции обратного вызова.|  
|`SCC_OPT_HASCANCELMODE`|`SCC_OPT_HCM_NO`<br /><br /> `SCC_OPT_HCM_YES`|Указывает, Интегрированной в настоящее время поддерживает отмену операции.|  
|`SCC_OPT_NAMECHANGEPFN`|Указатель на [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md) функции обратного вызова|Задает указатель на функцию обратного вызова для изменения имени.|  
|`SCC_OPT_SCCCHECKOUTONLY`|`SCC_OPT_SCO_NO`<br /><br /> `SCC_OPT_SCO_YES`|Указывает, разрешено ли Интегрированной проверки из его файлов вручную \(через пользовательский интерфейс управления источника\) или ли они должны быть извлечены только с помощью подключаемого модуля системы управления версиями.|  
|`SCC_OPT_SHARESUBPROJ`|Н\/Д|Если подключаемый модуль системы управления версиями позволяет интегрированной среды разработки указать папку локального проекта, подключаемый модуль возвращает `SCC_I_SHARESUBPROJOK`.|  
  
## SCC\_OPT\_EVENTQUEUE  
 Если `nOption` является `SCC_OPT_EVENTQUEUE`, IDE отключения \(или повторного включения\) фоновой обработки. Например во время компиляции, системы управления версиями, подключаемый модуль для остановки обработки при простое каких дать интегрированной среды разработки. После компиляции он бы включить фоновую обработку обновления подключаемых в очередь событий. Соответствующий `SCC_OPT_EVENTQUEUE` значение `nOption`, существует два возможных значения `dwVal`, а именно, `SCC_OPT_EQ_ENABLE` и `SCC_OPT_EQ_DISABLE`.  
  
## SCC\_OPT\_HASCANCELMODE  
 Если значение `nOption` является `SCC_OPT_HASCANCELMODE`, интегрированная среда разработки позволяет пользователям отменить длительных операций. Параметр `dwVal` для `SCC_OPT_HCM_NO` \(по умолчанию\) означает, что IDE режим без отмены. Подключаемый модуль системы управления версиями должна предлагать кнопку "Отмена", если ему, чтобы пользователь имел возможность отменить.`SCC_OPT_HCM_YES` Указывает, что интегрированная среда разработки предоставляет возможность отменить операцию, поэтому SCC подключаемого модуля не нужно отображать кнопку "Отмена". Если задает интегрированной среды разработки `dwVal` для `SCC_OPT_HCM_YES`, он готов реагировать на `SCC_MSG_STATUS` и `DOCANCEL` сообщения, отправляемые `lpTextOutProc` функции обратного вызова \(см. [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)\). Если интегрированная среда разработки не этой переменной, подключаемый модуль не следует отправлять эти два сообщения.  
  
## SCC\_OPT\_NAMECHANGEPFN  
 Если значение nOption `SCC_OPT_NAMECHANGEPFN`, и в исходном разрешить подключаемый модуль системы управления и интегрированной среды разработки, подключаемый модуль можно действительно переименовать или переместить файл во время операции системы управления версиями.`dwVal` Значение указателя функции типа [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md). Во время операции управления версиями подключаемый модуль можно вызвать эту функцию, передавая три параметра. Это старое имя файла, новое имя \(с полным путем\), этот файл и указатель на данные, имеет отношение к Интегрированной среде разработки \(с полным путем\). Отправляет интегрированной среды разработки, вызвав этот последний указатель `SccSetOption` с `nOption` значение `SCC_OPT_USERDATA`, с `dwVal` указывающий на данные. Поддержка этой функции является необязательным. Подключаемые VSSCI\-что использует эту возможность необходимо инициализировать его функция указателя и пользовательские данные переменные для `NULL`, и его не следует вызывать функцией переименования, если он присвоен один. Оно также должно быть готово для хранения значения, переданного или изменить его в ответ на вызов нового `SccSetOption`. Это не будет происходить в середине операции команды управления версиями, но это может произойти между командами.  
  
## SCC\_OPT\_SCCCHECKOUTONLY  
 Если значение nOption `SCC_OPT_SCCCHECKOUTONLY`, интегрированной среды разработки указывает, что файлы в текущем открытом проекте следует никогда не извлечь вручную через пользовательский интерфейс системы управления версиями. Вместо этого файлы должны быть извлечен только с помощью системы управления версиями, подключаемый модуль под контролем интегрированной среды разработки. Если `dwValue` имеет значение `SCC_OPT_SCO_NO`, это означает, что файлы должны рассматриваться обычно подключаемым модулем и может быть извлечен через пользовательский Интерфейс системы управления версиями. Если `dwValue` имеет значение `SCC_OPT_SCO_YES`, затем только подключаемый модуль может извлекать файлы и не должны вызываться пользовательского интерфейса системы управления версиями. Это предназначено для ситуаций, где интегрированной среды разработки может быть «псевдо файлы», которые имеют смысл для извлечения только с помощью интегрированной среды разработки.  
  
## SCC\_OPT\_SHARESUBPROJ  
 Если`nOption` имеет значение `SCC_OPT_SHARESUBPROJ`, интегрированной среды разработки тестирование ли подключаемый модуль системы управления версиями можно использовать указанную локальную папку при добавлении файлов из системы управления версиями. Значение `dwVal` параметр не имеет значения, в этом случае. Если подключаемый модуль позволяет интегрированной среды разработки указать локальную целевую папку, куда будут добавлены файлы из источника элемент управления, когда [SccAddFromScc](../extensibility/sccaddfromscc-function.md) вызывается, а затем подключаемый модуль должен возвращать `SCC_I_SHARESUBPROJOK` при `SccSetOption` вызове функции. Интегрированная среда разработки использует `lplpFileNames` параметр `SccAddFromScc` функции для передачи в конечную папку. Подключаемый модуль использует конечной папки для размещения файлов, добавленных в системе управления версиями. Если подключаемый модуль не возвращает `SCC_I_SHARESUBPROJOK` при `SCC_OPT_SHARESUBPROJ` был установлен, интегрированной среды разработки предполагает, что подключаемый модуль является возможность добавлять файлы только в локальной папке текущей.  
  
## См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [SccInitialize](../extensibility/sccinitialize-function.md)   
 [SccOpenProject](../extensibility/sccopenproject-function.md)   
 [SccAddFromScc](../extensibility/sccaddfromscc-function.md)   
 [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)   
 [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md)