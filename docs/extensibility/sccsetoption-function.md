---
title: "Функция SccSetOption | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- SccSetOption
helpviewer_keywords:
- SccSetOption function
ms.assetid: 4b5e6666-c24c-438a-a9df-9c52f58f8175
caps.latest.revision: 
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.workload:
- vssdk
ms.openlocfilehash: 70fe624984adce58191ee7d354185eac0bb527ed
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="sccsetoption-function"></a>Функция SccSetOption
Эта функция задает параметры, которые управляют поведением подключаемый модуль системы управления версиями.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
SCCRTN SccSetOption(  
   LPVOID pvContext,  
   LONG   nOption,  
   LONG   dwVal  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Исходная структура подключаемого модуля контекста элемента управления.  
  
 nOption  
 [in] Параметр, который устанавливается.  
  
 dwVal  
 [in] Настройки для параметра.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализация подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание:|  
|-----------|-----------------|  
|SCC_OK|Параметр был успешно установлен.|  
|SCC_I_SHARESUBPROJOK|Возвращается, если `nOption` был `SCC_OPT_SHARESUBPROJ` и подключаемый модуль системы управления версиями позволяет IDE, чтобы задать папку назначения.|  
|SCC_E_OPNOTSUPPORTED|Этот параметр не задан и не следует полагаться на.|  
  
## <a name="remarks"></a>Примечания  
 IDE вызывает эту функцию для управления поведением подключаемый модуль системы управления версиями. Первый параметр `nOption`, указывает значение, которое должно быть задано, а для второго `dwVal`, указывает, что следует делать с этим значением. Подключаемый модуль сохраняет эти сведения, связанные с `pvContext``,` , эту функцию необходимо вызывать в Интегрированной среде разработки после вызова [SccInitialize](../extensibility/sccinitialize-function.md) (но не обязательно после каждого вызова [SccOpenProject](../extensibility/sccopenproject-function.md)).  
  
 Сводка параметров и их значений.  
  
|`nOption`|`dwValue`|Описание:|  
|---------------|---------------|-----------------|  
|`SCC_OPT_EVENTQUEUE`|`SCC_OPT_EQ_DISABLE`<br /><br /> `SCC_OPT_EQ_ENABLE`|Включает или отключает фоновую очереди событий.|  
|`SCC_OPT_USERDATA`|Произвольное значение|Указывает значение пользователя должны быть переданы [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md) функции обратного вызова.|  
|`SCC_OPT_HASCANCELMODE`|`SCC_OPT_HCM_NO`<br /><br /> `SCC_OPT_HCM_YES`|Указывает ли интегрированной среды разработки в настоящее время поддерживает отмену операции.|  
|`SCC_OPT_NAMECHANGEPFN`|Указатель на [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md) функции обратного вызова|Задает указатель на функцию обратного вызова для изменения имени.|  
|`SCC_OPT_SCCCHECKOUTONLY`|`SCC_OPT_SCO_NO`<br /><br /> `SCC_OPT_SCO_YES`|Указывает, разрешено ли Интегрированной проверки из его файлов вручную (с помощью пользовательского интерфейса элемента управления источника) или ли они должны быть извлечены только с помощью подключаемого модуля системы управления версиями.|  
|`SCC_OPT_SHARESUBPROJ`|Н/Д|Если подключаемый модуль системы управления версиями позволяет IDE, чтобы указать папку локального проекта, подключаемый модуль возвращает `SCC_I_SHARESUBPROJOK`.|  
  
## <a name="sccopteventqueue"></a>SCC_OPT_EVENTQUEUE  
 Если `nOption` — `SCC_OPT_EVENTQUEUE`, интегрированной среды разработки отключение (или повторном включении) фоновой обработки. Например во время компиляции, системы управления версиями для остановки обработки при простое любого типа дать интегрированной среды разработки. После компиляции она будет включить фоновой обработки, чтобы поддерживать актуальность подключаемые в очередь событий. Соответствующий `SCC_OPT_EVENTQUEUE` значение `nOption`, существует два возможных значения `dwVal`, а именно, `SCC_OPT_EQ_ENABLE` и `SCC_OPT_EQ_DISABLE`.  
  
## <a name="sccopthascancelmode"></a>SCC_OPT_HASCANCELMODE  
 Если значение для `nOption` — `SCC_OPT_HASCANCELMODE`, интегрированной среды разработки позволяет пользователям отменить длительных операций. Установка `dwVal` для `SCC_OPT_HCM_NO` (по умолчанию) означает, что интегрированной среды разработки без режима "Отмена". Подключаемый модуль системы управления версиями необходимо предлагают свои собственные кнопки "Отмена", если он хочет, чтобы пользователь, чтобы иметь возможность отменить. `SCC_OPT_HCM_YES`Указывает, что интегрированная среда разработки предоставляет возможность отменить операцию, поэтому SCC подключаемого модуля не требуется отобразить кнопку "Отмена". Если задать в Интегрированной среде разработки `dwVal` для `SCC_OPT_HCM_YES`, он готов отвечать на `SCC_MSG_STATUS` и `DOCANCEL` сообщения, отправляемые `lpTextOutProc` функция обратного вызова (см. [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)). Если эта переменная не устанавливает интегрированной среды разработки, подключаемый модуль не следует отправлять эти два сообщения.  
  
## <a name="sccoptnamechangepfn"></a>SCC_OPT_NAMECHANGEPFN  
 Если имеет значение nOption `SCC_OPT_NAMECHANGEPFN`и в исходном подключаемый модуль системы управления и интерфейсом IDE разрешить его, подключаемый модуль может фактически переименовать или переместить файл во время операции управления версиями. `dwVal` Устанавливается в указатель на функцию типа [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md). Во время операции управления версиями подключаемый модуль можно вызвать эту функцию, передавая три параметра. Это прежнее имя файла, новое имя (с полным путем), этот файл и указатель на данные, имеет отношение к Интегрированной среде разработки (с полным путем). Отправляет интегрированной среды разработки в этот последний указатель путем вызова `SccSetOption` с `nOption` значение `SCC_OPT_USERDATA`, с `dwVal` указывающий на данные. Поддержка этой функции является необязательным. Подключаемые VSSCI-что использует эту возможность необходимо инициализировать его функции указателя и пользовательские данные переменных в `NULL`, и он не должны вызывать функцию, переименования, если оно задано одно. Оно также должно быть готово для хранения значения, переданного или изменить его в ответ на вызов нового `SccSetOption`. Это не происходит в середине операции команды управления версиями, но в некоторых случаях между командами.  
  
## <a name="sccoptscccheckoutonly"></a>SCC_OPT_SCCCHECKOUTONLY  
 Если имеет значение nOption `SCC_OPT_SCCCHECKOUTONLY`, интегрированной среды разработки указывает, что файлы в текущем открытом проекте должны никогда не извлечь вручную через пользовательский интерфейс системы управления версиями. Вместо этого файлов должен быть извлечен только с помощью системы управления версиями под управлением интегрированной среды разработки. Если `dwValue` имеет значение `SCC_OPT_SCO_NO`, это означает, что файлы должны рассматриваться обычно подключаемым модулем и может быть извлечен через пользовательский Интерфейс системы управления версиями. Если `dwValue` равно `SCC_OPT_SCO_YES`, затем только подключаемый модуль может извлекать файлы и не должны вызываться пользовательского интерфейса системы управления версиями. Это предназначено для ситуаций, где интегрированной среды разработки, могут иметь «псевдо files», которые имеют смысл для извлечения только с помощью интегрированной среды разработки.  
  
## <a name="sccoptsharesubproj"></a>SCC_OPT_SHARESUBPROJ  
 Если`nOption` равно `SCC_OPT_SHARESUBPROJ`, проводится ли тестирование IDE ли подключаемый модуль системы управления версиями можно использовать указанную локальную папку, при добавлении файлов из системы управления версиями. Значение `dwVal` параметр не имеет значения в этом случае. Если подключаемый модуль позволяет IDE, чтобы указать локальную целевую папку, куда будут добавлены файлы из источника управления [SccAddFromScc](../extensibility/sccaddfromscc-function.md) вызывается, то подключаемый модуль должен возвращать `SCC_I_SHARESUBPROJOK` при `SccSetOption` функция вызывается. Затем используется в Интегрированной среде разработки `lplpFileNames` параметр `SccAddFromScc` функции для передачи в папку назначения. Подключаемый модуль использует, конечную папку для размещения файлов, добавленных из системы управления версиями. Если подключаемый модуль не возвращает `SCC_I_SHARESUBPROJOK` при `SCC_OPT_SHARESUBPROJ` был установлен, интегрированной среды разработки предполагает, что подключаемый модуль является возможность добавлять файлы только в текущей локальной папке.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [SccInitialize](../extensibility/sccinitialize-function.md)   
 [SccOpenProject](../extensibility/sccopenproject-function.md)   
 [SccAddFromScc](../extensibility/sccaddfromscc-function.md)   
 [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)   
 [OPTNAMECHANGEPFN](../extensibility/optnamechangepfn.md)