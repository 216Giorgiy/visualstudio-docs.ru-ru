---
title: "Текст пользовательского интерфейса и справки для Visual Studio | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: e8747d07-6c90-46cc-b425-55b589f7e9e4
caps.latest.revision: "2"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.workload: vssdk
ms.openlocfilehash: 555fd622f5655a69ba77f3905a39635e01831c76
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="ui-text-and-help-for-visual-studio"></a>Текст пользовательского интерфейса и справки для Visual Studio
##  <a name="BKMK_UITextAndTerminology"></a>Текст пользовательского интерфейса и терминология  
 Текст понятными крайне важны для эффективной пользовательского интерфейса. Пользователи, как правило, для считывания метки во-первых, а именно те, наиболее важные для выполнения поставленной задачи. Статический текст считывается с частотой меньше. Планирование пользователи могут запускать свои сеансы работы с быстрой проверки всего окна, следуют чтения пользовательского интерфейса в указанном порядке приблизительное:  
  
1.  Интерактивных элементов управления в центре  
  
2.  Фиксация кнопки  
  
3.  В других приложениях интерактивных элементов управления  
  
4.  Основные инструкции  
  
5.  Дополнительные описания  
  
6.  Заголовок окна  
  
7.  Другой статический текст в основном тексте  
  
### <a name="usage-patterns-for-ui-text"></a>Использование шаблонов для текста интерфейса пользователя  
  
#### <a name="title-bar-text"></a>Текст заголовка  
 Текст заголовка должно соответствовать команды, требующей пользовательского интерфейса.  
  
#### <a name="instructional-text-helper-text"></a>Пояснительный текст (вспомогательный)  
 В некоторых диалоговых окнах бывает полезно для предоставления известных основных инструкциях объясняется, что делать в окне или на странице. Это иногда называется «вспомогательный текст».  
  
##### <a name="writing-style-rules-for-helper-text"></a>Создание правила стилей для поддержки текста  
  
-   Не смогут объяснить очевидным. Если он совершенно не требуется, не включайте пояснительный текст.  
  
-   Пояснительный текст всегда помещается в верхней части диалогового окна и должны обращаться к выполняемой задаче.  
  
-   Точно Объясните пользователям им необходимо сделать. Избегайте чрезмерного связи и избыточность.  
  
-   Просмотрите каждое окно и исключить повторяющиеся слова и операторы.  
  
-   Сохраните короткий пояснительный текст. Если Дополнительные сведения является необходимым для определенных пользователей или сценарии, укажите ссылку на подробные концептуальных разделов справки в сети.  
  
-   Напишите текст, чтобы каждое слово содержит вес и не требуется.  
  
-   Существующие рекомендации корпорации Майкрософт для [текст пользовательского интерфейса](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742478\(v=vs.85\).aspx) и [стиль и тон](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742477\(v=vs.85\).aspx).  
  
#### <a name="supplemental-instructions"></a>Дополнительные инструкции  
 Дополнительные инструкции предоставляют дополнительную информацию, которая помогает пользователю понять, элементы управления или управления группирований. Это также может включать текст подсказки, необходимо понимать, какой формат, ожидается элемент управления вводом. Используйте дополнительные инструкции только в случае необходимости. Зарезервируйте их в случае, если вероятность, что пользователь не будет полностью понимать последствия этих выбор, они берут.  
  
 ![Пояснительный текст в Visual Studio](../../extensibility/ux-guidelines/media/0601-b_supplementaltext1.png "0601 b_SupplementalText1")  
  
 **Пояснительный текст в Visual Studio**  
  
 ![Пояснительный текст в Visual Studio](../../extensibility/ux-guidelines/media/0601-c_supplementaltext2.png "0601 c_SupplementalText2")  
  
 **Пояснительный текст в Visual Studio**  
  
#### <a name="infotips"></a>Всплывающих подсказках  
 Часто пояснительный текст может быть слишком длинным, чтобы изменить расположение на месте в пользовательском Интерфейсе или может быть полезно только новые пользователи, походили помехи опытным пользователям. В этом случае инструкции или информационного текста следует разместить в виде всплывающей подсказки в всплывающую подсказку.  
  
 Всплывающих подсказках должны находиться рядом с элементами управления, они связаны и должны использовать определенные всплывающая подсказка значок, который ненавязчивого заметно.  
  
 ![Подсказка в Visual Studio](../../extensibility/ux-guidelines/media/0601-d_infotip.png "0601 d_InfoTip")  
  
 **Пример всплывающую подсказку в Visual Studio**  
  
##### <a name="writing-style-rules-for-infotips"></a>Создание правила стилей для всплывающих подсказках  
  
-   Запишите всплывающих подсказках как полные предложения. Они требуют определенных команд, прописная и завершение знаков препинания.  
  
-   Использование всплывающих подсказках для дополнения основные инструкции или сведения. При использовании только различных слов переформулировать цель не требуется всплывающую подсказку.  
  
-   Сохраните всплывающих подсказках кратким и емким. Используйте короткие слова и обычные, естественного языка, который поддерживает и предлагает пользователю.  
  
-   Существующие рекомендации корпорации Майкрософт для [текст пользовательского интерфейса](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742478\(v=vs.85\).aspx) и [стиль и тон](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742477\(v=vs.85\).aspx).  
  
#### <a name="control-labels"></a>Метки элементов управления  
 Метки элементов управления должны быть кратких и следуйте [Windows Desktop рекомендации для элементов управления](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742399\(v=vs.85\).aspx).  
  
 Дополнительные сведения о формате метки элемента управления и размещения в пользовательском Интерфейсе см. [макета для Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md).  
  
#### <a name="help-links"></a>Ссылки на разделы справки  
 Ссылки на разделы справки можно либо находиться в пояснительного текста либо в основной части пользовательского интерфейса. Можно ли ссылки на справку или запуска внутренней диалоговых окон.  
  
##### <a name="visual-style-rules-for-help-links"></a>Правила визуальный стиль для ссылки на разделы справки  
  
-   Используйте цвета нужное окружение для гиперссылки. Гиперссылки правильно оформленного не будет кратко мигать красным при нажатии. Если это происходит, то это означает, что не используются цвета среды.  
  
-   Подчеркивание должен использоваться только при наведении указателя мыши или при ссылку внедряется в абзаце.  
  
-   Более подробные сведения о стилях визуального элемента и взаимодействия для гиперссылок в разделе кнопок и гиперссылок.  
  
##### <a name="writing-style-rules-for-help-links"></a>Создание правила стилей для ссылки на разделы справки  
  
-   При запуске диалоговых окон, поддерживать стандарты для многоточия: нет кнопку с многоточием для навигации, эллипсы, если для задачи требуется дополнительный пользовательский Интерфейс.  
  
     ![Ссылку "Справка" в Visual Studio](../../extensibility/ux-guidelines/media/0601-e_helplink.png "0601 e_HelpLink")  
  
     **Многоточие (...) в ссылке справки указывает, что задача потребуется дополнительный пользовательский Интерфейс.**  
  
-   Ссылки не должен начинаться с «Дополнительные сведения», поскольку не намерения пользователя. Пользователю необходимо ответить на определенный вопрос, не будут получать общие образования.  
  
-   Справка фразу ссылки, чтобы они вопрос, ответ находится в разделе.  
  
     Неверный:  
     «Дополнительные сведения о ценах на мобильные службы Windows Azure»  
  
     Правильно:  
     «Какие варианты цен доступны для мобильных служб Windows Azure?»  
  
-   Никогда не используйте *нажмите кнопку...*  на текст ссылки.  
  
-   Никогда не ссылку только слово «сюда». Это создает проблему для некоторых чтения экрана, которые будут голосовая связь только с гиперссылками слово.  
  
     Неверный:  
     «Найти сведения о мобильных служб Windows Azure **здесь**»  
  
     Правильно:  
     «Какие варианты цен доступны для мобильных служб Windows Azure?»  
  
-   Дополнительные сведения на стиль правильные записи для ссылки на справку см. в разделе [руководство рабочего стола Windows для получения справки](https://msdn.microsoft.com/en-us/library/windows/desktop/dn742494\(v=vs.85\).aspx).  
  
#### <a name="hint-text"></a>Текст подсказки  
 Текст подсказки в виде водяного знака в элементе управления или под элементом управления. Правильное форматирование будет применяться при помощи соответствующий маркер VSColors `Environment.GrayText`.  
  
 Он может присутствовать в нескольких формах.  
  
-   Вместо метка элемента управления:  
  
     ![Указание текста в Visual Studio](../../extensibility/ux-guidelines/media/0601-f_hinttext1.png "0601 f_HintText1")  
  
-   С помощью команды инструкций:  
  
     ![Указание текста в Visual Studio](../../extensibility/ux-guidelines/media/0601-g_hinttext2.png "0601 g_HintText2")  
  
-   С текстом, указывающее, необходимая запись:  
  
     ![Указание текста в Visual Studio](../../extensibility/ux-guidelines/media/0601-h_hinttext3.png "0601 h_HintText3")  
  
#### <a name="watermark-text"></a>Текст водяного знака  
 На пустая область конструктора текст должен указывать, что нужно сделать, а также даны ссылки для открытия других связанных окон, при необходимости:  
  
 ![Подложка текст в Visual Studio](../../extensibility/ux-guidelines/media/0601-i_watermarktext.png "0601 i_WatermarkText")  
  
 **Пример текста водяного знака в Visual Studio**  
  
### <a name="common-terminology"></a>Общие термины  
  
|Термин|Объяснение|Комментарий|  
|----------|-----------------|-------------|  
|Вход и выход|Команды, используемые как синоним веб-для проверки подлинности в веб-свойство представления. В клиентах мы будем использовать один раз как представление верхнего уровня для подписи и из него подключение пользователя интегрированной среды разработки, которое представляет удостоверение верхнего уровня, обеспечивающий более высокого уровня такие возможности как перемещаемые и лицензирование, недоступны для всех подключений.|Пользователь интегрированной среды разработки является единственной возможностью, должны представляют вход / выход из команды, так как он представляет пользователя верхнего уровня IDE.|  
|Подключение / отключение|Использовать в местах, где компонент поддерживает одно подключение к веб-службы.|Обозреватель серверов, где можно иметь только одно активное подключение Azure одновременно, является примером/разрыв подключения.|  
|Добавление и удаление|Неразрушающее. Используется при добавлении или удалении что-нибудь из списка.|Диалоговое окно списка сервер TFS диспетчер соединений примером может служить добавление или удаление.|  
|Удаление|Разрушение. Используйте только в том случае, если удаляемый элемент будут окончательно удалены или удаляются с диска.|Обычно «Delete» требуется строка, если результатом является удаление файла с диска.|  
  
## <a name="error-messages"></a>Сообщения об ошибках  
  
### <a name="overview"></a>Обзор  
 Ошибки возникают. Установка ограничения на действия пользователя является разумным первым этапом вызывает ошибки сообщения не. Тем не менее при возникновении ошибки, сообщение об ошибке грамотно сконструированные могут сыграть большую сторону устранения проблемы. Сообщения об ошибках пожалуй являются наиболее важные типы уведомлений, который видит пользователь, поскольку они являются синхронными и указывают на проблему, которую нужно решить. Неправильно написанная ошибках оставить пользователей на свои собственные, чтобы определить причину ошибки, а также возможные решения.  
  
 Пользователи могут перестать внимания к чрезмерным или путать сообщения об ошибках, поэтому сообщения только необходимые записи, необходимые для пользователя. Если сообщение просто уведомления, затем используйте возможности.  
  
### <a name="rules-for-creating-an-error-message"></a>Правила для создания сообщения об ошибке  
  
-   При создании сообщения об ошибках, выберите уровень соответствующее сообщение об ошибке для аудитории. Цель для прост кратких описаний, укажите это действие, которое пользователь может предпринять, если это применимо. Все, что пользователю не нужно знать не состояние.  
  
-   Оказывать помощь конструктивные. Это упрощает чтение и отреагировать на сообщение об ошибке, содержащая инструкцию.  
  
-   Не следует использовать двойной отрицательных результатов.  
  
-   Выполните оба автоматическое и вручную грамматики и орфографии проверьте на любое сообщение об ошибке, который можно написать.  
  
-   Сложные сообщения об ошибках Избегайте последовательной связи. Никогда не использовать подключение F1 сообщения об ошибке. Само сообщение должно быть достаточно.  
  
-   Используйте соответствующий значок.  
  
-   Облегчить вопросы для понимания и использования кнопок, снимите выбор, например, «Удалить» и «Отмена».  
  
-   Для предупреждения необходимо иметь четкое представление о вследствие продолжение, которое будет иметь. Кнопки должно быть указано, результат.  
  
-   Для ошибок опишите пользователь может сделать для решения проблемы. Кнопки должны быть действий или, например, «Закрыть». Не используйте кнопки «ОК» для сообщение об ошибке.  
  
-   Некоторые вопросы, на при построении сообщение об ошибке:  
  
    -   Выяснить, как для устранения проблемы с этой ошибкой только пользователь?  
  
    -   Используется ли пользователь же терминологию с этой ошибкой?  
  
    -   Является ambigious этой ошибки или совместно использовать в нескольких ситуациях? Если это так, как вы проводят пользователя в решение, которые им необходимы?  
  
#### <a name="build-errors"></a>Ошибки построения  
 Поскольку Visual Studio — это средство разработки программного обеспечения, многие из его компонентов имеют компиляции, преобразование или кодирование шаг, чтобы преобразовать работу разработчика в двоичной форме. Эти преобразования могут вызывать ошибки, если компилятор не может обработать неправильно созданные файлы или не были правильно задать параметры компилятора.  
  
 Пользователи Visual Studio можно потратить огромное количество часов разработки, устранение ошибок построения. Это время ответа увеличивается, когда ошибок имеют зависимости или когда сообщения об ошибках плохо записываются, что может затруднить выявить источник ошибки.  
  
 Наиболее ошибки сборки являются те, которые не возникают в первую очередь, поэтому Visual Studio предоставляет автозаполнения и подчеркивание слов IntelliSense. Проверяющие элементы управления схемы и аналогичные средства предоставляют одинаковые обратной связи. Эти механизмы заранее помочь пользователю создать корректный код, что снижает вероятность возникновения ошибок сборки.  
  
 Visual Studio предоставляет окно инструментов, где пользователи могут считывать и перемещаться по ошибки, возникшие в окнах своих документов. Сочетания клавиш предоставляются, чтобы пользователь можно быстро переходить больших объемов кода и перейти непосредственно к месту проблемы. Visual Studio также позволяет каждой ошибки сборки должны быть привязаны к определенным кодом ключевое слово или контекста справки, чтобы пользователя можно перейти непосредственно к разделу справки, предоставляющий дополнительные сведения об ошибке.  
  
 Ошибки построения очистить и понятный записи:  
  
-   **Использовать простой язык** , объяснение ошибки с почти или совсем не жаргон компилятора. Не следует слишком технические текст ошибки построения.  
  
-   **Описываются возможные причины ее возникновения.** Например «отсутствует двоеточие между свойством и значением в "(свойство): (значение)" объявление.»  
  
-   Приводятся подробные сведения о возможных исправлений. Если не хватает места, Дополнительные сведения могут быть помещены в соответствующий раздел справки.  
  
### <a name="components-of-a-well-written-error-message"></a>Компоненты грамотно сконструированные сообщения об ошибке  
  
#### <a name="use-the-shell-dialog-service-for-error-messages"></a>Используйте службу оболочка диалогового окна сообщения об ошибках.  
 С помощью диалогового окна службы оболочки позволяет управлять внешним видом сообщения шрифты в частности, без значительные изменения к отдельным элементам. Используйте **IErrorInfo** механизмы и сообщать о них с помощью **IVsUIShell::SetErrorInfo/ReportErrorInfo**.  
  
#### <a name="choose-an-effective-and-appropriate-notification-presentation"></a>Выберите представления эффективный и соответствующие уведомления.  
 Используйте модальное диалоговое окно с критическое предупреждение, если требуется немедленное вмешательство во избежание потери данных (синхронной уведомление). Важные значки зарезервированы для ситуаций, в которых Закрытие сообщения без чтения, это может привести к отрицательных последствий. Потеря данных является критической ситуации, требующий ответа уровень сигнала. Значок "критический" злоупотребление desensitizes пользователям его значимость. Если информационные сообщения об ошибке, следует рассмотрите возможности в модальное диалоговое окно (асинхронное уведомление).  
  
#### <a name="provide-a-clean-succinct-explanation-of-why-the-problem-occurred-rather-than-a-technical-explanation"></a>Укажите более чистой, краткое объяснение того, почему возникла проблема, а не общее описание.  
 Перегрузки пользователей с технические подробности в объяснение делает их игнорировать сообщения об ошибках с большей вероятностью. Примеры хорошо обмена сообщениями.  
  
-   «Не удается открыть запрошенный файл».  
  
-   «Не удалось подключиться к Интернету».  
  
#### <a name="provide-information-about-how-to-fix-the-problem"></a>Приводятся сведения о том, как устранить проблему.  
 Предложить пользователя по устранению проблемы. Честно с пользователем, если нет предложений. Предоставляют прямые ссылки на альтернативный online источников, таких как технической поддержки или Поддержка сообщества. Повторите для направления пользователей к определенной сети сведения, относящиеся к проблему. Если код ошибки рассмотрите возможность связывания пользователей с поток дискуссии о этой ошибки. Примеры хорошо обмена сообщениями.  
  
-   «Убедитесь, что вы подключены к Интернету и повторите попытку.»  
  
-   «Убедитесь, что файл существует и имеется разрешение, чтобы открыть его».  
  
#### <a name="write-a-message-that-is-short-and-to-the-point"></a>Записать сообщение, краткое и к точке.  
 Сообщение об ошибке может уведомлять, объясните и предлагают решения но по-прежнему игнорироваться, если он слишком много слов. Одним из решений является использование прогрессивного раскрытия с кнопкой на сведения о. К примеру, дает краткое описание/решения, а затем указать дополнительные сведения в разделе кнопку сведения. Если пользователи выбирают Дополнительные сведения об этой ошибке, их можно сделать.  
  
 Язык в сообщении должно быть:  
  
-   **Соответствующие домена.** Используйте язык, который пользователь будет воспринимать. Хотя наши пользователи являются разработчиками, не обладают контекста и терминология, которая у нас есть.  
  
-   **Только.** Избегайте неопределенным содержимым и предоставить определенные имена и местоположения участвующие объекты. Например сообщение об ошибке, например «недопустимый символ» бесполезно. Знак? «Файл не найден». Какой файл?  
  
-   **Вежливость.** Не обвиняйте пользователя и не заставляйте его чувствовать себя дураком. Избегайте опасного или оскорбительных языка (kill и выполнение, прервать, Неустранимая, недопустимое). Избегайте текста в верхнем регистре, часто считается крик и не находится в удобном для чтения. Не используйте юмор.  
  
-   **Правильно.** Задайте правильное правописание (даже в альфа). Опечаток непрофессионально и неудобно.  
  
-   **Необходимые зависимости от контекста.** Используйте соответствующую кнопку текст. Избегайте кнопку «ОК» и вместо этого использовать «Продолжить» или «Да/нет».  
  
### <a name="error-message-examples"></a>Ошибка примеры сообщений  
  
|Хорошо|Неверный|  
|----------|---------|  
|«Номер набран больше не службы. Проверьте номер и наберите его еще раз или звоните 0 для оператора.»|-«(449) Ошибка: недопустимый номер»<br />-«Эта ошибка необработанное исключение указывает, что операция завершилась успешно.»<br /><br /> ![Сообщение об ошибке в Visual Studio](../../extensibility/ux-guidelines/media/0602-a_errordialog.png "0602 a_ErrorDialog")|  
  
## <a name="accessing-help"></a>Доступ к справке  
  
### <a name="overview"></a>Обзор  
 В дополнение к документации в библиотеке MSDN Visual Studio пользователь имеет несколько точек доступа для упрощения работы пользователя в пользовательском Интерфейсе. Убедитесь, что эти точки доступа постоянно доступны, необходимо воспользоваться преимуществами справочной системы, предоставляемые средой функция командам. Ниже приведены эти точки доступа.  
  
-   **Инструкции и дополнительный текст в диалоговых окнах.** Статический текст, который предоставляет направление или описание, либо в пользовательском Интерфейсе поверхности или доступным при наведении курсора мыши на значок всплывающая подсказка.  
  
-   **Справка F1** (редактор). В редакторе Visual Studio могут доверять пользователи, в любое время, при нажатии клавиши F1 откроется раздел справки для текущего выделения. Убедитесь, что разделы, посвященные F1 соответствующий и подробное сообщение.  
  
-   **Ссылки на разделы справки.** Гиперссылки в диалоговое окно, окно инструмента или конструктора, запуск раздела для упрощения работы пользователя Дополнительные сведения о технологии, возможности и сведения о способах выполнения задач.  
  
-   **Механизмы вспомогательный пользовательского интерфейса, такие как смарт-теги и стандартных диалоговых окон.** Эти механизмы призвано помочь пользователю понять элемент пользовательского интерфейса или упрощают задачу, например смарт-тегов и диалоговые окна построителя.  
  
-   **Кнопки справки пользовательского интерфейса** (устарело). Отображается индикатор в заголовке окна, предоставляющий доступ к соответствующий раздел справки F1.  
  
### <a name="text"></a>Text  
  
#### <a name="instructional-and-supplemental-text-in-dialogs"></a>Инструкции и дополнительный текст в диалоговых окнах  
 В диалоговых окнах, которые поддерживают сложные задачи может возникнуть необходимость предоставить пояснительный текст в пользовательском Интерфейсе, часто в верхней части диалогового окна или рядом с ней сложных элементов управления. В разделе [пользовательского интерфейса текст и терминология](../../extensibility/ux-guidelines/ui-text-and-help-for-visual-studio.md#BKMK_UITextAndTerminology) подробные сведения о написании стиля.  
  
#### <a name="infotips"></a>Всплывающих подсказках  
 Часто пояснительный текст может быть слишком длинным, чтобы изменить расположение на месте в пользовательском Интерфейсе или может быть полезно только новые пользователи, походили помехи опытным пользователям. В этом случае инструкции или информационного текста следует разместить в виде всплывающей подсказки в всплывающую подсказку.  
  
 Всплывающих подсказках должны находиться рядом с элементами управления, они связаны и должны использовать определенные всплывающая подсказка значок, который ненавязчивого заметно.  
  
 ![Подсказка в Visual Studio](../../extensibility/ux-guidelines/media/0601-d_infotip.png "0601 d_InfoTip")  
  
 **Пример всплывающую подсказку в Visual Studio**  
  
### <a name="interactive-help-mechanisms"></a>Механизмы интерактивной справки  
  
#### <a name="f1-help"></a>Справка F1  
 Справка F1 является обязательным в пределах редактора или конструктора, но не в другом месте в среде Visual Studio.  
  
#### <a name="hyperlinks-to-help-topics"></a>Ссылки на разделы справки  
 Гиперссылки можно использовать для выполнения действия, перемещение в Интегрированной среде разработки или запустить справку в браузере. . В разделе [пользовательского интерфейса текст и терминология](../../extensibility/ux-guidelines/ui-text-and-help-for-visual-studio.md#BKMK_UITextAndTerminology) подробные сведения о языке и 07.10.01 кнопки и гиперссылки, инструкции visual и макет.  
  
#### <a name="help--buttons-in-dialog-title-bars-deprecated"></a>Кнопки [?] (устарело) строки заголовка диалогового окна справки  
 В большинстве случаев кнопки справки [?] в строке заголовка диалоговых окон являются устаревшими. Разделы пользовательского интерфейса больше не являются частью нашей модели doc и поэтому может не существовать соответствующем разделе для связывания. По существу кнопка панели заголовка было то же, что справки F1 и больше не требуется в диалоговых окнах. В некоторых случаях это по-прежнему используется указывает, что дополнительные концептуальных и процедурных сведения недоступны, несмотря на то, что гиперссылки чаще используются в более новой пользовательского интерфейса.  
  
##### <a name="dialogs-created-through-the-environment"></a>Диалоги, созданные с помощью среды  
 Множество диалоговых окон оболочки создаются с помощью **VBDialogBoxParam** функции. Эта функция общих был обновлен, чтобы упростить перемещение **справки** кнопку из диалогового окна, чтобы **?** Кнопка, сохраняя архитектуру, которая обеспечивает обратную совместимость и расширяемые.  
  
 В частности **VBDialogBoxParam** функция просматривает шаблона диалогового окна для кнопки, идентификатор которого — **IDHELP** (9) или метка **справки** или **& Справка**. При обнаружении кнопку "Справка", она скрыта и **WS_EX_CONTEXTHELP** стиля добавляется к диалоговому окну, который помещает **?** Кнопка в строке заголовка диалогового окна.  
  
 При создании диалогового окна, он помещает proc диалогового окна в стек и вызывает диалоговое окно с предварительной обработки proc диалоговое окно с именем **DialogPreProc**. Когда **?** по нажатию кнопки отправляет **WM_SYSCOMMAND** из **SC_CONTEXTHELP** к диалоговому окну. **DialogPreProc** захватывает эта команда и изменяет его на **WM_HELP** сообщение, которое передается исходного процедуре диалоговое окно  
  
 Большинство диалоговых окон среды создания имеет кнопку «Справка» в диалоговом окне. При отображении диалогового окна «Справка» автоматически скрыто и только **?** кнопка работает. Если **?** Кнопка удаляется или когда-либо изменен в Windows, это решение позволяет быстро вернуться к исходной кнопки «Справка».  
  
 Это решение делает четыре предположения, которые могли стать причиной ошибок.  
  
-   Кнопка диалогового окна справки **IDHELP** (9).  
  
-   Диалоговое окно выглядит правильно, скрытого кнопку "Справка".  
  
-   Диалоговое окно не заменяет его чтобы процедура winproc результат.  
  
-   Диалоговое окно не встроено в другое диалоговое окно.  
  
 Если ваше диалоговое окно находится в пределах msenv и не использует **VBDialogBoxParam**, изучить использование **VBDialogBoxParam** перед реализацией собственный обработчик.  
  
##### <a name="dialogs-created-through-other-packages"></a>Диалоги, созданные в других пакетах  
 Вы можете реализовать решение для диалоговых окон, которые находятся за пределами msenv. Для класса общего диалогового окна в пакете VSPackage рассмотрите возможность перемещения кнопки в строке заголовка или реализации обработчика на каждое диалоговое окно. Следующий код — это общая схема реализации помогут вам приступить к работе:  
  
```  
struct DLGPROCITEM  
{  
    FARPROC proc; // The info used to create the dialog.  
    DLGPROCITEM* procPrev;  
};  
  
DLGPROCITEM* g_dlgProcStack = NULL;  
  
// A dialog starter/wrapper function is used to push the new  
// dialog proc to the top of our dialog proc stack.  
  
int SomeDialogStarterFunction(hinst, id, proc, etc)  
{  
    if (g_dlgProcStack == NULL)  
    {  
        g_dlgProcStack = new DLGPROCITEM;  
        g_dlgProcStack->procPrev = NULL;  
    }  
    else  
    {  
        DLGPROCITEM* procItem = new DLGPROCITEM;  
        g_dlgProcStack->procPrev = g_dlgProcStack;  
        g_dlgProcStack = procItem;  
    }  
}  
  
// Pop this dialog proc off the dialog proc stack.  
  
DialogBoxIndirectParam...(...)  
{  
    DLGPROCITEM* procItem = g_dlgProcStack->procPrev;  
    delete g_dlgProcStack;  
    g_dlgProcStack = procItem;  
}  
  
// A wrapper dialog procedure will allow us to capture the  
// SC_CONTEXTHELP button on the title bar from Windows and  
// forward it as a simple WM_HELP message back to the dialog.  
  
INT_PTR CALLBACK DialogPreProc(HWND hwndDlg, UINT uMsg,  
    WPARAM wParam, LPARAM lParam)  
{  
    if (uMsg == WM_SYSCOMMAND && wParam == SC_CONTEXTHELP)  
    {  
        uMsg = WM_HELP;  
        wParam = 0;  
        lParam = 0;  
    }  
    return CallWindowProc((WNDPROC)g_dlgProcStack->proc,  
        hwndDlg, uMsg, wParam, lParam);  
}  
```  
  
##### <a name="help-buttons-in-managed-code"></a>Кнопки «Справка» в управляемом коде  
 Переопределение поведения по умолчанию окна кнопка заголовка окна справки можно легко в управляемом коде. Ниже приведен полный демонстрационного приложения, демонстрирующий такие действия. По сути, необходимо переопределить в форму **WndProc** метода и затем пожара отключение справки F1 запросов при **SC_CONTEXTHELP** перехватывает сообщения.  
  
```  
using System;  
using System.Windows.Forms;  
  
public class HelpForm : Form  
{  
    private const int SC_CONTEXTHELP = 0xF180;  
    private const int WM_SYSCOMMAND = 0x0112;  
  
    public HelpForm()  
    {  
        this.ClientSize = new System.Drawing.Size(300, 250);  
        this.HelpButton = true;  
        this.MaximizeBox = false;  
        this.MinimizeBox = false;  
        this.Name = "HelpForm";  
        this.Text = "Help Form";  
    }  
  
    protected override void WndProc(ref Message m)  
    {  
        if (m.Msg == WM_SYSCOMMAND && SC_CONTEXTHELP == (int)m.WParam)  
            ShowHelp();  
        else  
            base.WndProc(ref m);  
    }  
  
    private void ShowHelp()  
    {  
        MessageBox.Show("F1 Help goes here.");  
    }  
  
     [STAThread]  
    static void Main()  
    {  
        Application.EnableVisualStyles();  
        Application.EnableRTLMirroring();  
        Application.Run(new HelpForm());  
    }  
}  
```  
  
## <a name="see-also"></a>См. также  
 [Шрифты и форматирование для Visual Studio](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md)   
 [Макет для Visual Studio](../../extensibility/ux-guidelines/layout-for-visual-studio.md)   
 [Уведомления и ход выполнения для Visual Studio](../../extensibility/ux-guidelines/notifications-and-progress-for-visual-studio.md)