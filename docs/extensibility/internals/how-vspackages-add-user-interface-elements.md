---
title: Как добавить элементы пользовательского интерфейса в пакеты VSPackage | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- user interfaces, adding elements
- UI element design [Visual Studio SDK], VSPackages
- VSPackages, contributing UI elements
ms.assetid: abc5d9d9-b267-48a1-92ad-75fbf2f4c1b9
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: 930ab9e741b2fd5bbc0ca2954192fe5e2c4313d4
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
ms.locfileid: "31136085"
---
# <a name="how-vspackages-add-user-interface-elements"></a>Как добавить элементы пользовательского интерфейса в пакеты VSPackage
Пакет VSPackage можно добавлять элементы пользовательского интерфейса (UI, например, меню, панелей инструментов) и средства windows для Visual Studio с помощью vsct-файле.  
  
 Можно найти рекомендации по проектированию для элементов пользовательского интерфейса в [Visual Studio техники](../../extensibility/ux-guidelines/visual-studio-user-experience-guidelines.md).  
  
## <a name="the-visual-studio-command-table-architecture"></a>Архитектура таблицы команд Visual Studio  
 Как уже отмечалось, архитектура таблиц команда поддерживает вышеупомянутый архитектурных принципов. Принципов абстрактные классы, структуры данных и средства архитектуры таблицы команды выглядят следующим образом:  
  
-   Существуют три основных типа элементов: меню, команд и группы. Меню могут быть предоставлены в пользовательском Интерфейсе как меню, подменю, панели инструментов или окна инструментов. Команды, процедуры, которые может выполнять пользователь в Интегрированной среде разработки, и они могут быть предоставлены как команды меню, кнопки, списки или других элементов управления. Группы являются контейнерами для меню и команд.  
  
-   Каждый элемент задается по определению, который описывает элемент, его приоритет относительно других элементов, а также флаги, которые изменяют свое поведение.  
  
-   Каждый элемент имеет размещения, в котором описывается родительский элемент. Элемент может иметь несколько родительских элементов, чтобы он может присутствовать в нескольких местах в пользовательском Интерфейсе.  
  
     Каждая команда должна присутствовать группа с родительским, даже если он является единственным дочерним элементом в этой группе. Каждый стандартного меню также должен иметь родительскую группу. Панели инструментов и окна инструментов в качестве своих собственных родительских объектов. Группы могут иметь в качестве родительского главной строке меню Visual Studio или любого меню, панели инструментов или окна инструментов.  
  
### <a name="how-items-are-defined"></a>Определение элементов  
 . Файлы Vsct представлены в формате XML. Vsct-файл определяет элементы пользовательского интерфейса для пакета и определяет, где эти элементы отображаются в Интегрированной среде разработки. Каждый меню, группы или команды в пакете впервые назначается идентификатор GUID и ID в `Symbols` раздела. В остальной части vsct-файлом файла, каждого меню, команды и группа идентифицируется комбинацией его GUID и ID. В следующем примере показано типичное `Symbols` раздел, созданный шаблона пакета Visual Studio при **команду меню** выбранных в шаблоне.  
  
```xml  
<Symbols>  
  <!-- This is the package guid. -->  
  <GuidSymbol name="guidMenuTextPkg" value="{b1253bc6-d266-402b-89e7-5e3d3b22c746}" />  
  
  <!-- This is the guid used to group the menu commands together -->  
  <GuidSymbol name="guidMenuTextCmdSet" value="{a633d4e4-6c65-4436-a138-1abeba7c9a69}">  
  
    <IDSymbol name="MyMenuGroup" value="0x1020" />  
    <IDSymbol name="cmdidMyCommand" value="0x0100" />  
  </GuidSymbol>  
  
  <GuidSymbol name="guidImages" value="{53323d9a-972d-4671-bb5b-9e418480922f}" >  
    <IDSymbol name="bmpPic1" value="1" />  
    <IDSymbol name="bmpPic2" value="2" />  
    <IDSymbol name="bmpPicSearch" value="3" />  
    <IDSymbol name="bmpPicX" value="4" />  
    <IDSymbol name="bmpPicArrows" value="5" />  
  </GuidSymbol>  
</Symbols>  
```  
  
 Это элемент верхнего уровня `Symbols` раздел [GuidSymbol элемент](../../extensibility/guidsymbol-element.md). `GuidSymbol` имена элементов сопоставляются идентификаторы GUID, используемые в интегрированной среде разработки для определения пакетов и их частей компонента.  
  
> [!NOTE]
>  Идентификаторы GUID шаблона пакета Visual Studio создаются автоматически. Можно также создать уникальный идентификатор GUID, щелкнув **создать GUID** на **средства** меню.  
  
 Первый `GuidSymbol` элемент, «guid [PackageName] Pkg», идентификатор GUID в самом пакете. Это идентификатор GUID, используемый в Visual Studio, чтобы загрузить пакет. Как правило не имеет дочерних элементов.  
  
 По соглашению, меню и команды группируются за секунду. `GuidSymbol` элемент, «guid [PackageName] CmdSet», и растровые изображения в разделе третий `GuidSymbol` элемент, «guidImages». Нет необходимости соответствуют этому соглашению, но каждого меню, группы, команды и точечный рисунок должен быть потомком `GuidSymbol` элемента.  
  
 Во втором `GuidSymbol` элемент, который представляет набор команд пакета, ряд `IDSymbol` элементов. Каждый [IDSymbol элемент](../../extensibility/idsymbol-element.md) сопоставляет имя числовое значение и может представлять меню, группу или команду, которая является частью набора команд. `IDSymbol` Элементами в третьем `GuidSymbol` растровые изображения представляют собой элемент, можно использовать в качестве значков для команд. Так как пары GUID и ID должно быть уникальным в приложении нет двух дочерних элементов того же `GuidSymbol` элемент может иметь то же значение.  
  
### <a name="menus-groups-and-commands"></a>Меню, групп и команд  
 Меню, группы или команды содержит GUID и ID, могут добавляться в интегрированную среду разработки. Каждый элемент пользовательского интерфейса должен иметь следующее:  
  
-   Объект `guid` атрибут, который совпадает с именем `GuidSymbol` элемент, заданный в элементе пользовательского интерфейса.  
  
-   `id` Атрибут, который совпадает с именем связанного `IDSymbol` элемента.  
  
     Вместе `guid` и `id` составления атрибуты *подписи* элемента пользовательского интерфейса.  
  
-   Объект `priority` атрибут, который определяет положение элемента пользовательского интерфейса в его родительском меню или группу.  
  
-   Объект [родительского элемента](../../extensibility/parent-element.md) с `guid` и `id` атрибуты, определяющие сигнатуры родительского меню или группу.  
  
#### <a name="menus"></a>Меню  
 Каждое меню определяется как [элемент меню](../../extensibility/menu-element.md) в `Menus` раздела. Меню должно иметь `guid`, `id`, и `priority` атрибуты и `Parent` элемент, а также следующие дополнительные атрибуты и дочерние элементы:  
  
-   Объект `type` атрибут, указывающий, следует ли отображать меню в интегрированной среде разработки в качестве своеобразного меню или панели инструментов.  
  
-   A [элемент строки](../../extensibility/strings-element.md) , содержащий [ButtonText элемент](../../extensibility/buttontext-element.md), указывающий заголовка меню в Интегрированной среде разработки и [CommandName элемент](../../extensibility/commandname-element.md), которое указывает имя, которое используется в **команда** окна для доступа к меню.  
  
-   Необязательные флаги. Объект [элемент Command флаг](../../extensibility/command-flag-element.md) может появляться в определении меню для изменения его внешнего вида и поведения в среде разработки.  
  
 Каждый `Menu` элемент должен иметь группу его родительского, если он не является фиксируемого элемента, например панель инструментов. Закрепляемое меню является собственным родителем. Дополнительные сведения о меню и значения для `type` см. в разделе [элемент меню](../../extensibility/menu-element.md) документации.  
  
 В следующем примере показано меню, которое отображается рядом с элементом в строке меню Visual Studio **средства** меню.  
  
```xml  
<Menu guid="guidTopLevelMenuCmdSet"  
id="TopLevelMenu" priority="0x700" type="Menu">  
  <Parent guid="guidSHLMainMenu"  
          id="IDG_VS_MM_TOOLSADDINS" />  
  <Strings>  
    <ButtonText>TestMenu</ButtonText>  
    <CommandName>TestMenu</CommandName>  
  </Strings>  
</Menu>  
```  
  
#### <a name="groups"></a>Группы  
 Группа — элемент, который определен в `Groups` раздел vsct-файле. Группы являются просто контейнерами. Они отсутствуют в интегрированной среде разработки, за исключением того, как Разделительная линия меню. Таким образом [элемент группы](../../extensibility/group-element.md) определяется только его подписи, приоритет и родительский.  
  
 Группа может иметь меню, другую группу или сам как родительский элемент. Однако родительский объект — обычно меню или панели инструментов. Меню в предыдущем примере является дочерним элементом `IDG_VS_MM_TOOLSADDINS` группы и группы является дочерним элементом в строке меню Visual Studio. Группа, в следующем примере является дочерним элементом меню в предыдущем примере.  
  
```  
 <Group guid="guidTopLevelMenuCmdSet" id="MyMenuGroup"  
priority="0x0600">  
   <Parent guid="guidTopLevelMenuCmdSet" id="TopLevelMenu"/>  
 </Group>  
```  
  
 Так как он входит в состав меню, эта группа будет обычно содержат команды. Он также может содержать другие меню. Это определение подменю, как показано в следующем примере.  
  
```xml  
<Menu guid="guidTopLevelMenuCmdSet" id="SubMenu"  
priority="0x0100" type="Menu">  
  <Parent guid="guidTopLevelMenuCmdSet" id="MyMenuGroup"/>  
  <Strings>  
    <ButtonText>Sub Menu</ButtonText>  
    <CommandName>Sub Menu</CommandName>  
  </Strings>  
</Menu>  
```  
  
#### <a name="commands"></a>Команды  
 Команды, которая предоставляется в интегрированную среду разработки определяется как [элемент Button](../../extensibility/button-element.md) или [элемент поля со списком](../../extensibility/combo-element.md). Отображение в меню или панели инструментов, команда должна быть группа, как его родительский элемент.  
  
##### <a name="buttons"></a>Кнопки  
 Кнопки определены в `Buttons` раздела. Кнопка считается любой элемент меню, кнопки или другого элемента, которую пользователь может щелкнуть для выполнения отдельных команд. Некоторые типы кнопка может также включать функции списка. Кнопки имеют одинаково необходимые и необязательные атрибуты, которые имеют меню, а также может иметь [значок элемента](../../extensibility/icon-element.md) , указывающий идентификатор GUID и идентификатор точечного рисунка, представляющий кнопку в Интегрированной среде разработки. Дополнительные сведения о кнопках и их атрибутов см. в разделе [элемент кнопки](../../extensibility/buttons-element.md) документации.  
  
 Кнопка в следующем примере дочерним элементом группы в предыдущем примере и будет выглядеть как элемент меню в его родительском меню этой группы в Интегрированной среде разработки.  
  
```  
<Button guid="guidTopLevelMenuCmdSet" id="cmdidTestCommand" priority="0x0100" type="Button">  
  <Parent guid="guidTopLevelMenuCmdSet" id="MyMenuGroup" />  
  <Icon guid="guidImages" id="bmpPic1" />  
  <Strings>  
    <CommandName>cmdidTestCommand</CommandName>  
    <ButtonText>Test Command</ButtonText>  
  </Strings>  
</Button>  
```  
  
##### <a name="combos"></a>Комбинировать  
 Комбинировать определяются в `Combos` раздела. Каждый `Combo` элемент представляет раскрывающегося списка в Интегрированной среде разработки. Список может или не может быть доступен для записи, пользователями, в зависимости от значения `type` атрибут поле со списком. Комбинировать имеют те же элементы, и поведение, которое кнопки имеют, а также может иметь следующие дополнительные атрибуты:  
  
-   Объект `defaultWidth` атрибут, указывающий ширину в пикселях.  
  
-   `idCommandList` Атрибут, указывающий список, содержащий элементы, которые отображаются в окне списка. Список команд должен быть объявлен в том же `GuidSymbol` узел, который содержит поле со списком.  
  
 В следующем примере определяется элемент поля со списком.  
  
```xml  
<Combos>  
  <Combo guid="guidFirstToolWinCmdSet"  
         id="cmdidWindowsMediaFilename"  
         priority="0x0100" type="DynamicCombo"  
         idCommandList="cmdidWindowsMediaFilenameGetList"  
         defaultWidth="130">  
    <Parent guid="guidFirstToolWinCmdSet"  
            id="ToolbarGroupID" />  
    <CommandFlag>IconAndText</CommandFlag>  
    <CommandFlag>CommandWellOnly</CommandFlag>  
    <CommandFlag>StretchHorizontally</CommandFlag>  
    <Strings>  
      <CommandName>Filename</CommandName>  
      <ButtonText>Enter a Filename</ButtonText>  
    </Strings>  
  </Combo>  
</Combos>  
```  
  
##### <a name="bitmaps"></a>Растровые изображения  
 Команды, которые отображаются вместе со значком должен включать `Icon` элемент, который ссылается на точечный рисунок с помощью его идентификатора GUID и идентификатор. Каждый рисунок представляет собой [растровое изображение элемента](../../extensibility/bitmap-element.md) в `Bitmaps` раздела. Единственные необходимые атрибуты для `Bitmap` , определение `guid` и `href`, указывающая на исходный файл. Если исходный файл является панелью ресурсов **usedList** атрибута требуется также, чтобы вывести список доступных образов на полосе. Дополнительные сведения см. в разделе [растровое изображение элемента](../../extensibility/bitmap-element.md) документации.  
  
### <a name="parenting"></a>Родительские связи  
 Следующие правила определяют способ вызова другого элемента в качестве родительского элемента.  
  
|Элемент|Заданные в этом разделе таблицы команд|Могут содержаться (родительской или путем размещения в `CommandPlacements` раздела или оба)|Может содержать (так называемый родительский элемент)|  
|-------------|--------------------------------------------------|---------------------------------------------------------------------------------------------------|---------------------------------------------|  
|Группа|[Группирует элемент](../../extensibility/groups-element.md), интегрированной среды разработки, других пакетов VSPackage|Меню, группы, сам элемент|Меню, групп и команд|  
|Меню|[Элемент меню](../../extensibility/menus-element.md), интегрированной среды разработки, других пакетов VSPackage|от 1 до *n* групп|0 для *n* групп|  
|Toolbar|[Элемент меню](../../extensibility/menus-element.md), интегрированной среды разработки, других пакетов VSPackage|Сам элемент|0 для *n* групп|  
|Menu Item|[Кнопки элемент](../../extensibility/buttons-element.md), интегрированной среды разработки, других пакетов VSPackage|от 1 до *n* группирует самого элемента|-0, чтобы *n* групп|  
|Кнопка|[Кнопки элемент](../../extensibility/buttons-element.md), интегрированной среды разработки, других пакетов VSPackage|от 1 до *n* группирует самого элемента||  
|поле со списком|[Элемент комбинировать](../../extensibility/combos-element.md), интегрированной среды разработки, других пакетов VSPackage|от 1 до *n* группирует самого элемента||  
  
### <a name="menu-command-and-group-placement"></a>Меню, команд и размещения группы  
 Меню, группы или команды может отображаться в нескольких местах в Интегрированной среде разработки. Для объекта, который будет отображаться в нескольких местах, его необходимо добавить к `CommandPlacements` раздел как [CommandPlacement элемент](../../extensibility/commandplacement-element.md). Как размещения команд можно добавить любой меню, группы или команды. Тем не менее панели инструментов нельзя расположить таким образом, так как они не могут находиться в нескольких местах контекстно-зависимое.  
  
 Размещений команд имеют `guid`, `id`, и `priority` атрибуты. GUID и ID должны совпадать с элемента, который располагается. `priority` Атрибут управляет расположение элемента относительно других элементов. При интегрированной среды разработки объединяет два или более элементов, имеющих одинаковый приоритет, их размещения не определены, так как в Интегрированной среде разработки не гарантирует, что ресурсы пакета считываются в том же порядке каждый раз при построении пакета.  
  
 Если меню или группа отображается в нескольких местах, в каждом экземпляре будут отображаться все дочерние элементы данного меню или группы.  
  
## <a name="command-visibility-and-context"></a>Видимость команды и контекстом  
 При установке нескольких пакетов VSPackage profusion меню, пункты меню и панелей инструментов может загромождать интегрированной среды разработки. Чтобы избежать этой проблемы, можно управлять видимостью отдельных элементов пользовательского интерфейса с помощью *ограничения на видимость* и флаги команды.  
  
##### <a name="visibility-constraints"></a>Ограничения на видимость  
 Ограничение видимость задается как [элемент VisibilityItem](../../extensibility/visibilityitem-element.md) в `VisibilityConstraints` раздела. Ограничение видимости определяет конкретных контекстах пользовательского интерфейса, в которых отображается целевого элемента. Меню или команды, включенные в этот раздел отображается только в том случае, когда один из определенных контекстов активен. Если меню или команды не упоминается в этом разделе, он всегда отображается по умолчанию. В этом разделе не применяется к группам.  
  
 `VisibilityItem` элементы должны иметь три атрибута, следующим образом: `guid` и `id` целевого элемента пользовательского интерфейса, и `context`. `context` Атрибут указывает, когда целевой элемент будут отображаться и принимает любой допустимый контекст пользовательского интерфейса, как его значение. Константы контекста пользовательского интерфейса для Visual Studio являются членами <xref:Microsoft.VisualStudio.VSConstants> класса. Каждый `VisibilityItem` элемент может принимать значение только одного контекста. Чтобы применить второй контекста, создайте вторую `VisibilityItem` элемент, указывающий на один и тот же элемент, как показано в следующем примере.  
  
```xml  
<VisibilityConstraints>  
  <VisibilityItem guid="guidSolutionToolbarCmdSet"  
        id="cmdidTestCmd"  
        context="UICONTEXT_SolutionHasSingleProject" />  
  <VisibilityItem guid="guidSolutionToolbarCmdSet"  
        id="cmdidTestCmd"  
        context="UICONTEXT_SolutionHasMultipleProjects" />  
</VisibilityConstraints>  
```  
  
##### <a name="command-flags"></a>Флаги команды  
 Следующие флаги команды может повлиять на видимость меню и команды, которому они применяются.  
  
 AlwaysCreate  
 Меню создается, даже если он не имеет групп и кнопки.  
  
 Допустимо для: `Menu`  
  
 CommandWellOnly  
 Примените этот флаг Если команда не отображается в меню верхнего уровня, и вы хотите сделать его доступным для настройки дополнительных оболочки, например, привязка к ключу. После установки пакета VSPackage, пользователь может настроить эти команды, открыв **параметры** диалоговое окно и последующего изменения размещения команд в разделе **клавиатуры среды** категории. Не влияет на расположение на контекстных меню, панелей инструментов, контроллеры меню или подменю.  
  
 Допустимые для: `Button`, `Combo`  
  
 DefaultDisabled  
 По умолчанию команда будет отключен, если пакет VSPackage, реализующий команды не загружена, или не был вызван метод QueryStatus.  
  
 Допустимые для: `Button`, `Combo`  
  
 DefaultInvisible  
 По умолчанию команда выполняется без внешних проявлений, если пакет VSPackage, реализующий команды не загружена, или не был вызван метод QueryStatus.  
  
 Следует использовать в сочетании с `DynamicVisibility` флаг.  
  
 Допустимые для: `Button`, `Combo`, `Menu`  
  
 DynamicVisibility  
 Видимость команды можно изменить с помощью метода QueryStatus или идентификатор GUID, который включается в контекст `VisibilityConstraints` раздела.  
  
 Применяется к командам, которые отображаются в меню, а не на панели инструментов. Элементы верхнего уровня панели инструментов можно отключить, но не скрыт, если флаг OLECMDF_INVISIBLE возвращается из метода QueryStatus.  
  
 В меню этот флаг также указывает, что должен быть автоматически скрыт при его члены скрыты. Этот флаг обычно назначается подменю, так как это поведение уже в меню верхнего уровня.  
  
 Следует использовать в сочетании с `DefaultInvisible` флаг.  
  
 Допустимые для: `Button`, `Combo`, `Menu`  
  
 NoShowOnMenuController  
 Если команду, которая содержит этот флаг находится на контроллер меню, команда не отображается в раскрывающемся списке.  
  
 Допустимо для: `Button`  
  
 Дополнительные сведения о флагах командной см. в разделе [элемент Command флаг](../../extensibility/command-flag-element.md) документации.  
  
##### <a name="general-requirements"></a>Общие требования  
 Команде необходимо передать следующий ряд тестов, перед выводом а включен:  
  
-   Команда располагается правильно.  
  
-   `DefaultInvisible` Не установлен флаг.  
  
-   Родительское меню или панели инструментов отображается.  
  
-   Команда выполняется без внешних проявлений из-за записи контекста на [VisibilityConstraints элемент](../../extensibility/visibilityconstraints-element.md) раздела.  
  
-   Код VSPackage, реализующий <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейс отображает и позволяет команде. Код интерфейса не перехвачено и применить его.  
  
-   Когда пользователь щелкает команду, он становится согласно процедуре, описанной в [маршрутизации алгоритм](../../extensibility/internals/command-routing-algorithm.md).  
  
## <a name="calling-pre-defined-commands"></a>Вызов предварительно определенных команд  
 [Используемыхкоманд элемент](../../extensibility/usedcommands-element.md) позволяет пакетам VSPackage для доступа к командам, предоставляемых в других пакетов VSPackage или IDE. Чтобы сделать это, создайте [Используемойкоманды элемент](../../extensibility/usedcommand-element.md) имеет идентификатор GUID и идентификатор команды для использования. Это обеспечивает загрузку команда средой Visual Studio, даже если он не является частью текущей конфигурации Visual Studio. Дополнительные сведения см. в разделе [Используемойкоманды элемент](../../extensibility/usedcommand-element.md).  
  
## <a name="interface-element-appearance"></a>Внешний вид элемента интерфейса  
 Ниже приведены рекомендации по выбору и размещение элементов команды.  
  
-   [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] предлагает множество элементов пользовательского интерфейса, которые выглядят по-разному в зависимости от расположения.  
  
-   Элемент пользовательского интерфейса, который определен с помощью `DefaultInvisible` флаг будет отображаться в Интегрированной среде разработки применяется либо отображается, его реализация VSPackage <xref:EnvDTE.IDTCommandTarget.QueryStatus%2A> метод, или связанных с определенного контекста пользовательского интерфейса в `VisibilityConstraints` раздела.  
  
-   Даже успешно позиционированные команды может не отображаться. Это так, как интегрированная среда разработки автоматически отображает или скрывает некоторые команды, в зависимости от интерфейсов, которые VSPackage содержит (или не содержит) реализуется. Например реализацию VSPackage некоторых создавать интерфейсы будет автоматически отображаться элементы меню, связанные с построением причины.  
  
-   Применение `CommandWellOnly` флаг в определение элемента пользовательского интерфейса означает, что команда может быть добавлено только путем настройки.  
  
-   Команды могут содержаться только в определенных контекстах пользовательского интерфейса, например, только в том случае, если диалоговое окно отображается, когда IDE находится в режиме конструктора.  
  
-   Чтобы определённые элементы пользовательского интерфейса для отображения в Интегрированной среде разработки, необходимо реализовать один или несколько интерфейсов или написать код.  
  
## <a name="see-also"></a>См. также  
 [Расширение меню и команд](../../extensibility/extending-menus-and-commands.md)