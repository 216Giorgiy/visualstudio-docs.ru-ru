---
title: "Определение состояния команды с помощью сборок взаимодействия | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "сборки взаимодействия, определение статуса команды"
  - "Обработка с использованием сборок взаимодействия, состояние команд"
ms.assetid: 2f5104d1-7b4c-4ca0-a626-50530a8f7f5c
caps.latest.revision: 18
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 18
---
# Определение состояния команды с помощью сборок взаимодействия
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

VSPackage должен хранить список состояние команды, которые он может обрабатывать. Среды не может определить, когда команда, обрабатывается в VSPackage становится включены или отключены. За это отвечает VSPackage для информирования о состояниях команды в среде, например, состояние общие команды например **Вырезать**, **копирования**, и **Вставить**.  
  
## Состояние источников уведомлений  
 Среды получает сведения о командах через VSPackages <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget.QueryStatus%2A> метод, который является частью VSPackage реализацию из <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейса. Среда вызывает <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget.QueryStatus%2A> методе VSPackage в двух случаях:  
  
-   Когда пользователь открывает главного меню или контекстное меню \(щелкнув правой кнопкой мыши\), в среде выполняется <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget.QueryStatus%2A> метод для всех команд, меню, определять их состояние.  
  
-   Когда VSPackage запрашивает среду обновить текущий пользовательский интерфейс \(UI\). Это происходит, как команды, которые видимы для пользователя, такие как **Вырезать**, **копирования**, и **Вставить** группирования на стандартной панели инструментов, становятся включенных и отключенных в ответ на действия контекста и пользователя.  
  
 Поскольку оболочка размещает несколько пакетов VSPackages, оболочка будет неприемлемо снижение производительности если требовалось опросить каждый VSPackage, чтобы определить состояние команды. Вместо этого VSPackage активно следует уведомить среды во время изменения при его пользовательского интерфейса. Дополнительные сведения о уведомление об обновлении см. [Обновление пользовательского интерфейса](../../extensibility/updating-the-user-interface.md).  
  
## Сбой уведомления состояния  
 Сбой VSPackage для уведомления среды изменения состояния команды можно поместить пользовательский Интерфейс в несогласованном состоянии. Помните, что все команды меню и контекстного меню можно поместить на панели инструментов для пользователя. Таким образом обновление пользовательского интерфейса только в том случае, когда открывается меню и контекстного меню недостаточно.  
  
## См. также  
 [Как добавить элементы пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md)   
 [Реализация](../../extensibility/internals/command-implementation.md)