---
title: "Таблицы запущенных документа | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "блокировки чтения"
  - "выполнение таблицы document (RDT) интерфейс IVsDocumentLockHolder"
  - "выполнение таблицы document (RDT)"
  - "выполнение таблицы document (RDT) Изменение блокировки"
  - "запущены таблицы document объекты данных документа"
ms.assetid: bbec74f3-dd8e-48ad-99c1-2df503c15f5a
caps.latest.revision: 18
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 18
---
# Таблицы запущенных документа
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Интегрированная среда разработки поддерживает список всех открытых документов в внутренней структуры, которая называется таблицы запущенных документа \(RDT\). Этот список содержит все открытые документы в памяти независимо от ли эти документы момент редактируется. Документ является любой элемент, который сохраняется, включая файлы проекта и основной файл проекта \(например, файл с расширением VCXPROJ\).  
  
## Элементы таблицы Document запущена  
 Таблицы запущенных документ содержит следующие записи.  
  
|Элемент|Описание|  
|-------------|--------------|  
|Моникер документа|Строка, однозначно определяющее объект данных документа. Это может быть абсолютный путь к файлу проекта системы управления файлами \(например, C:\\MyProject\\MyFile\). Эта строка используется также для проектов, сохраненные в хранилищах, отличных от файловых систем, таких как хранимые процедуры в базе данных. В этом случае система проектов можно придумать уникальная строка, она способна распознавать и возможно синтаксического анализа, чтобы определить, как сохранить документ.|  
|Владелец иерархии|Объект иерархии, которому принадлежит документа, представленный <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> интерфейса.|  
|Идентификатор элемента|Идентификатор элемента для конкретного элемента в иерархии. Это значение является уникальным среди всех документов в иерархии, который является владельцем этого документа, но это значение не обязательно быть уникальным в пределах иерархии.|  
|Объект данных документа|Как минимум, это `IUnknown`<br /><br /> . За пределами любого конкретного интерфейса интегрированной среды разработки не требуется `IUnknown` интерфейс для объекта данных пользовательского редактора документа. Однако для стандартного редактора Реализация редактора <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2> интерфейс, необходимый для обработки вызовов постоянного хранения файлов из проекта. Для получения дополнительной информации см. [Сохранение стандартного документа](../../extensibility/internals/saving-a-standard-document.md).|  
|Флаги|Флаги, определяющие, сохраняется ли документ ли применять блокировку чтения или редактирования и т. д., можно указать, когда элементы добавляются в RDT. Дополнительные сведения см. в разделе <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> перечисления.|  
|Изменить количество блокировок|Количество блокировок редактирования. Блокировки на изменение означает, что некоторые редактора документ открыт для редактирования. Когда количество блокировок редактирования переходит ноль, пользователю предлагается сохранить документ, если он был изменен. Например, каждый раз при открытии документа в редакторе с помощью **новое окно** команды блокировки на изменение будет добавлено в RDT документ. Чтобы блокировки edit должно устанавливаться документ должен иметь иерархии или идентификатором элемента.|  
|Число блокировок чтения|Число блокировок чтения. Блокировка чтения указывает, что документ считывается через некий механизм, например мастер. Блокировка чтения содержит документ в RDT в активном состоянии при, указывающее на то, что документ не может редактироваться. Можно задать блокировку чтения, даже в том случае, если документ не имеет иерархии или идентификатором элемента. Эта функция позволяет открыть документ в память и введите его в RDT без документа, принадлежащими любой иерархии. Эта возможность используется редко.|  
|Владелец блокировки|Экземпляр <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> интерфейса. Владелец блокировки реализуется функции, такие как мастеров, открывать и редактировать документы вне редактора. Владелец блокировки позволяет функция Добавление блокировки на изменение документа, чтобы предотвратить закрывается, хотя она по\-прежнему редактирования документа. Как правило, изменение блокировки только добавленные окон документов \(то есть, редакторы\).|  
  
 Каждая запись в RDT имеет уникальную иерархию или идентификатор элемента, связанной с ним, которая обычно соответствует одному узлу в проекте. Все документы, доступные для редактирования обычно принадлежат иерархии. Записи, сделанные в RDT управления какой проект или, более точно, какие иерархии в данный момент принадлежит редактируемого объекта данных документа. Используя сведения в RDT, интегрированной среды разработки может помешать документа, открытого с несколькими проектами одновременно.  
  
 Иерархия также управляет сохранность данных и использует информацию в RDT обновление **Сохранить** и **Сохранить как** диалоговые окна. При изменении документа пользователи, а затем выберите **выхода** команды **файл** меню интегрированной среды разработки запрашивает с **Сохранить изменения** для отображения всех проектов и элементов проектов, которые изменяются в настоящее время используется диалоговое окно. Это позволяет пользователям выбирать для сохранения документов. Список документов, чтобы сохранить \(то есть эти документы, в которых изменения\) создается на основе RDT. Любые элементы, которые вы хотите увидеть в **Сохранить изменения** диалоговое окно при выходе из приложения должны иметь записи в RDT. RDT координаты, какие документы сохраняются и ли пользователь получает запрос о сохранения операцию, используя значения, указанные в записи флаги для каждого документа. Дополнительные сведения о флагах RDT см. в разделе <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> перечисления.  
  
## Изменение блокировки и блокировки чтения  
 Изменение блокировки и блокировки чтения находятся в RDT. Увеличивает окно документа и уменьшает блокировки редактирования. Таким образом когда пользователь открывает новое окно документа, изменить счетчик блокировок увеличивает на единицу. Когда число блокировок, изменить достигает нуля, сохранить или сохранить данные для соответствующего документа сигнализирует иерархии. Иерархии могут затем сохраняться каким\-либо образом, включая сохранение в формате или в качестве элемента в хранилище данных. Можно использовать <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.LockDocument%2A> метода в <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable> интерфейс для добавления редактирования блокировки или блокировки чтения и <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.UnlockDocument%2A> метод для удаления этих блокировок.  
  
 Как правило при создании экземпляров документ в новом окне редактора окна автоматически добавляет блокировки редактирования документа в RDT. Тем не менее, если создать настраиваемое представление документа, не использует стандартный документ \(то есть, он не реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame> интерфейса\), то нужно задать собственную блокировку изменения. Например с помощью мастера документа изменить без его открытия в редакторе. Чтобы блокировка документов должен открываться в мастерах и похожих сущностей, необходимо реализовать эти сущности <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> интерфейса. Чтобы зарегистрировать ваш документ блокировку, вызов <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.RegisterDocumentLockHolder%2A> и передайте в вашей <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> реализации. Это добавляет RDT блокировку вашего документа. Другой сценарий для реализации блокировку документа — при открытии документа с помощью окна специальные средства. В данном экземпляре не смогут иметь окно инструментов закройте документ. Тем не менее, путем регистрации как владелец блокировки документа в RDT интегрированной среды разработки могут вызывать собственную реализацию <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder.CloseDocumentHolder%2A> метод для закрытия документа запроса.  
  
## Другие использует таблицу документов выполняется  
 Другие сущности в Интегрированной среде разработки использовать RDT для получения сведений о документах. Например диспетчер системы управления версиями использует RDT определить систему, чтобы загрузить документ в редакторе, после его получает последнюю версию файла. Чтобы сделать это, диспетчер системы управления версиями ищет файлы в RDT любой из них открыты. Если они являются, то диспетчер системы управления версиями сначала проверяет, что иерархии реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> метод. Если проект не реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> метода, а затем источник управления диспетчера проверки реализацию <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2.ReloadDocData%2A> в объекте данных документа напрямую.  
  
 IDE также использует RDT для resurface \(перемещение на передний план\) документ, если пользователь запрашивает документ. Дополнительные сведения см. в разделе [Отображение файлов с помощью команды Открыть файл](../../extensibility/internals/displaying-files-by-using-the-open-file-command.md). Чтобы определить, открыт ли файл в RDT, выполните одно из следующих.  
  
-   Запрос моникер документа \(документ полный путь\) узнать, открыт ли элемент.  
  
-   Используйте идентификатор иерархии или элемента, чтобы система проектов запрашивает документ полный путь и найдите элемент в RDT.  
  
## См. также  
 [Использование RDT\_ReadLock](../../extensibility/internals/rdt-readlock-usage.md)   
 [Сохранение состояния и таблицы Document запущена](../../extensibility/internals/persistence-and-the-running-document-table.md)