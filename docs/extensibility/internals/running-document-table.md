---
title: Запуск таблицы Document | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- read locks
- running document table (RDT), IVsDocumentLockHolder interface
- running document table (RDT)
- running document table (RDT), edit locks
- document data objects, running document table
ms.assetid: bbec74f3-dd8e-48ad-99c1-2df503c15f5a
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: 4a49a5267fcccbde60e194e3fc58b0f6b6ea7552
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="running-document-table"></a>Запуска таблицы документов
Интегрированная среда разработки поддерживает список всех открытых документов во внутренней структуре, запущенной таблице документов (RDT). Этот список включает все открытые документы в памяти независимо от ли эти документы момент редактируется. Документ является любой элемент, в которой сохраняется, включая файлы проекта и основной файл проекта (например, файл с расширением VCXPROJ).  
  
## <a name="elements-of-the-running-document-table"></a>Элементы таблицы Document запущена  
 Запущенной таблице документов содержатся следующие элементы.  
  
|Элемент|Описание|  
|-------------|-----------------|  
|Моникер документа|Строка, однозначно определяющее объект данных документа. Это может быть абсолютный путь для системы проектов, которая управляет файлами (например, C:\MyProject\MyFile). Эта строка также используется для проектов, сохраненные в хранилищах, отличных от файловых систем, таких как хранимые процедуры в базе данных. В этом случае система проектов можно придумать уникальную строку, которая может распознавать и возможно синтаксического анализа, чтобы определить, как сохранить документ.|  
|Владелец иерархии|Объект иерархии, которому принадлежит документа, представленный <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> интерфейса.|  
|Идентификатор элемента|Идентификатор элемента для конкретного элемента в иерархии. Это значение является уникальным среди всех документов в иерархии, которому принадлежит этот документ, но это значение не обязательно быть уникальным в пределах иерархии.|  
|Объект данных документа|Как минимум, это `IUnknown`<br /><br /> . IDE не требует любой определенный интерфейс, помимо `IUnknown` интерфейс для объекта данных документа специализированный редактор. Однако для стандартного редактора Реализация редактора <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2> интерфейс, необходимый для обработки вызовов сохраняемости файлов из проекта. Дополнительные сведения см. в разделе [сохранение стандартный документ](../../extensibility/internals/saving-a-standard-document.md).|  
|Флаги|Флаги, определяющие, сохраняется ли документ ли применять блокировку чтения или редактирования и т. д., можно указать при добавлении записей в RDT. Дополнительные сведения см. в описании перечисления <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS>.|  
|Измените число блокировок|Число блокировок редактирования. Блокировки на изменение означает, что некоторые редактора документ открыт для редактирования. Если счетчик блокировок редактирования переходит к нулю, пользователю предлагается сохранить документ, если он был изменен. Например, каждый раз при открытии документа в редакторе с помощью **новое окно** команд для этого документа в RDT добавляется блокировки на изменение. Для редактирования блокировки задаваемый, документ необходимо иметь иерархию или идентификатором элемента.|  
|Число блокировок чтения|Число блокировок чтения. Блокировка чтения указывает, до какого-либо механизма, например мастер выполняется чтение документа. Блокировка чтения содержит документ в RDT при, указывающее на то, что документ не может редактироваться. Можно задать блокировку чтения, даже в том случае, если документ не имеет иерархии или идентификатором элемента. Эта функция позволяет открыть документ в памяти и введите его в RDT без документа, принадлежащими любой иерархии. Эта возможность используется редко.|  
|Владелец блокировки|Экземпляр <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> интерфейса. Владелец блокировки реализуют функции, такие как мастеров, открывать и редактировать документы вне редактора. Владелец блокировки обеспечивает возможность добавлять в документ, чтобы предотвратить закрывается, хотя она по-прежнему редактирования документа блокировки на изменение. Как правило, изменение блокировки только добавленные окна документов (то есть, редакторы).|  
  
 Каждая запись в RDT имеет уникальную иерархию или идентификатор элемента, связанные с ним, которая обычно соответствует одному узлу в проект. Все документы, доступные для редактирования обычно принадлежат иерархии. Записи, сделанные в RDT управления какой проект или, точнее — иерархию, в данный момент принадлежит редактируемого объекта данных документа. Используя информацию в RDT, интегрированной среды разработки можно предотвратить документа, открытого с несколько проектов одновременно.  
  
 Иерархии также управляет сохраняемости данных и использует сведения из RDT обновление **Сохранить** и **Сохранить как** диалоговым окнам. При изменении документа пользователям, а затем выберите **выхода** из **файл** меню интегрированной среды разработки предлагает их с **сохранить изменения** диалоговое окно «», чтобы отобразить все проекты и элементы проектов, которые изменяются в настоящее время. Это позволяет пользователям выбирать, какие документы для сохранения. Список документов, чтобы сохранить (то есть эти документы, в которых изменения) создается на основе RDT. Любые элементы, которые вы хотите увидеть в **сохранить изменения** диалоговое окно при выходе из приложения должны иметь записи в RDT. RDT координаты документов, которые сохраняются и является ли пользователь получает запрос о сохранения операцию с использованием значений, указанных в записи флаги для каждого документа. Дополнительные сведения о флагах RDT см. в разделе <xref:Microsoft.VisualStudio.Shell.Interop._VSRDTFLAGS> перечисления.  
  
## <a name="edit-locks-and-read-locks"></a>Изменение блокировки и блокировки чтения  
 Редактирование блокировок и блокировок чтения находятся в RDT. Увеличивает окно документа и уменьшает блокировки редактирования. Таким образом когда пользователь открывает новое окно документа, изменить счетчик блокировок увеличивает на единицу. Когда количество блокировок редактирования достигает нуля, сохранить или сохранить данные для соответствующего документа сигнализирует иерархии. Иерархии могут затем сохраняться данные каким-либо образом, включая сохранение в файл или в качестве элемента в репозитории. Можно использовать <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.LockDocument%2A> метод в <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable> интерфейс для добавления редактирования блокировки или блокировки, для чтения и <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.UnlockDocument%2A> метод, чтобы удалить эти блокировки.  
  
 Как правило при создании окна документа редактора фрейм окна автоматически добавляет блокировки изменения документа в RDT. Тем не менее, если создать настраиваемое представление документа, не использует стандартный документ (то есть, он не реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame> интерфейса), то нужно задать собственную блокировку изменения. Например с помощью мастера редактировании документа без его открытия в редакторе. Чтобы блокировки документа должен открываться в мастерах и похожих сущностей, необходимо реализовать эти сущности <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> интерфейса. Чтобы зарегистрировать блокировку ваш документ, вызовите <xref:Microsoft.VisualStudio.Shell.Interop.IVsRunningDocumentTable.RegisterDocumentLockHolder%2A> и передайте в вашей <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder> реализации. Это добавляет RDT блокировку ваш документ. Другой сценарий для реализации блокировку документа является при открытии документа с помощью окна специальных инструментов. В данном экземпляре не удается установить в окне инструментов закройте документ. Тем не менее, можно зарегистрировать как владелец блокировки документа в RDT интегрированной среды разработки может вызывать собственную реализацию <xref:Microsoft.VisualStudio.Shell.Interop.IVsDocumentLockHolder.CloseDocumentHolder%2A> метод для закрытия документа запроса.  
  
## <a name="other-uses-of-the-running-document-table"></a>Другим пользователям таблицы Document запущена  
 Другими сущностями в Интегрированной среде разработки используется RDT для получения сведений о документах. Например диспетчер системы управления версиями использует RDT сообщить системе перезагрузить документ в редакторе, после его получения последней версии файла. Чтобы сделать это, диспетчер системы управления версиями ищет файлы в RDT для просмотра, если любой из них открыты. Если они являются, то диспетчер системы управления версиями сначала проверяет, реализует иерархии <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> метод. Если проект не реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistHierarchyItem2.ReloadItem%2A> метод, то источник управления manager проверяет наличие реализация <xref:Microsoft.VisualStudio.Shell.Interop.IVsPersistDocData2.ReloadDocData%2A> метод в объект данных документа напрямую.  
  
 IDE также использует RDT для resurface (перемещение на передний план) открытом документе, если пользователь запрашивает документ. Дополнительные сведения см. в разделе [отображение файлов с помощью команды откройте файл](../../extensibility/internals/displaying-files-by-using-the-open-file-command.md). Чтобы определить, открыт ли файл в RDT, выполните одно из следующих.  
  
-   Запрос узнать, является ли элемент открытым моникер документа (т. е полный путь к документу).  
  
-   Используйте идентификатор иерархии или элемента для запрашивает документ полный путь в системе проекта и найдите элемент в RDT.  
  
## <a name="see-also"></a>См. также  
 [Использование RDT_ReadLock](../../extensibility/internals/rdt-readlock-usage.md)   
 [Сохранение состояния и запуск таблицы документов](../../extensibility/internals/persistence-and-the-running-document-table.md)