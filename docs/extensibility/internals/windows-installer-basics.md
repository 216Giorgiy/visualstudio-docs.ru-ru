---
title: "Основы установщика Windows | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Установщик Windows, пакеты VSPackage"
  - "Пакеты VSPackage, основы установщика Windows"
ms.assetid: 497e479b-add8-4644-870a-917f15306b97
caps.latest.revision: 12
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 12
---
# Основы установщика Windows
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Установщик Windows устанавливает и удаляет приложения или программных продуктов на компьютере пользователя, выполнения этих задач в единицах, называемых компоненты установщика Windows \(также называемые WICs или просто компонентов\). Идентификатор GUID идентифицирует каждый WIC, является основной единицей установки и подсчетом ссылок для настройки с помощью установщика Windows.  
  
 Полную документацию установщика Windows см. в разделе Platform SDK [установщика Windows](http://msdn.microsoft.com/library/aa372866.aspx).  
  
## Создание VSPackage  
 Установщик Windows использует пакеты установки, которые содержат данные, которые нужны установщика Windows для установки, удаления или восстановление продукта и запуска программы установки пользовательский интерфейс \(UI\). Каждый пакет установки включает MSI\-файл, который содержит базу данных установки, общие сведения и потоков данных для различных этапов установки. Использование установщика, необходимо создать экземпляр. Поскольку установщик организует установок с концепцией компонентов и сохраняет сведения об установке в реляционной базе данных, процесс создания пакета установки широко включает следующие действия:  
  
1.  План разработки для поддержки управления версиями и стратегии side\-by\-side установки.  
  
2.  Определите компоненты, которые должны отображаться пользователям.  
  
3.  Упорядочите компоненты VSPackage и зависимости.  
  
4.  Заполнение базы данных установки с информацией.  
  
5.  Проверка установки пакета.  
  
 В этой документации в основном занимается первый и третий этапы процесса. При выполнении этой процедуры распределить компоненты VSPackage по WICs, можно составлять управление версиями и обслуживание стратегии учетной записи для последующих версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Остальные три действия подробно описаны в документации установщика Windows в Platform SDK.  
  
## Основные термины  
 Ниже приведены определения ключевых терминов, относящихся к технологии установщика Windows.  
  
 Ресурс  
 Файлы, разделы реестра, сочетания клавиш, или и так далее, могут быть установлены на компьютере. Эти ресурсы логически сгруппированы в компоненты установщика Windows.  
  
 Компонент установщика Windows \(WIC\)  
 Базовая единица представляет логическое группирование связанных ресурсов, которые устанавливаются и удаляются как единое установки. Компоненты установщика Windows идентифицируются компонент уникальный идентификатор или идентификатор GUID. Кроме того установщик Windows ведет подсчет на уровне WIC его ссылок. Максимальное управления версиями обеспечивает гибкость включать не более одного основного ресурса, например библиотеку DLL в заданной WIC. Обратите внимание, что после идентификации и заполнить WIC, присвойте ему идентификатор GUID и развернуть его нельзя изменить композицию. Дополнительные сведения см. в разделе [организации приложения на компоненты](http://msdn.microsoft.com/library/aa370561.aspx).  
  
 Пакет \(распространяемый пакет\)  
 Единица развертывания, состоящий из MSI\-файла и внешние исходные файлы, к которым может указывать этот файл. Пакет содержит все сведения, для установки Windows для запуска пользовательского интерфейса, а также для установки или удаления приложения.  
  
 MSI\-файл  
 Файл хранилища со структурой COM, содержащий инструкции и данные, необходимые для установки приложения. Каждый пакет содержит по крайней мере один файл MSI. MSI\-файл содержит база данных установщика, общие сведения и возможно один или несколько преобразований и внутренних исходных файлов. Устанавливаемые файлы можно сжимаются в CAB\-файл и сохранен в потоке в MSI\-файл или хранятся, сжатие или несжатых данных за пределами MSI\-файла на носителе источника. Дополнительные сведения см. в разделе [расширения файлов установщика Windows](http://msdn.microsoft.com/library/aa372842\(VS.85\).aspx).  
  
## Применение правил установщика Windows  
 Два набора правил определения развертывания ресурсов в своей установки компонентов. Один набор правил с помощью установщика Windows, сохраняется, пока необходимо обеспечить как автор установки второго набора.  
  
> [!NOTE]
>  Применение правил установщика Windows происходит только в том случае, если выполняется проверка файла MSI\-файл. Тем не менее являются cautioned считать эти правила и рекомендации. Дополнительные сведения см. в разделе [Проверка установки базы данных](http://msdn.microsoft.com/library/aa372477\(VS.85\).aspx) и [Проверка пакета](http://msdn.microsoft.com/library/aa370569\(VS.85\).aspx).  
  
#### Правила применяются установщика  
  
-   Все файлы в данный компонент устанавливается в тот же каталог. И наоборот файлы, установленные для разделения папок должна принадлежать отдельные компоненты.  
  
-   Может существовать только один путь к разделу каждого компонента. Путь к разделу является просто файла или раздела реестра, представляющий весь компонент.  
  
#### Поставщик компонентов обязанности  
  
-   Любых двух ресурсов, которые могут поставляться отдельно в последующих версиях должен существовать в отдельные компоненты. Ресурсы должны быть сгруппированы в том же компоненте, только в том случае, если вы уверены, что эти ресурсы никогда не будет поставляться отдельно. На самом деле, рекомендуется, основной все ресурсы \(например, DLL\), всегда существуют в отдельном WICs. Дополнительные сведения см. в разделе [Определение компоненты установщика](http://msdn.microsoft.com/library/aa368269\(VS.85\).aspx).  
  
-   Ресурс с контролем версий не следует никогда не поставляется в нескольких WIC.  
  
## См. также  
 [Что произойдет, если правила компонентов перестали работать?](http://msdn.microsoft.com/library/aa372795\(VS.85\).aspx)