---
title: "Создание нового проекта: За кулисами, часть 1 | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "проекты [Visual Studio], диалоговое окно нового проекта"
  - "Создание проекта новые проекты [Visual Studio]"
ms.assetid: 66778698-0258-467d-8b8b-c351744510eb
caps.latest.revision: 29
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 29
---
# Создание нового проекта: За кулисами, часть 1
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Когда\-нибудь задумывались о том, как создать проект собственного типа? Интересно, что фактически происходит при создании нового проекта? Давайте взглянем взгляд изнутри и увидеть, что происходит в действительности.  
  
 Существует несколько задач, которые координаты Visual Studio:  
  
-   Отображается дерево всех доступных типов проектов.  
  
-   Он отображает список шаблонов приложений для каждого типа проекта и позволяет выбрать одну.  
  
-   Он собирает сведения о проекте для приложения, такие как имя и путь проекта.  
  
-   Эта информация передает фабрики проектов.  
  
-   Создает элементы проектов и папок в текущем решении.  
  
## Диалоговом окне Новый проект  
 Все начинается при выборе типа проекта для нового проекта. Давайте начнем, щелкнув **Новый проект** на **файл** меню.**Новый проект** откроется диалоговое окно, выглядящие примерно так:  
  
 ![Диалоговое окно “Новый проект”](~/extensibility/internals/media/newproject.gif "NewProject")  
  
 Давайте взглянем поближе.**Типов проектов** дерева перечислены различные типы проектов, можно создать. При выборе типа проекта, например **Visual C\# Windows**, вы увидите список шаблонов приложений, чтобы приступить к работе.**Установленные шаблоны visual Studio** устанавливаются Visual Studio и доступны для любого пользователя компьютера. Можно добавить новые шаблоны для создания или сбора **Мои шаблоны** и доступны только для вас.  
  
 При выборе шаблона **приложения Windows**, описание типа приложения отображается в диалоговом окне; в данном случае **проект для создания приложения с пользовательским интерфейсом Windows**.  
  
 В нижней части **Новый проект** диалоговом вы увидите несколько элементов управления, сбора дополнительной информации. Элементы управления, вы видите зависят от типа проекта, но обычно они включают проект **имя** текстовое поле **расположение** текстовое поле и связанных **Обзор** кнопки и **имя решения** текстового поля и связанные **Создать каталог для решения** флажок.  
  
## Заполнение диалоговом окне Новый проект  
 Где does **Новый проект** диалоговое окно Получение информации из? Существует два механизма работы здесь, один из них рекомендуется к использованию.**Новый проект** объединяет диалоговое окно и отображает информацию, полученную из обоих механизмов.  
  
 Старый метод \(не рекомендуется\) использует записи системного реестра и файлов VSDir. Этот механизм работает, если открыть Visual Studio. Метод новой использует VSTEMPLATE\-файлы. Этот механизм работает при инициализации Visual Studio, например, путем запуска  
  
```  
devenv /setup  
```  
  
 или  
  
```  
devenv /installvstemplates  
```  
  
### Типы проектов  
 Положение и имена **типы проектов** корневых узлов, таких как **Visual C\#** и **другие языки**, определяется путем записи системного реестра. Организация дочерних узлов, таких как **базы данных** и **смарт\-устройств**, отражает иерархию папок, содержащих соответствующие файлы с расширением VSTEMPLATE. Давайте сначала взглянем на корневые узлы.  
  
#### Корневые узлы типа проекта  
 При [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] будет инициализирован, он проходит подразделов реестра системы HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\VisualStudio\\14.0\\NewProjectTemplates\\TemplateDirs для построения и назовите корневые узлы **типы проектов** дерева. Эта информация кэшируется для последующего использования. Взгляните на ключ \\\/1 TemplateDirs\\ {FAE04EC1\-301F\-11D3\-BF4B\-00C04F79EFBC}. Каждая запись является идентификатором GUID VSPackage. Имя удаляемого подраздела \(\/ 1\) учитывается, но его присутствие означает **типы проектов** корневого узла. Корневой узел, в свою очередь, может иметь несколько подразделов, определяющие его внешний вид в **типы проектов** дерева. Давайте взглянем на некоторые из них.  
  
##### \(Значение по умолчанию\)  
 Это идентификатор ресурса локализованную строку с именем корневого узла. Строковый ресурс находится в вспомогательной библиотеки DLL по VSPackage GUID.  
  
 В примере является VSPackage GUID  
  
 {FAE04EC1\-301F\-11D3\-BF4B\-00C04F79EFBC}  
  
 и идентификатор ресурса \(значение по умолчанию\) корневой узел \(\/ 1\) является \#2345  
  
 Если найти GUID в соседнем ключ пакетов и проверить подраздел SatelliteDll, можно найти путь сборки, которая содержит строковый ресурс:  
  
 \\VC\#\\VCSPackages\\1033\\csprojui.dll \< путь установки visual Studio \>  
  
 Чтобы проверить это, откройте проводник и перетащите csprojui.dll в каталоге Visual Studio... Строка таблицы видно, что ресурс \#2345 предлагает заголовок **Visual C\#**.  
  
##### SortPriority  
 Этот параметр определяет положение корневой узел в **типы проектов** дерева.  
  
 REG\_DWORD SortPriority 0x00000014 \(20\)  
  
 Чем ниже номер приоритета, тем выше уровень дерева.  
  
##### DeveloperActivity  
 Если этот раздел отсутствует, положение корневого узла управляется диалоговое окно параметров разработчика. Например:  
  
 REG\_SZ DeveloperActivity VC \#  
  
 Показывает, что Visual C\# корневой узел, если установлена Visual Studio [!INCLUDE[vcprvc](../../debugger/includes/vcprvc_md.md)] разработки. В противном случае, он будет дочерний узел **другие языки**.  
  
##### Папка  
 При наличии этого подраздела корневой узел становится дочерним узлом указанной папки. Отобразится список возможных папки в разделе  
  
 HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\VisualStudio\\11.0\\NewProjectTemplates\\PseudoFolders  
  
 Например запись проекты базы данных имеет ключ папки, соответствующей записи в PseudoFolders другие типы проектов. Таким образом, в **типы проектов** дерева, **проектов баз данных** будет дочерним узлом **другие типы проектов**.  
  
#### Тип дочерние узлы и .vstdir файлы проекта  
 Положение дочерних узлов в **типы проектов** дерева соответствует иерархии папок в папках Шаблоны\_проекта. Для шаблонов \(**Установленные шаблоны Visual Studio**\), типичное расположение — \\Program Files\\Microsoft 14.0\\Common7\\IDE\\ProjectTemplates\\ Visual Studio и шаблонов пользователя \(**Мои шаблоны**\), типичное расположение — Мои \\My Documents\\Visual Studio 14.0\\Templates\\ProjectTemplates\\. Иерархии папок в обоих случаях объединяются для создания **типы проектов** дерева.  
  
 Для Visual Studio с C\# параметры разработчика **типы проектов** дерева выглядит примерно так:  
  
 ![Типы проектов](~/extensibility/internals/media/projecttypes.png "ProjectTypes")  
  
 В соответствующую папку Шаблоны\_проекта выглядит следующим образом:  
  
 ![Шаблоны проектов](~/extensibility/internals/media/projecttemplates.png "ProjectTemplates")  
  
 При **Новый проект** откроется диалоговое окно [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] просматривает папку Шаблоны\_проекта и воссоздает свою структуру в **типы проектов** дерева с некоторыми изменениями:  
  
-   Корневой узел в **типы проектов** дерева определяется шаблон приложения.  
  
-   Имя узла может быть локализована и может содержать специальные символы.  
  
-   Можно изменить порядок сортировки.  
  
##### Поиск корневого узла для типа проекта  
 Когда Visual Studio просматривает папки Шаблоны\_проекта, открывает все ZIP\-файлы и извлекает VSTEMPLATE\-файлов. VSTEMPLATE\-файл использует XML для описания шаблон приложения. Для получения дополнительной информации см. [Создание нового проекта: За кулисами, часть 2](../Topic/New%20Project%20Generation:%20Under%20the%20Hood,%20Part%20Two.md).  
  
 Тег \< ProjectType \> определяет тип проекта для приложения. Например файл \\CSharp\\SmartDevice\\WindowsCE\\1033\\WindowsCE\-EmptyProject.zip содержит файл EmptyProject.vstemplate с этим тегом:  
  
```  
<ProjectType>CSharp</ProjectType>  
```  
  
 Тег \< ProjectType \>, а не вложенную папку в папке Шаблоны\_проекта определяет корневой узел приложения в **типы проектов** дерева. В примере приложения Windows CE будут отображены в **Visual C\#** корневой узел, и даже если перемещение папки WindowsCE VisualBasic папку, чтобы Windows CE приложений по\-прежнему будут отображены в **Visual C\#** корневого узла.  
  
##### Локализация имя узла  
 Visual Studio просматривает папки Шаблоны\_проекта, проверяются все найденных файлов .vstdir. Файл .vstdir является XML\-файл, который определяет отображение типов проекта в **Новый проект** диалоговое окно. В файле .vstdir используйте имя тега \< LocalizedName \> **типы проектов** узла.  
  
 Например файл \\CSharp\\Database\\TemplateIndex.vstdir содержит этот тег:  
  
```  
<LocalizedName Package="{462b036f-7349-4835-9e21-bec60e989b9c}" ID="4598"/>  
```  
  
 Определяет вспомогательные библиотеки DLL и ресурсов идентификатор локализованную строку с именем корневой узел в этом случае **базы данных**. Локализованное имя может содержать специальные символы, которые не доступны в именах папок, таких как **.NET**.  
  
 Если ни один тег \< LocalizedName \>, тип проекта с именем в папке, **SmartPhone2003**.  
  
##### Поиск порядок сортировки для типа проекта  
 Для определения порядка сортировки типа проекта, файлы .vstdir использовать тег \< SortOrder \>.  
  
 Например файл \\CSharp\\Windows\\Windows.vstdir содержит этот тег:  
  
```  
<SortOrder>5</SortOrder>  
```  
  
 Файл \\CSharp\\Database\\TemplateIndex.vstdir содержит тег с большим значением:  
  
```  
<SortOrder>5000</SortOrder>  
```  
  
 Чем меньше номер в \< SortOrder \> тег, позицию вверх в дереве, поэтому **Windows** узел отображается выше, чем **базы данных** узел в **типы проектов** дерева.  
  
 Если ни один тег \< SortOrder \> указан для типа проекта, он отображается в алфавитном порядке следующие типы любого проекта, содержащие \< SortOrder \> спецификации.  
  
 Обратите внимание, что нет .vstdir файлов в папке Мои документы \(**Мои шаблоны**\) папки. Имена типов проекта пользователь приложения не локализуются и отображаются в алфавитном порядке.  
  
#### Краткий обзор  
 Изменим **Новый проект** диалоговое окно и создать новый шаблон проекта пользователя.  
  
1.  Добавьте вложенную папку MyProjectNode в папку 14.0\\Common7\\IDE\\ProjectTemplates\\CSharp Files\\Microsoft Visual Studio.  
  
2.  Создайте файл MyProject.vstdir в папке MyProjectNode, используя любой текстовый редактор.  
  
3.  Добавьте следующие строки в файл .vstdir:  
  
    ```  
    <TemplateDir Version="1.0.0">  
        <SortOrder>6</SortOrder>  
    </TemplateDir>  
    ```  
  
4.  Сохраните и закройте файл .vstdir.  
  
5.  Создайте файл MyProject.vstemplate в папке MyProjectNode, используя любой текстовый редактор.  
  
6.  Добавьте следующие строки в VSTEMPLATE\-файла:  
  
    ```  
    <VSTemplate Version="2.0.0" Type="Project" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005">  
        <TemplateData>  
            <ProjectType>CSharp</ProjectType>  
        </TemplateData>  
    </VSTemplate>  
    ```  
  
7.  Сохраните файл the.vstemplate и закройте редактор.  
  
8.  Отправьте новая сжатая папка MyProjectNode\\MyProject.zip VSTEMPLATE\-файл.  
  
9. Командное окно Visual Studio введите:  
  
    ```  
    devenv /installvstemplates  
    ```  
  
 Запустите Visual Studio.  
  
1.  Откройте **Новый проект** диалогового окна выберите и разверните **Visual C\#** узел проекта.  
  
 ![MyProjectNode](~/extensibility/internals/media/myprojectnode.png "MyProjectNode")  
  
 **MyProjectNode** отображается как дочерний узел Visual C\# просто узле Windows.  
  
## См. также  
 [Создание нового проекта: За кулисами, часть 2](../Topic/New%20Project%20Generation:%20Under%20the%20Hood,%20Part%20Two.md)