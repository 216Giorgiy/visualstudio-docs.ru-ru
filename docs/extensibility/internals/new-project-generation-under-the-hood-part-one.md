---
title: "Создание нового проекта: За кулисами, часть 1 | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- projects [Visual Studio], new project dialog
- projects [Visual Studio], new project generation
ms.assetid: 66778698-0258-467d-8b8b-c351744510eb
caps.latest.revision: "29"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: efe08d9e23f1a77fd68df2bdba4389e7b7955b11
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="new-project-generation-under-the-hood-part-one"></a>Создание нового проекта: За кулисами, часть 1
Когда-нибудь задумывались о том, как создать проект собственного типа? Интересно, что фактически происходит при создании нового проекта? Давайте peek за кулисами и посмотрим, что действительно происходит.  
  
 Существует несколько задач, которые Visual Studio координаты для вас.  
  
-   Отображается дерево всем доступным типам проектов.  
  
-   Он отображает список шаблонов приложений для каждого типа проекта и позволяет выбрать один.  
  
-   Он собирает сведения о проекте для приложения, такие как имя проекта и пути.  
  
-   Он передает эти сведения фабрики проектов.  
  
-   Он создает папки и элементы проектов в текущем решении.  
  
## <a name="the-new-project-dialog-box"></a>Диалоговое окно создания проекта  
 Все начинается с выбора типа проекта для нового проекта. Давайте начнем, щелкнув **новый проект** на **файл** меню. **Новый проект** диалоговое окно, внешнего вида, что-нибудь следующим образом:  
  
 ![Диалоговое окно нового проекта](../../extensibility/internals/media/newproject.gif "NewProject")  
  
 Давайте рассмотрим это более подробно. **Типов проектов** дерева перечислены различные типы проектов, можно создать. При выборе типа проекта, например **Visual C# Windows**, вы увидите список шаблонов приложений, чтобы приступить к работе. **Установленные шаблоны Visual Studio** устанавливаются Visual Studio и доступны всем пользователям компьютера. Можно добавить новые шаблоны для создания или сбора **Мои шаблоны** и доступны только для вас.  
  
 При выборе шаблона **приложение Windows**, описание типа приложения появляется в диалоговом окне; в данном случае **проект для создания приложения с пользовательским интерфейсом Windows**.  
  
 В нижней части **новый проект** диалоговое окно, вы увидите несколько элементов управления, для получения дополнительных сведений. Элементы управления, вы видите зависят от типа проекта, но обычно они включают проект **имя** текстовое поле **расположение** текстовое поле и связанных **Обзор** кнопки и **Имя решения** текстовое поле и связанных **создать каталог для решения** флажок.  
  
## <a name="populating-the-new-project-dialog-box"></a>Заполнение диалоговое окно нового проекта  
 Где does **новый проект** диалоговое окно получать его данные? Существует два механизма на работе, один из них рекомендуется к использованию. **Новый проект** объединяет диалоговое окно и отображает информацию, полученную из обоих механизмы.  
  
 Старый метод (не рекомендуется) использует элементы системного реестра и файлы .vsdir. Этот механизм запускается при открытии Visual Studio. Метод новой использует VSTEMPLATE-файлах. Этот механизм работает при инициализации Visual Studio, например, путем запуска  
  
```  
devenv /setup  
```  
  
 или  
  
```  
devenv /installvstemplates  
```  
  
### <a name="project-types"></a>Типы проектов  
 Положение и имена **типов проектов** корневых узлов, таких как **Visual C#** и **другие языки**, определяется системного реестра. Организация дочерних узлов, таких как **базы данных** и **смарт-устройств**, отражает иерархию папок, содержащих соответствующие VSTEMPLATE-файлах. Давайте сначала взглянем на корневые узлы.  
  
#### <a name="project-type-root-nodes"></a>Корневые узлы типа проекта  
 При [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] будет инициализирован, он проходит подразделов раздела реестра системы HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\14.0\NewProjectTemplates\TemplateDirs для построения и назовите корневые узлы **типыпроектов** дерева. Эта информация кэшируется для последующего использования. Посмотрите на TemplateDirs\\{FAE04EC1-301F-11D3-BF4B-00C04F79EFBC} \\ /1 ключ. Каждая запись представляет собой идентификатор GUID пакета VSPackage. Имя подраздела (/ 1) учитывается, но его наличие указывает, что это **типов проектов** корневой узел. Корневой узел, в свою очередь, может иметь несколько подразделов, которые определяют его внешний вид в **типов проектов** дерева. Рассмотрим некоторые из них.  
  
##### <a name="default"></a>(Значение по умолчанию)  
 Это идентификатор ресурса локализованную строку с именем корневого узла. Строковый ресурс находится в вспомогательную библиотеку DLL, выбранного по GUID пакета VSPackage.  
  
 В примере является GUID пакета VSPackage  
  
 {FAE04EC1-301F-11D3-BF4B-00C04F79EFBC}  
  
 и идентификатор ресурса (значение по умолчанию) корневой узел (/ 1) является #2345  
  
 Если найти GUID в соседнем ключ пакетов и проверить подраздел SatelliteDll, можно найти путь сборки, содержащей строкового ресурса:  
  
 \<Путь установки Visual Studio > \VC#\VCSPackages\1033\csprojui.dll  
  
 Чтобы проверить это, откройте проводник и перетащите csprojui.dll в каталоге Visual Studio... Таблица строк показано, что ресурс #2345 заголовок **Visual C#**.  
  
##### <a name="sortpriority"></a>SortPriority  
 Этот параметр определяет положение корневой узел в **типов проектов** дерева.  
  
 REG_DWORD SortPriority 0x00000014 (20)  
  
 Чем меньше число приоритет, чем выше уровень дерева.  
  
##### <a name="developeractivity"></a>DeveloperActivity  
 При наличии этого подраздела положение корневого узла управляется диалоговое окно параметров разработчика. Например:  
  
 REG_SZ DeveloperActivity VC #  
  
 Показывает, что Visual C# корневой узел Если Visual Studio для [!INCLUDE[vcprvc](../../code-quality/includes/vcprvc_md.md)] разработки. В противном случае будет дочерним узлом **другие языки**.  
  
##### <a name="folder"></a>Папка  
 При наличии этого подраздела корневой узел становится дочерним узлом указанной папки. Отображается список папок, можно в разделе  
  
 HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\VisualStudio\11.0\NewProjectTemplates\PseudoFolders  
  
 Например операция Проекты базы данных имеет ключ папки, соответствующей записи в PseudoFolders другие типы проектов. В этом случае в **типов проектов** дерева, **проекты базы данных** будет дочерним узлом **другие типы проектов**.  
  
#### <a name="project-type-child-nodes-and-vstdir-files"></a>Дочерние узлы типа проекта и файлы .vstdir  
 Положение дочерних узлов в **типов проектов** дерева соответствует иерархии папок в папках Шаблоны_проекта. Для шаблонов машин (**установленные шаблоны Visual Studio**), типичное расположение — \Program Files\Microsoft 14.0\Common7\IDE\ProjectTemplates\ Visual Studio и в пользовательских шаблонах (**Мои шаблоны**), типичное расположение — \My Documents\Visual Studio 14.0\Templates\ProjectTemplates\\. Иерархии папок в обоих случаях объединяются для создания **типов проектов** дерева.  
  
 Для Visual Studio с C# параметров разработчика **типов проектов** дерева выглядит примерно так:  
  
 ![Типы проектов](../../extensibility/internals/media/projecttypes.png "ProjectTypes")  
  
 В соответствующую папку Шаблоны_проекта выглядит следующим образом:  
  
 ![Шаблоны проектов](../../extensibility/internals/media/projecttemplates.png "Шаблоны_проекта")  
  
 При **новый проект** откроется диалоговое окно, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] прослеживает Шаблоны_проекта папки и повторно создает ее структуру в **типов проектов** дерева с определенными изменениями:  
  
-   Корневой узел в **типов проектов** дерева определяется шаблон приложения.  
  
-   Имя узла можно локализовать и может содержать специальные символы.  
  
-   Порядок сортировки может быть изменен.  
  
##### <a name="finding-the-root-node-for-a-project-type"></a>Поиск корневого узла для типа проекта  
 Если Visual Studio обходит Шаблоны_проекта папок, он открывает все ZIP-файлы и извлекает все файлы с расширением VSTEMPLATE. VSTEMPLATE-файл XML используется для описания шаблоном приложений. Дополнительные сведения см. в разделе [Создание нового проекта: В механизме, второй части](../../extensibility/internals/new-project-generation-under-the-hood-part-two.md).  
  
 \<ProjectType > тег определяет тип проекта для приложения. Например файл \CSharp\SmartDevice\WindowsCE\1033\WindowsCE-EmptyProject.zip содержит файл EmptyProject.vstemplate с этим тегом:  
  
```  
<ProjectType>CSharp</ProjectType>  
```  
  
 \<ProjectType > тега, а не вложенную папку в папке Шаблоны_проекта определяет корневого узла приложения в **типов проектов** дерева. В примере приложения Windows CE, они будут отображены в **Visual C#** корневой узел, и даже если перемещение WindowsCE папки в папку VisualBasic, чтобы Windows CE приложений по-прежнему будут отображены в  **Visual C#** корневого узла.  
  
##### <a name="localizing-the-node-name"></a>Локализация имя узла  
 Когда Visual Studio обходит Шаблоны_проекта папок, он проверяет все файлы .vstdir найденную. Файл .vstdir является XML-файл, который управляет внешним видом тип проекта в **новый проект** диалоговое окно. В файле .vstdir используйте \<LocalizedName > тег с именем **типов проектов** узла.  
  
 Например файл \CSharp\Database\TemplateIndex.vstdir содержит этот тег:  
  
```  
<LocalizedName Package="{462b036f-7349-4835-9e21-bec60e989b9c}" ID="4598"/>  
```  
  
 Определяет вспомогательные библиотеки DLL и ресурсов идентификатор локализованную строку с именем корневого узла в этом случае **базы данных**. Локализованное имя может содержать специальные символы, которые не доступны в именах папок, таких как **.NET**.  
  
 Если не \<LocalizedName >-тегов, именем типа проекта саму папку **SmartPhone2003**.  
  
##### <a name="finding-the-sort-order-for-a-project-type"></a>Поиск порядок сортировки для типа проекта  
 Для определения порядка сортировки типа проекта, файлы .vstdir используют \<SortOrder > тег.  
  
 Например файл \CSharp\Windows\Windows.vstdir содержит этот тег:  
  
```  
<SortOrder>5</SortOrder>  
```  
  
 Файл \CSharp\Database\TemplateIndex.vstdir содержит тег с большим значением:  
  
```  
<SortOrder>5000</SortOrder>  
```  
  
 Чем меньше число в \<SortOrder > тег, тем выше позицию в дереве, поэтому **Windows** узел расположен выше, чем **базы данных** узел в **типы проектов**  дерева.  
  
 Если не \<SortOrder > тег задан для типа проекта, он отображается в алфавитном порядке следующие все типы проектов, содержащих \<SortOrder > спецификации.  
  
 Обратите внимание, что файлы не .vstdir в папке Мои документы (**Мои шаблоны**) папки. Имена типов проекта пользователь приложения не локализуются и отображаются в алфавитном порядке.  
  
#### <a name="a-quick-review"></a>Краткий обзор  
 Изменим **новый проект** диалоговое окно и создать новый шаблон проекта пользователя.  
  
1.  Добавьте вложенную папку MyProjectNode папки 14.0\Common7\IDE\ProjectTemplates\CSharp \Program Files\Microsoft Visual Studio.  
  
2.  Создайте файл MyProject.vstdir в папке MyProjectNode, используя любой текстовый редактор.  
  
3.  Добавьте следующие строки в файле .vstdir:  
  
    ```  
    <TemplateDir Version="1.0.0">  
        <SortOrder>6</SortOrder>  
    </TemplateDir>  
    ```  
  
4.  Сохраните и закройте файл .vstdir.  
  
5.  Создайте файл MyProject.vstemplate в папке MyProjectNode, используя любой текстовый редактор.  
  
6.  Добавьте следующие строки в VSTEMPLATE-файле:  
  
    ```  
    <VSTemplate Version="2.0.0" Type="Project" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005">  
        <TemplateData>  
            <ProjectType>CSharp</ProjectType>  
        </TemplateData>  
    </VSTemplate>  
    ```  
  
7.  Сохраните файл the.vstemplate и закройте редактор.  
  
8.  Отправьте новые сжатую папку MyProjectNode\MyProject.zip VSTEMPLATE-файл.  
  
9. В командную строку Visual Studio введите следующее:  
  
    ```  
    devenv /installvstemplates  
    ```  
  
 Запустите Visual Studio.  
  
1.  Откройте **новый проект** диалогового окна поле, а затем разверните **Visual C#** узел проекта.  
  
 ![MyProjectNode](../../extensibility/internals/media/myprojectnode.png "MyProjectNode")  
  
 **MyProjectNode** отображается как дочерний узел Visual C# под узла Windows.  
  
## <a name="see-also"></a>См. также  
 [Создание нового проекта. Как это работает, часть 2](../../extensibility/internals/new-project-generation-under-the-hood-part-two.md)