---
title: "Обновление проектов | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Обновление пакетов VSPackages"
  - "обновление приложений, стратегий"
  - "Пакеты VSPackage, поддержка обновления"
ms.assetid: e01cb44a-8105-4cf4-8223-dfae65f8597a
caps.latest.revision: 12
caps.handback.revision: 12
ms.author: "gregvanl"
manager: "ghogen"
---
# Обновление проектов
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Изменения в проект из одной версии модели [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] к следующему маю требовать, чтобы проекты и решения, которые были обновлены, чтобы они могли работать на более новой версии.  [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] предоставляет интерфейсы, которые могут использоваться для реализации поддержки обновлений в собственных проектах.  
  
## Стратегии обновления  
 Чтобы поддерживать обновление, реализация системы проектов должна определить и реализовать стратегию обновления.  Для определения стратегии, можно выбрать для поддержки параллельную резервную копию, копирующую архивацию или оба \(SxS\).  
  
-   Резервная копия SxS означает, что проект копируется только те файлы, которые необходимо обновить на месте, добавляя соответствующий суффикс имени файла, например ".old".  
  
-   Копирующая архивация означает, что проект копирует все элементы проекта к предоставляемое пользователем резервное расположение.  Соответствующие файлы на месте хранения исходных проектов затем обновлены.  
  
## Как работает обновление  
 Если решение, созданного в более ранней версии [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] открывает в новой версии, проверках интегрированной среды разработки файл решения для определения, является ли для этого нужно обновить.  Если необходимо, то обновление **Мастер обновления** автоматически запускает для обхода пользователя через процесс обновления.  
  
 Если решению необходимо обновить, он запросы каждое фабрики проектов для своей стратегии обновления.  Стратегия указывающее, поддерживает ли фабрики проектов копирующую архивацию или резервное копирование SxS.  Сведения отправляются в корпорацию **Мастер обновления**, который собирает сведения, необходимые для резервного копирования и представляет параметры, применимые для пользователя.  
  
### Решения с несколькими проектами  
 Если решение содержит несколько проектов и стратегии обновления отличаются, например, когда проект с\+\+, который поддерживает только резервную копию SxS и веб\-проекты, которые поддерживают только копирующую архивацию фабрики проектов, следует обсудить стратегию обновления.  
  
 Запросы каждое фабрика проекта для решения <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectUpgradeViaFactory>.  Затем он вызывает <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectUpgradeViaFactory.UpgradeProject_CheckOnly%2A> просмотреть, если файлы проекта необходимо обновить, и определить, поддерживаемые стратегии обновления.  **Мастер обновления** затем вызвать.  
  
 После того как пользователь завершает мастера <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectUpgradeViaFactory.UpgradeProject%2A> вызывается для каждого проекта рабочей среде выполнения реальное обновление.  Чтобы упростить резервное копирование, IVsProjectUpgradeViaFactory предоставляют методы <xref:Microsoft.VisualStudio.Shell.Interop.SVsUpgradeLogger> служба, чтобы вести журнал процесса обновления.  Эту службу нельзя кэшировать.  
  
 После обновления все нужные глобальные файлы, каждая фабрика проекта может выбрать создать проект.  Реализация проекта должна поддерживать <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectUpgrade>.  <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectUpgrade.UpgradeProject%2A> затем метод вызывается, чтобы обновить все соответствующие элементы проекта.  
  
> [!NOTE]
>  <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectUpgradeViaFactory.UpgradeProject%2A> метод не предоставляет службу SVsUpgradeLogger.  Эта служба может быть получена путем вызова <xref:Microsoft.VisualStudio.OLE.Interop.IServiceProvider.QueryService%2A>.  
  
## Рекомендации  
 Используйте <xref:Microsoft.VisualStudio.Shell.Interop.SVsQueryEditQuerySave> служба для проверки существования можно изменить файл до изменения его, и может сохранить ее перед сохранением его.  Это поможет вашей резервной копии и обновления реализации обработка файлы проекта в системе управления версиями файлов с недостаточными разрешениями и т д  
  
 Используйте <xref:Microsoft.VisualStudio.Shell.Interop.SVsUpgradeLogger> службы во время резервного копирования и всех действий обновления для предоставления сведений об успешном или неуспешном выполнении процесса обновления.  
  
 Дополнительные сведения о резервном копировании и проектах обновления см. в комментариях IVsProjectUpgrade в vsshell2.idl.  
  
## См. также  
 [Проекты](../../extensibility/internals/projects.md)   
 [Обновление пользовательских проектов](../../misc/upgrading-custom-projects.md)   
 [Обновление элементов проекта](../../misc/upgrading-project-items.md)