---
title: Запрос на изменение запроса сохраните (VSPackage управления источника) | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- QEQS events
- Query Edit Query Save events
- source control packages, Query Edit Query Save events
ms.assetid: c360d2ad-fe42-4d65-899d-d1588cc8a322
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: bf4fd74544e0646a84e4fdc37f35ba84b301f693
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
ms.locfileid: "31131521"
---
# <a name="query-edit-query-save-source-control-vspackage"></a>Изменение запроса запроса сохраните (VSPackage управления источника)
[!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] редакторы выполнить рассылку события запроса изменить запрос сохранить (QEQS). [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Заглушки управления источника реализует службу QEQS, чтобы получатель событий QEQS. Затем эти события делегируются VSPackage активного систему управления версиями. Активные систему управления версиями, VSPackage реализует <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2> и его методы. Методы `IVsQueryEditQuerySave2` интерфейса обычно называется непосредственно перед редактировании документа в первый раз, и непосредственно после сохранения документа.  
  
## <a name="queryeditquerysave-events"></a>QueryEditQuerySave событий  
 Система управления версиями VSPackage должен обрабатывать события, QEQS путем реализации `IVsQueryEditQuerySave2` интерфейс и необходимые методы. Ниже приводится краткое описание, VSPackage должен реализовывать по крайней мере двух методов. Действительная реализация должно быть в соответствии с логикой модель управления версиями.  
  
### <a name="queryeditfiles-method"></a>Метод QueryEditFiles  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QueryEditFiles%2A> Вызывается, когда любой проект или редактор хочет изменить файл. В идеальном случае этот метод вызывается *перед* изменения файла и при сохранении файла. При вызове `IVsQueryEditQuerySave2::QueryEditFiles` метод проверяет, являются ли заданного файлов в системе управления версиями, того, требуется ли для извлечения и ли они можно загрузить в память. Если обстоятельствах препятствует файлы редактируемыми, `IVsQueryEditQuerySave2::QueryEditFiles` метод сообщает вызывающей программе для отмены редактирования. Можно также укажите режим вызова вызывающим объектом. В режиме «молчания» этот метод принимает действия только в том случае, если это не вызовет для отображения пользовательского интерфейса. Если неизбежна пользовательского интерфейса, флаг должен быть возвращен указывают на неполадку.  
  
 Поведение метода в режиме транзакций; то есть при отмене изменения в одном файле редактирование отменяется для всех файлов. И наоборот Если изменения допускаются, допускается для всех файлов. Если этот метод позволяет редактирования один раз для заданного набора файлов, она должна всегда разрешать изменение при последующих вызовах для того же набора файлов. Разрешить изменение цикл продолжается, пока не закрыт, сохранен и перезагружен; файлы до изменения их атрибутов (свойства); или пока не будут изменены исходного пакета управления. Варианты, которые следует учитывать при реализации `IVsQueryEditQuerySave2::QueryEditFiles` метод включают несколько файлов, файлов со специальным, отмените от пользователя и изменения в памяти.  
  
### <a name="querysavefiles-method"></a>Метод QuerySaveFiles  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2.QuerySaveFiles%2A> Вызывается, когда любой проект или редактора необходимо для сохранения набора файлов. При вызове `IVsQueryEditQuerySave2::QuerySaveFiles` метод проверяет, заданного файлы доступны только для чтения и являются ли они в системе управления версиями. Если файлы нужно извлечь, вызов делегируется исходного пакета управления. Если обстоятельствах файлы не будут сохранены, `IVsQueryEditQuerySave2::QuerySaveFiles` метод необходимо сообщить редактору, чтобы отменить сохранение. Как и в `IVsQueryEditQuerySave2::QueryEditFiles` метод, возможна укажите режим вызова вызывающим объектом. В режиме «молчания» этот метод принимает действия только в том случае, если это не вызовет для отображения пользовательского интерфейса. Если неизбежна пользовательского интерфейса, флаг должен быть возвращен указывают на неполадку.  
  
 Этот метод должен работать в режиме транзакций; то есть при отмене сохранения в одном файле сохранения отменяется для всех файлов. И наоборот Если может сохранить, его необходимо разрешен для всех файлов. Как и в `IVsQueryEditQuerySave2::QueryEditFiles` метод, варианты, которые следует учитывать при реализации `IVsQueryEditQuerySave2::QuerySaveFiles` метод включают несколько файлов, файлов со специальным, отмените от пользователя и изменения в памяти.  
  
## <a name="see-also"></a>См. также  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsQueryEditQuerySave2>