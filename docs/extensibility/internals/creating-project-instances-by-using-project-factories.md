---
title: "Создание экземпляров проекта с помощью фабрик проекта | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "фабрики проекта"
  - "проекты [Visual Studio SDK] фабрики проекта"
ms.assetid: 94c90012-8669-459c-af8e-307ac242c8c4
caps.latest.revision: 13
caps.handback.revision: 13
ms.author: "gregvanl"
manager: "ghogen"
---
# Создание экземпляров проекта с помощью фабрик проекта
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Типы проектов в рамках [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] используйте a фабрика проекта создать экземпляры объектов проекта.  Фабрика проекта аналогично стандартной фабрике класса для cocreatable COM\-объект.  Однако объекты проекта не cocreatable: они могут быть только созданы с помощью фабрики проектов.  
  
 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Интегрированная среда разработки вызывает фабрики проектов реализовано в VSPackage, когда пользователь загружает существующий проект или создайте новый проект in  [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  Новый объект проекта предоставляет интегрированную среду разработки с достаточным сведения для заполнения обозревателя решений.  Новый объект проекта также предоставляет необходимые интерфейсы для поддержки все соответствующие действия пользовательского интерфейса, инициированные интегрированной средой разработки.  
  
 Можно реализовать <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory> интерфейс класса в проекте.  Обычно он находится в собственном модуле.  
  
 Пример реализации `IVsProjectFactory` интерфейс см. в разделе PrjFac.cpp, которое содержится в  [Простого проекта](http://msdn.microsoft.com/ru-ru/385fd2a3-d9f1-4808-87c2-a3f05a91fc36) каталог образцов.  
  
 Проекты, которые поддерживают быть владельцем статистической обработке должны сохранять ключ владельца в файле проекта.  После <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory.CreateProject%2A> метод вызывается в проекте с ключом " владелец ", владелец которого проекта преобразует его ключ владельца на идентификатор GUID фабрики проектов затем вызывает  `CreateProject` метод в данном среде проекта, чтобы сделать фактическое создание.  
  
## Создание владелец которого проект  
 Владелец владелец которого создается проект в 2 действия.  
  
1.  Посредством вызова метода <xref:Microsoft.VisualStudio.Shell.Interop.IVsOwnedProjectFactory.PreCreateForOwner%2A>.  Это дает возможность создать проект имеемому статистическая обработка вычислениеый объект проекта, основанный на элементе управления вводом `IUnknown`.  Владелец которого проект передает внутреннюю `IUnknown` и статистическая обработка вычислениеый объект обратно в проект владелец.  Это дает возможность хранения внутреннего имеемому проект `IUnknown`.  
  
2.  Посредством вызова метода <xref:Microsoft.VisualStudio.Shell.Interop.IVsOwnedProjectFactory.InitializeForOwner%2A>.  Владелец которого проект делает все его создания экземпляра при вызове этого метода, а не вызывать `IVsProjectFactory::CreateProject` как проектами за, которые не принадлежат аргументы.  Входные данные `VSOWNEDPROJECTOBJECT` перечисление обычно статистически вычислениеый владелец которого проект.  Владелец которого проект может использовать эту переменную, чтобы определить, был ли создан его объект проекта уже \(файл cookie не равен NULL\) или \(NULL должен быть создан equals " cookie "\).  
  
 Типы проектов определяются уникальный идентификатор GUID проекта, аналогичный код CLSID cocreatable COM\-объект.  Как правило, одна фабрика проекта обрабатывает создание экземпляров одного типа проекта, хотя можно иметь один дескриптор фабрики проектов несколько GUID типа проекта.  
  
 Типы проектов, связанные с определенным расширением имени файла.  Если пользователь пытается открыть существующий файл проекта или пытается создать новый проект путем клонирования шаблон, интегрированная среда разработки использует расширение файла для определения соответствующего идентификатора GUID проекта.  
  
 Как только интегрированная среда разработки определяет, является ли она должна создание нового проекта или открытия существующего проекта определенного типа, интегрированная среда разработки использует сведения в системном реестре вниз \[HKEY\_LOCAL\_MACHINE \\ software \\ microsoft \\ VisualStudio \\ 8,0 \\ projects\], чтобы найти, VSPackage реализует необходимые фабрики проектов.  Загружает это интегрированная среда разработки VSPackage.  в <xref:Microsoft.VisualStudio.Shell.Interop.IVsRegisterProjectTypes.RegisterProjectType%2A> метод VSPackage должен зарегистрировать его фабрики проектов с интегрированной средой разработки с помощью вызова  <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage.SetSite%2A> метод.  
  
 Основной метод <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory.CreateProject%2A> интерфейс  `IVsProjectFactory` что следует обрабатывать 2 сценария: открытие существующего проекта и создание нового проекта.  Большинство проектов хранят свое состояние проекта в файле проекта.  Как правило, создаются новые проекты, выполнив копию файла шаблона, переданного `CreateProject` метод и затем открывать копию.  Существующие проекты создаются непосредственно открывать файл проекта, передаваемый `CreateProject` метод.  `CreateProject` метод может отобразить дополнительные функции пользовательского интерфейса для пользователя по мере необходимости.  
  
 Проект может также не использовать никаких файлов, а вместо этого для хранения состояния проекта в механизме хранения, отличной от файловой системы, например базы данных или веб\-сервере.  В этом случае параметр имени файла, передаваемый `CreateProject` метод путь файловой системы, но фактически не является уникальным URL\-адрес\-к строка\- указывает данные проекта.  Нет необходимости копировать файлы шаблона, передайте значение `CreateProject` активировать соответствующую последовательность конструкции для выполнения.  
  
## См. также  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsOwnedProjectFactory>   
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory>   
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsRegisterProjectTypes>   
 [Контрольный список: Создание новых типов проектов](../../extensibility/internals/checklist-creating-new-project-types.md)