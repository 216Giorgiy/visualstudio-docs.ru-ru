---
title: Создание экземпляров проекта с помощью фабрик проекта | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- project factories
- projects [Visual Studio SDK], project factories
ms.assetid: 94c90012-8669-459c-af8e-307ac242c8c4
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: b3a59eee6701caf0b4d3b56df273b280f8bf6ece
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="creating-project-instances-by-using-project-factories"></a>Создание экземпляров проекта с помощью фабрик проекта
Типы проектов в [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] использовать *фабрики проектов* создавать экземпляры объектов проекта. Стандартный класс фабрики для COM-объектов, создаваемых посредством функции CoCreateInstance аналогично фабрики проектов. Однако объекты проекта не создаваемых посредством функции CoCreateInstance: они могут создаваться только с помощью фабрики проектов.  
  
 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] IDE вызывает фабрики проектов, которые реализованы в пакете VSPackage, когда пользователь загружает существующий проект или создает новый проект в [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Новый объект проекта, который предоставляет интегрированную среду разработки достаточно сведений для заполнения в обозревателе решений. Новый объект проекта также обеспечивает необходимые интерфейсы для поддержки всех соответствующих действий пользовательского интерфейса, инициированных интегрированной среды разработки.  
  
 Можно реализовать <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory> интерфейса класса в проекте. Как правило он располагается в свой собственный модуль.  
  
 Пример реализации `IVsProjectFactory` интерфейса см. в разделе PrjFac.cpp, содержащийся в [базового проекта](http://msdn.microsoft.com/en-us/385fd2a3-d9f1-4808-87c2-a3f05a91fc36) каталог образцов.  
  
 Проекты, которые поддерживают статистически владельцем необходимо сохранить ключ владельца в их файл проекта. Когда <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory.CreateProject%2A> метод будет вызван на проект с помощью ключа владельца, принадлежащие проекта преобразуют ее владелец ключа фабрики проектов, GUID, а затем вызывает `CreateProject` метод для этой фабрики проектов сделать фактическое создание.  
  
## <a name="creating-an-owned-project"></a>Создание собственных проекта  
 Владелец создает собственный проект состоит из двух этапов:  
  
1.  Путем вызова <xref:Microsoft.VisualStudio.Shell.Interop.IVsOwnedProjectFactory.PreCreateForOwner%2A> метод. Это дает возможность создать статистические проект объекта на основании входных управление принадлежащие проекта `IUnknown`. Собственный проект передает внутренний `IUnknown` и сводный объект обратно в проект владельца. Это дает возможность хранения внутреннего принадлежащие проекта `IUnknown`.  
  
2.  Путем вызова <xref:Microsoft.VisualStudio.Shell.Interop.IVsOwnedProjectFactory.InitializeForOwner%2A> метод. Собственный проект делает его создание экземпляра, когда данный метод вызывается вместо вызова метода `IVsProjectFactory::CreateProject` как в случае для проектов, которые не принадлежат. Входные данные `VSOWNEDPROJECTOBJECT` перечисления обычно является статистическим владельца проекта. Собственный проект можно использовать эту переменную для определения его объект проекта уже была ли создана (файл cookie не равно NULL) или должен быть создан (файл cookie равно NULL).  
  
 Типы проектов идентифицируются уникальный идентификатор GUID, аналогично CLSID объекта COM создаваемых посредством функции CoCreateInstance проектов. Как правило дескрипторы фабрики один проект, создание экземпляров один тип проектов, несмотря на то, что можно иметь один фабрики проектов обрабатывать более одного проекта типа GUID.  
  
 Типы проектов связаны с расширением определенного файла. Когда пользователь пытается открыть существующий файл проекта или пытается создать новый проект путем клонирования шаблона, интегрированной среды разработки использует расширение файла для определения соответствующего GUID проекта.  
  
 Как только интегрированной среды разработки определяет, использует ли он должен создать новый проект или открыть существующий проект определенного типа, интегрированной среды разработки сведения в системном реестре в разделе [HKEY_LOCAL_MACHINE\Software\Microsoft\VisualStudio\8.0\Projects] чтобы узнать, какие VSPackage реализует фабрики необходимые проектов. IDE загружает этот пакет VSPackage. В <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage.SetSite%2A> метод VSPackage необходимо зарегистрировать его фабрики проектов в Интегрированной среде разработки путем вызова <xref:Microsoft.VisualStudio.Shell.Interop.IVsRegisterProjectTypes.RegisterProjectType%2A> метод.  
  
 Основной способ `IVsProjectFactory` интерфейс <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory.CreateProject%2A> которого должен обрабатывать два сценария: открытие существующего проекта и создание нового проекта. Большинство проектов сохранять свое состояние проекта в файле проекта. Как правило, новые проекты создаются путем внесения копию файла шаблона, передаваемый `CreateProject` метод и открытия этой копии. Существующие проекты создаются путем напрямую, открыв файл проекта, передаваемый `CreateProject` метод. `CreateProject` Метод может отображать дополнительные возможности пользовательского интерфейса для пользователя при необходимости.  
  
 Проект можно также использовать файлы и, вместо этого храните состояние проекта в механизм хранения, отличные от файловой системы, например базы данных или веб-сервера. В этом случае параметр имени файла, передаваемый `CreateProject` метод не является фактически путь в файловой системе, но уникальная строка — URL-адрес, для определения данных проекта. Необходимо скопировать файлы шаблонов, которые передаются `CreateProject` для запуска последовательности соответствующих конструкторов для выполнения.  
  
## <a name="see-also"></a>См. также  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsOwnedProjectFactory>   
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsProjectFactory>   
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsRegisterProjectTypes>   
 [Контрольный список. Создание типов проектов](../../extensibility/internals/checklist-creating-new-project-types.md)