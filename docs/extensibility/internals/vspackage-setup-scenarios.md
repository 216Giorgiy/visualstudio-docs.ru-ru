---
title: "Сценарии установки VSPackage | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Пакеты VSPackage, рекомендации по развертыванию"
ms.assetid: d2928498-f27c-46b4-a9cd-cba41fd85a10
caps.latest.revision: 21
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 21
---
# Сценарии установки VSPackage
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Очень важно для разработки VSPackage установщик для гибкости. Например может понадобиться в будущем выпуске исправления безопасности, или можно изменить бизнес\-стратегии, который требует тщательного управления версиями side\-by\-side поддержки.  
  
 В [Поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md), можно прочитать о преимуществах и проблемы поддержки установки side\-by\-side [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] общего доступа или side\-by\-side установок VSPackage. Короче говоря, side\-by\-side VSPackages предоставляют наибольшую гибкость для поддержки новых возможностей [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
 Сценарии, рассмотренные в этом разделе не только, но они должны быть представлены как рекомендации.  
  
## Компоненты, конфиденциальности и совместное использование  
  
##### Создание независимых компонентов  
 После идентификации и заполнить компонент назначения `GUID`, и развернуть компонент, нельзя изменить композицию. При изменении компонента композиции, полученный компонент должен быть новый компонент с новым `GUID`. Учитывая эти факты, наибольшую гибкость управления версиями обеспечиваемая делая каждую единицу независимо, самостоятельных компонента. Дополнительные сведения о правила, определяющие компоненты см [Изменение кода компонента](http://msdn.microsoft.com/library/aa367849\(VS.85\).aspx) и [что произойдет, если компонент правила разбиваются?](http://msdn.microsoft.com/library/aa372795\(VS.85\).aspx).  
  
##### Не следует смешивать общие и закрытые ресурсы в компоненте  
 Подсчет ссылок происходит на уровне компонента. Следовательно смешение общие и закрытые ресурсы в одном компоненте делает невозможным обновление закрытый ресурсы, такие как исполняемый файл без перезаписи общих ресурсов также. Этот сценарий создает проблемы обратной совместимости и запрещает создание side\-by\-side возможностей.  
  
 Например, значения реестра используется для регистрации VSPackage с [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] должны храниться в компоненте отдельно от той, которая используется для регистрации VSPackage с [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Общие файлы или значения реестра, перейдите в еще один компонент.  
  
## Сценарий 1: Общие VSPackage  
 В этом случае общие VSPackage \(единый двоичный файл, который поддерживает несколько версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]\) поставляется в пакет установщика Windows. Регистрация с каждой версией [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] управляется выбираемых пользователем функции. Это также означает, что при назначении для разделения функций каждого компонента могут быть выбраны для установки или удаления, создания пользователя в элементе управления интеграции VSPackage в разных версиях [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. \(См. [компоненты установщика Windows](http://msdn.microsoft.com/library/aa372840\(VS.85\).aspx) Дополнительные сведения об использовании функций в пакеты установщика Windows.\)  
  
 ![График VS Shared VSPackage](~/extensibility/internals/media/vs_sharedpackage.gif "VS\_SharedPackage")  
Общий установочный пакет VSPackage  
  
 Как показано на рисунке, общие компоненты становятся частью функцию Feat\_Common, которая всегда устанавливается. Благодаря функции Feat\_VS2002 и Feat\_VS2003 видимым, пользователи могут выбирать во время установки в какой версии [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] хочет интегрировать VSPackage. Пользователи также могут использовать режим обслуживания установщика Windows, чтобы добавить или удалить компоненты, который в данном случае добавляет или удаляет сведения о регистрации VSPackage из разных версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
> [!NOTE]
>  Установка компонентов отображаемый столбец 0 скрывает его. Значение столбца низкого уровня, например 1, гарантирует, что он будет всегда установлен. Дополнительные сведения см. в разделе [свойство INSTALLLEVEL](http://msdn.microsoft.com/library/aa369536\(VS.85\).aspx) и [таблицы компонентов](http://msdn.microsoft.com/library/aa368585.aspx).  
  
## Сценарий 2: Обновление общих VSPackage  
 В этом случае поставляется обновленную версию установщика VSPackage в сценарии 1. Для примера, обновление добавляет поддержку [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)], но также может быть проще безопасности обновления или исправления ошибки пакетом. Установщик Windows для установки новых компонентов правилах компоненты без изменений в системе не копируются. В этом случае система с версии 1.0 уже присутствует перезапишет обновляемых компонентов Comp\_MyVSPackage.dll и пользователи могут выбирать для добавления новой функции Feat\_VS2005 с его Comp\_VS2005\_Reg компонента.  
  
> [!CAUTION]
>  Каждый раз, когда VSPackage является общим для нескольких версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)], очень важно, что последующих выпусках VSPackage обратной совместимости с предыдущими версиями платформы [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Там, где не может поддерживать обратную совместимость, необходимо использовать VSPackages side\-by\-side, закрытым. Для получения дополнительной информации см. [Поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md).  
  
 ![Изображение обновление пакета VS Shared VS](~/extensibility/internals/media/vs_sharedpackageupdate.gif "VS\_SharedPackageUpdate")  
Общие обновления установщик VSPackage  
  
 Этот сценарий представлен новый установщик VSPackage, преимуществами поддержки небольшие обновления установщика Windows. Просто установить версию 1.1 и его обновлении версии 1.0. Однако не обязательно иметь версии 1.0 в системе. Та же программа установит версии 1.1 в системе без версии 1.0. Преимущество для предоставления незначительного обновления таким образом является, что нет необходимости проходить через работу по разработке обновления установщик и установщик полного продукта. Установщик выполняет оба задания. Исправление безопасности или пакета обновления может вместо этого воспользоваться преимуществами исправлений установщика Windows. Дополнительные сведения см. в разделе [обновления и исправления](http://msdn.microsoft.com/library/aa370579\(VS.85\).aspx).  
  
## Сценарий 3: Side\-by\-Side VSPackage  
 Этот сценарий знакомит два установщика VSPackage — один для каждой версии Visual Studio .NET 2003 и [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Каждый установщик устанавливает side\-by\-side или частный VSPackage \(специально созданных и установлены для конкретной версии [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]\). Каждый VSPackage имеет свой собственный компонент. Следовательно, каждый по отдельности обслуживаются исправления или обслуживания освобождает. Поскольку VSPackage DLL, теперь зависит от версии, допускается включать регистрационные сведения в один и тот же компонент как библиотеку DLL.  
  
 ![График пакета VS Side&#45;by&#45;Side VS](~/extensibility/internals/media/vs_sbys_package.gif "VS\_SbyS\_Package")  
Установщик Side\-by\-side VSPackage  
  
 Каждый установщик также включает код, который совместно используется двумя установщиками. Если совместно используемого кода устанавливается в общем расположении, оба MSI\-файлы установки установит общего кода только один раз. Второй установщика просто увеличивает значение счетчика ссылок на компонент. Счетчик ссылок гарантирует, что если один из пакетов VSPackages удаляется, общий код будет храниться другие VSPackage. Если второй VSPackage удаляется также, общего кода будет удален.  
  
## Сценарий 4: Обновление VSPackage Side\-by\-Side  
 В этом случае VSPackage для [!INCLUDE[vsprvslong](../../code-quality/includes/vsprvslong_md.md)] обнаружил из безопасности уязвимость, если необходимо выполнить обновление. Как и в сценарии 2 можно создать новый MSI\-файл, который обновляет существующую установку включает исправление безопасности, а также развертывание новых установок с исправлением безопасности уже на месте.  
  
 В этом случае VSPackage является управляемых VSPackage установлены в глобальный кэш сборок \(GAC\). При перестроении в него исправления безопасности, необходимо изменить номер редакции часть номера версии сборки. Сведения о регистрации для нового номера версии сборки заменяет предыдущую версию, вызывает [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] для загрузки сборки, основного.  
  
 ![График обновления пакета VS Side&#45;by&#45;Side VS](~/extensibility/internals/media/vs_sbys_packageupdate.gif "VS\_SbyS\_PackageUpdate")  
Установщик обновлений Side\-by\-side VSPackage  
  
 **Примечание** Дополнительные сведения о развертывании сборок side\-by\-side в разделе [Упрощение развертывания и устранения DLL Hell с платформой .NET Framework](http://msdn.microsoft.com/library/ms973843.aspx).  
  
## См. также  
 [установщик Windows](http://msdn.microsoft.com/library/cc185688\(VS.85\).aspx)   
 [Поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md)