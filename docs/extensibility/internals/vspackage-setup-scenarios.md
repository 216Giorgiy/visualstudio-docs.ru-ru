---
title: "Сценарии установки VSPackage | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- VSPackages, deployment considerations
ms.assetid: d2928498-f27c-46b4-a9cd-cba41fd85a10
caps.latest.revision: 
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.workload:
- vssdk
ms.openlocfilehash: dea9d25f211ca5042234c0400b2a10086136f49c
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="vspackage-setup-scenarios"></a>Сценарии установки пакета VSPackage
Очень важно разработать VSPackage установщик для обеспечения гибкости. Например может понадобиться в будущем выпуске исправления безопасности или может измениться бизнес-стратегии, который требует поддержки тщательную-параллельное управление версиями.  
  
 В [поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md), вы найдете сведения о преимуществах и проблемы поддержки установок side-by-side [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] совместно используемой или side-by-side установок VSPackage. Иными словами, пакеты VSPackage side-by-side предоставляют наибольшую гибкость для поддержки новых возможностей [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
 Сценарии, рассмотренные в этом разделе не только выбранных параметров, но они должны быть представлены как предлагаемые рекомендации.  
  
## <a name="components-privacy-and-sharing"></a>Компоненты, конфиденциальности и совместное использование  
  
##### <a name="make-your-components-independent"></a>Создание независимых компонентов  
 После идентификации и заполнить компонент назначения `GUID`и развертывания компонента, нельзя изменить его композицию. При изменении компонента композиции, полученный компонент должен быть новый компонент с новым `GUID`. Учитывая эти факты, является предоставленные наибольшую гибкость управления версиями, делая каждой единицы независимые, самостоятельных компонента. Дополнительные сведения о правила, определяющие компонентов см. в разделе [изменения кода компонента](http://msdn.microsoft.com/library/aa367849\(VS.85\).aspx) и [что произойдет, если компонент правила разбиваются?](http://msdn.microsoft.com/library/aa372795\(VS.85\).aspx).  
  
##### <a name="do-not-mix-shared-and-private-resources-in-a-component"></a>Не следует смешивать общие и закрытые ресурсы в компоненте  
 Подсчет ссылок происходит на уровне компонента. Таким образом смешивание общие и закрытые ресурсы в одном компоненте не позволяет обновить закрытый ресурсы, такие как исполняемого файла, без также перезаписи общих ресурсов. Этот сценарий создает проблемах обратной совместимости и запрещает создание side-by-side возможностей.  
  
 Например, параметры реестра, используемый для регистрации VSPackage с [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] должен храниться в компоненте отдельно от одного, используемый для регистрации VSPackage с [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Общие файлы или значения реестра, перейдите в еще один компонент.  
  
## <a name="scenario-1-shared-vspackage"></a>Сценарий 1: Общие VSPackage  
 В этом сценарии общие VSPackage (единый двоичный файл, который поддерживает несколько версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]) поставляется в пакет установщика Windows. Регистрация с каждой версией [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] управляется выбираемых пользователем функции. Это также означает, что при назначении для разделения компонентов каждого компонента могут быть выбраны для установки или удаления, дать пользователю контроль над интеграции VSPackage в разные версии [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. (См. [компоненты установщика Windows](http://msdn.microsoft.com/library/aa372840\(VS.85\).aspx) Дополнительные сведения об использовании функций в пакеты установщика Windows.)  
  
 ![График VS Shared VSPackage](../../extensibility/internals/media/vs_sharedpackage.gif "VS_SharedPackage")  
Общий установочный пакет VSPackage  
  
 Как показано на рисунке, общие компоненты становятся частью функцию Feat_Common, которая всегда устанавливается. По возможности Feat_VS2002 и Feat_VS2003 сделана видимой, пользователи могут выбирать во время установки в какой версии [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] хочет VSPackage для интеграции. Пользователи также могут использовать режим обслуживания установщика Windows для добавления или удаления компонентов, что в этом случае добавляет или удаляет сведения о регистрации VSPackage из разных версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
> [!NOTE]
>  Установка отображаемого столбца какой-либо функции 0 скрывает. Значение столбца низкого уровня, например 1, гарантирует, что он будет всегда установлен. Дополнительные сведения см. в разделе [свойство INSTALLLEVEL](http://msdn.microsoft.com/library/aa369536\(VS.85\).aspx) и [таблицы компонентов](http://msdn.microsoft.com/library/aa368585.aspx).  
  
## <a name="scenario-2-shared-vspackage-update"></a>Сценарий 2: Общие обновления пакета VSPackage  
 В этом сценарии поставляется обновленную версию установщика VSPackage в сценарии 1. Для примера, обновление добавляет поддержку для [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)], но также могут быть более простой безопасности обновления или исправления ошибки пакета обновления. Правила установщика Windows для установки новых компонентов требуются компоненты без изменения уже в системе не копируются. В этом случае перезапишет обновляемых компонентов Comp_MyVSPackage.dll и позволяют пользователям выбрать и добавить новый компонент Feat_VS2005 с его компоненте Comp_VS2005_Reg систему версии 1.0 уже присутствует.  
  
> [!CAUTION]
>  Каждый раз, когда пакет VSPackage является общим для нескольких версий [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)], очень важно, что последующих выпусков VSPackage обратной совместимости с предыдущими версиями платформы [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Там, где не может обеспечить обратную совместимость, необходимо использовать пакеты VSPackage side-by-side, private. Дополнительные сведения см. в разделе [поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md).  
  
 ![VS Shared изображение обновление пакета VS](../../extensibility/internals/media/vs_sharedpackageupdate.gif "VS_SharedPackageUpdate")  
Общий установщик обновлений VSPackage  
  
 Этот сценарий представлен новый установщик VSPackage, использование преимуществ поддержки незначительные обновления установщика Windows. Пользователи просто установить версии 1.1, а его обновлении версии 1.0. Однако не обязательно иметь версии 1.0 в системе. Та же программа установит версии 1.1 на систему без версии 1.0. Преимущество для предоставления вспомогательных обновления таким образом является, нет необходимости выполнить работу по разработке обновления установщик и установщик продукта full. Один установщик выполняет оба задания. Исправление безопасности или пакетом обновления могут вместо этого воспользуйтесь преимуществами исправлений установщика Windows. Дополнительные сведения см. в разделе [обновления и исправления](http://msdn.microsoft.com/library/aa370579\(VS.85\).aspx).  
  
## <a name="scenario-3-side-by-side-vspackage"></a>Сценарий 3: Side-by-Side VSPackage  
 Этот сценарий предоставляет два установщика VSPackage — один для каждой версии Visual Studio .NET 2003 и [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Каждый установщик устанавливает side-by-side или private, пакет VSPackage (один, в частности создаваемый и установлены для конкретной версии [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]). Каждого пакета VSPackage имеет свой собственный компонент. Следовательно, каждый отдельно обслуживаются обновления или обслуживания освобождает. Так как библиотеки DLL VSPackage теперь зависит от версии, можно безопасно для включения регистрационные сведения в том же компоненте как библиотеку DLL.  
  
 ![Сторона VS-45; &#45; График пакета VS стороне](../../extensibility/internals/media/vs_sbys_package.gif "VS_SbyS_Package")  
Установщик пакета VSPackage Side-by-side  
  
 Каждого установщика также содержит код, который совместно используется двумя установщиками. Если общий код установлен в общую папку, оба MSI-файлы установки установит общий код только один раз. Второй установщика просто увеличивает счетчик ссылок в компоненте. Счетчик ссылок гарантирует, что один из пакетов VSPackage в случае удаления общего кода будет останутся для других пакетов VSPackage. В случае удаления также второй VSPackage общий код будет удален.  
  
## <a name="scenario-4-side-by-side-vspackage-update"></a>Сценарий 4: Обновление пакета VSPackage Side-by-Side  
 В этом сценарии VSPackage для [!INCLUDE[vsprvslong](../../code-quality/includes/vsprvslong_md.md)] обнаружил из безопасности уязвимость, если необходимо обновление. Как и в сценарии 2 можно создать новый файл MSI-файл, который обновляет существующую установку включает исправление безопасности, а также развертывание новых установок с исправлением безопасности уже на месте.  
  
 В этом случае пакет VSPackage является управляемый пакет VSPackage, установлены в глобальный кэш сборок (GAC). При повторном построении он включает исправление безопасности, необходимо изменить номер редакции часть номера версии сборки. Сведения о регистрации для новый номер версии сборки заменяет предыдущую версию, в результате чего [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] для загрузки основных сборки.  
  
 ![Сторона VS-45; &#45; График обновления пакета VS стороне](../../extensibility/internals/media/vs_sbys_packageupdate.gif "VS_SbyS_PackageUpdate")  
Установщик обновлений Side-by-side VSPackage  
  
 **Примечание** Дополнительные сведения о развертывании сборок side-by-side см. в разделе [Упрощение развертывания и решению DLL Hell с платформой .NET Framework](http://msdn.microsoft.com/library/ms973843.aspx).  
  
## <a name="see-also"></a>См. также  
 [Установщик Windows](http://msdn.microsoft.com/library/cc185688\(VS.85\).aspx)   
 [Поддержка нескольких версий Visual Studio](../../extensibility/supporting-multiple-versions-of-visual-studio.md)