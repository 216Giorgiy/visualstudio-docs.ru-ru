---
title: Команды конструктора | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- commands
- commands, implementation
ms.assetid: 097108c3-f758-4b87-89d6-b32d12d9041a
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: 43b83e5a02fb84ad09531f87b3120168bad0b2e0
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="command-design"></a>Команды конструктора
При добавлении команды VSPackage, необходимо указать которых может отображаться, когда он доступен и каким образом будет обрабатываться.  
  
## <a name="defining-commands"></a>Определение команды  
 Чтобы определить новые команды, следует включите файл таблицы команд Visual Studio (.vsct) в проекте VSPackage. При создании пакетов VSPackage с помощью шаблона пакета Visual Studio, проект содержит один из этих файлов. Дополнительные сведения см. в разделе [Visual Studio Command Table (. Файлы Vsct)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md).  
  
 Visual Studio выполняет слияние всех vsct-файлами, найденного, чтобы он мог отображать команды. Поскольку эти файлы отличаются от двоичных VSPackage, Visual Studio не имеет загрузить пакет, чтобы найти команды. Дополнительные сведения см. в разделе [как пакеты VSPackage добавить элементы пользовательского интерфейса](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
 Visual Studio использует <xref:Microsoft.VisualStudio.Shell.ProvideMenuResourceAttribute> атрибута регистрации для определения ресурсов меню и команд. Дополнительные сведения см. в разделе [реализации](../../extensibility/internals/command-implementation.md).  
  
 Команды можно изменить во время выполнения несколькими различными способами. Они могут отображаться или скрыты, включить или отключить. Они выводятся различные текст или значки или содержать разные значения. Большую индивидуальной настройки может быть выполнена до Visual Studio загружает VSPackage. Дополнительные сведения см. в разделе [как пакеты VSPackage добавить элементы пользовательского интерфейса](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
## <a name="command-handlers"></a>Обработчики команд  
 При создании команды необходимо указать обработчик событий для выполнения команды. Если пользователь выбирает команду, оно будет направлено соответствующим образом. Маршрутизация команды означает отправки его в правильный пакет VSPackage, чтобы включить или отключить его, скрыть или отобразить ее и выполните его, если пользователь выбирает для этого. Дополнительные сведения см. в разделе [маршрутизации алгоритм](../../extensibility/internals/command-routing-algorithm.md).  
  
## <a name="the-visual-studio-command-environment"></a>Команда среды Visual Studio  
 Visual Studio может содержать любое количество пакетов VSPackage, и каждый может передать свой собственный набор команд. Среду отображает только команды, которые подходят для текущей задачи. Дополнительные сведения см. в разделе [доступности](../../extensibility/internals/command-availability.md) и [объекты контекста выбора](../../extensibility/internals/selection-context-objects.md).  
  
 Пакет VSPackage, который определяет новые команды, меню, панелей инструментов и контекстных меню сведения его команды в Visual Studio во время установки с помощью записи реестра, которые ссылаются на ресурсы в сборках с машинным или управляемым. Каждый ресурс затем ссылается на файл ресурсов (.cto) двоичные данные, которые получаются при компиляции файла таблицы команд Visual Studio (.vsct). Это позволяет системе Visual Studio для предоставления наборы объединенных команд, меню и панели инструментов без необходимости загружать каждого установленного пакета VSPackage.  
  
### <a name="command-organization"></a>Команда организации  
 Среде помещает команды, группы, приоритет и меню.  
  
-   Группы — это логические наборы связанных команд, например, **Вырезать**, **копирования**, и **вставить** группы команд. Группы — это набор команд, отображаемых в меню.  
  
-   Приоритет определяет порядок отображения отдельных команд в группе меню.  
  
-   Меню действуют как контейнеры для группы.  
  
 Среде есть стандартных некоторые команды, группы и меню. Дополнительные сведения см. в разделе [команды по умолчанию, группы и инструментов размещения](../../extensibility/internals/default-command-group-and-toolbar-placement.md).  
  
 Команды могут назначаться основную группу. Основная группа определяет позицию команды в структуре главного меню и в **Настройка** диалоговое окно. Команда может встречаться в несколько групп; Например команда может быть в главном меню, контекстное меню и панели инструментов. Дополнительные сведения см. в разделе [как пакеты VSPackage добавить элементы пользовательского интерфейса](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
### <a name="command-routing"></a>маршрутизация команд  
 Процесс маршрутизации команд для пакетов VSPackage и вызова отличается от процесса вызова методов в экземплярах объектов.  
  
 Среде направляет команды последовательно в контекст команды внутренней (local), который основан на текущее выделение, самый внешний контекст (глобальные). Невозможно выполнить команду контекста является тот, который обрабатывает его. Дополнительные сведения см. в разделе [маршрутизации алгоритм](../../extensibility/internals/command-routing-algorithm.md).  
  
 В большинстве случаев среды обрабатывает команды с помощью <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейса. Поскольку схема маршрутизации команд позволяет использовать множество различных объектов для обработки команд, <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> может быть реализован любое количество объектов; они включают элементы управления ActiveX, окна представления реализации, объекты документа, иерархии проекта и VSPackage сами объекты (для глобальные команды). В некоторых специальных случаях, например, маршрутизация команд в иерархии, <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> интерфейс должен быть реализован.  
  
## <a name="related-topics"></a>См. также  
  
|Заголовок|Описание|  
|-----------|-----------------|  
|[Реализация](../../extensibility/internals/command-implementation.md)|Описывает, как реализуются команды в VSPackage.|  
|[Доступность](../../extensibility/internals/command-availability.md)|Описывается, как Visual Studio контекст определяет список доступных команд.|  
|[Алгоритм маршрутизации](../../extensibility/internals/command-routing-algorithm.md)|Описывает, как архитектура маршрутизации команд Visual Studio позволяет использовать команды должны обрабатываться разные пакеты VSPackage.|  
|[Рекомендации по размещению](../../extensibility/internals/command-placement-guidelines.md)|Предлагает методы для позиционирования команд в среде Visual Studio.|  
|[Как добавить элементы пользовательского интерфейса с помощью пакетов VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md)|Описывает, как пакеты VSPackage наилучшим образом можно использовать команду архитектуры Visual Studio.|  
|[Стандартное размещение команды, группы и панели инструментов](../../extensibility/internals/default-command-group-and-toolbar-placement.md)|Описывает, как пакеты VSPackage могут лучше всего использовать команды, которые включены в Visual Studio.|  
|[Управление пакетами VSPackage](../../extensibility/managing-vspackages.md)|Описывает, как Visual Studio загружает пакеты VSPackage.|  
|[Файлы таблицы команд Visual Studio (VSCT-файлы)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md)|Предоставляет сведения о файлах vstc на основе XML, которые используются для описания макета и внешнего вида команды в пакеты VSPackage.|