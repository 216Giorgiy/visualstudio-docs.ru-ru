---
title: "Команды конструктора | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "команды"
  - "команды, реализация"
ms.assetid: 097108c3-f758-4b87-89d6-b32d12d9041a
caps.latest.revision: 34
caps.handback.revision: 34
ms.author: "gregvanl"
manager: "ghogen"
---
# Команды конструктора
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

При добавлении команды в VSPackage, необходимо указать, где он должен отображаться, если он доступен и его.  
  
## Указание команд  
 Чтобы определить новые команды включите файл таблицы команды Visual Studio \(.vsct\) в проекте VSPackage.  Если вы создали VSPackage с помощью шаблона пакета Visual Studio, проект включает один из этих файлов.  Дополнительные сведения см. в разделе [Таблицы команд Visual Studio \(. Файлы Vsct\)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md).  
  
 Visual Studio объединяет все файлы .vsct он обнаруживает для правильного отображения команд.  Поскольку эти файлы определены из типа binary VSPackage Visual Studio не может загрузить пакет, чтобы найти команды.  Дополнительные сведения см. в разделе [Как добавить элементы пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
 Visual Studio использует <xref:Microsoft.VisualStudio.Shell.ProvideMenuResourceAttribute> атрибут регистрации для определения ресурсов и команды меню.  Дополнительные сведения см. в разделе [Реализация](../../extensibility/internals/command-implementation.md).  
  
 Команды можно изменить во время выполнения несколькими различными способами.  Они могут отображать или скрывать, чтобы включить или отключить.  Они могут отображаться различные текст или значки или содержат различные значения.  Многие настройки может быть выполнена до загрузки Visual Studio в VSPackage.  Дополнительные сведения см. в разделе [Как добавить элементы пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
## Обработчики команды  
 При создании команды, необходимо предоставить обработчик событий, чтобы выполнить команду.  Если пользователь выбирает команду, то его необходимо соответствующим образом перенаправления.  Маршрутизация команду отправить это означает к правильному VSPackage, чтобы включить или отключить его, скрывать или отображать его и выполняет его если пользователь выбрал.  Дополнительные сведения см. в разделе [Алгоритм маршрутизации](../../extensibility/internals/command-routing-algorithm.md).  
  
## Среда команды Visual Studio  
 Visual Studio может узел любой номер VSPackages, каждый из которых может способствовать собственный набор команд.  Среды, соответствующие команды отображаются только на текущую задачу.  Дополнительные сведения см. в разделах [Доступность](../../extensibility/internals/command-availability.md) и [Выбор контекста объектов](../../extensibility/internals/selection-context-objects.md).  
  
 VSPackage, задающее новые команды меню, панели инструментов или контекстные меню предоставляют свои данные команды Visual Studio во время установки с помощью записи реестра, что ресурсы ссылки в собственном или управляемых сборках.  Каждый ресурс затем ссылается на файл ресурсов двоичных данных \(.cto\), который создается при компилировании файла таблицы команды Visual Studio \(.vsct\).  Это позволяет Visual Studio, чтобы обеспечить объединенные наборов команд меню и панели инструментов устанавливается без загрузки VSPackage. каждое  
  
### Упорядочение команд  
 Команды позиций среды группой, приоритетом и меню.  
  
-   Группы логической коллекции связанных команд, например **Вырезать**"  **копия**и  **Вставить** группа команд.  Группы команд, которые появляются в меню.  
  
-   Приоритет определяет порядок следования отдельных команд в группе отображаются в меню.  
  
-   Меню являются контейнерами для групп.  
  
 Среда предопределяет некоторые команды, группы и меню.  Дополнительные сведения см. в разделе [Команда, группы и размещения панели инструментов по умолчанию](../../extensibility/internals/default-command-group-and-toolbar-placement.md).  
  
 Команда может быть присвоено основной группе.  Первичная группа отслеживает положение команд в структуре, и в главное меню **Настройка** диалоговое окно.  Команда может появляться в нескольких групп; например, команда может находиться на главном меню, в контекстном меню и на панели инструментов.  Дополнительные сведения см. в разделе [Как добавить элементы пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md).  
  
### Маршрутизация команд  
 Процесс вызова и маршрутизация команд для VSPackages отличается от процесса вызова методов для экземпляров объекта.  
  
 Среда направляет команды последовательно от самой внутренней \(local\) контекста команд, который основан на текущем выделенном фрагменте, к внешней \(global\) контексту.  Первый контекст, который способен выполнить команду по одному, которое обрабатывает его.  Дополнительные сведения см. в разделе [Алгоритм маршрутизации](../../extensibility/internals/command-routing-algorithm.md).  
  
 В большинстве экземплярах, с помощью команды дескрипторов среды <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> интерфейс.  Поскольку схема маршрутизации команд включает много различных объектов к командам маркера, <xref:Microsoft.VisualStudio.OLE.Interop.IOleCommandTarget> может быть реализован любым количеством объектов; они включают управления microsoft ActiveX, реализации представления окна, объекты документа иерархии проекта и объекты сами VSPackage \(для глобальных команд\).  В некоторых специализированных случаях, например при маршрутизации команд в иерархии <xref:Microsoft.VisualStudio.Shell.Interop.IVsHierarchy> интерфейс должен быть реализован.  
  
## Связанные разделы  
  
|Заголовок|Описание|  
|---------------|--------------|  
|[Реализация](../../extensibility/internals/command-implementation.md)|Описывает, как реализовать команды в VSPackage.|  
|[Доступность](../../extensibility/internals/command-availability.md)|Описывается контекст Visual Studio определяет, какие команды доступны.|  
|[Алгоритм маршрутизации](../../extensibility/internals/command-routing-algorithm.md)|Описывается архитектура маршрутизации команд Visual Studio включает команды обрабатываться другим VSPackages.|  
|[Рекомендации по размещению](../../extensibility/internals/command-placement-guidelines.md)|Предлагает как разместить команды среды Visual Studio.|  
|[Как добавить элементы пользовательского интерфейса в пакеты VSPackage](../../extensibility/internals/how-vspackages-add-user-interface-elements.md)|Описывает, как VSPackages может лучше всего использовать архитектуру команды Visual Studio.|  
|[Команда, группы и размещения панели инструментов по умолчанию](../../extensibility/internals/default-command-group-and-toolbar-placement.md)|Описывает, как VSPackages может оптимального использования команды, которые включены в Visual Studio.|  
|[Управление пакеты VSPackage](../../extensibility/managing-vspackages.md)|Описывает, как Visual Studio загружает VSPackages.|  
|[Таблицы команд Visual Studio \(. Файлы Vsct\)](../../extensibility/internals/visual-studio-command-table-dot-vsct-files.md)|Предоставляет сведения о файлах .vsct основанных на XML, которые используются для описания структуры и просмотр команд в VSPackages.|