---
title: "Практическое руководство: Установка подключаемого модуля системы управления версиями | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Установка [Visual Studio SDK] подключаемых модулей системы управления версиями"
  - "Источник подключаемые модули управления, установка"
ms.assetid: 9e2e01d9-7beb-42b2-99b2-86995578afda
caps.latest.revision: 32
caps.handback.revision: 32
ms.author: "gregvanl"
manager: "ghogen"
---
# Практическое руководство: Установка подключаемого модуля системы управления версиями
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Создание подключаемого модуля системы управления версиями состоит из трех этапов:  
  
1.  Создайте библиотеку DLL с помощью функции, определенные в разделе Справочник по API подключаемого модуля управления источника данной документации.  
  
2.  Реализация функции API подключаемого модуля управления источника. Когда [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] вызовы, освободить интерфейсы и диалоговые окна из подключаемого модуля.  
  
3.  Зарегистрируйте библиотеки DLL, сделав соответствующие записи в реестр.  
  
## <a name="integration-with-visual-studio"></a>Интеграция с Visual Studio  
 [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] поддерживает подключаемые модули источника управления, которые соответствуют API подключаемого модуля управления источника.  
  
### <a name="registering-the-source-control-plug-in"></a>Регистрация подключаемый модуль системы управления версиями  
 Прежде чем выполнение интегрированной среды разработки (IDE) можно вызвать в системе управления версиями, он сначала найти источник библиотеки DLL подключаемого модуля, который экспортирует API управления.  
  
##### <a name="to-register-the-source-control-plug-in-dll"></a>Чтобы зарегистрировать DLL подключаемого модуля управления версиями  
  
1.  Добавьте две записи в разделе HKEY_LOCAL_MACHINE в подраздел программного ОБЕСПЕЧЕНИЯ, указывает имя вашей компании подраздел, следуют подраздел имя вашего продукта. Шаблон — HKEY_LOCAL_MACHINE\SOFTWARE\\*[название организации]*\\*[имя продукта]*\\*[операция]* = значение. Две записи всегда вызываются SCCServerName и данный параметр. Каждый является обычную строку.  
  
     Например если название компании Майкрософт и вашей системы управления версиями называется SourceSafe, этот путь реестра будет HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe. В этом подразделе первая запись SCCServerName, строковая чтения пользователю именования продукта. Вторая запись данный параметр, — полный путь к источнику управления библиотеки DLL подключаемого модуля, в Интегрированной среде разработки должен подключаться к. Ниже представлен пример записи реестра.  
  
    |Пример реестра|Образец значения|  
    |---------------------------|------------------|  
    |HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\SCCServerName|Microsoft Visual SourceSafe|  
    |HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\SCCServerPath|c:\vss\win32\ssscc.dll|  
  
    > [!NOTE]
    >  Данный параметр — это полный путь к подключаемом модуле SourceSafe. Подключаемый модуль системы управления версиями будет использовать разные названия компаний и продуктов, но те же пути записи реестра.  
  
2.  Можно использовать следующие необязательные параметры реестра для изменения поведения подключаемый модуль системы управления версиями. Эти записи перейдите в подраздел же SccServerName и данный параметр.  
  
    -   Запись HideInVisualStudioregistry может использоваться, если требуется отключить источник управления plug в отображаются в списке Выбор подключаемых модулей [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)]. Эта запись также влияет на автоматическое переключение на подключаемый модуль системы управления версиями. Один из возможных способов использования этой операции — Если необходимо указать пакет системы управления версиями, который заменяет подключаемый модуль системы управления версиями, но вы хотите упростить для пользователей для миграции с помощью системы управления версиями, подключаемый модуль для исходного пакета управления. При установке пакет системы управления версиями, он задает запись реестра, который скрывает подключаемого модуля.  
  
         HideInVisualStudio является значением типа DWORD и имеет значение 1, чтобы скрыть подключаемый модуль или 0, чтобы показать подключаемого модуля. Если параметр отсутствует, по умолчанию — Показать подключаемого модуля.  
  
    -   Запись реестра DisableSccManager можно отключить или скрыть **запуска \< сервера системы управления версиями>** пункт меню, который обычно отображается в разделе **файла** -> **системы управления версиями** подменю. Это меню выбора параметра вызовы [SccRunScc](../../extensibility/sccrunscc-function.md) функции. Подключаемый модуль системы управления версиями может не поддерживать внешней программы и поэтому может потребоваться отключить или скрыть даже **запуска** пункт меню.  
  
         DisableSccManager является значением типа DWORD равен 0 для включения **запуска \< сервера системы управления версиями>** пункт меню, равным 1, чтобы отключить команду меню и значение 2, чтобы скрыть параметр меню. Если этот параметр реестра отсутствует, по умолчанию задается для отображения пункта меню.  
  
    |Пример реестра|Образец значения|  
    |---------------------------|------------------|  
    |HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\HideInVisualStudio|1|  
    |HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\SourceSafe\DisableSccManager|1|  
  
3.  Добавьте подраздел SourceCodeControlProvider, в разделе HKEY_LOCAL_MACHINE в подразделе программного ОБЕСПЕЧЕНИЯ.  
  
     Этот подраздел реестра ProviderRegKey присваивается строка, представляющая подраздел, помещаются в реестре на шаге 1. Шаблон — HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\ProviderRegKey = программного ОБЕСПЕЧЕНИЯ\\*[название организации]*\\*[имя продукта]*.  
  
     Ниже приведен пример содержимого для этого подраздела.  
  
    |Запись реестра|Образец значения|  
    |--------------------|------------------|  
    |HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\ProviderRegKey|SOFTWARE\Microsoft\SourceSafe|  
  
    > [!NOTE]
    >  Подключаемый модуль системы управления версиями будет использовать же подраздел и имена входа, но значение будет другим.  
  
4.  Создать подраздел с именем InstalledSCCProviders в подразделе SourceCodeControlProvider, а затем поместите одну запись в этом подразделе.  
  
     Имя для данного элемента является имя, понятное пользователю поставщика (то же, как значения, указанного в записи SCCServerName) и имеет значение, опять же, раздел, созданный на шаге 1. Шаблон — HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\InstalledSCCProviders\\*[отображаемое имя]* = программного ОБЕСПЕЧЕНИЯ\\*[название организации]*\\*[имя продукта]*.  
  
     Например:  
  
    |Пример реестра|Образец значения|  
    |---------------------------|------------------|  
    |HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider\InstalledSCCProviders\Microsoft Visual SourceSafe|SOFTWARE\Microsoft\SourceSafe|  
  
    > [!NOTE]
    >  Может существовать несколько источника подключаемые модули управления таким образом зарегистрированы. Это как [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] находит все установленные на основе API подключаемого модуля управления источника подключаемых модулей.  
  
## <a name="how-an-ide-locates-the-dll"></a>Как Интегрированная среда разработки определяет библиотеку DLL  
  [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] IDE имеет два способа поиск источника управления DLL подключаемого модуля:  
  
-   Найдите подключаемый модуль системы управления версиями по умолчанию и подключаться к ней без вмешательства пользователя.  
  
-   Найти все зарегистрированные источник подключаемые модули управления, из которого пользователь выбирает один.  
  
 Чтобы найти библиотеку DLL в первый способ, среда Разработки выполняет подраздел HKEY_LOCAL_MACHINE\Software\SourceCodeControlProvider для записи ProviderRegKey. Значение этого элемента указывает на другой раздел. Затем среда Разработки выполняет запись с именем данный параметр в этой второй подраздел в разделе HKEY_LOCAL_MACHINE. Значение этого элемента указывает Интегрированной среде разработки DLL.  
  
> [!NOTE]
>  IDE загрузить библиотеки DLL из относительные пути (например,.\NewProvider.DLL). Должен быть указан полный путь к библиотеке DLL (например, c:\Providers\NewProvider.DLL). Это повышает безопасность среды IDE, запрещая загрузку несанкционированного или олицетворенного DLL подключаемого модуля.  
  
 Чтобы найти библиотеку DLL в второй способ, среда Разработки выполняет подраздел HKEY_LOCAL_MACHINE\Software\SourceCodeControlProvider\InstalledSCCProviders для всех операций*.* Каждая запись содержит имя и значение. Среда интегрированной Разработки отобразит список этих имен пользователю*.* Когда пользователь выбирает имя, IDE находит значение для выбранного имени, указывающий на раздел. Среда Разработки выполняет запись с именем данный параметр в этом разделе, в разделе HKEY_LOCAL_MACHINE. Значение этого элемента указывает Интегрированной среде разработки на соответствующие библиотеки DLL.  
  
 Подключаемый модуль системы управления версиями должна поддерживать оба способа найти библиотеку DLL и следовательно, задайте ProviderRegKey, перезаписывая все предыдущие настройки. Еще важнее он должен добавить себя в список InstalledSccProviders, пользователь может иметь Выбор какой подключаемый модуль системы управления версиями.  
  
> [!NOTE]
>  Поскольку используется раздел реестра HKEY_LOCAL_MACHINE, подключаемый модуль системы управления только из одного источника, можно зарегистрировать как по умолчанию модуль управления версиями на данном компьютере (Однако [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] позволяет определить, какой модуль управления версиями они хотят использовать для конкретного решения). Во время вашего процесса установки проверьте, если устанавливается подключаемый модуль системы управления версиями; Если это так, попросите пользователя или не должна использоваться новые системы управления версиями, подключаемый модуль, устанавливаемого по умолчанию. Во время отмены установки не удаляйте другие подразделы реестра, которые являются общими для всех источник подключаемые модули управления в HKEY_LOCAL_MACHINE\SOFTWARE\SourceCodeControlProvider; Удалите только определенной SCC подраздела.  
  
## <a name="how-the-ide-detects-version-1213-support"></a>Как IDE определяет поддерживаемые версии 1.2 или 1.3  
 Как does [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] определить, является ли подключаемый модуль поддерживает функциональные возможности версии 1.2 или 1.3 API подключаемого модуля управления источника? Чтобы объявить расширенные возможности, подключаемый модуль системы управления версиями необходимо реализовать соответствующую функцию.  
  
 Во-первых, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] проверяет значение, возвращаемое вызовом [SccGetVersion](../../extensibility/sccgetversion-function.md). Его должно быть больше или равно 1.2.  
  
 Далее, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] определяет, поддерживаются ли определенный новая возможность, проверив `lpSccCaps` аргумент в [SccInitialize](../../extensibility/sccinitialize-function.md).  
  
 Если оба эти условия выполнены, можно вызвать новые функции, поддерживаемые в версии 1.2 и 1.3.  
  
## <a name="see-also"></a>См. также  
 [Приступая к работе](../../extensibility/internals/getting-started-with-source-control-plug-ins.md)