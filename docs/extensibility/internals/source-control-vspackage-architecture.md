---
title: "Исходная архитектура управления VSPackage | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: source control packages, architecture
ms.assetid: 453125fc-23dc-49b1-8476-94581f05e6c7
caps.latest.revision: "25"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: 80153e271fed6a7fab49e00c8124f1ede7613bfa
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="source-control-vspackage-architecture"></a>Архитектура VSPackage исходного элемента управления
Пакет системы управления версиями, пакет VSPackage, который использует службы, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] предоставляет интегрированную среду разработки. В ответ пакета системы управления версиями обеспечивает его функциональные возможности, что в систему управления версиями. Кроме того, пакет управления версиями является альтернативой более универсально, чем для интеграции системы управления версиями в подключаемый модуль системы управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
 Подключаемый модуль, реализующий API подключаемых модулей управления источника придерживается строгого контракта. Например, подключаемый модуль не может заменить значение по умолчанию [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] пользовательского интерфейса (UI). Кроме того API подключаемых модулей управления источника не поддерживает подключаемый модуль для реализации собственную модель управления версиями. Пакет системы управления версиями, однако обходит часть этих ограничений. Пакет управления версиями имеет полный контроль над взаимодействие управления источника [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] пользователя. Кроме того пакет управления версиями можно использовать собственную модель управления версиями и логику и его можно определить все интерфейсы пользователя, связанные с управлением источника.  
  
## <a name="source-control-package-components"></a>Компоненты пакета системы управления версиями  
 Как показано на схеме архитектуры, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] компонент с именем заглушки управления источника является пакет VSPackage, который интегрирует пакета системы управления версиями с [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
 Заглушки исходный элемент управления обрабатывает следующие задачи.  
  
-   Предоставляет общий пользовательский Интерфейс, необходимый для системы управления версиями пакета регистрации.  
  
-   Загружает пакет системы управления версиями.  
  
-   Задает пакет системы управления версиями, как активных и неактивных.  
  
 Заглушки управления источника ищет службу active для пакета управления версиями и перенаправляет все входящие вызовы службы из интегрированной среды разработки для этого пакета.  
  
 Пакет адаптера системы управления версиями является специальные управления версиями пакета, который [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] предоставляет. Этот пакет является основным компонентом для поддержки источника подключаемые модули управления на основе API-интерфейсы управления подключаемого модуля источника. Когда подключаемый модуль системы управления версиями подключаемого модуля активной, заглушка управления источника отправляет его события пакет адаптера системы управления версиями. В свою очередь пакет адаптера системы управления версиями взаимодействует с подключаемым модулем системы управления версиями с помощью API управления подключаемого модуля источника, а также предоставляет стандартный пользовательский Интерфейс, который является общим для всех источник подключаемые модули управления.  
  
 При активной пакета пакета системы управления версиями, с другой стороны, заглушки управления источника напрямую взаимодействует с пакета с помощью [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] интерфейсы пакета системы управления версиями. Пакет управления версиями отвечает за размещение собственного пользовательского интерфейса системы управления версиями.  
  
 ![График архитектуры элемента управления](../../extensibility/internals/media/vsipsccarch.gif "VSIPSCCArch")  
  
 Пакет системы управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] не предоставляет исходный код элемента управления или API-Интерфейс для интеграции. Сравните это с подходом, описанные в [Создание подключаемый модуль системы управления источника](../../extensibility/internals/creating-a-source-control-plug-in.md) где подключаемый модуль системы управления версиями должна реализовывать жесткая набор функций и обратные вызовы.  
  
 Как и любой VSPackage пакета системы управления версиями является COM-объект, который может быть создан с помощью `CoCreateInstance`. Пакет VSPackage делает себя доступным для [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] IDE путем реализации <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>. При создании экземпляра VSPackage получает указатель сайта и <xref:Microsoft.VisualStudio.OLE.Interop.IServiceProvider> интерфейс, обеспечивающий доступ VSPackage доступных служб и интерфейсов в Интегрированной среде разработки.  
  
 Написание пакета системы управления версиями на основе VSPackage требует более сложных опыт программирования, чем написание на основе API подключаемых модулей для управления источника подключаемого модуля.  
  
## <a name="see-also"></a>См. также  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>   
 [Начало работы](../../extensibility/internals/getting-started-with-source-control-vspackages.md)