---
title: "Архитектура VSPackage источника элемента управления | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "пакеты управления исходным кодом, архитектура"
ms.assetid: 453125fc-23dc-49b1-8476-94581f05e6c7
caps.latest.revision: 25
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 25
---
# Архитектура VSPackage источника элемента управления
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

Пакет системы управления версиями VSPackage, использующего службы, [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Интегрированная среда разработки.  При возвращении пакета системы управления версиями обеспечивает функциональность в качестве службы системы управления версиями.  Кроме того, пакет системы управления версиями более разносторонняя возможностей, чем подключаемый модуль системы управления версиями для внедрения в системе управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
 Подключаемый модуль системы управления версиями, реализующий интерфейс API системы управления версиями подключаемый модуль остается неизменным строгим контрактом.  Например, подключаемый модуль не может заменить значение по умолчанию [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] интерфейс пользователя\).  Более того, api\-интерфейсы подключаемый модуль системы управления версиями не позволяет подключаемый модуль, чтобы реализовать собственную модель системы управления версиями.  Пакет системы управления версиями, однако клавишу оба этих ограничений.  Пакет системы управления версиями имеет полный контроль над взаимодействием системы управления версиями a [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] пользователь.  Кроме того, пакет системы управления версиями можно использовать собственные модели и логику системы управления версиями, и он может определять пользовательские интерфейсы источника элемент управления\-родственные.  
  
## Компоненты пакета системы управления версиями  
 Как показано на схеме архитектуры, a [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] компонент с именем заглушки системы управления версиями пакета VSPackage, которые интегрируются для системы управления версиями  [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)].  
  
 Заглушка системы управления версиями обрабатывает следующие задачи.  
  
-   Предоставляет общий пользовательский интерфейс, необходимые для регистрации пакета системы управления версиями.  
  
-   Загружает пакет из системы управления версиями.  
  
-   Устанавливает пакет системы управления версиями, как активный\/неактивные.  
  
 Заглушка системы управления версиями ищет активная службы для пакета системы управления версиями и направляет все входящие служебные вызовы из среды разработки в этот пакет.  
  
 Пакет адаптера системы управления версиями, то пакет специальной системы управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] предоставляет.  Этот пакет является центральным компонентом для поддержки модулей системы управления версиями на основе API подключаемых модулей системы управления версиями.  Когда подключаемый модуль системы управления версиями, заглушки активный подключаемый модуль системы управления версиями отправляет его события к пакету адаптера системы управления версиями.  В свою очередь пакет адаптера системы управления версиями обеспечивает взаимодействие с подключаемым модулем системы управления версиями с помощью API системы управления версиями подключаемого модуля, а также обеспечивает по умолчанию пользовательский интерфейс, общее для всех модулей системы управления версиями.  
  
 Если пакет системы управления версиями активный пакет, с другой стороны, заглушки системы управления версиями непосредственно взаимодействует с пакетом, используя [!INCLUDE[vsipsdk](../../extensibility/includes/vsipsdk_md.md)] интерфейсы пакета системы управления версиями.  Пакет системы управления версиями, отвечающий за размещение собственный пользовательский интерфейс системы управления версиями.  
  
 ![График архитектуры элемента управления](~/extensibility/internals/media/vsipsccarch.gif "VSIPSCCArch")  
  
 Для пакета системы управления версиями [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] не выполняют код элемента управления источника поставок или api\-интерфейсов для интеграции.  Сравните этот подход с конспектированный in [Создание подключаемого модуля системы управления версиями](../../extensibility/internals/creating-a-source-control-plug-in.md) когда подключаемый модуль системы управления версиями, должен реализовывать сплошной набор функций и обратных вызовов.  
  
 Практическое любое VSPackage пакета системы управления версиями COM\-объект, может быть создан с помощью `CoCreateInstance`.  Делает доступным в VSPackage [!INCLUDE[vsprvs](../../code-quality/includes/vsprvs_md.md)] Интегрированная среда разработки путем реализации  <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>.  При создании экземпляра, VSPackage получает указатель сайта и <xref:Microsoft.VisualStudio.OLE.Interop.IServiceProvider> интерфейс, предоставляющий доступ VSPackage к доступным службам и интерфейсам в интегрированной среде разработки.  
  
 Записи VSPackage\-основанный пакета системы управления версиями требует более чем написание дополнительно опыт программирования подключаемый модуль системы управления версиями API\-основанный подключаемым модулем.  
  
## См. также  
 <xref:Microsoft.VisualStudio.Shell.Interop.IVsPackage>   
 [Начало работы](../../extensibility/internals/getting-started-with-source-control-vspackages.md)