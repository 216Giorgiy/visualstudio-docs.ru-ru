---
title: "Функция SccGetCommandOptions | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- SccGetCommandOptions
helpviewer_keywords:
- SccGetCommandOptions function
ms.assetid: bbe4aa4e-b4b0-403e-b7a0-5dd6eb24e5a9
caps.latest.revision: 14
ms.author: gregvanl
manager: ghogen
translation.priority.mt:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Machine Translation
ms.sourcegitcommit: 5db97d19b1b823388a465bba15d057b30ff0b3ce
ms.openlocfilehash: 86f8b896581d4238e1328bd0fe086987145c9fb5
ms.lasthandoff: 02/22/2017

---
# <a name="sccgetcommandoptions-function"></a>Функция SccGetCommandOptions
Эта функция пользователю Дополнительные параметры для данной команды.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp#  
SCCRTN SccGetCommandOptions(  
   LPVOID pvContext,  
   HWND hWnd,  
   enum SCCCOMMAND iCommand,  
   LPCMDOPTS* ppvOptions  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Структура подключаемого модуля контекста исходного элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 iCommand  
 [in] Команда, для которой запрашиваются Дополнительные параметры (см. [код команды](../extensibility/command-code-enumerator.md) возможные значения).  
  
 ppvOptions  
 [in] Структура параметров (также может быть `NULL`).  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|-----------|-----------------|  
|SCC_OK|Выполнено.|  
|SCC_I_ADV_SUPPORT|Подключаемый модуль системы управления версиями поддерживает дополнительные параметры для команды.|  
|SCC_I_OPERATIONCANCELED|Пользователь отменил источника управления подключаемые в **параметры** диалоговое окно.|  
|SCC_E_OPTNOTSUPPORTED|Подключаемый модуль системы управления версиями не поддерживает эту операцию.|  
|SCC_E_ISCHECKEDOUT|Невозможно выполнить эту операцию с файлом, который в данный момент извлечен.|  
|SCC_E_ACCESSFAILURE|Произошла ошибка при доступе к системе управления версиями, вероятно, из-за проблемы с сетью или конкуренции. Рекомендуется повторить операцию.|  
|SCC_E_NONSPECIFICERROR|Неспецифическая ошибка.|  
  
## <a name="remarks"></a>Примечания  
 IDE вызывает эту функцию в первый раз с `ppvOptions` = `NULL` для определения, если подключаемый модуль системы управления версиями поддерживает дополнительные параметры для заданной команды. Если подключаемый модуль поддерживает функцию, для этой команды, IDE вызывает эту функцию снова при запросе дополнительных параметров (обычно реализуются как **Дополнительно** кнопку в диалоговом окне) и предоставляет отличный от NULL указатель для `ppvOptions` , указывающий `NULL` указателя. Подключаемый модуль сохраняет любые дополнительные параметры, заданные пользователем в структуру частного и возвращает указатель на эту структуру в `ppvOptions`. Эта структура передается ко всем функциям API подключаемых модулей исходного элемента управления, необходимо знать о нем, включая последующие вызовы `SccGetCommandOptions` функции.  
  
 Пример может помочь прояснить этой ситуации.  
  
 Пользователь выбирает **получить** IDE и команда отображает **получить** диалоговое окно. Вызовы IDE `SccGetCommandOptions` работать с `iCommand` значение `SCC_COMMAND_GET` и `ppvOptions` значение `NULL`. Это значение интерпретируется системой управления версиями, подключаемый модуль как вопрос, «У вас любые дополнительные параметры для этой команды?» Если подключаемый модуль возвращает `SCC_I_ADV_SUPPORT`, среда интегрированной разработки отобразит **Дополнительно** кнопку в его **получить** диалоговое окно.  
  
 При первом нажатии **Дополнительно** Интегрированной кнопки, снова вызывает `SccGetCommandOptions` функции этого времени, отличным от`NULL``ppvOptions` , указывающий `NULL` указателя. Подключаемый модуль отображает собственную **получить параметры** диалоговом пользователю предлагается ввести сведения помещает эти сведения в отдельную структуру и возвращает указатель на структуру, что в `ppvOptions`.  
  
 При нажатии кнопки **Дополнительно** снова вызывает интегрированной среды разработки в том же диалоговом `SccGetCommandOptions` функция снова без изменения `ppvOptions`, что структура передается обратно подключаемого модуля. Это позволяет подключаемого модуля, чтобы повторно инициализировать диалоговое окно его значениями, которые пользователь ранее было установлено. Подключаемый модуль изменяет структуру на месте перед возвратом.  
  
 Наконец, когда пользователь нажимает **ОК** в среде разработки **получить** диалоговое окно, вызывает IDE [SccGet](../extensibility/sccget-function.md), передачи структуры, возвращаемые в `ppvOptions` , содержащий дополнительные параметры.  
  
> [!NOTE]
>  Команда `SCC_COMMAND_OPTIONS` используется, когда среда интегрированной разработки отобразит **параметры** диалоговым окном, которое позволяет пользователю задать установки, которые управляют работой интеграции. Если подключаемый модуль системы управления версиями хочет предоставить собственное диалоговое окно настройки, она может содержать от **Дополнительно** кнопку в диалоговом окне Настройка интегрированной среды разработки. Подключаемый модуль не отвечает за получение и сохранять эти сведения; интегрированной среды разработки не использовать его или изменить его.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [Код команды](../extensibility/command-code-enumerator.md)
