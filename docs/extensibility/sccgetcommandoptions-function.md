---
title: "Функция SccGetCommandOptions | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- SccGetCommandOptions
helpviewer_keywords:
- SccGetCommandOptions function
ms.assetid: bbe4aa4e-b4b0-403e-b7a0-5dd6eb24e5a9
caps.latest.revision: 
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.workload:
- vssdk
ms.openlocfilehash: 3bce2922c961bf29f320f047a91057a638fe708a
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="sccgetcommandoptions-function"></a>Функция SccGetCommandOptions
Эта функция пользователю для настройки дополнительных параметров для данной команды.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
SCCRTN SccGetCommandOptions(  
   LPVOID pvContext,  
   HWND hWnd,  
   enum SCCCOMMAND iCommand,  
   LPCMDOPTS* ppvOptions  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Исходная структура подключаемого модуля контекста элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 iCommand  
 [in] Команда, для которого запрашиваются Дополнительные параметры (в разделе [код команды](../extensibility/command-code-enumerator.md) возможные значения).  
  
 ppvOptions  
 [in] Структура параметров (также может быть `NULL`).  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализация подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание:|  
|-----------|-----------------|  
|SCC_OK|Выполнено.|  
|SCC_I_ADV_SUPPORT|Подключаемый модуль системы управления версиями поддерживает дополнительные параметры для команды.|  
|SCC_I_OPERATIONCANCELED|Пользователь отменил соответствующей источника управления подключаемые в **параметры** диалоговое окно.|  
|SCC_E_OPTNOTSUPPORTED|Подключаемый модуль системы управления версиями не поддерживает эту операцию.|  
|SCC_E_ISCHECKEDOUT|Невозможно выполнить эту операцию с файлом, который в данный момент извлечен.|  
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления версиями, возможно, из-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC_E_NONSPECIFICERROR|Неспецифичную сбоя.|  
  
## <a name="remarks"></a>Примечания  
 IDE вызывает эту функцию в первый раз с `ppvOptions` = `NULL` для определения, если подключаемый модуль системы управления версиями поддерживает функцию Дополнительные параметры для заданной команды. Если подключаемый модуль поддерживает компонент, для этой команды, интегрированной среды разработки вызывает эту функцию снова при запросе дополнительных параметров (обычно реализуются как **Дополнительно** кнопку в диалоговом окне) и предоставляет НЕНУЛЕВОЙ указатель для `ppvOptions` , указывающий `NULL` указателя. Подключаемый модуль сохраняет любые дополнительные параметры, заданные пользователем в Закрытая структура и возвращает указатель на этой структуре в `ppvOptions`. Эта структура передается ко всем функциям API подключаемых модулей исходного элемента управления, необходимо знать о нем, включая последующие вызовы `SccGetCommandOptions` функции.  
  
 Пример может прояснить этой ситуации.  
  
 Пользователь выбирает **получить** команда и интегрированной среды разработки отображаются **получить** диалоговое окно. Вызовы IDE `SccGetCommandOptions` функционировать с `iCommand` значение `SCC_COMMAND_GET` и `ppvOptions` значение `NULL`. Это значение интерпретируется системой управления версиями, подключаемый модуль в виде вопроса, «У вас есть любые дополнительные параметры для этой команды?» Если подключаемый модуль возвращает `SCC_I_ADV_SUPPORT`, интегрированная среда разработки отображает **Дополнительно** кнопку в его **получить** диалоговое окно.  
  
 При первом щелчке **Дополнительно** кнопки, интегрированной среды разработки снова вызывает `SccGetCommandOptions` функции этого времени, отличным от`NULL``ppvOptions` , указывающий `NULL` указателя. Подключаемый модуль отображает собственную **параметры получения** диалоговом запросит у пользователя сведения помещает эти сведения в отдельную структуру и возвращает указатель на этой структуре в `ppvOptions`.  
  
 При нажатии кнопки **Дополнительно** снова вызывает интегрированной среды разработки в диалоговом окне же `SccGetCommandOptions` функции еще раз без изменения `ppvOptions`, после чего структуры передается обратно подключаемого модуля. Это позволяет подключаемого модуля, чтобы повторно инициализировать диалоговое окно его значениями, которые пользователь ранее было задано. Подключаемый модуль изменяет структуру на месте перед возвратом.  
  
 Наконец, когда пользователь щелкает **ОК** в среде разработки **получить** диалоговое окно, вызовы интегрированной среды разработки [SccGet](../extensibility/sccget-function.md), передачи структуры, возвращаемых в `ppvOptions` , содержащий Дополнительные параметры.  
  
> [!NOTE]
>  Команда `SCC_COMMAND_OPTIONS` используется, когда интегрированная среда разработки отображает **параметры** диалоговым окном, которое позволяет пользователю задать установки, которые управляют работой интеграции. Если подключаемый модуль системы управления версиями хочет предоставить собственное диалоговое окно настроек, он может отображать из **Дополнительно** кнопку в диалоговом окне Настройка интегрированной среды разработки. Подключаемый модуль не отвечает за получение и сохранять эти сведения; IDE не использовать его или изменить его.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [Код команды](../extensibility/command-code-enumerator.md)