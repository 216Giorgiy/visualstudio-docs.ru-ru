---
title: "Поддерживает несколько представлений документов | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "редакторы [Visual Studio SDK] пользовательские - несколько представлений документов"
ms.assetid: c7ec2366-91c4-477f-908d-e89068bdb3e3
caps.latest.revision: 25
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 25
---
# Поддерживает несколько представлений документов
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Можно предоставить более чем одно представление документа, создав отдельные объекты представления данных документа и документ для редактора.  Некоторые случаи, в которых дополнительное представление документа было бы полезно:  
  
-   Поддержка нового окна: Требуется редактор обеспечить несколько представлений одного типа, так что пользователь, который уже имеет окно открыть в редакторе мог открыть новое окно, выбрав **Новое окно** команда из  **Окно** меню.  
  
-   Поддержка представление формы и кода: Необходимо предоставить пользовательский редактор представления различных типов.  [!INCLUDE[vbprvb](../code-quality/includes/vbprvb_md.md)], например, предоставляет представление формы и представление кода.  
  
 Дополнительные сведения об этом см. в разделе процедуру CreateEditorInstance в файле EditorFactory.cs в проекте специализированного редактора созданного шаблоном пакета Visual Studio.  Дополнительные сведения об этом проекте см. в разделе [Пошаговое руководство: Создание специализированного редактора](../extensibility/walkthrough-creating-a-custom-editor.md).  
  
## Синхронизировать представления  
 При реализации нескольких представлений, объект данных документа отвечает за сохранить все представления синхронизирована с данными.  Можно использовать интерфейсы обработки событий on <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> синхронизировать несколько раз с данными представления.  
  
 Если не используется <xref:Microsoft.VisualStudio.TextManager.Interop.VsTextBuffer> объект для представления нескольких синхронизировать, затем необходимо реализовать собственную систему событий для обработки изменения, внесенные в объект данных документа.  Можно использовать различные уровни гранулярности для хранения нескольких представлений последним.  С помощью параметра максимальной степени гранулярности, при вводе в одно представление другие представления обновляются немедленно.  С минимальным уровнем детализации других представлений не обновляются до тех пор, пока они не активированы.  
  
## Определение, является ли данные уже открытого документа  
 Запуск таблица document \(RDT\) в справках интегрированной среды разработки \(ide\), отслеживается ли данные для документа уже открыт, как показано на следующей диаграмме.  
  
 ![График DocDataView](~/extensibility/media/docdataview.gif "Docdataview")  
Несколько представлений  
  
 По умолчанию каждое представление \(объект представления документа\) содержится в его границах окна \(<xref:Microsoft.VisualStudio.Shell.Interop.IVsWindowFrame>\).  Как уже определено, однако данные документа может отображаться в нескольких представлений.  Чтобы разрешить это Visual Studio проверяет RDT, чтобы определить, является ли документ в вопросе уже открыт в редакторе.  При вызове интегрированной среды разработки <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory.CreateEditorInstance%2A> чтобы создать значение, отличное от null, возвращенных в редакторе  `punkDocDataExisting` параметр указывает на то, что документ уже открыт в другом редакторе.  Дополнительные сведения о функциях см. в разделе RDT [Таблицы запущенных документа](../extensibility/internals/running-document-table.md).  
  
 в вашем <xref:Microsoft.VisualStudio.Shell.Interop.IVsEditorFactory> реализация просмотрите возвращенный объект данных внутри документа  `punkDocDataExisting` определить, является ли данные документа подходят для редактора.  \(Например, HTML только данные должны отображаться редактором HTML.\) Если соответствующее, фабрика редактора должен предоставить второе представление данных.  Если `punkDocDataExisting` параметр отсутствует  `NULL`возможно, что объект данных документа открыт в другом редакторе или более правоподобном, что данные документа уже открыт в другом представлении с теми же редактор.  Если данные документа, открытого в другом редакторе, в фабрику редактора не поддерживает, а затем Visual Studio не удается открыть в фабрику редактора.  Дополнительные сведения см. в разделе [Практическое руководство: присоединение представления документа данных](../extensibility/how-to-attach-views-to-document-data.md).