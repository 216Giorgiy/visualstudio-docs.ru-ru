---
title: "Функция SccCreateSubProject | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SccCreateSubProject"
helpviewer_keywords: 
  - "Функция SccCreateSubProject"
ms.assetid: 08154aed-ae5c-463c-8694-745d0e332965
caps.latest.revision: 19
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 19
---
# Функция SccCreateSubProject
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Эта функция создает подпроект с заданным именем в существующий проект родительского заданные `lpParentProjPath` аргумент.  
  
## Синтаксис  
  
```cpp#  
SCCRTN SccCreateSubProject(  
   LPVOID pContext,  
   HWND   hWnd,  
   LPSTR  lpUser,  
   LPCSTR lpParentProjPath,  
   LPCSTR lpSubProjName,  
   LPSTR  lpAuxProjPath,  
   LPSTR  lpSubProjPath  
);  
```  
  
#### Параметры  
 pContext  
 \[in\] Подключаемый модуль Контекстный указатель исходного элемента управления.  
  
 hWnd  
 \[in\] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpUser  
 \[in, out\] Имя пользователя \(до SCC\_USER\_SIZE, включая символ конца строки NULL\).  
  
 lpParentProjPath  
 \[in\] Строка, идентифицирующая путь родительского проекта \(до SCC\_PRJPATH\_SIZE, включая символ конца строки NULL\).  
  
 lpSubProjName  
 \[in\] Имя предлагаемые подпроекта \(до SCC\_PRJPATH\_SIZE, включая символ конца строки NULL\).  
  
 lpAuxProjPath  
 \[in, out\] Вспомогательный строка, определяющая проекта \(до SCC\_PRJPATH\_SIZE, включая символ конца строки NULL\).  
  
 lpSubProjPath  
 \[in, out\] Выходная строка идентификации пути для подпроекта \(до SCC\_PRJPATH\_SIZE, включая символ конца строки NULL\).  
  
## Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|--------------|--------------|  
|SCC\_OK|Подпроект успешно создан.|  
|SCC\_E\_INITIALIZEFAILED|Не удалось инициализировать родительского проекта.|  
|SCC\_E\_INVALIDUSER|Пользователь не может войти систему управления версиями.|  
|SCC\_E\_COULDNOTCREATEPROJECT|Не удается создать подпроект.|  
|SCC\_E\_PROJSYNTAXERR|Проект недопустимый синтаксис.|  
|SCC\_E\_UNKNOWNPROJECT|Родительский проект неизвестен подключаемый модуль системы управления версиями.|  
|SCC\_E\_INVALIDFILEPATH|Путь к файлу недопустим или непригодным для использования.|  
|SCC\_E\_NOTAUTHORIZED|Для выполнения этой операции не разрешено пользователю.|  
|SCC\_E\_ACCESSFAILURE|Произошла ошибка при доступе к системе управления версиями, вероятно, из\-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC\_E\_CONNECTIONFAILURE|Удалось установить подключаемый модуль подключения управления источника.|  
|SCC\_E\_NONSPECIFICERROR<br /><br /> SCC\_E\_UNKNOWNERROR|Неспецифическая ошибка.|  
  
## Заметки  
 Если подпроект с именем уже существует, функция может изменить имя по умолчанию для создания уникальных, например путем добавления «\_ \< число \>» к нему. Вызывающий объект должен быть готов к внесению изменений `lpUser`, `lpSubProjPath`, и `lpAuxProjPath`.`lpSubProjPath` И`lpAuxProjPath` аргументы затем используются в вызове [SccOpenProject](../extensibility/sccopenproject-function.md). Они не должно изменяться после возврата вызывающему объекту. Эти строки представляют собой способ для системы управления версиями, подключаемый модуль для отслеживания сведений, которые нужно связать с проектом. Так как подключаемый модуль можно использовать форматированную строку, могут не подходить для просмотра вызывающей стороны интегрированной среды разработки эти два параметра, при возврате не отображаются. Функция возвращает успех или неудачу кода и в случае успешного выполнения заполняет переменную `lpSubProjPath` путем полного проекта в новый проект.  
  
 Эта функция аналогична [SccGetProjPath](../extensibility/sccgetprojpath-function.md), за исключением того, что он автоматически создает проект, а не предлагать пользователю выбрать один. При `SccCreateSubProject` вызове функции `lpParentProjName` и `lpAuxProjPath` не будет пустым и будет соответствовать допустимым проектом. Эти строки обычно принимаются IDE из предыдущего вызова `SccGetProjPath` функции или [SccGetParentProjectPath](../extensibility/sccgetparentprojectpath-function.md).  
  
 `lpUser` Аргумент представляет собой имя пользователя. IDE передаст тем же именем пользователя, он ранее получен от `SccGetProjPath`, и модуль управления версиями следует использовать имя по умолчанию. Если пользователь уже открытое соединение с помощью подключаемого модуля, подключаемый модуль должен попытайтесь устранить каких\-либо запросов, чтобы убедиться в том, что функция будет работать без вмешательства пользователя. Тем не менее, если имя входа не удается, подключаемый модуль должен запросить пользователя для входа и, получив является допустимым именем входа, передайте имя обратно в `lpUser`. Так как подключаемый модуль может изменить эту строку, IDE будет всегда выделяется буфер размером \(SCC\_USER\_LEN \+ 1 или SCC\_USER\_SIZE, который включает места для завершающего символа null\). Если строка изменяется, новая строка необходимо допустимое имя входа \(по крайней мере как допустимый как старая строка\).  
  
## Технические примечания для SccCreateSubProject и SccGetParentProjectPath  
 Добавление решений и проектов в систему управления версиями, был упрощен в Visual Studio, чтобы свести к минимуму количество раз, когда пользователь будет предложено выбрать расположения в системе управления версиями. Эти изменения активируются по Visual Studio, если подключаемый модуль системы управления версиями поддерживает несколько новых функций `SccCreateSubProject` и `SccGetParentProjectPath`. Однако следующий параметр реестра можно отключить эти изменения и вернуться к поведению предыдущих Visual Studio \(исходный элемент управления Plug\-in API версии 1.1\).  
  
 \[HKEY\_CURRENT\_USER\\Software\\Microsoft\\VisualStudio\\8.0\\SourceControl\] «DoNotCreateSolutionRootFolderInSourceControl» \= DWORD: 00000001  
  
 Если этот параметр реестра не существует или имеет значение DWORD: 00000000, Visual Studio пытается использовать новые функции `SccCreateSubProject` и `SccGetParentProjectPath`.  
  
 Если параметр реестра DWORD: 00000001, Visual Studio не будет пытаться использовать эти новые функции и операции добавления в систему управления версиями работают так, как было в предыдущих версиях Visual Studio.  
  
## См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [SccGetParentProjectPath](../extensibility/sccgetparentprojectpath-function.md)   
 [SccGetProjPath](../extensibility/sccgetprojpath-function.md)