---
title: "Функция SccPopulateList | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SccPopulateList"
helpviewer_keywords: 
  - "Функция SccPopulateList"
ms.assetid: 7416e781-c571-4a7f-8af3-a089ce8be662
caps.latest.revision: 13
caps.handback.revision: 13
ms.author: "gregvanl"
manager: "ghogen"
---
# Функция SccPopulateList
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Эта функция обновляет список файлов для определенного источника команды управления и предоставляет состояние системы управления версиями для всех файлов данного.  
  
## Синтаксис  
  
```cpp#  
SCCRTN SccPopulateList (  
   LPVOID          pvContext,  
   enum SCCCOMMAND nCommand,  
   LONG            nFiles,  
   LPCSTR*         lpFileNames,  
   POPLISTFUNC     pfnPopulate,  
   LPVOID          pvCallerData,  
   LPLONG          lpStatus,  
   LONG            fOptions  
);  
```  
  
#### Параметры  
 pvContext  
 \[in\] Структура подключаемого модуля контекста исходного элемента управления.  
  
 nCommand  
 \[in\] Команда управления версиями, который будет применяться ко всем файлам в `lpFileNames` массива \(см. [Код команды](../extensibility/command-code-enumerator.md) список команд\).  
  
 nFiles  
 \[in\] Число файлов в `lpFileNames` массива.  
  
 lpFileNames  
 \[in\] Массив имен файлов в Интегрированной среде разработки.  
  
 pfnPopulate  
 \[in\] Функции обратного вызова интегрированной среды разработки для добавления и удаления файлов \(в разделе [POPLISTFUNC](../extensibility/poplistfunc.md) Подробные сведения\).  
  
 pvCallerData  
 \[in\] Без изменений значение, передаваемое функции обратного вызова.  
  
 lpStatus  
 \[in, out\] Массив для системы управления версиями, подключаемый модуль Возвращает флаги состояния для каждого файла.  
  
 Возможности  
 \[in\] Команда флаги \(в разделе «PopulateList флаг» [Битовые флаги, используемые команды](../extensibility/bitflags-used-by-specific-commands.md) Подробные сведения\).  
  
## Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|--------------|--------------|  
|SCC\_OK|Выполнено.|  
|SCC\_E\_NONSPECIFICERROR|Неспецифическая ошибка.|  
  
## Заметки  
 Эта функция проверяет список файлов текущего состояния. Он использует `pfnPopulate` функцию обратного вызова для уведомления вызывающей стороны, если файл не соответствует критериям для `nCommand`. Например, если команда является `SCC_COMMAND_CHECKIN` и не извлечен файл в списке, а затем используется для информирования вызывающий объект обратного вызова. Иногда подключаемый модуль системы управления версиями может найти другие файлы, которые могут быть частью команды и добавить их. Это позволяет, например, Visual Basic пользователю извлекать BMP\-файл, который используется в свой проект, но не отображается в файле проекта Visual Basic. Пользователь выбирает **получить** в Интегрированной среде разработки. Отображает список всех файлов, которые он считает, что пользователь может получить, интегрированной среды разработки, но перед отображением списка `SccPopulateList` функция вызывается для убедитесь, что список, отображаемый в актуальном состоянии.  
  
## Пример  
 IDE формирует список файлов, которые он считал, пользователь может получить. Перед отображением этого списка, он вызывает `SccPopulateList` функции, давая возможность модуль управления версиями, добавлять и удалять файлы из списка. Подключаемый модуль изменяет список путем вызова функции данного обратного вызова \(см. [POPLISTFUNC](../extensibility/poplistfunc.md) Дополнительные сведения\).  
  
 Подключаемый модуль по\-прежнему вызывать `pfnPopulate` функцию, которая добавляет и удаляет файлы, до его завершения, а затем возвращает из `SccPopulateList` функции. IDE можно затем отобразить его список.`lpStatus` Массив представляет все файлы в исходном списке, переданный в интегрированной среде разработки. Подключаемый модуль заполняет состояние все эти файлы в дополнение к этому, чтобы сделать использование функции обратного вызова.  
  
> [!NOTE]
>  Подключаемый модуль системы управления версиями всегда имеет возможность просто немедленно возвращать управление этой функцией, оставляя в списке как. Если подключаемый модуль реализует эту функцию, он может указать, задав `SCC_CAP_POPULATELIST` битов флагов возможность в первый вызов [SccInitialize](../extensibility/sccinitialize-function.md). По умолчанию подключаемый модуль должен всегда предполагать наличие всех элементов, передаваемых в файлы. Однако если задает IDE `SCC_PL_DIR` флаг в `fOptions` параметр, все элементы, передаваемого в должны считаться каталоги. Подключаемый модуль следует добавить все файлы, которые принадлежат, в каталогах. Сочетание файлов и каталогов никогда не передают интегрированной среды разработки.  
  
## См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [SccInitialize](../extensibility/sccinitialize-function.md)   
 [POPLISTFUNC](../extensibility/poplistfunc.md)   
 [Битовые флаги, используемые команды](../extensibility/bitflags-used-by-specific-commands.md)   
 [Код команды](../extensibility/command-code-enumerator.md)