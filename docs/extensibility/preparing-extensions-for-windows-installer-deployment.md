---
title: "Подготовка расширения для развертывания установщика Windows | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "MSI-файл VSIX"
ms.assetid: 5ee2d1ba-478a-4cb7-898f-c3b4b2ee834e
caps.latest.revision: 15
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 15
---
# Подготовка расширения для развертывания установщика Windows
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Пакет установщика Windows \(MSI\) нельзя использовать для развертывания пакета VSIX. Тем не менее можно извлечь содержимое пакета VSIX для развертывания MSI. В этом документе показано, как подготовить проект, результат которого по умолчанию — это пакет VSIX для включения в проект установки.  
  
## Подготовка проекта расширения для развертывания установщика Windows  
 Перед добавлением в проект установки, выполните следующие действия для новых проектов расширения.  
  
#### Чтобы подготовить проект расширения для развертывания установщика Windows  
  
1.  Создайте VSPackage, компонент MEF, редактор обрамления или других типов проектов расширяемости, включает манифест VSIX.  
  
2.  Откройте VSIX\-манифест размещаются в редакторе кода.  
  
3.  Задать элемент InstalledByMsi манифест VSIX для `true`. Дополнительные сведения о манифесте VSIX в разделе [Справочник по схеме 2.0 расширения VSIX](../extensibility/vsix-extension-schema-2-0-reference.md).  
  
     Это предотвращает попытки установки компонента установщик VSIX.  
  
4.  Щелкните правой кнопкой мыши проект в **обозревателе решений** и нажмите кнопку **Свойства**.  
  
5.  Выберите **VSIX** вкладка.  
  
6.  Установите флажок **VSIX копирования содержимого в папке** и введите путь к которой проект установки будет загружать файлы.  
  
## Извлечение файлов из существующего пакета VSIX  
 Выполните следующие действия для добавления содержимого существующего пакета VSIX в проект установки, при отсутствии исходных файлов.  
  
#### Чтобы извлечь файлы из существующего пакета VSIX  
  
1.  Переименовать. VSIX\-файл, содержащий расширение из *filename*.vsix для *filename*.zip.  
  
2.  Скопируйте содержимое ZIP\-файл в каталог.  
  
3.  Удалите файл \[Content\_types\] .xml из каталога.  
  
4.  Измените манифест VSIX, как показано в предыдущей процедуре.  
  
5.  Добавьте оставшиеся файлы в проект установки.  
  
## См. также  
 [Visual Studio Installer Deployment](http://msdn.microsoft.com/ru-ru/121be21b-b916-43e2-8f10-8b080516d2a0)   
 [Walkthrough: Creating a Custom Action](http://msdn.microsoft.com/ru-ru/4bd4b63a-2b91-431e-839c-5752443f0eaf)