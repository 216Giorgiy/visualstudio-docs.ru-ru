---
title: "Предоставляет контекст языковой службы с помощью прежних версий API | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: editors [Visual Studio SDK], legacy - language service context
ms.assetid: daa2df22-9181-4bad-b007-a7d40302bce1
caps.latest.revision: "14"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.workload: vssdk
ms.openlocfilehash: 4dbee7d2998170277369f48c3b912307d2c7e414
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="providing-a-language-service-context-by-using-the-legacy-api"></a>Предоставляет контекст языковой службы с помощью API прежних версий
Существует два варианта языковой службы предоставить контекст пользователя с помощью [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] базового редактора: текст маркера контекста, задать либо все контекста пользователя. Здесь описаны различия между ними.  
  
 Дополнительные сведения о предоставляет контекст для языковую службу, подключенном к собственного редактора см. в разделе [как: предоставляют контекст для редакторов](../extensibility/how-to-provide-context-for-editors.md).  
  
## <a name="provide-text-marker-context-to-the-editor"></a>Предоставляет контекст маркера текста в редакторе  
 Для обеспечения контекста ошибки компилятора, обозначенном текстовых меток в [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] основы редактора, реализуйте <xref:Microsoft.VisualStudio.TextManager.Interop.IVsTextMarkerContextProvider> интерфейса. В этом случае служба языка предоставляет контекст только в том случае, когда курсор находится на текстовой метки. Это позволяет редактор для предоставления ключевое слово из позиции курсора для **динамической справки** окна без атрибутов.  
  
## <a name="provide-all-user-context-to-the-editor"></a>Укажите все контекст пользователя в редактор  
 Если вы создаете языковой службы и используете [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] основы редактора, а затем можно реализовать <xref:Microsoft.VisualStudio.TextManager.Interop.IVsLanguageContextProvider> интерфейс, чтобы предоставить контекст службы языка.  
  
 Для реализации `IVsLanguageContextProvider`, контейнер контекста (коллекция) подключен к редактора, который отвечает за обновление контейнера контекста. Когда **динамической справки** вызывает <xref:Microsoft.VisualStudio.Shell.Interop.IVsUserContext.Update%2A> интерфейса на этот контейнер контекста в состоянии простоя, контейнер контекста запрашивает редактор для обновления. Редактор затем уведомляет языковой службы, его необходимо обновить редактор и передает указатель на контекст контейнера. Это делается путем вызова <xref:Microsoft.VisualStudio.TextManager.Interop.IVsLanguageContextProvider.UpdateLanguageContext%2A> способ языковой службы из редактора. Контейнер контекст с использованием указателя, языковой службы теперь добавлять и удалять атрибуты и ключевые слова. Дополнительные сведения см. в разделе <xref:Microsoft.VisualStudio.TextManager.Interop.IVsLanguageContextProvider>.  
  
 Существует два разных способа реализации `IVsLanguageContextProvider`:  
  
-   Предусмотрено ключевое слово контекста контейнер  
  
     При вызове редактор для обновления контекста контейнера передать в соответствующие ключевые слова и атрибуты и возвратит `S_OK`. Это возвращаемое значение указывает, что редактор сохранить контекст ключевое слово и атрибут, а не предоставляют ключевое слово из позиции курсора в контейнере контекста.  
  
-   Получить ключевое слово из ключевого слова из позиции курсора  
  
     При вызове редактор для обновления контекста контейнера передайте соответствующие атрибуты и возвратит `E_FAIL`. Это возвращаемое значение указывает, что редактор сохранить атрибутов в наборе контекста, но обновить контекст контейнера с помощью ключевого слова из позиции курсора.  
  
 На следующей диаграмме показано, как контекст предоставляется для языковой службы, который реализует `IVsLanguageContextProvider`.  
  
 ![График LangServiceImplementation2](../extensibility/media/vslanguageservice2.gif "vsLanguageService2")  
Контекст для языковой службы  
  
 Как видно из диаграммы, [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] основной текстовый редактор имеет контейнер контекста, присоединенные к ней. Этот контекст в контейнере указывает на трех отдельных подконтекст контейнеры: языковой службы, редактор по умолчанию и текстовой метки. Языковой службы и текст маркера подконтекст контейнеры содержат атрибуты и ключевые слова для языковой службы, если <xref:Microsoft.VisualStudio.TextManager.Interop.IVsLanguageContextProvider> интерфейс реализован и текстовых маркеров: Если <xref:Microsoft.VisualStudio.TextManager.Interop.IVsTextMarkerContextProvider> реализации интерфейса. Если не реализовать любой из этих интерфейсов, редактор предоставляет контекст для ключевого слова из позиции курсора в контейнере подконтекст редактор по умолчанию.  
  
## <a name="context-guidelines-for-editors-and-designers"></a>Рекомендации по контекст для редакторов и конструкторов  
 Редакторы и конструкторы должны предоставить общие ключевое слово для редактора или конструктора окна. Это делается, чтобы отображает раздел справки универсальным, но применимо, для конструктора или редактора при нажатии клавиши F1. Редактор должен Помимо этого, укажите ключевое слово текущей позиции курсора или предоставить основные термины, зависящие от текущего выделения. Это позволяет убедиться, что раздел справки для текста или элемент пользовательского интерфейса, на который указывает или выбранных отображается при нажатии клавиши F1. Конструктор предоставляет контекст для элемента, выбранного в конструкторе, например кнопки на форме. Редакторы и конструкторы необходимо также подключаться к языковой службы, перечисленные в [Essentials службы языка для прежних версий](../extensibility/internals/legacy-language-service-essentials.md).