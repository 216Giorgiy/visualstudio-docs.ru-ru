---
title: "Создание категория параметров | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "параметры профиля, создания категорий"
ms.assetid: 97c88693-05ff-499e-8c43-352ee073dcb7
caps.latest.revision: 39
caps.handback.revision: 39
ms.author: "gregvanl"
manager: "ghogen"
---
# Создание категория параметров
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

В этом пошаговом руководстве создать категорию параметров Visual Studio и использовать его для сохранения значений и восстановить значения из файла параметров. Категория параметров — это группа связанных свойств, которые отображаются в виде «пользовательские параметры точки»; то есть как флажок в **Импорт и экспорт параметров** мастера. \(Его можно найти на **средства** меню.\) Сохранить или восстановить как категория параметры и параметры не отображаются в мастере. Дополнительные сведения см. в статье [Настройка параметров разработки в Visual Studio](http://msdn.microsoft.com/ru-ru/22c4debb-4e31-47a8-8f19-16f328d7dcd3).  
  
 Создать категорию параметров, производный от класса <xref:Microsoft.VisualStudio.Shell.DialogPage> класса.  
  
 Для этого пошагового выполнения первого раздела [Создание страницы параметров](../extensibility/creating-an-options-page.md). Полученный сетка свойств параметров позволяет просматривать и изменять свойства в категории. После сохранения категории свойств в файле параметров, вы проверяете файл, чтобы увидеть, как хранятся значения свойств.  
  
## Обязательные компоненты  
 Начиная с Visual Studio 2015, не установить пакет SDK для Visual Studio из центра загрузки. Она будет включена в качестве дополнительного компонента в установку Visual Studio. VS SDK также можно установить позже. Для получения дополнительной информации см. [Установка Visual Studio SDK](../extensibility/installing-the-visual-studio-sdk.md).  
  
## Создание категория параметров  
 В этом разделе использования точки настраиваемые параметры для сохранения и восстановления значений параметров категории.  
  
#### Чтобы создать категорию параметров  
  
1.  Завершить [Создание страницы параметров](../extensibility/creating-an-options-page.md).  
  
2.  Откройте файл VSPackage.resx и добавьте эти три строковых ресурсов:  
  
    |Имя|Значение|  
    |---------|--------------|  
    |106|Мои категории|  
    |107|Мои параметры|  
    |108|OptionInteger и OptionFloat|  
  
     Это создает ресурсы, имя категории «My Category» объекта «мои параметры» и описание категории «OptionInteger и OptionFloat».  
  
    > [!NOTE]
    >  Из этих трех имя категории не отображается в мастере импорта и экспорта параметров.  
  
3.  Добавьте в MyToolsOptionsPackage.cs, `float` свойство с именем `OptionFloat` для `OptionPageGrid` класса, как показано в следующем примере.  
  
    ```c#  
    public class OptionPageGrid : DialogPage  
    {  
        private int optionInt = 256;  
        private float optionFloat = 3.14F;  
  
        [Category("My Options")]  
        [DisplayName("My Integer option")]  
        [Description("My integer option")]  
        public int OptionInteger  
        {  
            get { return optionInt; }  
            set { optionInt = value; }  
        }  
        [Category("My Options")]  
        [DisplayName("My Float option")]  
        [Description("My float option")]  
        public float OptionFloat  
        {  
            get { return optionFloat; }  
            set { optionFloat = value; }  
        }  
    }  
    ```  
  
    > [!NOTE]
    >  `OptionPageGrid` Категорию с именем «My Category» теперь состоит из двух свойств `OptionInteger` и `OptionFloat`.  
  
4.  Добавить <xref:Microsoft.VisualStudio.Shell.ProvideProfileAttribute> к `MyToolsOptionsPackage` класса ему «My Category», «категория», присвойте ему имя объекта «Мои параметры» и isToolsOptionPage присвоено значение true. Значение categoryResourceID, objectNameResourceID и DescriptionResourceID соответствующий строковый ресурс, который ранее созданные идентификаторы.  
  
    ```c#  
    [ProvideProfileAttribute(typeof(OptionPageGrid),   
        "My Category", "My Settings", 106, 107, isToolsOptionPage:true, DescriptionResourceID = 108)]  
    ```  
  
5.  Выполните сборку решения и запустите отладку. В экспериментальном экземпляре вы увидите, что **мою страницу сетки** теперь имеет целые и десятичные значения.  
  
## Проверка файла параметров  
 В этом разделе вы экспортируете значения категории свойств в файл параметров. Просмотрите файл и затем импортировать обратно в категории свойств значения.  
  
1.  Запустите проект в режиме отладки, нажав клавишу F5. Запустится экспериментальный экземпляр.  
  
2.  Откройте **инструменты и параметры** диалогового окна.  
  
3.  В представлении дерева в левой области разверните **Мои категории** и нажмите кнопку **мою страницу сетки**.  
  
4.  Измените значение **OptionFloat** для 3.1416 и **OptionInteger** до 12. Нажмите кнопку **ОК**.  
  
5.  В меню **Сервис** выберите команду **Импорт и экспорт параметров**.  
  
     **Импорт и экспорт параметров** откроется окно мастера.  
  
6.  Убедитесь, что **Экспортировать выбранные параметры среды** выбран и нажмите кнопку **Далее**.  
  
     **Выбор параметров для экспорта** появится страница.  
  
7.  Щелкните **Мои параметры**.  
  
     **Описание** примет **OptionInteger и OptionFloat**.  
  
8.  Убедитесь, что **Мои параметры** только категорией выбран и нажмите кнопку **Далее**.  
  
     **Имя файла параметров** появится страница.  
  
9. Имя нового файла параметров `MySettings.vssettings` и сохраните его в соответствующий каталог. Нажмите кнопку **Готово**.  
  
     **Экспорт завершен** страница сообщает, что ваши параметры успешно экспортированы.  
  
10. На **файл** наведите указатель мыши на **Откройте**, а затем нажмите кнопку **файл**. Найдите `MySettings.vssettings` и откройте его.  
  
     Можно найти категории свойств, экспортированный в следующем разделе файла \(ваш GUID будет отличаться\).  
  
    ```  
    <Category name="My Category_My Settings"   
          Category="{4802bc3e-3d9d-4591-8201-23d1a05216a6}"   
          Package="{6bb6942e-014c-489e-a612-a935680f703d}"   
          RegisteredName="My Category_My Settings">  
          PackageName="MyToolsOptionsPackage">  
       <PropertyValue name="OptionFloat">3.1416</PropertyValue>   
       <PropertyValue name="OptionInteger">12</PropertyValue>   
    </Category>  
    ```  
  
     Обратите внимание, что имя полного категории образуется путем добавления символа подчеркивания в имени категории, за которым следует имя объекта. OptionFloat и OptionInteger появляются в категории, вместе с их экспортированный значения.  
  
11. Закройте файл параметров без изменений.  
  
12. На **средства** меню, щелкните **Параметры**, разверните **Мои категории**, нажмите кнопку **мою страницу сетки** и измените значение **OptionFloat** 1.0 и **OptionInteger** 1. Нажмите кнопку **ОК**.  
  
13. На **средства** меню, щелкните **Импорт и экспорт параметров**, выберите **Импортировать выбранные параметры среды**, и нажмите кнопку **Далее**.  
  
     **Сохранить текущие параметры** появится страница.  
  
14. Выберите **Нет, импортировать новые параметры** и нажмите кнопку **Далее**.  
  
     **Выбор набора параметров для импорта** появится страница.  
  
15. Выберите `MySettings.vssettings` файл в **Мои параметры** узла дерева. Если файл не отображается в представлении в виде дерева, щелкните **Обзор** его найти. Нажмите кнопку **Далее**.  
  
     **Выбор параметров для импорта** откроется диалоговое окно.  
  
16. Убедитесь, что **Мои параметры** выбран и нажмите кнопку **Готово**. Когда **Импорт завершен** страницу, нажмите кнопку **Закрыть**.  
  
17. На **средства** меню, щелкните **Параметры**, разверните **Мои категории**, нажмите кнопку **мою страницу сетки** и проверить, восстановлены значения категории свойств.