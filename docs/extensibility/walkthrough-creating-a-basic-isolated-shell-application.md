---
title: "Пошаговое руководство: Создание приложения основные изолированной среды | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "Оболочка Visual Studio, пошаговые руководства"
  - "Оболочки [Visual Studio], пошаговые руководства"
  - "приложения на основе оболочки изолированного пошаговые руководства [Visual Studio]"
ms.assetid: 8b12e223-aae3-4c23-813d-ede1125f5f69
caps.latest.revision: 54
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 54
---
# Пошаговое руководство: Создание приложения основные изолированной среды
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

В этом пошаговом руководстве показано, как создать решение изолированной оболочки, Настройка окна справки о средства и создать программу установки, который устанавливает изолированной оболочки.  
  
## Обязательные компоненты  
 Для выполнения данного пошагового руководства, необходимо установить пакет SDK для Visual Studio. Для получения дополнительной информации см. [SDK для Visual Studio](../extensibility/visual-studio-sdk.md). Чтобы развернуть изолированной оболочки, необходимо также использовать распространяемый пакет оболочки Visual Studio \(изолированный режим\).  
  
## Создание решения для изолированной оболочки  
 В этом разделе показано, как использовать изолированной оболочки Visual Studio шаблон проекта для создания решения изолированной оболочки. Решение содержит следующие проекты:  
  
-   *Имя\_решения*. Проект AboutBoxPackage, который позволяет настраивать внешний вид справки или "о программе".  
  
-   Проект ShellExtensionsVSIX, который содержит файл source.extension.vsixmanifest, который определяет различные компоненты приложения изолированной среды.  
  
-   *Имя\_решения* проект, который создает исполняемый файл, который вызывает приложения изолированной среды. Этот проект содержит папку настроек оболочки, которая позволяет настроит звуковое внешний вид и поведение приложения изолированной среды.  
  
-   *Имя\_решения* проект пользовательского интерфейса, который создает вспомогательную сборку, определяющий команды активного меню и локализуемые строки.  
  
#### Чтобы создать решение основных изолированной оболочки  
  
1.  Откройте Visual Studio и создайте новый проект.  
  
2.  В **Новый проект** окна, разверните **другие типы проектов** и **расширения**. Выберите **изолированной оболочки Visual Studio** шаблона проекта.  
  
3.  Присвойте проекту имя `MyVSShellStub` и укажите расположение. Убедитесь, что **Создать каталог для решения** проверяется и нажмите кнопку **ОК**.  
  
     Новое решение отображается в **обозревателе решений**.  
  
4.  Постройте решение и начать отладку приложения изолированной среды.  
  
     Появится изолированной оболочки Visual Studio. Считывает заголовок **MyVSShellStub**. Мелкие создается на основе \\MyVSShellStub\\Resource Files\\ApplicationIcon.ico.  
  
## Настройка имени приложения и значок  
 Может потребоваться фирменной настройкой приложения, используя имя организации и логотипа в строке заголовка. Ниже показано, как изменить имя и значок, который отображается в строке заголовка пользовательского приложения, изменив файл определения пакета MyVSShellStub.Application.pkgdef.  
  
#### Чтобы настроить имя приложения и значок  
  
1.  Откройте в проекте MyVSShellStub \\Shell Customization\\MyVSShellStub.Application.pkgdef.  
  
2.  Изменение `AppName` значение элемента для **«Имя\_приложения» \= «редактор Fabrikam Музыка»**  
  
3.  Чтобы изменить значок приложения, скопируйте каталог \\MyVSShellStub\\MyVSShellStub\\MyVSShellStub\\ другой значок. Переименуйте существующий файл ApplicationIcon.ico в ApplicationIcon1.ico. Переименуйте файл в ApplicationIcon.ico.  
  
4.  Постройте решение и запустить отладку. Появится интегрированная среда разработки изолированной оболочки. Заголовок содержит ваш новый значок рядом с полем **Редактор музыки Fabrikam**.  
  
## Настройка страницы домашней страницы обозревателя по умолчанию  
 В этом разделе показано, как изменить Домашняя страница по умолчанию **веб\-обозреватель** окно, изменив файл определения пакета.  
  
#### Чтобы настроить домашнюю страницу веб\-обозревателя по умолчанию  
  
1.  В файле MyVSShellStub.Application.pkgdef изменить `DefaultHomePage` значение элемента «http:\/\/www.microsoft.com».  
  
2.  Перестройте проект MyVSShellStub.  
  
3.  Постройте решение и запустить отладку.  
  
4.  В **представления и другие окна**, нажмите кнопку **веб\-обозреватель**.**Веб\-обозреватель** окно отображает домашнюю страницу корпорации Microsoft.  
  
## Удаление команды Print  
 Файл .vsct в проекте изолированной оболочки пользовательский Интерфейс состоит из набора объявлений формы `<Define name=No_`*элемент*`>`, где *элемент* является одним из стандартных меню Visual Studio и команд.  
  
 Если объявление части, что меню или команды исключается из изолированной оболочки. И наоборот Если объявление комментариями, меню или команды включается в изолированной оболочки.  
  
 В следующих шагах раскомментируйте команды print в файле .vsct.  
  
#### Чтобы удалить команду печати  
  
1.  Убедитесь, что **печати** команда появляется на **файл** меню в приложении изолированной оболочки.  
  
2.  Откройте в проекте MyVSShellStubUI \\Resource Files\\MyVSShellStubUI.vsct для редактирования.  
  
3.  Раскомментируйте следующую строку:  
  
    ```  
    <!-- <Define name="No_PrintChildrenCommand"/> -->  
    ```  
  
4.  При этом удаляются команды print.  
  
5.  Начните отладку приложения изолированной среды. Убедитесь, что **файл \/ печать** команды отсутствует.  
  
## Удаление компонентов из изолированной оболочки  
 Можно удалить некоторые пакеты, которые загружаются с помощью Visual Studio, изменив файл .pkgundef, если не требуется этих функций в приложении пользовательские изолированной оболочки. Укажите пакет, в одном из подразделов реестра $RootKey$ \\Packages.  
  
> [!NOTE]
>  Возможности GUID Visual Studio, см. [GUID пакета возможностей Visual Studio](../extensibility/package-guids-of-visual-studio-features.md).  
  
 Ниже показан способ удаления XML редактор от изолированной оболочки.  
  
#### Чтобы удалить редактора XML  
  
1.  Откройте файл MyVSShellStub.pkgundef в папке проекта MyVSShellStub настроек оболочки.  
  
2.  Раскомментируйте следующую строку:  
  
     \[$RootKey \\Packages\\$ {87569308\-4813\-40a0\-9cd0\-d7a30838ca3f}\]  
  
3.  Перестройте решение и запустить отладку изолированной оболочки. Откройте XML\-файл, например, \\MyVSShellStub\\MyVSShellStub\\MyVSShellStubUI\\MyVSShellStubUI.vsct. Убедитесь, что ключевые слова XML в файле не выделение цветом и, введя «\<» в строке не активизирует подсказки в XML.  
  
## Настройка справки и "о программе"  
 Можно настроить справку или "о программе", который создается как часть шаблона проекта изолированной оболочки.  
  
#### Чтобы изменить имя компании  
  
1.  Название компании, сведения об авторских правах, версии и описание продукта находятся в проекте MyVSShellStub.AboutBoxPackage в файле \\Properties\\AssemblyInfo.cs. Откройте этот файл.  
  
2.  Изменение `AssemblyCompany` значение **Fabrikam**,  `AssemblyProduct` и `AssemblyTitle` значения **Редактор музыки Fabrikam**, и `AssemblyCopyright` значение **© Fabrikam, 2015**:  
  
    ```  
    [assembly: AssemblyTitle("Fabrikam Music Editor")] [assembly: AssemblyDescription("")] [assembly: AssemblyConfiguration("")] [assembly: AssemblyCompany("Fabrikam")] [assembly: AssemblyProduct("Fabrikam Music Editor")] [assembly: AssemblyCopyright("Copyright © Fabrikam 2015")] [assembly: AssemblyCompany("Fabrikam")] [assembly: AssemblyProduct("Fabrikam Music Editor ")] [assembly: AssemblyCopyright("Copyright © Fabrikam 2015”)]  
    ```  
  
3.  Чтобы добавить описание продукта, измените `AssemblyDescription` значение **Описание редактора Fabrikam музыки.**:  
  
    ```  
    [assembly: AssemblyDescription("The description of Fabrikam Music editor.”)]  
    ```  
  
4.  Начать отладку приложения и в приложении изолированной оболочки откройте **Справка \/ о программе** поле. Вы должны увидеть измененные строки. Заголовок справки или "о программе" совпадает с именем `AssemblyTitle` значение в файл AssemblyInfo.cs.  
  
5.  Свойства **справки и о** само поле находятся в файле MyVSShellStub.AboutBoxPackage\\AboutBox.xaml. Чтобы изменить ширину справки или "о программе", перейдите в `AboutDialogStyle` блокировку и задать `Width` значение 200:  
  
    ```  
    <Style x:Key="AboutDialogStyle" TargetType="Window"> <Setter Property="Height" Value="Auto" /> <Setter Property="Width" Value="200" /> <Setter Property="ShowInTaskbar" Value="False" /> <Setter Property="ResizeMode" Value="NoResize" /> <Setter Property="WindowStyle" Value="SingleBorderWindow" /> <Setter Property="SizeToContent" Value="Height" /> </Style>  
    ```  
  
6.  Перестройте решение и запустить отладку изолированной оболочки. Справка\/о поле должно быть приблизительно квадрата.  
  
## Перед развертыванием приложения изолированной среды  
 Приложение изолированной оболочки можно установить на любом компьютере, имеет распространяемый пакет оболочки Visual Studio \(изолированный режим\). Дополнительные сведения о распространяемого пакета см. в разделе [загрузки расширения Visual Studio](http://go.microsoft.com/fwlink/?LinkID=119298) веб\-сайта.  
  
## Развертывание приложения изолированной среды  
 Создав проект установки развертывания приложения изолированной оболочки на конечном компьютере. Необходимо указать следующее:  
  
-   Структура папок и файлов на конечном компьютере.  
  
-   Условия запуска, которые гарантируют, что платформа .NET Framework и Visual Studio оболочки среды выполнения устанавливаются на конечном компьютере.  
  
 В следующей процедуре необходимо будет установить InstallShield Limited Edition на компьютере.  
  
#### Создание проекта установки  
  
1.  В **обозревателе решений**, щелкните правой кнопкой мыши узел решения и нажмите кнопку **Добавление нового проекта**.  
  
2.  В **Новый проект** диалогового окна разверните **другие типы проектов** а затем выберите **установки и развертывания**. Выберите шаблон InstallShield. Назовите новый проект `MySetup` и выберите **ОК**.  
  
3.  Если InstallShield Limited Edition уже установлен, перейдите к следующему шагу.  
  
     Если InstallShield Limited Edition еще не установлена, откроется страница загрузки InstallShield. Следуйте инструкциям по загрузке и установке продукта, Выбор версии InstallShield, который совместим с версией Visual Studio. Необходимо решить, следует зарегистрировать установки InstallShield или использовать его в качестве оценки. После завершения установки необходимо перезапустить Visual Studio.  
  
    > [!IMPORTANT]
    >  Перед созданием проекта InstallShield, необходимо запустить Visual Studio с правами администратора. Если этого не сделать, возникнет ошибка при построении проекта.  
  
 Следующие шаги показывают, как настроить проект установки.  
  
> [!IMPORTANT]
>  Убедитесь, что вы создали конфигурацию выпуска изолированной оболочки проекта по крайней мере один раз, прежде чем настраивать проект установки.  
  
#### Чтобы настроить проект установки  
  
1.  В **обозревателе решений**, в разделе **MySetup** проекта, выберите **Помощник по проекту**. В нижней строке **Помощник по проекту** окно, выберите **сведений о приложении**. Введите **Fabrikam** как название компании и **Редактор музыки Fabrikam** в качестве имени приложения. Нажмите стрелку вперед в правом нижнем углу **Помощник по проекту**.  
  
2.  Выберите **Да** под **приложению требуется программное обеспечение установлено на компьютере?** а затем выберите **полный пакет Microsoft .NET Framework 4.5**.  
  
3.  Выберите **файлы приложения** расположенную в нижней части окна и убедитесь, что **Редактор музыки Fabrikam** выбрать папку.  
  
4.  Выберите **Добавить файлы** кнопки. В **Добавить файлы** диалогового окна добавьте следующие файлы из **MyVSShellStub\\Release** папки:  
  
    1.  MyVSShellStub.exe.config  
  
    2.  DebuggerProxy.dll  
  
    3.  DebuggerProxy.dll.manifest  
  
    4.  MyVSShellStub.pkgdef  
  
    5.  MyVSShellStub.pkgundef  
  
    6.  MyVSShellStub.winprf  
  
    7.  Splash.bmp  
  
5.  Щелкните **Добавление выходных элементов проекта** и добавьте **MyVSShellStub\-источник вывода**. Нажмите кнопку **ОК**.  
  
6.  В левой области в разделе **конечный компьютер**, щелкните правой кнопкой мыши **Fabrikam музыки редактор \[INSTALLDIR\]** узла и добавить **новую папку** с именем **расширения**.  
  
7.  Щелкните правой кнопкой мыши **расширения** узел в левой области и добавьте новую папку с именем **приложения**.  
  
8.  Выберите **приложения** папку и нажмите кнопку **Добавление выходных элементов проекта** кнопку, а затем выберите основной выходной файл из проекта MyVSShellStub.AboutBoxPackage.  
  
9. Щелкните **Добавить файлы** и из папки \\MyVSShellStub\\Release\\Extensions\\Application\\ добавьте следующие файлы:  
  
    -   MyVSShellStub.AboutBoxPackage.pkgdef  
  
    -   MyVSShellStub.Application.pkgdef  
  
10. Щелкните правой кнопкой мыши **музыки Fabrikam редактор \[INSTALLDIR\]** узел в левой области и добавьте новую папку с именем **1033**.  
  
11. Выберите папку 1033 и нажмите кнопку **Добавление выходных элементов проекта** и выберите основной выходной файл из проекта MyVSShellStubUI.  
  
12. Переместите **ярлыков** окна.  
  
13. Щелкните **New** создайте ярлык и выберите **\\Fabrikam\\Fabrikam Music Editor\\MyVSShellStub.Primary Output \[ProgramFilesFolder\]**.  
  
14. Переместите **установки интервью** области.  
  
15. Все элементы **Нет**.  
  
16. В **обозревателе решений**, откройте в проекте MySetup **определить требования к установке и действия \\ требования**.**Требования** откроется окно.  
  
17. Щелкните правой кнопкой мыши **требования к программному обеспечению системы** и выберите **создать условие запуска**.**Мастер поиска системы** отображается.  
  
18. В **то, что вы хотите найти?** области, выберите **реестра** в раскрывающемся списке и нажмите кнопку **Далее**.  
  
19. В **способ для отображения?** выберите **HKEY\_LOCAL\_MACHINE** как корневой раздел реестра. Введите **SOFTWARE\\Wow6432Node\\Microsoft\\DevDiv\\vs\\Servicing\\14.0\\isoshell** для 64\-разрядных систем или **SOFTWARE\\Microsoft\\DevDiv\\vs\\Servicing\\14.0\\isoshell** для 32\-разрядных систем и введите **установки** как значение реестра. Нажмите кнопку **Далее**.  
  
20. В **то, что вы хотите использовать выбранное значение?** области введите **этого продукта требуется распространяемого компонента Visual Studio 2015 изолированной оболочки должны быть установлены.** отображаемый текст и нажмите кнопку **Готово**.  
  
21. Перестройте решение изолированной оболочки, чтобы создать проект установки.  
  
     Файл setup.exe можно найти в следующей папке:  
  
     \\MyVSShellStub\\MySetup\\MySetup\\Express\\SingleImage\\DiskImages\\DISK1  
  
## Тестирование программы установки  
 Для проверки установки, скопируйте файл setup.exe на другой компьютер и запустите исполняемый файл программы установки. Вы сможете запустить приложения изолированной среды.