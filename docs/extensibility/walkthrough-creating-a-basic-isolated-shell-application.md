---
title: "Пошаговое руководство: Создание базового приложения Isolated Shell | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Visual Studio shell, walkthroughs
- Shell [Visual Studio], walkthroughs
- walkthroughs [Visual Studio], isolated shell-based application
ms.assetid: 8b12e223-aae3-4c23-813d-ede1125f5f69
caps.latest.revision: 54
ms.author: gregvanl
manager: ghogen
translation.priority.mt:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: MT
ms.sourcegitcommit: 47057e9611b824c17077b9127f8d2f8b192d6eb8
ms.openlocfilehash: e007e366847ac42d3916b16cbde190e8fd755821
ms.contentlocale: ru-ru
ms.lasthandoff: 09/06/2017

---
# <a name="walkthrough-creating-a-basic-isolated-shell-application"></a>Пошаговое руководство: Создание приложения основные изолированной оболочки
В этом пошаговом руководстве показано, как создать решение изолированной оболочки, Настройка окна справки о и создать программу установки, который устанавливает изолированной оболочки.  
  
## <a name="prerequisites"></a>Предварительные требования  
 Для выполнения этого пошагового руководства необходимо установить пакет SDK для Visual Studio. Дополнительные сведения см. в разделе [пакет SDK для Visual Studio](../extensibility/visual-studio-sdk.md). Чтобы развернуть изолированной оболочки, воспользуйтесь распространяемый пакет оболочки Visual Studio (изолированной).  
  
## <a name="creating-an-isolated-shell-solution"></a>Создание решения изолированной оболочки  
 В этом разделе показано, как использовать шаблон проекта изолированной оболочки Visual Studio для создания решения изолированной оболочки. Решение содержит следующие проекты:  
  
-   *Имя_решения*. AboutBoxPackage проект, который позволяет настраивать внешний вид справки / "о программе".  
  
-   Проект ShellExtensionsVSIX, содержащий файл source.extension.vsixmanifest, который определяет различные компоненты приложения изолированной оболочки.  
  
-   *Имя_решения* проекта, который создает исполняемый файл, который использует приложение изолированной оболочки. Этот проект содержит папку Настройка оболочки, которая позволяет настроит звуковое внешний вид и поведение приложения изолированной оболочки.  
  
-   *Имя_решения* проекта пользовательского интерфейса, который создает вспомогательную сборке, которая определяет команды активного меню и локализуемые строки.  
  
#### <a name="to-create-a-basic-isolated-shell-solution"></a>Для создания решения основных изолированной оболочки  
  
1.  Откройте Visual Studio и создайте новый проект.  
  
2.  В **новый проект** окна, разверните **другие типы проектов** и затем **расширяемости**. Выберите **изолированной оболочки Visual Studio** шаблона проекта.  
  
3.  Присвойте проекту имя `MyVSShellStub` и укажите расположение. Убедитесь, что **создать каталог для решения** проверяется и нажмите кнопку **ОК**.  
  
     Новое решение отображается в **обозревателе решений**.  
  
4.  Выполните сборку решения и начните отладку приложения изолированной оболочки.  
  
     Появится изолированной оболочки Visual Studio. Считывает заголовок **MyVSShellStub**. Значок для строки заголовка создается на основе \MyVSShellStub\Resource Files\ApplicationIcon.ico.  
  
## <a name="customizing-the-application-name-and-icon"></a>Настройка имени приложения и значок  
 Может потребоваться добавление фирменной символики приложения с помощью имени вашей компании и логотипа в заголовке окна. Ниже показано, как изменить имя и значок, который отображается в строке заголовка пользовательского приложения, изменив файл определения пакета MyVSShellStub.Application.pkgdef.  
  
#### <a name="to-customize-the-application-name-and-icon"></a>Чтобы настроить имя приложения и значок  
  
1.  В проекте MyVSShellStub откройте \Shell Customization\MyVSShellStub.Application.pkgdef.  
  
2.  Изменение `AppName` значение элемента для **«Имя_приложения» = "Редактор Fabrikam музыка»**  
  
3.  Чтобы изменить значок приложения, скопируйте в каталог \MyVSShellStub\MyVSShellStub\MyVSShellStub\ другой значок. Переименуйте существующий файл ApplicationIcon.ico в ApplicationIcon1.ico. Переименуйте файл в ApplicationIcon.ico.  
  
4.  Постройте решение и запустите отладку. Появится интегрированная среда разработки изолированной оболочки. Заголовок содержит ваш новый значок рядом с полем **редактор музыка Fabrikam**.  
  
## <a name="customizing-the-default-web-browser-home-page"></a>По умолчанию Web Домашняя страница браузера настройки  
 В этом разделе показано, как изменить домашнюю страницу по умолчанию для **веб-браузер** окно, изменив файл определения пакета.  
  
#### <a name="to-customize-the-default-web-browser-home-page"></a>Чтобы настроить домашнюю страницу веб-браузер по умолчанию  
  
1.  В файле MyVSShellStub.Application.pkgdef измените `DefaultHomePage` элемента значение «http://www.microsoft.com».  
  
2.  Перестройте проект MyVSShellStub.  
  
3.  Постройте решение и запустите отладку.  
  
4.  В **представления и другие окна**, нажмите кнопку **веб-браузер**. **Веб-браузер** окне отображается домашняя страница корпорации Майкрософт.  
  
## <a name="removing-the-print-command"></a>Удаление команды Print  
 Vsct-файл в проект пользовательского интерфейса изолированной оболочки состоит из набора объявлений формы `<Define name=No_` *элемент*`>`, где *элемент* является одним из стандартных меню Visual Studio и команд.  
  
 Если объявление является uncommented, этого меню или команды исключается из изолированной оболочки. И наоборот Если объявление закомментирована, меню или команды включается в изолированной оболочки.  
  
 В следующих шагах раскомментируйте команды print в vsct-файл.  
  
#### <a name="to-remove-the-print-command"></a>Чтобы удалить команду печати  
  
1.  Убедитесь, что **печати** команда появится в **файл** меню в приложении изолированной оболочки.  
  
2.  В проекте MyVSShellStubUI откройте \Resource Files\MyVSShellStubUI.vsct для редактирования.  
  
3.  Раскомментируйте эту строку:  
  
    ```  
    <!-- <Define name="No_PrintChildrenCommand"/> -->  
    ```  
  
4.  Эта функция удаляет команды print.  
  
5.  Начните отладку приложения изолированной оболочки. Убедитесь, что **файл / печать** команды отсутствует.  
  
## <a name="removing-features-from-the-isolated-shell"></a>Удаление компонентов из изолированной оболочки  
 Вы можете удалить некоторые пакеты, которые загружаются с помощью Visual Studio путем редактирования файла .pkgundef, если требуется отключить эти функции в приложении пользовательских изолированной оболочки. Укажите пакет, в одном из подразделов раздела реестра \Packages $RootKey$.  
  
> [!NOTE]
>  Возможностей идентификаторы GUID в Visual Studio, см [пакета GUID из функции Visual Studio](../extensibility/package-guids-of-visual-studio-features.md).  
  
 Ниже показано, как удалите XML-редактор из изолированной оболочки.  
  
#### <a name="to-remove-the-xml-editor"></a>Чтобы удалить редактора XML  
  
1.  Откройте файл MyVSShellStub.pkgundef в папке Настройка оболочки MyVSShellStub проекта.  
  
2.  Раскомментируйте следующую строку:  
  
     [$RootKey$ \Packages\\{87569308-4813-40a0-9cd0-d7a30838ca3f}]  
  
3.  Перестройте решение и запустить отладку изолированной оболочки. Откройте XML-файл, например, \MyVSShellStub\MyVSShellStub\MyVSShellStubUI\MyVSShellStubUI.vsct. Убедитесь, что ключевые слова XML в файле не выделяются цветом и что нажатие «<» в строке не активизирует подсказки в XML.  
  
## <a name="customizing-the-helpabout-box"></a>Настройка справки / "о программе"  
 Вы можете настроить Справка/о поле, оно создается как часть шаблона проекта изолированной оболочки.  
  
#### <a name="to-customize-the-company-name"></a>Чтобы изменить название компании  
  
1.  Название компании, сведения об авторских правах, версия продукта и описание продукта в проекте MyVSShellStub.AboutBoxPackage находятся в файле \Properties\AssemblyInfo.cs. Откройте этот файл.  
  
2.  Изменение `AssemblyCompany` значение **Fabrikam**, `AssemblyProduct` и `AssemblyTitle` значения **редактор музыка Fabrikam**и `AssemblyCopyright` значение **авторские права © 2015 Fabrikam**:  
  
    ```  
    [assembly: AssemblyTitle("Fabrikam Music Editor")]  
    [assembly: AssemblyDescription("")]  
    [assembly: AssemblyConfiguration("")]  
    [assembly: AssemblyCompany("Fabrikam")]  
    [assembly: AssemblyProduct("Fabrikam Music Editor")]  
    [assembly: AssemblyCopyright("Copyright © Fabrikam 2015")] [assembly: AssemblyCompany("Fabrikam")]  
    [assembly: AssemblyProduct("Fabrikam Music Editor ")]  
    [assembly: AssemblyCopyright("Copyright © Fabrikam 2015")]  
    ```  
  
3.  Чтобы добавить описание продукта, измените `AssemblyDescription` значение **Описание редактора Fabrikam музыки.**:  
  
    ```  
    [assembly: AssemblyDescription("The description of Fabrikam Music editor.")]  
    ```  
  
4.  Начать отладку приложения и приложения изолированной оболочки откройте **Справка / о программе** поле. Вы увидите измененных строк. Заголовок Справка/о поле совпадает со значением `AssemblyTitle` значения в файл AssemblyInfo.cs.  
  
5.  Свойства **Справка/о программе** самого поля находятся в файле MyVSShellStub.AboutBoxPackage\AboutBox.xaml. Чтобы изменить ширину Справка/о поле, перейдите к `AboutDialogStyle` блокировку и задать `Width` свойство до 200:  
  
    ```  
    <Style x:Key="AboutDialogStyle" TargetType="Window">  
        <Setter Property="Height" Value="Auto" />  
        <Setter Property="Width" Value="200" />  
        <Setter Property="ShowInTaskbar" Value="False" />  
        <Setter Property="ResizeMode" Value="NoResize" />  
        <Setter Property="WindowStyle" Value="SingleBorderWindow" />  
        <Setter Property="SizeToContent" Value="Height" />  
    </Style>  
    ```  
  
6.  Перестройте решение и запустить отладку изолированной оболочки. Справка / "о программе" должно быть приблизительно квадрат.  
  
## <a name="before-you-deploy-the-isolated-shell-application"></a>Перед развертыванием приложения изолированной оболочки  
 Приложение изолированной оболочки можно установить на любом компьютере, имеет распространяемый пакет оболочки Visual Studio (изолированной). Дополнительные сведения о распространяемого пакета см. в разделе [загрузки расширяемости Visual Studio](http://go.microsoft.com/fwlink/?LinkID=119298) веб-сайта.  
  
## <a name="deploying-the-isolated-shell-application"></a>Развертывание приложения изолированной оболочки  
 Развертывание приложения изолированной оболочки на целевом компьютере, создав проект установки. Необходимо указать следующее:  
  
-   Размещение папки и файлы на целевом компьютере.  
  
-   Условия запуска, которые гарантируют, что платформа .NET Framework и Visual Studio оболочки среды выполнения устанавливаются на конечном компьютере.  
  
 В следующей процедуре необходимо установить на компьютер InstallShield Limited Edition.  
  
#### <a name="to-create-the-setup-project"></a>Создание проекта установки  
  
1.  В **обозревателе решений**, щелкните правой кнопкой мыши узел решения и нажмите кнопку **Добавление нового проекта**.  
  
2.  В **новый проект** диалогового окна разверните **другие типы проектов** , а затем выберите **Установка и развертывание**. Выберите шаблон InstallShield. Имя для нового проекта `MySetup` и нажмите кнопку **ОК**.  
  
3.  Если InstallShield Limited Edition уже установлен, перейдите к следующему шагу.  
  
     Если InstallShield Limited Edition не установлен, появится на странице загрузки InstallShield. Следуйте инструкциям по загрузке и установке продукта, Выбор версии InstallShield, который совместим с версией Visual Studio. Необходимо решить, следует ли зарегистрировать установки InstallShield или использовать его в качестве ознакомительной версии. После завершения установки необходимо перезапустить Visual Studio.  
  
    > [!IMPORTANT]
    >  Перед созданием проекта InstallShield, необходимо запустить Visual Studio с правами администратора. Если этого не сделать, возникнет ошибка при построении проекта.  
  
 Следующие шаги показывают, как настроить проект установки.  
  
> [!IMPORTANT]
>  Убедитесь, что создали конфигурации выпуска проекта изолированной оболочки по крайней мере один раз, прежде чем настраивать проект установки.  
  
#### <a name="to-configure-the-setup-project"></a>Чтобы настроить проект установки  
  
1.  В **обозревателе решений**в разделе **MySetup** проекта, выбор **Project Assistant**. В нижней строке **Project Assistant** окно, выберите **сведения о приложении**. Введите **Fabrikam** как название компании и **редактор музыка Fabrikam** в качестве имени приложения. Нажмите стрелку «вперед» в правом нижнем углу **Project Assistant**.  
  
2.  Выберите **Да** под **в вашем приложении требуется программное обеспечение устанавливается на компьютере?** , а затем выберите **полный пакет Microsoft .NET Framework 4.5**.  
  
3.  Выберите **файлы приложения** , расположенную в нижней части окна и убедитесь, что **редактор музыка Fabrikam** выбрать папку.  
  
4.  Выберите **добавить файлы** кнопки. В **добавить файлы** диалогового окна поле, добавьте следующие файлы из **MyVSShellStub\Release** папки:  
  
    1.  MyVSShellStub.exe.config  
  
    2.  DebuggerProxy.dll  
  
    3.  DebuggerProxy.dll.manifest  
  
    4.  MyVSShellStub.pkgdef  
  
    5.  MyVSShellStub.pkgundef  
  
    6.  MyVSShellStub.winprf  
  
    7.  Splash.bmp  
  
5.  Нажмите кнопку **Добавление выходных элементов проекта** и добавьте **MyVSShellStub-источник выходных данных**. Нажмите кнопку **ОК**.  
  
6.  В левой области в разделе **конечный компьютер**, щелкните правой кнопкой мыши **Fabrikam музыка редактор [INSTALLDIR]** узел и добавьте **новую папку** с именем **расширения**.  
  
7.  Щелкните правой кнопкой мыши **расширения** на левой панели и добавить новую папку с именем **приложения**.  
  
8.  Выберите **приложения** папку и нажмите кнопку **Добавление выходных элементов проекта** , а затем выберите основной выходной файл проекта MyVSShellStub.AboutBoxPackage.  
  
9. Нажмите кнопку **добавить файлы** и из папки \MyVSShellStub\Release\Extensions\Application\ добавьте следующие файлы:  
  
    -   MyVSShellStub.AboutBoxPackage.pkgdef  
  
    -   MyVSShellStub.Application.pkgdef  
  
10. Щелкните правой кнопкой мыши **Fabrikam музыка редактор [INSTALLDIR]** на левой панели и добавить новую папку с именем **1033**.  
  
11. Выберите папку 1033 и нажмите кнопку **Добавление выходных элементов проекта** и выберите основные выходные файлы из проекта MyVSShellStubUI.  
  
12. Переместите **ярлыков** окна.  
  
13. Нажмите кнопку **New** создать ярлык и выберите **\Fabrikam\Fabrikam Music Editor\MyVSShellStub.Primary Output [ProgramFilesFolder]**.  
  
14. Переместите **установки Interview** области.  
  
15. Все элементы **нет**.  
  
16. В **обозревателе решений**, в проекте MySetup откройте **определяют требования и действия установки \ требования**. **Требования** открывается окно.  
  
17. Щелкните правой кнопкой мыши **требования к системе для программного обеспечения** и выберите **создать условие запуска**. **Мастер поиска системы** отображается.  
  
18. В **то, что вы хотите найти?** области, выберите **запись реестра** в раскрывающемся списке и нажмите кнопку **Далее**.  
  
19. В **способ для отображения?** выберите **HKEY_LOCAL_MACHINE** как корневой раздел реестра. Введите **SOFTWARE\Wow6432Node\Microsoft\DevDiv\vs\Servicing\14.0\isoshell** для 64-разрядных системах или **SOFTWARE\Microsoft\DevDiv\vs\Servicing\14.0\isoshell** для 32-разрядных систем и введите **установить** как значение реестра. Нажмите кнопку **Далее**.  
  
20. В **то, что вы хотите использовать выбранное значение?** панели введите **этого продукта требуется Visual Studio 2015 изолированной оболочки распространяемый пакет должен быть установлен.** отображаемый текст и нажмите кнопку **Готово**.  
  
21. Пересоберите решение изолированной оболочки, чтобы создать проект установки.  
  
     Файл setup.exe можно найти в следующей папке:  
  
     \MyVSShellStub\MySetup\MySetup\Express\SingleImage\DiskImages\DISK1  
  
## <a name="testing-the-installation-program"></a>Тестирование программы установки  
 Для проверки установки, скопируйте файл setup.exe на другой компьютер и запустите исполняемый файл программы установки. Можно запустить приложение изолированной оболочки.
