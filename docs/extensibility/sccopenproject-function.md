---
title: "Функция SccOpenProject | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SccOpenProject"
helpviewer_keywords: 
  - "Функция SccOpenProject"
ms.assetid: d609510b-660a-46d7-b93d-2406df20434d
caps.latest.revision: 16
caps.handback.revision: 16
ms.author: "gregvanl"
manager: "ghogen"
---
# Функция SccOpenProject
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Эта функция открывает существующий проект управления источника или создает новую.  
  
## Синтаксис  
  
```cpp#  
SCCRTN SccOpenProject (  
   LPVOID        pvContext,  
   HWND          hWnd,  
   LPSTR         lpUser,  
   LPCSTR        lpProjName,  
   LPCSTR        lpLocalProjPath,  
   LPSTR         lpAuxProjPath,  
   LPCSTR        lpComment,  
   LPTEXTOUTPROC lpTextOutProc,  
   LONG          dwFlags  
);  
```  
  
#### Параметры  
 pvContext  
 \[in\] Структура подключаемого модуля контекста исходного элемента управления.  
  
 hWnd  
 \[in\] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpUser  
 \[in, out\] Имя пользователя \(не должна превышать SCC\_USER\_SIZE, включая символ конца строки NULL\).  
  
 lpProjName  
 \[in\] Строка, определяющая имя проекта.  
  
 lpLocalProjPath  
 \[in\] Путь рабочей папки для проекта.  
  
 lpAuxProjPath  
 \[in, out\] Необязательный дополнительный строка, определяющая проекта \(не должна превышать SCC\_AUXPATH\_SIZE, включая символ конца строки NULL\).  
  
 lpComment  
 \[in\] Комментарий в новый проект, который создается.  
  
 lpTextOutProc  
 \[in\] Необязательная функция обратного вызова для отображения вывода из подключаемого модуля системы управления версиями.  
  
 dwFlags  
 \[in\] Сигналы ли новый проект необходимо создать проект неизвестно источника элемент управления подключаемого модуля. Значение может быть сочетанием `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN.`  
  
## Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|--------------|--------------|  
|SCC\_OK|Успех при открытии проекта.|  
|SCC\_E\_INITIALIZEFAILED|Не удалось инициализировать проект.|  
|SCC\_E\_INVALIDUSER|Пользователь не может войти систему управления версиями.|  
|SCC\_E\_COULDNOTCREATEPROJECT|Проект не существует до вызова метода; `SCC_OPT_CREATEIFNEW` был установлен флаг, но не удалось создать проект.|  
|SCC\_E\_PROJSYNTAXERR|Проект недопустимый синтаксис.|  
|SCC\_E\_UNKNOWNPROJECT|Проект неизвестен подключаемого модуля системы управления версиями и `SCC_OPT_CREATEIFNEW` не установлен флаг.|  
|SCC\_E\_INVALIDFILEPATH|Путь к файлу недопустим или непригодным для использования.|  
|SCC\_E\_NOTAUTHORIZED|Для выполнения этой операции не разрешено пользователю.|  
|SCC\_E\_ACCESSFAILURE|Произошла ошибка при доступе к системе управления версиями, вероятно, из\-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC\_E\_NONSPECFICERROR|Неспецифическая ошибка; Система управления версиями не инициализирован.|  
  
## Заметки  
 IDE может передать имя пользователя \(`lpUser`\), или он может просто передать указатель на пустую строку. Если имя пользователя, подключаемый модуль системы управления версиями следует использовать как значение по умолчанию. Тем не менее, если имя не было передано, или не удалось выполнить вход с заданным именем, подключаемый модуль должен предлагать пользователю вход и будет возвращать допустимое имя в `lpUser` при получении действительного имени входа`.` так как подключаемый модуль может изменяться строка имени пользователя, IDE всегда будет выделить буфер размером \(`SCC_USER_LEN`\+ 1 или SCC\_USER\_SIZE, который включает места для завершающего символа null\).  
  
> [!NOTE]
>  Первое действие в Интегрированной среде разработки, может потребоваться для выполнения может быть вызов `SccOpenProject` функции или [SccGetProjPath](../extensibility/sccgetprojpath-function.md). По этой причине у них одинаковые `lpUser` параметр.  
  
 `lpAuxProjPath` и`lpProjName` считываются из файла решения, или они возвращаются из вызова `SccGetProjPath` функции. Эти параметры содержат строки, подключаемый модуль системы управления версиями связывает с проектом и имеют смысл только в подключаемый модуль. Если отсутствуют такие строки в файле решения и пользователь не имеет было предложено перейти \(вернет строку через `SccGetProjPath` функции\), Интегрированной передает пустые строки как `lpAuxProjPath` и `lpProjName`, и ожидает обновления подключаемым модулем, когда эта функция возвращает эти значения.  
  
 `lpTextOutProc` — указатель на функцию обратного вызова, предоставляемых IDE для подключаемого модуля в целях отображения выходной результат команды системы управления версиями. Эта функция обратного вызова подробно описывается в [LPTEXTOUTPROC](../extensibility/lptextoutproc.md).  
  
> [!NOTE]
>  Если подключаемый модуль системы управления версиями собирается этих преимуществ, его необходимо установить `SCC_CAP_TEXTOUT` флаг в [SccInitialize](../extensibility/sccinitialize-function.md). Если этот флаг не установлен или Интегрированной среде разработки не поддерживает эту функцию, `lpTextOutProc` будет `NULL`.  
  
 `dwFlags` Параметр определяет результат в том случае, если проекта, открытого в данный момент не существует. Он состоит из двух битовые флаги, `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN`. Если проект уже открыта существует, функция просто открывает проект и возвращает `SCC_OK`. Если проект не существует и `SCC_OP_CREATEIFNEW` флаг установлен, подключаемый модуль системы управления версиями можно создать проект в системе управления версиями, открыть его и возвратить `SCC_OK`. Если проект не существует, а `SCC_OP_CREATEIFNEW` флаг имеет значение off, подключаемый модуль должен проверять `SCC_OP_SILENTOPEN` флаг. Если этот флаг не включено, подключаемый модуль может запросить у пользователя имя проекта. Если этот флаг установлен в, подключаемый модуль должен просто возвращает `SCC_E_UNKNOWNPROJECT`.  
  
## Порядок вызова  
 В обычных событий [SccInitialize](../extensibility/sccinitialize-function.md) будет вызываться сначала открыть сеанс управления источника. Сеанс может состоять из вызова `SccOpenProject`, следуют другие вызовы функций API подключаемого модуля управления источника и будет завершена с помощью вызова [SccCloseProject](../extensibility/scccloseproject-function.md). Такие сеансы могут повторяться несколько раз, прежде чем [SccUninitialize](../extensibility/sccuninitialize-function.md) вызывается.  
  
 Если наборы подключаемого модуля управления версиями `SCC_CAP_REENTRANT` бит в `SccInitialize`, а затем выше последовательности сеанса может повторяться много раз параллельно. Различные `pvContext` структуры отслеживания сеансов, в котором каждый `pvContext` связан с одним открытым проектом одновременно. На основе`pvContext` параметра, подключаемый модуль можно определить, какой проект упоминается в любой определенный вызов. Если бит возможность `SCC_CAP_REENTRANT` не задано, nonreentrant подключаемых модулей системы управления версиями имели ограниченные возможности для работы с несколькими проектами.  
  
> [!NOTE]
>  `SCC_CAP_REENTRANT` Бит появилась в версии 1.1 API подключаемого модуля управления источника. Он не установлен или обрабатывается в версии 1.0, а все версии 1.0 источника подключаемые модули управления считаются nonreentrant.  
  
## См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [SccCloseProject](../extensibility/scccloseproject-function.md)   
 [SccGetProjPath](../extensibility/sccgetprojpath-function.md)   
 [SccInitialize](../extensibility/sccinitialize-function.md)   
 [SccUninitialize](../extensibility/sccuninitialize-function.md)   
 [Ограничения длины строки](../extensibility/restrictions-on-string-lengths.md)   
 [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)