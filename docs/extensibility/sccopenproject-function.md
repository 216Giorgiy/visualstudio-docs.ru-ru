---
title: "Функция SccOpenProject | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords: SccOpenProject
helpviewer_keywords: SccOpenProject function
ms.assetid: d609510b-660a-46d7-b93d-2406df20434d
caps.latest.revision: "16"
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.openlocfilehash: 734d61b4fade0775c5e017a85fa5364779bc567b
ms.sourcegitcommit: f40311056ea0b4677efcca74a285dbb0ce0e7974
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/31/2017
---
# <a name="sccopenproject-function"></a>Функция SccOpenProject
Эта функция открывает существующий проект элемента управления источника или создает новый.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
SCCRTN SccOpenProject (  
   LPVOID        pvContext,  
   HWND          hWnd,  
   LPSTR         lpUser,  
   LPCSTR        lpProjName,  
   LPCSTR        lpLocalProjPath,  
   LPSTR         lpAuxProjPath,  
   LPCSTR        lpComment,  
   LPTEXTOUTPROC lpTextOutProc,  
   LONG          dwFlags  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Исходная структура подключаемого модуля контекста элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpUser  
 [in, out] Имя пользователя (не должна превышать SCC_USER_SIZE, включая символ конца строки).  
  
 lpProjName  
 [in] Строка, определяющая имя проекта.  
  
 lpLocalProjPath  
 [in] Путь рабочей папки для проекта.  
  
 lpAuxProjPath  
 [in, out] Необязательный дополнительный строка, определяющая проекта (не должна превышать SCC_AUXPATH_SIZE, включая символ конца строки).  
  
 lpComment  
 [in] Комментарий в новый проект, который находится в процессе создания.  
  
 lpTextOutProc  
 [in] Необязательная функция обратного вызова для отображения текста в выходных данных из системы управления версиями.  
  
 dwFlags  
 [in] Сигналы ли нового проекта должна быть создана, если проект является неизвестным источником управления подключаемого модуля. Значение может представлять собой сочетание `SCC_OP_CREATEIFNEW` и`SCC_OP_SILENTOPEN.`  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализация подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|-----------|-----------------|  
|SCC_OK|Успех при открытии проекта.|  
|SCC_E_INITIALIZEFAILED|Не удается инициализировать проект.|  
|SCC_E_INVALIDUSER|Пользователь не может войти систему управления версиями.|  
|SCC_E_COULDNOTCREATEPROJECT|Проект не существует до вызова метода;  `SCC_OPT_CREATEIFNEW` был установлен флаг, но не удалось создать проект.|  
|SCC_E_PROJSYNTAXERR|Проект недопустимый синтаксис.|  
|SCC_E_UNKNOWNPROJECT|Проект неизвестен подключаемый модуль системы управления версиями и `SCC_OPT_CREATEIFNEW` не установлен флаг.|  
|SCC_E_INVALIDFILEPATH|Путь к файлу недопустим или недоступным для использования.|  
|SCC_E_NOTAUTHORIZED|Для выполнения этой операции не разрешено пользователю.|  
|SCC_E_ACCESSFAILURE|Возникла проблема с доступом к системе управления версиями, возможно, из-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC_E_NONSPECFICERROR|Неспецифичную сбоя; Система управления версиями не был инициализирован.|  
  
## <a name="remarks"></a>Примечания  
 Интегрированная среда разработки может передавать в имя пользователя (`lpUser`), или он может просто передать указатель на пустую строку. Если имя пользователя, подключаемый модуль системы управления версиями следует использовать как значение по умолчанию. Тем не менее, если имя не было передано, или Ошибка входа в систему с заданным именем, подключаемый модуль должен предлагать пользователю входить в систему и будет возвращать допустимое имя в `lpUser` при получении действительного имени входа`.` так, как подключаемый модуль может изменить строку имени пользователя , интегрированной среды разработки всегда будет выделить буфер размером (`SCC_USER_LEN`+ 1 или SCC_USER_SIZE, который включает место для завершающего нуль-символа).  
  
> [!NOTE]
>  Первое действие для выполнения может потребоваться интегрированной среды разработки может быть вызов `SccOpenProject` функции или [SccGetProjPath](../extensibility/sccgetprojpath-function.md). По этой причине у них одинаковые `lpUser` параметра.  
  
 `lpAuxProjPath`и`lpProjName` считываются из файла решения, или они будут возвращены в результате вызова `SccGetProjPath` функции. Эти параметры содержат строки, которые подключаемый модуль системы управления версиями связывает с проектом и имеют смысл только в подключаемый модуль. Если строки отсутствуют в файле решения и пользователь не имеет было предложено перейти (вернет строки с помощью `SccGetProjPath` функции), интегрированной среды разработки передает пустые строки как `lpAuxProjPath` и `lpProjName`и ожидает обновлять эти значения Если подключаемый модуль возвращает эта функция.  
  
 `lpTextOutProc`является указателем на функцию обратного вызова, предоставляемые интегрированной среды разработки в систему управления версиями подключаемого модуля в целях отображения выходных данных команды. Эта функция обратного вызова подробно описывается в [LPTEXTOUTPROC](../extensibility/lptextoutproc.md).  
  
> [!NOTE]
>  Если подключаемый модуль системы управления версиями Защищаемая использования этой возможности, его необходимо установить `SCC_CAP_TEXTOUT` флаг в [SccInitialize](../extensibility/sccinitialize-function.md). Если этот флаг не задан или если интегрированной среды разработки не поддерживает эту функцию, `lpTextOutProc` будет `NULL`.  
  
 `dwFlags` Параметр определяет результат, если открыть проект в настоящее время не существует. Он состоит из двух битовые флаги, `SCC_OP_CREATEIFNEW` и `SCC_OP_SILENTOPEN`. Если проект уже открыта существует, функция просто открывает проект и возвращает `SCC_OK`. Если проект не существует и если `SCC_OP_CREATEIFNEW` флаг установлен, подключаемый модуль системы управления версиями можно создать проект в системе управления версиями, откройте его и вернуть `SCC_OK`. Если проект не существует и если `SCC_OP_CREATEIFNEW` флаг имеет значение off, подключаемый модуль следует проверить для `SCC_OP_SILENTOPEN` флаг. Если этот флаг не на, подключаемый модуль может запрашивать у пользователя имя проекта. Если этот флаг включен, подключаемый модуль должен возвращать `SCC_E_UNKNOWNPROJECT`.  
  
## <a name="calling-order"></a>Порядок вызова метода  
 Во время обычной событий [SccInitialize](../extensibility/sccinitialize-function.md) будет вызываться сначала открыть сеанс управления источника. Сеанс может состоять из вызова `SccOpenProject`, следуют другие вызовы функций API подключаемых модулей для управления источника и будет завершена с вызов [SccCloseProject](../extensibility/scccloseproject-function.md). Такие сеансы могут повторяться несколько раз, прежде чем [SccUninitialize](../extensibility/sccuninitialize-function.md) вызывается.  
  
 Если наборы подключаемый модуль системы управления версиями `SCC_CAP_REENTRANT` бит в `SccInitialize`, то сеанс порядок операций может повторяться много раз в параллельном режиме. Различные `pvContext` структуры отслеживания различных сеансов, в котором каждый `pvContext` связан с одним открытым проектом одновременно. На основе`pvContext` параметр подключаемого модуля можно определить, какой проект ссылается на любой определенный вызов. Если бит возможность `SCC_CAP_REENTRANT` не задано, nonreentrant подключаемые модули управления версиями ограниченные возможности для работы с несколькими проектами.  
  
> [!NOTE]
>  `SCC_CAP_REENTRANT` Бит появилась в версии 1.1 API подключаемых модулей управления источника. Он не задан или обрабатывается в версии 1.0, и все версии 1.0 источника подключаемые модули управления считаются nonreentrant.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [SccCloseProject](../extensibility/scccloseproject-function.md)   
 [SccGetProjPath](../extensibility/sccgetprojpath-function.md)   
 [SccInitialize](../extensibility/sccinitialize-function.md)   
 [SccUninitialize](../extensibility/sccuninitialize-function.md)   
 [Ограничения длины строки](../extensibility/restrictions-on-string-lengths.md)   
 [LPTEXTOUTPROC](../extensibility/lptextoutproc.md)