---
title: "Управление сопоставлениями файлов Side-by-Side | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "команды, используемые по умолчанию"
ms.assetid: 9b6df3bc-d15c-4a5d-9015-948a806193b7
caps.latest.revision: 17
caps.handback.revision: 17
ms.author: "gregvanl"
manager: "ghogen"
---
# Управление сопоставлениями файлов Side-by-Side
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Если в VSPackage предоставляет ассоциации файлов, то необходимо решить, как обрабатывать параллельные установки, в которых указанная версия [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] действия, чтобы открыть файл.  Несовместимые форматы файлов смешивают проблему.  
  
 Пользователи ожидают новую версию продукта для совместимости с предыдущими версиями, так что существующие файлы можно загрузить в новой версии без потери данных.  В идеале в VSPackage может и загрузки и сохранения форматы файлов предыдущих версий.  Если это не так, то необходимо предложить обновление формат файла до новой версии вашего VSPackage.  Оборотная сторона к этому подходу, что обновленный файл невозможно открыть в версии.  
  
 Чтобы избежать этой проблемы, можно изменить расширения при форматы файлов будут несовместимыми.  Например, версия 1 в VSPackage может использоваться расширение, .mypkg10 и версии 2 может использовать расширение, .mypkg20.  Это различие определяет VSPackage, которое открывается указанный файл.  При добавлении более новое VSPackages в список программ, которые связаны с прежним расширением, пользователи могут нажать правой кнопкой мыши файл и выбрать, чтобы открыть его в более новом VSPackage.  На этом этапе в VSPackage может предложить обновление файла до нового формата или открытия файла и поддерживать совместимость с более ранними версиями VSPackage.  
  
> [!NOTE]
>  Можно сочетать эти подходы.  Например, можно обеспечить обратную совместимость, загрузив более старый файл и предложить обновление формат файла, когда пользователь сохраняет его.  
  
## Поиск в проблему  
 Если требуется несколько параллельное VSPackages использовать одинаковое расширение, то нужно выбрать версия [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] это связано с расширением.  Здесь варианта: 2  
  
-   Открытие файла в последней версии [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] устанавливается на компьютере пользователя.  
  
     В этом подходе, установщик отвечает за определение последней версии [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] в том числе то в записи реестра и написанной для ассоциации файлов.  В пакете установщика Windows можно включить настраиваемые действия задать свойство которого указывает последнюю версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].  
  
    > [!NOTE]
    >  В данном контексте "является более высокое" означает "последнюю версию, поддерживаемую". Эти записи установщика автоматически не обнаруживает последующий выпуск [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].  Записи в пределах [Определение требований к системе](../extensibility/internals/detecting-system-requirements.md) и in  [Команды, которые необходимо выполнить после установки](../extensibility/internals/commands-that-must-be-run-after-installation.md) схожи с одним представленным здесь необходимы, а для поддержки дополнительных версий  [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].  
  
     Следующие строки в таблице CustomAction задать свойство DEVENV\_EXE\_LATEST, чтобы установить свойства таблицами и RegLocator обсуженными в AppSearch [Команды, которые необходимо выполнить после установки](../extensibility/internals/commands-that-must-be-run-after-installation.md).  Строки в таблице InstallExecuteSequence планирующие настраиваемые действия в начале последовательности выполнения.  Значения в столбце критерий выполняют логики:  
  
    -   Visual Studio .NET 2002 последнюю версию, если линия присутствующая версия.  
  
    -   Visual Studio .NET 2003 последняя версия, только если оно присутствует, а [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] отсутствует.  
  
    -   [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] последняя версия, если линия присутствующая версия.  
  
     Чистый результат, что DEVENV\_EXE\_LATEST содержит путь к последней версии devenv.exe.  
  
    ### CustomAction, определяющих строки таблицы последнюю версию Visual Studio  
  
    |Действие|Тип|Исходный код|Целевой объект|  
    |--------------|---------|------------------|--------------------|  
    |CA\_SetDevenvLatest\_2002|51|DEVENV\_EXE\_LATEST|\[DEVENV\_EXE\_2002\]|  
    |CA\_SetDevenvLatest\_2003|51|DEVENV\_EXE\_LATEST|\[DEVENV\_EXE\_2003\]|  
    |CA\_SetDevenvLatest\_2005|51|DEVENV\_EXE\_LATEST|\[DEVENV\_EXE\_2005\]|  
  
    ### Строки таблицы InstallExecuteSequence, которые определяют последнюю версию Visual Studio  
  
    |Действие|Атрибут Condition|Последовательность|  
    |--------------|-----------------------|------------------------|  
    |CA\_SetDevenvLatest\_2002|DEVENV\_EXE\_2002 И NOT \(DEVENV\_EXE\_2003 ИЛИ DEVENV\_EXE\_2005\)|410|  
    |CA\_SetDevenvLatest\_2003|DEVENV\_EXE\_2003 И НЕ DEVENV\_EXE\_2005|420|  
    |CA\_SetDevenvLatest\_2005|DEVENV\_EXE\_2005|430|  
  
     Можно использовать свойство DEVENV\_EXE\_LATEST в таблице реестра пакета установщика Windows для записи HKEY\_CLASSES\_ROOT \\*Идентификатор ProgId*\\ Значение по умолчанию командной клавиши оболочки \\ \\\], \[DEVENV\_EXE\_LATEST открыть "%1 "  
  
-   Запустите общая программа запуска, которая может сделать наилучший выбор из доступных версий VSPackage.  
  
     Разработчики  [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] выбрать такой подход для обработки сложных требований нескольких форматов решений и проектов этот результат из нескольких версий  [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].  В этом подходе регистрации программа запуска как обработчик расширений.  Кнопка вызова проверяет файл и решает которой версии [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] и в VSPackage может обрабатывать этого указанный файл.  Например, если пользователь открывает файл последнего сохранения указанной версией в VSPackage кнопка вызова может запустить то VSPackage в соответствующей версии [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].  Кроме того, пользователь может настроить кнопка вызова всегда запускается более поздней версии.  Кнопка вызова спросить у пользователя также может обновлять формат файла.  Если формат файла содержит номер версии, то кнопка вызова может информировать пользователей, если формат файла от версии, которая больше чем одно или несколько устанавливается VSPackages.  
  
     Кнопка вызова должна находиться в компоненте установщика Windows, совместно используемый всеми версиями в VSPackage.  Этот процесс обеспечивает более поздней версии всегда устанавливается и не будет удален до тех пор, пока не будут удалены все версии вашего VSPackage.  Таким образом, сохраняются ассоциации файлов и другие записи реестра компонента запуска, даже если удалена одна версия VSPackage.  
  
## Удалите и ассоциации файлов  
 Удаление VSPackage, который записывает записи реестра для ассоциаций файлов удаляет ассоциации файлов.  Поэтому модуль не имеет связанных программы.  Установщик Windows "не восстанавливается" записей реестра, которые были добавлены, когда VSPackage был установлен.  Ниже приведены некоторые способы устранения ассоциации файла пользователя:  
  
-   Используйте общий компонент запуска, как описано выше.  
  
-   Проинструктируйте пользователь выполнить восстановление версии VSPackage, пользователь хочет, чтобы иметь ассоциацию файла.  
  
-   Убедитесь в отдельном исполнительную программу, перезаписывает соответствующих записей реестра.  
  
-   Проверьте параметры конфигурации страницу или диалоговое окно, позволяющие пользователям выбирать ассоциации файлов и исправить потерянные ассоциации.  Проинструктируйте пользователям запускать после удаления.  
  
## См. также  
 [Регистрация расширений файлов для развертываний Side\-By\-Side](../extensibility/registering-file-name-extensions-for-side-by-side-deployments.md)   
 [Регистрация команды для расширений имен файлов](../extensibility/registering-verbs-for-file-name-extensions.md)