---
title: Управление сопоставлениями файлов Side-by-Side | Документы Microsoft
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- vs-ide-sdk
ms.topic: conceptual
helpviewer_keywords:
- verbs, setting default
ms.assetid: 9b6df3bc-d15c-4a5d-9015-948a806193b7
author: gregvanl
ms.author: gregvanl
manager: douge
ms.workload:
- vssdk
ms.openlocfilehash: e9144125786e7aa5f2a70823a033d49ac3fa2990
ms.sourcegitcommit: 6a9d5bd75e50947659fd6c837111a6a547884e2a
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/16/2018
---
# <a name="managing-side-by-side-file-associations"></a>Управление сопоставлениями файлов Side-by-Side
Если VSPackage предоставляет сопоставления файлов, необходимо решить, как обрабатывать side-by-side установок, в котором на конкретную версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] нужно вызывать для открытия файла. Несовместимые форматы файлов составного проблему.  
  
 Пользователи ожидают, что новая версия продукта для обеспечения совместимости с более ранними версиями, чтобы существующие файлы могут загружаться в новой версии без потери данных. В идеальном случае VSPackage можно загрузить и сохранить в форматах, более ранних версий. Если это значение равно true, должны обеспечивать обновление до новой версии вашего VSPackage формат файла. Недостатком этого подхода является то, что обновленный файл невозможно открыть в более ранней версии.  
  
 Чтобы избежать этой проблемы, можно изменить расширения мере несовместимые форматы файлов. Например, использовать версии 1 пакета VSPackage расширения, .mypkg10 и версии 2 может использовать расширение .mypkg20. Это различие определяет пакет VSPackage, который открывает конкретного файла. При добавлении более новые пакеты VSPackage в список программ, которые связаны со старым расширением, пользователи щелкните правой кнопкой мыши файл и затем выберите и откройте его в новой VSPackage. На этом этапе VSPackage может предложить обновления файла в новый формат или откройте файл и поддерживать совместимость с предыдущими версиями пакета VSPackage.  
  
> [!NOTE]
>  Можно объединять эти подходы. Например можно предлагать обратной совместимости, загрузив старый файл и предлагать обновить формат файла, когда пользователь сохраняет его.  
  
## <a name="facing-the-problem"></a>Проблемы с выходом  
 Если требуется несколько пакетов VSPackage side-by-side использовать то же самое расширение, необходимо выбрать версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] , связанном с расширением. Ниже приведены два варианта.  
  
-   Откройте файл в последнюю версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] установлен на компьютере пользователя.  
  
     При таком подходе установщик отвечает за определение последнюю версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] включительно, в записи реестра для сопоставления файлов. В пакет установщика Windows можно включить настраиваемые действия, чтобы задать свойство, указывающее последнюю версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].  
  
    > [!NOTE]
    >  В этом контексте «последнюю» означает «последнюю поддерживаемую версию.» Эти записи установщик не может автоматически определить последующих выпусков [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]. Записи в [требования к системе для обнаружения](../extensibility/internals/detecting-system-requirements.md) и [команды, необходимо будет выполнить после завершения установки](../extensibility/internals/commands-that-must-be-run-after-installation.md) похожи на те, представленной здесь и необходимы для поддержки дополнительных версий [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)].  
  
     Следующие строки в таблице настраиваемое действие установить свойство DEVENV_EXE_LATEST как свойство, задаваемое AppSearch и RegLocator таблицы подробно [команды, необходимо будет выполнить после завершения установки](../extensibility/internals/commands-that-must-be-run-after-installation.md). Строки в таблице InstallExecuteSequence запланировать пользовательские действия в начале последовательности execute. Значения столбца условие сделать логику работы:  
  
    -   Visual Studio .NET 2002 — это последняя версия, если он присутствует только в версии.  
  
    -   Visual Studio .NET 2003 — это последняя версия, только в том случае, если он присутствует и [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] отсутствует.  
  
    -   [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] Если присутствует только версия является последней версией.  
  
     Конечным результатом становится, DEVENV_EXE_LATEST содержит путь к последней версии программы devenv.exe.  
  
    ### <a name="customaction-table-rows-that-determine-the-latest-version-of-visual-studio"></a>Настраиваемое действие строк таблицы, которые определяют последнюю версию Visual Studio  
  
    |Действие|Тип|Исходный код|целевого объекта|  
    |------------|----------|------------|------------|  
    |CA_SetDevenvLatest_2002|51|DEVENV_EXE_LATEST|[DEVENV_EXE_2002]|  
    |CA_SetDevenvLatest_2003|51|DEVENV_EXE_LATEST|[DEVENV_EXE_2003]|  
    |CA_SetDevenvLatest_2005|51|DEVENV_EXE_LATEST|[DEVENV_EXE_2005]|  
  
    ### <a name="installexecutesequence-table-rows-that-determine-the-latest-version-of-visual-studio"></a>InstallExecuteSequence строк таблицы, которые определяют последнюю версию Visual Studio  
  
    |Действие|Условие|Sequence|  
    |------------|---------------|--------------|  
    |CA_SetDevenvLatest_2002|DEVENV_EXE_2002 AND NOT (DEVENV_EXE_2003 ИЛИ DEVENV_EXE_2005)|410|  
    |CA_SetDevenvLatest_2003|DEVENV_EXE_2003 И НЕ DEVENV_EXE_2005|420|  
    |CA_SetDevenvLatest_2005|DEVENV_EXE_2005|430|  
  
     Свойство DEVENV_EXE_LATEST таблицы реестра пакета установщика Windows используется для записи HKEY_CLASSES_ROOT*ProgId*ShellOpenCommand ключ по умолчанию, [DEVENV_EXE_LATEST] «%1»  
  
-   Запустите программу общего запуска, можно выбрать наиболее подходящую из доступных версий пакета VSPackage.  
  
     Разработчики [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] подходу из нескольких форматов решений и проектов, которые являются результатом многих версиях операционной системы сложные требования к обработке [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]. При таком подходе регистрации программы запуска в качестве обработчика расширений. Средство запуска проверяет файл и решает, какую версию [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)] и VSPackage может обрабатывать конкретного файла. Например, если пользователь открывает файл, который был сохранен на конкретную версию VSPackage, средство запуска можно запустить, VSPackage в соответствующей версии [!INCLUDE[vsprvs](../code-quality/includes/vsprvs_md.md)]. Кроме того пользователь может настроить средство запуска всегда запускается последняя версия. Средство запуска также может запрашивать у пользователя, чтобы обновить формат файла. Если формат файла включает номер версии, средство запуска может уведомляет пользователя, если формат файла — из версии, которая является более поздней, чем один или несколько установленных пакетов VSPackage.  
  
     Средство запуска должен находиться в компонент установщика Windows, которая совместно со всеми версиями VSPackage. Этот процесс гарантирует, что последняя версия всегда устанавливается и не удаляется, пока удаляются все версии пакета VSPackage. Таким образом сопоставления файлов и другим записям реестра запуска компонента сохраняются даже в случае удаления одной версии пакета VSPackage.  
  
## <a name="uninstall-and-file-associations"></a>Удалите и сопоставлений файлов  
 При удалении пакет VSPackage, который записывает записи реестра для сопоставления файлов удаляет сопоставления файлов. Таким образом у расширения есть нет связанных программ. Установщик Windows не «recover» записи реестра, которые были добавлены при установке VSPackage. Ниже приведены некоторые способы исправления сопоставление файлов:  
  
-   Использование компонента общего запуска как описано выше.  
  
-   Пользователь должен запустить восстановление версии VSPackage, который пользователь хочет владельцем сопоставления файлов.  
  
-   Укажите отдельные исполняемой программы, которая перезапишет соответствующие записи в реестр.  
  
-   Укажите параметры страницы или диалогового окна появляется конфигурации, позволяющий пользователям выбрать сопоставления файлов и освобождение потери связи. Поручить пользователям выполнить его после удаления.  
  
## <a name="see-also"></a>См. также  
 [Регистрация расширения имен файлов для развертываний Side-By-Side](../extensibility/registering-file-name-extensions-for-side-by-side-deployments.md)   
 [Регистрация команд для расширений имен файлов](../extensibility/registering-verbs-for-file-name-extensions.md)