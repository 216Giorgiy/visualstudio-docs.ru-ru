---
title: "Функция SccAdd | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SccAdd"
helpviewer_keywords: 
  - "Функция SccAdd"
ms.assetid: 545268f3-8e83-446a-a398-1a9db9e866e8
caps.latest.revision: 17
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 17
---
# Функция SccAdd
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Эта функция добавляет новые файлы системы управления версиями.  
  
## Синтаксис  
  
```cpp#  
SCCRTN SccAdd(  
   LPVOID    pvContext,  
   HWND      hWnd,  
   LONG      nFiles,  
   LPCSTR*   lpFileNames,  
   LPCSTR    lpComment,  
   LONG*     pfOptions,  
   LPCMDOPTS pvOptions  
);  
```  
  
#### Параметры  
 pvContext  
 \[in\] Структура подключаемого модуля контекста исходного элемента управления.  
  
 hWnd  
 \[in\] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 nFiles  
 \[in\] Число файлов, выбранных для добавления в текущий проект, как оно указано в `lpFileNames` массива.  
  
 lpFileNames  
 \[in\] Массив полных имен локальных файлов для добавления.  
  
 lpComment  
 \[in\] Комментарий, который применяется для всех файлов, для добавления.  
  
 pfOptions  
 \[in\] Массив из командной строки на каждого файла.  
  
 pvOptions  
 \[in\] Параметры конкретного подключаемого модуля системы управления версиями.  
  
## Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|--------------|--------------|  
|SCC\_OK|Добавить операция выполнена успешно.|  
|SCC\_E\_FILEALREADYEXISTS|Указанный файл уже существует в системе управления версиями.|  
|SCC\_E\_TYPENOTSUPPORTED|Тип файла \(например, двоичные\), системы управления версиями не поддерживается.|  
|SCC\_E\_OPNOTSUPPORTED|Система управления версиями не поддерживает эту операцию.|  
|SCC\_E\_ACCESSFAILURE|Произошла ошибка при доступе к системе управления версиями, вероятно, из\-за проблемы с сетью или конфликтов. Рекомендуется повторить операцию.|  
|SCC\_E\_NOTAUTHORIZED|Для выполнения этой операции не разрешено пользователю.|  
|SCC\_E\_NONSPECIFICERROR|Неспецифическая ошибка; Добавление не выполняется.|  
|SCC\_I\_OPERATIONCANCELED|Операция была отменена до завершения.|  
|SCC\_I\_RELOADFILE|Файл или проект должен быть перезагружен.|  
|SCC\_E\_FILENOTEXIST|Локальный файл не найден.|  
  
## Заметки  
 Обычные `fOptions` здесь заменяются массивом, `pfOptions`, с одним `LONG` параметр спецификации каждого файла. Это потому, что тип файла зависит от файла к файлу.  
  
> [!NOTE]
>  Нельзя указать оба `SCC_FILETYPE_TEXT` и `SCC_FILETYPE_BINARY` Параметры для одного файла, но не указывать ни одного. Задание не является таким же, как параметр `SCC_FILETYPE_AUTO`, в этом случае подключаемый модуль autodetects тип файлов управления версиями.  
  
 Ниже приведен список флагов, используемых в `pfOptions` массива:  
  
|Параметр|Значение|Смысл|  
|--------------|--------------|-----------|  
|SCC\_FILETYPE\_AUTO|0x00|Подключаемый модуль системы управления версиями следует определить тип файла.|  
|SCC\_FILETYPE\_TEXT|0x01|Указывает текстовый файл ASCII.|  
|SCC\_FILETYPE\_BINARY|0x02|Указывает тип файла, кроме текста ASCII.|  
|SCC\_ADD\_STORELATEST|0x04|Сохраняет последнюю копию файла, а не разности.|  
|SCC\_FILETYPE\_TEXT\_ANSI|0x08|Обрабатывает файл как текст ANSI.|  
|SCC\_FILETYPE\_UTF8|0x10|Обрабатывает файл как текст в Юникоде в формат UTF8.|  
|SCC\_FILETYPE\_UTF16LE|0x20|Обрабатывает файл как текст в кодировке Юникод в UTF16 Little Endian формата.|  
|SCC\_FILETYPE\_UTF16BE|0x40|Обрабатывает файл как текст в кодировке Юникод в UTF16 Big Endian формате.|  
  
## См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)