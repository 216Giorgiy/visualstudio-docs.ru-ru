---
title: "Функция SccAddFromScc | Microsoft Docs"
ms.custom: ""
ms.date: "12/05/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "SccAddFromScc"
helpviewer_keywords: 
  - "Функция SccAddFromScc"
ms.assetid: 902e764d-200e-46e1-8c42-4da7b037f9a0
caps.latest.revision: 17
caps.handback.revision: 17
ms.author: "gregvanl"
manager: "ghogen"
---
# Функция SccAddFromScc
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Эта функция позволяет пользователю выполнять поиск файлов, находящихся в системе управления версиями и впоследствии включить эти файлы текущего проекта. Например эту функцию можно получить общий файл заголовка в текущий проект без копирования файла. Возвращаемый массив файлов, `lplpFileNames`, содержащий список файлов, которые пользователь хочет добавить в проект в интегрированной среде разработки.  
  
## Синтаксис  
  
```cpp#  
SCCRTN SccAddFromScc (  
   LPVOID   pvContext,  
   HWND     hWnd,  
   LPLONG   lpnFiles,  
   LPCSTR** lplpFileNames  
);  
```  
  
#### Параметры  
 pvContext  
 \[in\] Структура подключаемого модуля контекста исходного элемента управления.  
  
 hWnd  
 \[in\] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpnFiles  
 \[in, out\] Число файлов, которые добавляются в буфер. \(Это `NULL` Если объем памяти, на который указывает `lplpFileNames` требуется выпустить. Подробнее см. примечания.\)  
  
 lplpFileNames  
 \[in, out\] Массив указателей на все имена файлов без пути к каталогам. Этот массив выделяется и освобождается при подключаемый модуль системы управления версиями. Если `lpnFiles` \= 1 и `lplpFileNames` не `NULL`, имя массива, на который указывает `lplpFileNames` содержит папку назначения.  
  
## Возвращаемое значение  
 Реализации подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание|  
|--------------|--------------|  
|SCC\_OK|Файлы были успешно находятся и добавлен в проект.|  
|SCC\_I\_OPERATIONCANCELED|Операция была отменена не оказывает влияния.|  
|SCC\_I\_RELOADFILE|Файл или проект должен быть перезагружен.|  
  
## Заметки  
 Вызывает данную функцию, интегрированной среды разработки. Если подключаемый модуль системы управления версиями поддерживает указание локальную целевую папку, передает IDE `lpnFiles` \= 1 и передает имя локальной папки в `lplpFileNames`.  
  
 При вызов `SccAddFromScc` функция возвращает подключаемый модуль назначил значения `lpnFiles` и `lplpFileNames`, выделение памяти для массива имя файла, при необходимости \(Обратите внимание, что такое распределение заменяет указатель в `lplpFileNames`\). Подключаемый модуль системы управления версиями отвечает за размещение всех файлов в каталоге пользователя или в папке, указанной категории. Затем интегрированная среда разработки добавляет файлы проекта интегрированной среды разработки.  
  
 Наконец, IDE вызывает данную функцию, второй раз, передавая `NULL` для `lpnFiles`. Это значение интерпретируется как специальный сигнал системой управления версиями, подключаемый модуль для освобождения памяти, выделенной для массива имен файлов в `lplpFileNames``.`  
  
 `lplpFileNames` — `char ***` указателя. Подключаемый модуль системы управления версиями помещает указатель на массив указателей на имена файлов, таким образом передавая список стандартным способом для этого API.  
  
> [!NOTE]
>  Первоначальной версии VSSCI API не принес способ указания целевого проекта для добавленных файлов. С учетом этой семантику `lplpFIleNames` параметра были улучшены, чтобы сделать его параметром, а не в выходной параметр. Если только один файл указан, то есть значение указывает `lpnFiles` \= 1, то первый элемент `lplpFileNames` содержит целевую папку. Для использования этих новую семантику вызовов IDE `SccSetOption` работать с `nOption`параметра `SCC_OPT_SHARESUBPROJ`. Если подключаемый модуль системы управления версиями не поддерживает семантику, она возвращает `SCC_E_OPTNOTSUPPORTED`. Это так отключает использование **Добавить из системы управления версиями** функции. Если подключаемый модуль поддерживает **Добавить из системы управления версиями** функции \(`SCC_CAP_ADDFROMSCC`\), то оно должно поддерживать новую семантику и вернуть `SCC_I_SHARESUBPROJOK`.  
  
## См. также  
 [Функции API подключаемого модуля источника элемента управления](../extensibility/source-control-plug-in-api-functions.md)   
 [SccSetOption](../extensibility/sccsetoption-function.md)