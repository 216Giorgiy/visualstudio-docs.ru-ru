---
title: "Функция SccAddFromScc | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology:
- vs-ide-sdk
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- SccAddFromScc
helpviewer_keywords:
- SccAddFromScc function
ms.assetid: 902e764d-200e-46e1-8c42-4da7b037f9a0
caps.latest.revision: 
author: gregvanl
ms.author: gregvanl
manager: ghogen
ms.workload:
- vssdk
ms.openlocfilehash: f92950bc833c2d2658c3e13cd7e800e877b32de9
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="sccaddfromscc-function"></a>Функция SccAddFromScc
Эта функция позволяет пользователю для поиска файлов, которые уже находятся в системе управления версиями и впоследствии сделать частью текущего проекта, эти файлы. Например эту функцию можно получить общего файла заголовка в текущий проект, не копируя файл. Возвращаемый массив файлов, `lplpFileNames`, содержит список файлов, которые пользователь хочет добавить в проект интегрированной среды разработки.  
  
## <a name="syntax"></a>Синтаксис  
  
```cpp  
SCCRTN SccAddFromScc (  
   LPVOID   pvContext,  
   HWND     hWnd,  
   LPLONG   lpnFiles,  
   LPCSTR** lplpFileNames  
);  
```  
  
#### <a name="parameters"></a>Параметры  
 pvContext  
 [in] Исходная структура подключаемого модуля контекста элемента управления.  
  
 hWnd  
 [in] Дескриптор окна интегрированной среды разработки, подключаемый модуль системы управления версиями можно использовать в качестве родительского для все диалоговые окна, которые он предоставляет.  
  
 lpnFiles  
 [in, out] Число файлов, которые добавляются в буфер. (Это `NULL` Если объем памяти, на который указывает `lplpFileNames` требуется выпустить. Примечания Дополнительные сведения см.)  
  
 lplpFileNames  
 [in, out] Массив указателей на всех имен файлов без пути к каталогам. Этот массив выделяется и освобождается, подключаемый модуль системы управления версиями. Если `lpnFiles` = 1 и `lplpFileNames` не `NULL`, имя массива, на который указывает `lplpFileNames` содержит папку назначения.  
  
## <a name="return-value"></a>Возвращаемое значение  
 Реализация подключаемого модуля управления источника этой функции должен возвращать одно из следующих значений:  
  
|Значение|Описание:|  
|-----------|-----------------|  
|SCC_OK|Файлы были успешно расположен и добавлена в проект.|  
|SCC_I_OPERATIONCANCELED|Операция была отменена не оказывает влияния.|  
|SCC_I_RELOADFILE|Файл или проект должен быть перезагружен.|  
  
## <a name="remarks"></a>Примечания  
 Эту функцию вызывает интегрированной среды разработки. Если подключаемый модуль системы управления версиями поддерживает задание локальной целевой папки, интегрированной среды разработки передает `lpnFiles` = 1 и передает имя локальной папки в `lplpFileNames`.  
  
 При вызове `SccAddFromScc` функция возвращает подключаемый модуль присвоены значения для `lpnFiles` и `lplpFileNames`, выделение памяти для массива имя файла, при необходимости (Обратите внимание, что такое распределение заменяет указатель в `lplpFileNames`). Для размещения всех файлов в каталоге пользователя или в папке указанного обозначение отвечает подключаемый модуль системы управления версиями. Затем интегрированной среды разработки добавляет файлы в проект интегрированной среды разработки.  
  
 Наконец, интегрированной среды разработки вызывает эту функцию во второй раз, передавая `NULL` для `lpnFiles`. Это значение интерпретируется как специальный сигнал системой управления версиями, подключаемый модуль, чтобы освободить память, выделенную для массива в имя файла`lplpFileNames``.`  
  
 `lplpFileNames`— `char ***` указателя. Подключаемый модуль системы управления версиями размещает указатель на массив указателей на имена файлов, таким образом передавая список стандартным способом для этого API.  
  
> [!NOTE]
>  Начальной версии VSSCI API не предоставил возможность указать проект назначения для добавленных файлов. Чтобы решить эту семантику `lplpFIleNames` параметра были усовершенствованы, чтобы сделать его параметр/out, а не в выходной параметр. Если только один файл указан, то есть значение указывает `lpnFiles` = 1, то первый элемент `lplpFileNames` содержит целевую папку. Для использования этих новую семантику вызовов IDE `SccSetOption` функционировать с `nOption`равным `SCC_OPT_SHARESUBPROJ`. Если подключаемый модуль системы управления версиями не поддерживает семантику, она возвращает `SCC_E_OPTNOTSUPPORTED`. Выполнив так отключает использование **добавить из системы управления версиями** компонентов. Если подключаемый модуль поддерживает **добавить из системы управления версиями** компонент (`SCC_CAP_ADDFROMSCC`), то он должен поддерживать новую семантику и возвращать `SCC_I_SHARESUBPROJOK`.  
  
## <a name="see-also"></a>См. также  
 [Функции API подключаемого модуля управления источника](../extensibility/source-control-plug-in-api-functions.md)   
 [SccSetOption](../extensibility/sccsetoption-function.md)