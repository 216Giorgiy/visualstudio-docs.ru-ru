---
title: "Общеязыковая среда выполнения и вычисление выражений | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-sdk"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "отладка [отладка SDK], вычисление выражений"
  - "вычисление выражений и CLR"
ms.assetid: b36c1eb5-1aaf-48a6-b287-ee7a273d2b1c
caps.latest.revision: 15
ms.author: "gregvanl"
manager: "ghogen"
caps.handback.revision: 15
---
# Общеязыковая среда выполнения и вычисление выражений
[!INCLUDE[vs2017banner](../../code-quality/includes/vs2017banner.md)]

> [!IMPORTANT]
>  В Visual Studio 2015 этот способ реализации вычислители выражений является устаревшим. Сведения о реализации вычислители выражений CLR, см. в разделе [вычислители выражений CLR](https://github.com/Microsoft/ConcordExtensibilitySamples/wiki/CLR-Expression-Evaluators) и [управляемых образец средства оценки выражений](https://github.com/Microsoft/ConcordExtensibilitySamples/wiki/Managed-Expression-Evaluator-Sample).  
  
 Компиляторы, такие как Visual Basic и C\# \(произносится как "Си\-шарп"\), которые предназначены для Common Language Runtime \(CLR\), создают промежуточного языка MSIL \(Microsoft\), который затем скомпилировать в машинный код. Среда CLR предоставляет отладчик \(DE\), выполнить отладку полученного кода. Если вы планируете интегрировать ваш собственный язык программирования в Visual Studio IDE, вы можно скомпилировать в MSIL\-код и поэтому не придется писать собственные DE. Тем не менее необходимо написать вычислитель выражений \(EE\), который способен вычисление выражений в контексте языка программирования.  
  
## Обсуждение  
 Для получения набора объектов данных и набор операторов, используемых для управления их обычно синтаксический анализ выражения на языке компьютера. Например выражение «A \+ B» может быть проанализировано применение оператора сложения \(\+\) к данным объектов «» и «Б», что может привести к другому объекту данных. Общий набор данных объекты, операторов и их связи чаще всего представляются в программе дерева, в котором операторы в узлах дерева и объекты данных в ветвях. Проанализированное дерево выражения, которое разбиваются на форме дерева часто называется.  
  
 После синтаксического анализа выражения для оценки каждого объекта данных вызывается поставщик символ \(SP\). Например, если «A» определен в более одного метода, а затем вопрос «Какие A?» необходимо получить ответ перед возможно установить значение A. Ответ, возвращенный хранимой Процедуры имеет вид «Третий элемент в пятом кадре стека» или «A, который составляет 50 байт за началом статическую память выделяется этот метод».  
  
 Помимо создания MSIL для самой программы, CLR компиляторы также позволяет создавать максимально содержательным отладочную информацию, которая записывается в файл базы данных программы \(PDB\). При условии, что частные языковой компилятор создает отладочную информацию в том же формате, как CLR компиляторы, SP среды CLR может определить, что по языку именованных объектов данных. После определения объекта именованных данных EE используется объект привязки связать \(или привязать\) объекта данных в область памяти, содержащий значение этого объекта. Затем DE получить или задать новое значение для объекта данных.  
  
 Собственный компилятор может предоставить CLR отладочную информацию, вызвав `ISymbolWriter` интерфейс \(который определен в .NET Framework в пространстве имен `System.Diagnostics.SymbolStore`\). Компиляция в MSIL и записи отладочной информации через эти интерфейсы, можно использовать собственный компилятор CLR DE и SP. Это значительно упрощает интеграцию специального языка в Интегрированной среде разработки Visual Studio.  
  
 Когда CLR DE вызывает собственный EE для вычисления выражения, DE предоставляет EE с интерфейсами SP и объект привязки. Таким образом написание средства ядро отладки на основе среды CLR требуется только реализовать интерфейсы вычислителя соответствующее выражение; CLR отвечает за привязки и символов, обработка для вас.  
  
## См. также  
 [Написание вычислитель выражений CLR](../../extensibility/debugger/writing-a-common-language-runtime-expression-evaluator.md)