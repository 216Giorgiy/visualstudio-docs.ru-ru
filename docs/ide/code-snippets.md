---
title: "Фрагменты кода | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-general"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "vs.ExpansionManagerImport"
  - "vs.codesnippetmanager"
helpviewer_keywords: 
  - "фрагменты кода"
  - "фрагменты кода, раскрытие"
  - "фрагменты кода, параметры замены"
  - "фрагменты кода, разместить во фрагменте"
  - "параметры замены"
  - "разместить во фрагменте"
ms.assetid: 85976ad9-4c9a-4e7b-896e-66ec6f955199
caps.latest.revision: 13
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
caps.handback.revision: 13
---
# Фрагменты кода
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Фрагменты кода — это небольшие блоки многократно используемого кода, которые можно вставлять в файл кода с помощью команды контекстного меню или сочетания клавиш.  Они обычно содержат часто используемый код, например конструкции TRY\-FINALLY или IF\-ELSE, но могут также использоваться и для вставки целых классов или методов.  
  
## Фрагменты расширения и фрагменты окружения  
 В Visual Studio существует два типа фрагментов кода: фрагменты расширения, которые добавляются в указанное курсором место и могут заменить собой ярлык фрагмента, и фрагменты окружения \(только в C\# и C\+\+\), которые добавляются вокруг выделенного блока кода.  
  
 Пример вставки фрагмента. В C\# ярлык TRYF служит для вставки блока TRY\-FINALLY:  
  
```  
try  
{  
  
}  
finally  
{  
  
}  
  
```  
  
 Чтобы вставить этот фрагмент, выберите в контекстном меню окна кода команду **Вставить фрагмент**, затем команду **Visual C\#**, затем введите `tryf` и нажмите клавишу TAB или введите `tryf` и нажмите клавишу TAB \+ TAB.  
  
 Пример фрагмента окружения. В C\+\+ ярлык `if` может использоваться для вставки фрагмента или для добавления фрагмента обрамления.  Если выбрать строку кода \(например, `return FALSE;`\) и последовательно выбрать команды **Окружить** и **IF**, фрагмент кода будет помещен около этой строки:  
  
```  
if (true)  
{  
    return FALSE;  
}  
  
```  
  
## Параметры замены фрагмента кода  
 Фрагменты кода могут содержать параметры замены, представляющие собой заполнители, которые необходимо заменить на конкретные значения при написании кода.  В предыдущем примере `true` — это параметр замены, который будет заменен на подходящее условие.  При замене изменения повторяются для каждого вхождения одного и того же параметра в фрагменте.  
  
 Например, в Visual Basic имеется фрагмент кода, который вставляет свойство.  В контекстном меню окна кода выберите последовательно команды **Вставить фрагмент**, **Шаблоны кода** и **Свойства, процедуры, события**, а затем определите свойство.  Вставлен следующий код:  
  
```  
Private newPropertyValue As String  
Public Property NewProperty() As String  
    Get  
        Return newPropertyValue  
    End Get  
    Set(ByVal value As String)  
        newPropertyValue = value  
    End Set  
End Property  
  
```  
  
 Если изменить `newPropertyValue` на `m_property`, изменяется каждое вхождение `newPropertyValue`.  Если изменить `String` на `Int` в объявлении свойства, то значение метода SET также изменится на `Int`.  
  
## Диспетчер фрагментов кода  
 Вы можете просмотреть все фрагменты кода, установленные в настоящий момент, а также их расположение на диске, выбрав команду **Инструменты\/Диспетчер фрагментов кода**.  Список фрагментов отсортирован по языку.  
  
 Вы можете добавлять и удалять каталоги фрагментов с помощью кнопок **Добавить** и **Удалить** в диалоговом окне **Диспетчер фрагментов кода**.  Чтобы добавить отдельные фрагменты, используйте кнопку **Импорт**.  
  
## См. также  
 [Пошаговое руководство. Создание фрагмента кода](../ide/walkthrough-creating-a-code-snippet.md)   
 [Практическое руководство. Распространение фрагментов кода](../ide/how-to-distribute-code-snippets.md)   
 [Рекомендации по использованию фрагментов кода](../ide/best-practices-for-using-code-snippets.md)   
 [Устранение неполадок, связанных с использованием фрагментов](../ide/troubleshooting-snippets.md)   
 [Фрагменты кода Visual C\#](../ide/visual-csharp-code-snippets.md)   
 [Фрагменты кода Visual C\+\+](../ide/visual-cpp-code-snippets.md)   
 [Справочник по схеме фрагментов кода](../ide/code-snippets-schema-reference.md)