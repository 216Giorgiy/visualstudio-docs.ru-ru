---
title: "Диагностика неработающих ссылок | Microsoft Docs"
ms.custom: ""
ms.date: "12/15/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-ide-general"
ms.tgt_pltfrm: ""
ms.topic: "article"
helpviewer_keywords: 
  - "создание ссылок на компоненты, устранение неполадок"
  - "создание ссылок на файлы из проектов"
  - "устранение неполадок для ссылок"
  - "проекты Visual Basic, ссылки"
  - "проекты Visual C#, ссылки"
ms.assetid: 00a9ade9-652e-40de-8ada-85f63cd183ee
caps.latest.revision: 15
caps.handback.revision: 15
author: "kempb"
ms.author: "kempb"
manager: "ghogen"
---
# Диагностика неработающих ссылок
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

Если приложение пытается использовать неработающую ссылку, генерируется ошибка исключения.  Основной причиной таких ошибок является невозможность найти компонент, указанный ссылкой, однако существует несколько ситуаций, в которых ссылка считается неработающей.  Эти ситуации перечислены ниже:  
  
-   Неверно или не полностью указан путь ссылок проекта.  
  
-   Ссылка указывает на файл, который был удален.  
  
-   Ссылка указывает на файл, который был переименован.  
  
-   Сбой подключения к сети или проверки подлинности.  
  
-   Ссылка указывает на COM\-компонент, который не установлен на данном компьютере.  
  
 Далее приведены рекомендации по устранению этих неполадок.  
  
> [!NOTE]
>  Ссылки на файлы сборок включаются в файл проекта с указанием абсолютного пути.  Поэтому пользователь, работающий в среде коллективной разработки, может не иметь указанной ссылкой сборки в своей локальной среде.  Чтобы избежать этих ошибок, лучше в таких случаях добавлять ссылки между проектами.  Дополнительные сведения см. в разделах [NIB How to: Add or Remove References By Using the Add Reference Dialog Box](http://msdn.microsoft.com/ru-ru/3bd75d61-f00c-47c0-86a2-dd1f20e231c9) и [Программирование с использованием сборок](../Topic/Programming%20with%20Assemblies.md).  
  
## Неверный путь ссылок  
 Когда проект используется на нескольких компьютерах, поиск ссылки может не дать результатов, если указанный ею компонент расположен в разных папках на разных компьютерах.  Ссылки сохраняются под именем файла компонента \(например MyComponent\).  При добавлении ссылки к проекту, путь к папке с файлом компонента \(например C:\\MyComponents\\\) добавляется к свойству проекта **Путь ссылок**.  
  
 При открытии проекта поиск файлов компонентов, указанных ссылками, выполняется в каталогах, определяемых свойством "Путь ссылок".  Если проект открывается на компьютере, который хранит компонент в другом каталоге, например в каталоге D:\\MyComponents\\, ссылка найдена не будет и в списке задач появится ошибка.  
  
 Для устранения этой проблемы можно удалить неработающую ссылку и заменить ее с помощью диалогового окна "Добавить ссылку".  Также можно использовать элемент **Путь ссылок** на странице свойств проекта и изменить папки в списке, указав правильное расположение.  Свойство **Путь ссылок** сохраняется для каждого пользователя на каждом компьютере.  Поэтому изменение пути ссылок не влияет на других разработчиков проекта.  
  
> [!TIP]
>  При использовании ссылок между проектами таких проблем не возникает.  Поэтому по возможности рекомендуется вместо ссылок на файлы использовать ссылки между проектами.  
  
#### Чтобы восстановить неработающую ссылку проекта с помощью исправления пути ссылок  
  
1.  В **Обозревателе решений** щелкните правой кнопкой мыши узел проекта и нажмите кнопку **Свойства**.  
  
2.  Откроется **Конструктор проектов**.  
  
3.  При использовании языка программирования Visual Basic выберите страницу **Ссылки** и нажмите кнопку **Пути для ссылок**.  В диалоговом окне **Пути для ссылок** введите путь к папке, содержащей элемент, на который нужно сделать ссылку, в поле **Папка** и нажмите кнопку **Добавить папку**.  
  
     \-или\-  
  
     При использовании языка программирования Visual C\# выберите страницу **Пути для ссылок**.  В поле **Папка** введите путь к папке, содержащей элемент, на который нужно сделать ссылку, и нажмите кнопку **Добавить папку**.  
  
## Файл, на который указывает ссылка, был удален  
 Возможно, файл, на который указывает ссылка, был удален и больше не существует на диске.  
  
#### Чтобы исправить неработающую ссылку проекта, указывающую на отсутствующий на диске файл  
  
-   Удалите ссылку.  
  
-   Если ссылка находится в другом месте на компьютере, необходимо считать ее из этого расположения.  
  
-   Дополнительные сведения см. в разделе [NIB How to: Add or Remove References By Using the Add Reference Dialog Box](http://msdn.microsoft.com/ru-ru/3bd75d61-f00c-47c0-86a2-dd1f20e231c9).  
  
## Файл, на который указывает ссылка, был переименован  
 Возможно, файл, на который указывает ссылка, был переименован.  
  
#### Чтобы исправить неработающую ссылку, указывающую на переименованный файл  
  
-   Удалите эту ссылку, после чего добавьте ссылку на файл с новым именем.  
  
-   Если ссылка находится в другом месте на компьютере, необходимо считать ее из этого расположения.  Дополнительные сведения см. в разделе [NIB How to: Add or Remove References By Using the Add Reference Dialog Box](http://msdn.microsoft.com/ru-ru/3bd75d61-f00c-47c0-86a2-dd1f20e231c9).  
  
## Сбой подключения к сети или проверки подлинности  
 Недоступность файлов может быть вызвана множеством причин, в том числе сбоем подключения к сети или проверки подлинности.  В каждом отдельном случае требуется уникальное решение; например, можно обратиться к локальному администратору для получения доступа к необходимым ресурсам.  Однако в любом случае можно просто удалить ссылку и изменить код, в котором она используется.  Дополнительные сведения см. в разделе [NIB How to: Add or Remove References By Using the Add Reference Dialog Box](http://msdn.microsoft.com/ru-ru/3bd75d61-f00c-47c0-86a2-dd1f20e231c9).  
  
## Компонент COM не установлен на компьютере  
 Если какой\-либо пользователь добавил ссылку на COM\-компонент, а другой пользователь пытается выполнить этот код на компьютере, на котором данный компонент не установлен, то последний получит сообщение о неработающей ссылке.  Для исправления ошибки достаточно установить этот компонент на втором компьютере.  Дополнительные сведения об использовании ссылок на компоненты COM в проектах см. в разделе [COM\-взаимодействие в приложениях .NET Framework](/dotnet/visual-basic/programming-guide/com-interop/com-interoperability-in-net-framework-applications).  
  
## См. также  
 [Introduction to the Project Designer](http://msdn.microsoft.com/ru-ru/898dd854-c98d-430c-ba1b-a913ce3c73d7)   
 [Страница "Ссылки" в конструкторе проектов \(Visual Basic\)](../ide/reference/references-page-project-designer-visual-basic.md)   
 [NIB How to: Add or Remove References By Using the Add Reference Dialog Box](http://msdn.microsoft.com/ru-ru/3bd75d61-f00c-47c0-86a2-dd1f20e231c9)