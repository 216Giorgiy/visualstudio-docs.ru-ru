---
title: Управление окружениями и интерпретаторами Python
description: Использование окна окружений Python в Visual Studio для управления глобальными и виртуальными окружениями, настройка пользовательских окружений, установка интерпретаторов Python, установка пакетов, задание путей для поиска и управление окружениями для проектов Visual Studio.
ms.date: 03/21/2018
ms.prod: visual-studio-dev15
ms.technology: vs-python
ms.topic: conceptual
author: kraigb
ms.author: kraigb
manager: douge
ms.workload:
- python
- data-science
ms.openlocfilehash: 422503cf1e9332ce2b42674f7a6293e844401772
ms.sourcegitcommit: 42ea834b446ac65c679fa1043f853bea5f1c9c95
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/19/2018
---
# <a name="managing-python-environments-in-visual-studio"></a>Управление средами Python в Visual Studio

*Окружение* Python представляет собой контекст, в котором выполняется код Python. Различают глобальные, виртуальные окружения и окружения Conda. Окружение состоит из интерпретатора, библиотеки (обычно это стандартная библиотека Python) и нескольких установленных пакетов. Вместе они определяют, какие языковые конструкции и синтаксис допустимы, какие возможности операционной системы доступны и какие пакеты можно использовать.

В Visual Studio для Windows есть окно [Окружения Python](#managing-python-environments-in-visual-studio), которое позволяет управлять окружениями и выбрать одно из них в качестве окружения по умолчанию для новых проектов. Все это мы рассмотрим в этой статье. Для каждого конкретного проекта можно выбрать определенное окружение вместо варианта по умолчанию.

**Примечание.** Если вы только начинаете работу с Python в Visual Studio, ознакомьтесь с необходимыми базовыми сведениями в следующих статьях:

- [Работа с Python в Visual Studio](overview-of-python-tools-for-visual-studio.md)
- [Установка поддержки Python в Visual Studio](installing-python-support-in-visual-studio.md)

Обратите также внимание, что вы не можете управлять окружениями для кода Python, который открыт только в качестве папки с помощью элементов **Файл > Открыть > Папка**. В таком случае [создайте проект Python на основе существующего кода](quickstart-01-python-in-visual-studio-project-from-existing-code.md), чтобы использовать функции окружения Visual Studio.

Если вы хотите установить пакеты в окружении, см. сведения о [вкладке "Пакеты"](python-environments-window-tab-reference.md#packages-tab).

## <a name="types-of-environments"></a>Типы окружений

### <a name="global-environments"></a>Глобальные среды

Каждая установка Python (например, Python 2.7, Python 3.6, Anaconda 4.4.0 и т. п.) поддерживает собственное окружение. Дополнительные сведения см. в статье [о выборе и установке интерпретаторов Python](installing-python-interpreters.md). Каждое окружение состоит из определенного интерпретатора Python, его стандартной библиотеки и набора предварительно установленных пакетов. Установив пакет в глобальном окружении, мы предоставляем к нему доступ для всех проектов, в которых оно используется. Если окружение находится в защищенной области файловой системы (например, в `c:\program files`), для установки пакетов требуются привилегии администратора.

Глобальные окружения доступны для всех проектов на компьютере. В Visual Studio вы можете выбрать одно глобальное окружение по умолчанию, которое будет использоваться для всех проектов, если вы не укажете другое для определенного проекта. Дополнительные сведения см. в разделе о [выборе окружения для проекта](selecting-a-python-environment-for-a-project.md).

### <a name="virtual-environments"></a>Виртуальные среды

Пакеты, установленные в глобальном окружении, доступны для всех проектов, в которых оно используется. При этом могут возникать конфликты, если двум проектам требуются несовместимые пакеты или разные версии одного пакета. Виртуальные окружения позволяют избежать таких конфликтов. В них применяются интерпретатор и стандартная библиотека из глобального окружения, но раздельные хранилища пакетов в изолированных папках.

В Visual Studio вы можете создать для конкретного проекта виртуальное окружение, которое хранится во вложенной папке проекта. В Visual Studio есть команда для создания файла `requirements.txt` из виртуального окружения, что позволяет легко воссоздать окружение на других компьютерах. См. дополнительные сведения о [виртуальных окружениях](selecting-a-python-environment-for-a-project.md#using-virtual-environments).

### <a name="conda-environments"></a>Окружения Conda

Окружение Conda создается с помощью инструмента `conda`. Как правило, такие окружения хранятся в папке `envs` в каталоге установки Anaconda и действуют так же, как глобальные окружения. Например, если установить пакет в окружении Conda, он станет доступным для всех проектов, в которых используется это окружение.

Сейчас Visual Studio не обнаруживает окружения Conda автоматически, но вы можете указать их в Visual Studio вручную. Дополнительные сведения см. в разделе [Указание существующего окружения вручную](#manually-identifying-an-existing-environment).

## <a name="the-python-environments-window"></a>Окно "Окружения Python"

Окружения, обнаруженные Visual Studio, отображаются в окне **Окружения Python**. Чтобы открыть это окно, используйте один из следующих методов:

- Выберите в меню команды **Просмотр > Другие окна > Python Environments** (Среды Python).
- В обозревателе решений щелкните правой кнопкой мыши узел **Окружения Python** в нужном проекте и выберите **Просмотреть все окружения Python**.

    ![Команда View All Python Environments (Показать все среды Python) в обозревателе решений](media/environments-view-all.png)

В любом случае окно **Окружения Python** откроется на вкладке того же уровня, что и обозреватель решений.

![Окно со средами Python](media/environments-default-view.png)

На рисунке выше мы видим, что в Visual Studio обнаружены две установки: Python 3.6 (32-разрядной версии) и Anaconda 5.0.0.

Полужирным шрифтом выделено окружение по умолчанию Python 3.6 (в нашем примере это часть установки Anaconda), которое Visual Studio применяет для всех новых проектов. Команды в нижней части окна относятся к выбранному интерпретатору Python 3.6, и в нашем примере это установка в каталоге `C:\Python36-32`. Если нужное окружение не отображается, ознакомьтесь с разделом [Указание существующего окружения вручную](#manually-identifying-an-existing-environment).

Справа от каждого окружения в списке есть элемент управления, который позволяет открыть интерактивное окно для этого окружения. Может отображаться другой элемент управления. Он предназначен для обновления базы данных IntelliSense для этого окружения (дополнительные сведения о базе данных см. в разделе об [окне окружений](python-environments-window-tab-reference.md#intellisense-tab)).

Под списком окружений есть раскрывающийся список с параметрами **Обзор**, **Пакеты** и **IntelliSense**. Они описаны в [справочной документации об окне "Окружения Python"](python-environments-window-tab-reference.md). Кроме того, если окно **Окружения Python** развернуть достаточно широко, эти параметры отобразятся в виде вкладок. Такой вариант может оказаться для вас более удобным.

![Развернутое окно Python Environments (Среды Python)](media/environments-expanded-view.png)

> [!Note]
> Несмотря на то что Visual Studio учитывает параметр system-site-packages, его нельзя изменить из среды Visual Studio.

|   |   |
|---|---|
| ![значок кинокамеры для видео](../install/media/video-icon.png "Просмотреть видео") | [Просмотрите видео (Microsoft Virtual Academy)](https://mva.microsoft.com/en-US/training-courses/python-tools-for-visual-studio-2017-18121?l=qrDmN4LWE_8305918567) об окружениях Python в Visual Studio (2 мин 35 с).|

### <a name="what-if-no-environments-appear"></a>Что делать, если окружения не отображаются?

Если окружения не отображаются, значит Visual Studio не удалось обнаружить ни одной установки Python в стандартных расположениях. Такое может случиться, если после установки Visual Studio 2017 вы очистили все параметры интерпретаторов в настройках установщика для рабочей нагрузки Python. Возможно, вы не установили интерпретатор для Visual Studio 2015 или более ранней версии. Дополнительные сведения см. в статье [Установка интерпретаторов Python](installing-python-interpreters.md).

Если вы точно знаете, что на компьютере установлен интерпретатор Python, но Visual Studio (любая версия) не может его обнаружить, укажите его расположение вручную с помощью команды **+ Настраиваемый...** Дополнительные сведения см. в следующем разделе [Указание существующего окружения вручную](#manually-identifying-an-existing-environment).

> [!Tip]
> Visual Studio обнаруживает обновления для существующих интерпретаторов, например обновление Python 2.7.11 до версии 2.7.14, с помощью установщиков с сайта python.org. В процессе установки старое окружение исчезнет из списка **Окружения Python**, прежде чем на его месте появится обновленная версия.
>
> Но если вы переместите интерпретатор и его окружение вручную с помощью средств файловой системы, Visual Studio не сможет узнать его новое расположение. Дополнительные сведения см. в разделе [о перемещении интерпретатора](installing-python-interpreters.md#moving-an-interpreter).

## <a name="manually-identifying-an-existing-environment"></a>Указание существующего окружения вручную

Чтобы указать окружение (в том числе окружение Conda), установленное в нестандартном расположении, выполните следующие действия:

1. Выберите **+ Настраиваемое...** в окне **Окружения Python**, чтобы открыть вкладку **Настройка**.

    ![Представление по умолчанию для новой настраиваемой среды](media/environments-custom-1.png)

1. Введите имя среды в поле **Описание**.

1. Введите путь к интерпретатору или найдите его (с помощью кнопки **...***) в поле **Префикс пути**.

1. Если Visual Studio обнаружит интерпретатор Python в этом расположении (ниже представлен пример пути к окружению Conda), команда **Автоматическое определение** станет активна. Если выбрать **Автоматическое определение*, все оставшиеся поля заполняется автоматически. Также вы можете заполнить эти поля вручную.

    ![Включение команды автоматического определения](media/environments-custom-2.png)

    ![Заполнение полей сведениями об окружении с помощью автоматического определения](media/environments-custom-3.png)

1. Когда все поля будут заполнены нужными значениями, щелкните **Применить**, чтобы сохранить конфигурацию. Теперь это окружение можно использовать в Visual Studio так же, как и остальные.

1. Если потребуется удалить окружение, которое вы указали вручную, щелкните команду **Удалить** на вкладке **Настройка**. Для автоматически обнаруженных сред этот параметр не предлагается. Дополнительные сведения см. в [описании вкладки "Настройка"](python-environments-window-tab-reference.md#configure-tab).

## <a name="see-also"></a>См. также

- [Установка интерпретаторов Python](installing-python-interpreters.md)
- [Выбор интерпретатора для проекта](selecting-a-python-environment-for-a-project.md)
- [Использование requirements.txt для зависимостей](managing-required-packages-with-requirements-txt.md)
- [Пути поиска](search-paths.md)
- [Справочная информация по окну "Окружения Python"](python-environments-window-tab-reference.md)