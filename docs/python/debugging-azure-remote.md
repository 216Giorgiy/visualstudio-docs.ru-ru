---
title: "Удаленная отладка Azure для Python в Visual Studio | Документация Майкрософт"
ms.custom: 
ms.date: 5/8/2017
ms.prod: visual-studio-dev15
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-python
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: d68fdc53-65a1-423c-8964-9815dbb3387e
caps.latest.revision: 1
author: kraigb
ms.author: kraigb
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Human Translation
ms.sourcegitcommit: 85576806818a6ed289c2f660f87b5c419016c600
ms.openlocfilehash: d2caa21359655a2079a853123baea31e471ba040
ms.contentlocale: ru-ru
ms.lasthandoff: 05/09/2017

---

# <a name="remotely-debugging-python-code-on-azure"></a>Удаленная отладка кода Python а Azure

[Поддержка Python в Visual Studio](installation.md) включает возможность удаленной отладки кода Python, который выполняется в службе приложений Azure. В отличие от обычной удаленной отладки, в этом сценарии нет прямого доступа к целевому компьютеру по протоколу TCP. Поэтому в Visual Studio есть прокси-сервер для предоставления доступа к протоколу отладчика по HTTP. В проектах, созданных с использованием веб-шаблона, этот прокси-сервер автоматически настраивается в созданном файле `web.debug.config`. Также удаленная отладка активируется при публикации проекта с конфигурацией отладки. Этот процесс описан в разделе [Publishing to Azure App Service](template-web.md#publishing-to-azure-app-service) (Публикации в службе приложений Azure).

Поскольку для удаленной отладки в Azure используются веб-сокеты, они должны быть включены для вашей службы приложения. Для этого перейдите на [портал Azure](https://portal.azure.com), откройте страницу **Параметры > Параметры приложения** и установите для параметра **Общие параметры > Веб-сокеты** значение **Включено**, а затем нажмите **Сохранить**, чтобы применить изменения. (Обратите внимание, что функция **Отладка** здесь не имеет отношения к отладке Python).

![Включение веб-сокетов на портале Azure](media/azure-remote-debugging-enable-web-sockets.png)

Когда проект правильно развернут и для него включены веб-сокеты, вы можете подключиться к службе приложений из **обозревателя сервера** в Visual Studio (**Просмотр > Обозреватель сервера**). Найдите нужный сайт в разделе **Azure > Служба приложений**, открыв соответствующую группу ресурсов, щелкните его правой кнопкой мыши и выберите действие **Подключить отладчик (Python)**. (Обратите внимание, что другая команда **Подключить отладчик** действует для приложений .NET, работающих под управлением IIS, и будет полезна только в тех случаях, когда рядом с приложением Python размещен код .NET).

Теперь вы можете перейти в Visual Studio непосредственно к набору инструкций для прямого подключения, как описано ниже в разделе [Подключение без обозревателя серверов](#attaching-without-server-explorer). Если вы не видите команды **Подключить отладчик (Python)** или Visual Studio не может подключиться к сайту, воспользуйтесь статьей [Устранение неполадок с удаленной отладкой Azure с помощью Инструментов Python для Visual Studio](debugging-azure-remote-troubleshooting.md).

Если подключение будет выполнено успешно, Visual Studio переключится в представление отладчика. На панели инструментов вы увидите отлаживаемый процесс, который можно узнать по протоколу `wss://` в URI:

![Отладка веб-сайта, размещенного в службе приложений Azure](media/azure-remote-debugging-attached.png)

После подключения процесс отладки мало чем отличается от обычной удаленной отладки, за исключением нескольких ограничений. В частности, веб-сервер IIS, который обрабатывает входящие запросы и передает их в код Python с помощью FastCGI, имеет время ожидания обработки запроса. По умолчанию это 90 секунд. Если обработка запроса потребует больше времени (например, из-за прерывания процесса в точке останова), IIS завершит процесс и, соответственно, закроет сеанс отладки. 

## <a name="attaching-without-server-explorer"></a>Подключение без обозревателя серверов

Вы можете подключить отладчик напрямую к службе приложений. Для этого выполните инструкции, указанные на странице информации о прокси-сервере WebSocket, которую Visual Studio развертывает на вашем сайте по адресу `<site_url>/ptvsd`, например так: `ptvsdemo.azurewebsites.net/ptvsd`. Открыв эту страницу, вы заодно убедитесь, что прокси-сервер настроен правильно:

![Страница информации о прокси удаленной отладки в Azure](media/azure-remote-debugging-proxy-info-page.png)

Как уже сказано, вам нужно создать URL-адрес с использованием секрета из файла `web.debug.config`, который создается заново при каждой публикации проекта. По умолчанию этот файл скрыт в обозревателе решений и не включается в проект. Чтобы открыть его, следует выбрать функцию "Показать все файлы" или использовать сторонний редактор. Открыв этот файл, найдите параметр appSetting с именем `WSGI_PTVSD_SECRET`:

![Определение конечной точки отладчика в службе приложений Azure](media/azure-remote-debugging-secret.png)

Теперь вам нужно создать URL-адрес в формате `wss://<secret>@<site_name>.azurewebsites.net/ptvsd`, заменив здесь &lt;secret&gt; и &lt;site_name&gt; соответствующими значениями.

Чтобы подключить отладчик, выберите действие **Отладка > Присоединиться к процессу**, затем выберите значение **Удаленная отладка Python** в раскрывающемся списке **Транспорт**, введите полученный URL-адрес в текстовое поле **Квалификатор** и нажмите клавишу ВВОД. Если Visual Studio успешно подключится к службе приложений, вы увидите в списке один процесс Python. Выберите его и нажмите **Присоединить**, чтобы запустить отладку:

![Диалоговое окно "Присоединение к процессу" для присоединения к веб-сайту Azure](media/azure-remote-debugging-manual-attach.png)

