---
title: "Выбор окружения для проекта | Документация Майкрософт"
description: "В обозревателе решений Visual Studio вы можете назначить определенный интерпретатор и (или) окружение Python, которые следует всегда использовать для конкретного проекта, игнорируя окружение по умолчанию. Также вы можете создавать виртуальные окружения и управлять ими."
ms.custom: 
ms.date: 02/20/2018
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-python
ms.devlang: python
ms.tgt_pltfrm: 
ms.topic: article
author: kraigb
ms.author: kraigb
manager: ghogen
ms.workload:
- python
- data-science
ms.openlocfilehash: 6f422cc60638b7eed4a5b42516e7496c4a6f6209
ms.sourcegitcommit: c0a2385a16cc4f47d2e1ff23d35c4da40f5605e0
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/23/2018
---
# <a name="selecting-a-python-interpreter-and-environment-for-use-in-a-project"></a>Выбор интерпретатора и окружения Python для проекта

Весь код в проекте Python выполняется в контексте определенного окружения. Visual Studio использует это же окружение для отладки, импорта, автозавершения элементов, проверки синтаксиса и других задач.

Для всех новых проектов Python в Visual Studio настраивается глобальное окружение по умолчанию, которое указано в узле **Окружения Python** в обозревателе решений:

![Глобальное окружение Python по умолчанию, отображаемое в обозревателе решений](media/environments-project.png)

Вы можете предоставить для проекта другие окружения, в том числе виртуальные. В любой определенный момент времени можно активировать только одно окружение.

## <a name="using-global-environments"></a>Использование глобального окружения

Чтобы предоставить проекту определенное глобальное окружение (в том числе [указанные вручную](managing-python-environments-in-visual-studio.md#manually-identifying-an-existing-environment) окружения Conda), щелкните правой кнопкой мыши узел **Окружения Python** и выберите действие **Добавление и удаление окружений Python...** Выберите нужное окружение из списка:

![Диалоговое окно добавления и удаления сред Python](media/environments-add-remove.png)

Когда вы нажмете **ОК**, все выбранные окружения отобразятся в узле **Окружения Python**. Полужирным шрифтом здесь выделено окружение, которое активно в текущий момент:

![Несколько окружений Python отображаются в обозревателе решений](media/environments-project-multiple.png)

Чтобы активировать другое окружение, щелкните его имя правой кнопкой мыши и выберите команду **Активировать окружение**. Ваш выбор сохраняется в проекте, и выбранное окружение применяется при каждом последующем открытии проекта.

Если вы снимете все флажки в диалоговом окне **Добавление и удаление окружений Python**, в Visual Studio будет активировано глобальное окружение по умолчанию.

## <a name="using-virtual-environments"></a>Использование виртуальных окружений

Виртуальное окружение — это уникальное сочетание интерпретатора Python и набора библиотек, которое не повторяется в других глобальных окружениях и окружениях Conda. Виртуальные окружения обычно используются для проектов с особыми требованиями, для удовлетворения которых вы не хотите изменять другие окружения.

Как только виртуальная среда будет добавлена в проект, она появится в окне **Python Environments** (Среды Python). Вы можете активировать ее, как и любую другую среду, а также управлять ее пакетами.

У виртуальных окружений есть недостаток. Они содержат жестко заданные пути к файлам, поэтому предоставить к ним общий доступ или перенести их на другие компьютеры разработки не так просто. К счастью, с помощью файла `requirements.txt` вы можете разрешить получателям проекта без труда восстановить это окружение. Дополнительные сведения см. в статье [Managing required packages with requirements.txt](managing-required-packages-with-requirements-txt.md) (Управление требуемыми пакетами с помощью requirements.txt).

### <a name="activating-an-existing-virtual-environment"></a>Активация существующего виртуального окружения

Если у вас уже есть виртуальное окружение, его можно активировать для проекта следующим образом:

1. В обозревателе решений выберите **Добавить существующее виртуальное окружение...**, щелкнув правой кнопкой мыши элемент **Окружения Python**.

1. Откроется диалоговое окно **Обзор**. Найдите и выберите здесь папку с виртуальным окружением, а затем нажмите кнопку **ОК**. Если Visual Studio обнаружит в этом окружении файл `requirements.txt`, появится запрос на установку обнаруженных пакетов.

1. Через несколько секунд виртуальное окружение появится в узле обозревателя решений **Окружения Python**. Виртуальное окружение не активируется по умолчанию, поэтому щелкните его правой кнопкой мыши и выберите действие **Активировать окружение**.

### <a name="creating-a-virtual-environment"></a>Создание виртуальной среды

Виртуальное окружение можно создать напрямую в Visual Studio, выполнив следующие действия:

1. В обозревателе решений выберите **Добавить виртуальное окружение...**, щелкнув правой кнопкой мыши **Окружения Python** . Откроется следующее диалоговое окно:

    ![Создание виртуальной среды](media/environments-add-virtual-1.png)

1. В поле **Расположение виртуального окружения** укажите путь к виртуальному окружению. Если вы укажете только имя, для виртуального окружения в текущем проекте создается вложенная папка с таким же именем.

1. Выберите среду в качестве базового интерпретатора и щелкните **Создать**. В Visual Studio отобразится индикатор выполнения, который позволяет отслеживать процесс настройки окружения и скачивания необходимых пакетов. Теперь виртуальное окружение отобразится в окне **Окружения Python** для проекта, в котором оно создано.

1. Виртуальное окружение не активируется по умолчанию. Чтобы активировать окружение для проекта, щелкните его правой кнопкой мыши и выберите **Активировать окружение**.

> [!Note]
> Если указан путь к расположению существующего виртуального окружения, Visual Studio автоматически обнаруживает базовый интерпретатор (для этого используется файл `orig-prefix.txt` в каталоге окружения `lib`). Вместо кнопки "Создать" отображается кнопка **Добавить**.
>
> Если в добавляемом виртуальном окружении есть файл `requirements.txt`, в диалоговом окне **Добавление виртуального окружения** отображается запрос на автоматическую установку пакетов. Этот механизм упрощает восстановление окружения на другом компьютере:
>
> ![Создание виртуальной среды при наличии файла requirements.txt](media/environments-requirements-txt.png)
>
> В любом случае результат будет такой же, как и при **добавлении существующего виртуального окружения**.

### <a name="remove-a-virtual-environment"></a>Удаление виртуального окружения

1. В обозревателе решений щелкните правой кнопкой мыши виртуальное окружение и выберите **Удалить**.

1. В Visual Studio вам будет предложено выбрать нужное действие (убрать или удалить виртуальное окружение). Вариант **Убрать** означает, что окружение исчезнет из проекта, но сохранится в файловой системе. Если выбрать **Удалить**, окружение убирается из проекта и все его файлы удаляются из файловой системы. Это действие не затрагивает базовый интерпретатор.

## <a name="viewing-installed-packages"></a>Просмотр установленных пакетов

В обозревателе решений можно развернуть узел любого окружения, чтобы быстро просмотреть установленные в нем пакеты (то есть те, которые можно импортировать и применять в коде, когда активно это окружение):

![Пакеты Python для среды в обозревателе решений](media/environments-installed-packages.png)

Чтобы установить новые пакеты, щелкните окружение правой кнопкой мыши и выберите действие **Установить пакет Python...**. В окне **Окружения Python** откроется вкладка **Пакеты**. Введите условие поиска (лучше всего имя пакета), и в Visual Studio отобразятся все подходящие пакеты.

Пакеты (и зависимости) в Visual Studio скачиваются из репозитория [Python Package Index (PyPI)](https://pypi.python.org/pypi). В нем же вы можете искать доступные пакеты. В строке состояния Visual Studio и окне вывода отображаются сведения об установке. Чтобы удалить пакет, щелкните его правой кнопкой мыши и выберите команду **Удалить**.

Не забывайте, что отображаемые записи могут быть неточными, а задания установки и удаления — ненадежными или недоступными. Visual Studio использует диспетчер пакетов pip, если он доступен, и при необходимости скачивает и устанавливает его. Visual Studio также может использовать диспетчер пакетов простой установки (easy_install). Здесь же отображаются пакеты, установленные с помощью команд `pip` или `easy_install` из командной строки.

Обратите внимание, что сейчас Visual Studio не позволяет использовать `conda` для установки пакетов в окружении Conda. Вместо этого используйте `conda` из командной строки.

> [!Tip]
> Если пакет содержит исходный код собственных компонентов в файлах `*.pyd`, попытка pip установить пакет завершается сбоем. Если необходимая версия Visual Studio не установлена, pip не может скомпилировать эти компоненты. В этом случае отображается сообщение об ошибке: `error: Unable to find vcvarsall.bat`. Как правило, диспетчер `easy_install` может скачать предварительно скомпилированные двоичные файлы. Подходящий компилятор для более старых версий Python можно скачать по адресу [http://aka.ms/VCPython27](http://aka.ms/VCPython27). Дополнительные сведения см. в записи блога команды разработчиков Python [How to deal with the pain of “unable to find vcvarsall.bat”](https://blogs.msdn.microsoft.com/pythonengineering/2016/04/11/unable-to-find-vcvarsall-bat/) (Что делать в случае возникновения ошибки "Не удалось найти vcvarsall.bat").

## <a name="see-also"></a>См. также

- [Управление средами Python в Visual Studio](managing-python-environments-in-visual-studio.md)
- [Использование requirements.txt для зависимостей](managing-required-packages-with-requirements-txt.md)
- [Пути поиска](search-paths.md)
- [Справочная информация по окну "Окружения Python"](python-environments-window-tab-reference.md)