---
title: "Интерактивная среда REPL Python в Visual Studio | Документация Майкрософт"
ms.custom: 
ms.date: 4/10/2017
ms.prod: visual-studio-dev15
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-python
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 642dc47e-c265-44ea-a77d-3db14170a36f
caps.latest.revision: 1
author: kraigb
ms.author: kraigb
manager: ghogen
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
translationtype: Human Translation
ms.sourcegitcommit: 9328c347d548a03a536cea16bd5851817c03d5a2
ms.openlocfilehash: ca444dbe9fea25b205ae2060d462f23957368496
ms.lasthandoff: 04/10/2017

---

# <a name="working-with-the-python-interactive-window"></a>Работа с интерактивным окном Python

Visual Studio предоставляет интерактивное окно цикла "чтение — оценка — вывод" (REPL) для каждой среды Python, что улучшает REPL, который вы получаете при выполнении `python.exe` в командной строке. В интерактивном окне (открывается с помощью команд меню **Просмотр > Другие окна > &lt;Среда&gt; > Интерактивный**) можно ввести произвольный код Python и немедленно увидеть результаты, что позволяет вам изучать API и экспериментировать с ним, а также интерактивно разрабатывать рабочий код для добавления в проекты.

![Интерактивное окно Python](~/docs/python/media/interactive-window.png)

Visual Studio предоставляет ряд режимов REPL Python.

| REPL | Описание | Редактирование | Отладка | Изображения |
| --- | --- | --- | --- | --- |
| Стандартный | Режим REPL по умолчанию, взаимодействует с Python напрямую | Стандартное редактирование (многострочное редактирование и т. д.) | Да, через `$attach` | Нет |
| Отладка | Режим REPL по умолчанию, взаимодействует с отлаженным процессом Python | Стандартное редактирование | Только отладка | Нет |
| IPython | REPL взаимодействует с серверной частью IPython | Команды IPython, средства Pylab | Нет | Да, встроенные в REPL |
| IPython без Pylab | REPL взаимодействует с серверной частью IPython | Стандартный IPython | Нет | Да, в отдельном окне | 

В этой статье описывается **стандартный** режим REPL и режим **отладки** REPL. Дополнительные сведения о режимах IPython см. в статье [Using Python in the Interactive Window](interactive-repl-ipython.md) (Использование Python в интерактивном окне).

Вводный обзор интерактивного окна Python представлен в видео [Getting Started with Python in Visual Studio, Part 5: Interactive REPL](https://youtu.be/yc2CROtTsC0?list=PLReL099Y5nRdLgGAdrb_YeTdEnd23s6Ff) (Начало работы с Python в Visual Studio, часть 5. Интерактивное окно REPL) длительностью 2 мин 51 с, размещенном на сайте youtube.com.

> [!VIDEO https://www.youtube.com/embed/yc2CROtTsC0]

## <a name="opening-an-interactive-window"></a>Открытие интерактивного окна

Существует несколько способов открыть интерактивное окно для среды.

Первый способ — переключитесь в окно сред Python (**Просмотр > Другие окна > Python Environments (Среды Python)** или с помощью клавиш CTRL+K, Ctrl+`) и выберите команду **Open Interactive Window** (Открыть интерактивное окно) или нажмите кнопку выбранной среды.

![Ссылка на интерактивное окно в окне Python Environments (Среды Python)](~/docs/python/media/interactive-window-opening.png)

Второй способ — выберите **Просмотр > Другие окна**, чтобы показать команды для перехода в **интерактивные окна** для каждой среды, которые обычно отображаются в нижней части меню.

![Пункты меню интерактивного окна после выбора "Просмотр" > "Другие окна"](~/docs/python/media/interactive-window-menu.png)

Третий способ — интерактивное окно можно открыть в файле запуска проекта или с помощью отдельного файла, выбрав команду меню **Отладка > Execute [Project | File] in Python Interactive (Выполнить [Файл | Проект] в интерактивном окне Python)** (SHIFT+ALT+F5):

![Пункт меню Execute Project in Python Interactive (Выполнить проект в интерактивном окне Python)](~/docs/python/media/interactive-execute-project.png)

Наконец, можно выбрать код в файле и использовать описанную ниже команду [Send code to interactive](#send-code-to-interactive-command) (Отправить код в интерактивное окно).

## <a name="interactive-window-options"></a>Параметры интерактивного окна

Чтобы управлять различными аспектами интерактивного окна, выберите команду **Configure interactive window** (Настроить интерактивное окно) в окне Python Environments (Среды Python) или **Инструменты > Параметры > Python Tools (Инструменты Python) > Интерактивное приложение Windows**:

![Параметры интерактивного окна Python](media/interactive-window-options.png)

Также существует отдельный набор параметров в **интерактивном окне отладки**, которое управляет поведением во время сеанса отладки:

![Параметры отладки интерактивного окна Python](media/interactive-window-debug-options.png)

## <a name="using-the-interactive-window"></a>Работа с интерактивным окном Python

Открыв интерактивное окно, можно приступить к построчному вводу кода в строках `>>>`. Интерактивное окно выполняет код в каждой строке по мере ввода, включая импорт модулей, определение переменных и т. д. Это видно в первых двух строках на следующем рисунке.

![Интерактивное окно Python](~/docs/python/media/interactive-window.png)

Когда оператор заканчивается двоеточием, как в случае с указанным выше оператором `for`, возникает исключение, так как для надлежащего выполнения блока кода нужны дополнительные строки. В этом случае в начале строки отображаются символы `...`, что указывает, что вам нужно ввести дополнительные строки для блока, как показано в четвертой и пятой строке на приведенном выше рисунке. При нажатии клавиши ВВОД в пустой строке блок закроется и будет выполнен в интерпретаторе.

> [!Tip]
> Интерактивное окно улучшает обычные условия работы с REPL в командной строке Python, автоматически выделяя отступами операторы, принадлежащие к окружающей области видимости. В журнале (можно отозвать с помощью стрелки вверх) также представлены многострочные элементы, в то время как в среде REPL с командной строкой содержатся только единичные строки.

Интерактивное окно — это отличный способ проверить работу новой библиотеки. Можно импортировать библиотеку, проверить вложенные пакеты, классы и функции.  Python может предоставить все эти сведения с помощью функции `help()`.  Кроме того, поддержка Python в Visual Studio предоставляет предложения и документацию на основе моделей кода, используемых в редакторе, без необходимости выполнения библиотеки.  При выполнении кода Visual Studio использует сведения из среды выполнения Python для улучшения этих предложений.  

<a name="meta-commands"></a> Интерактивное окно также поддерживает несколько метакоманд. Все метакоманды начинаются с `$`. Чтобы получить список метакоманд, введите `$help`, а для получения сведений об использовании конкретной команды введите `$help <command>`.

| Метакоманда | Описание |
| --- | --- |
| `$$` | Вставляет комментарий, благодаря чему можно комментировать код на протяжении всего сеанса. |
| `$attach` | Присоединяет отладчик Visual Studio к процессу окна REPL для включения отладки. |
| `$cls`, `$clear` | Удаляет содержимое окна редактора, не затрагивая журнал и контекст выполнения. |
| `$help` | Выводит список команд или справку по определенной команде. |
| `$load` | Загружает команды из файла и выполняет их до завершения. |
| `$mod` | Переключает текущую область на модуль с указанным именем. |
| `$reset` | Сбрасывает среду выполнения до начального состояния, но сохраняет историю. |
| `$wait` | Ожидает на протяжении как минимум указанного числа миллисекунд. |

Команды также можно расширять с помощью MEF (Managed Extensibility Framework для .NET).

## <a name="switching-scopes"></a>Переключение областей

По умолчанию интерактивное окно проекта действует в приделах файла запуска проекта, как и при запуске из командной строки. Для автономного файла действия выполняются в рамках этого файла. Во время сеанса REPL можно в любой момент изменить область с помощью раскрывающегося меню в верхней части интерактивного окна:

![Области интерактивного окна](~/docs/python/media/interactive-scopes.png)

После импорта модуля, например с помощью команды `import os`, вы увидите в раскрывающемся списке параметры, позволяющие переключиться в любую область этого модуля. В интерактивном окне появится сообщение, указывающее новую область, чтобы можно было отследить, как вы попали в определенное состояние во время сеанса.

После ввода `dir()` в области отобразятся допустимые идентификаторы этой области, включая имена функций, классы и переменные. Например, если ввести `$mod importlib`, за которым следует `dir()`, отобразится следующее:

![Интерактивное окно в области importlib](~/docs/python/media/interactive-importlib-scope.png)

<a name="sending-code-to-interactive"</a>
## <a name="send-code-to-interactive-command"></a>Команда Send code to interactive (Отправить код в интерактивное окно)

Помимо выполнения действий непосредственно в интерактивном окне, можно выбрать код в редакторе, щелкнуть правой кнопкой мыши и выбрать команду **Отправить в Interactive**:

![Команда меню "Отправить в Interactive"](~/docs/python/media/interactive-send-to.png)

Это также удобно для итеративной или эволюционной разработки кода, включая тестирование кода по мере разработки. Например, после того как вы отправили фрагмент кода в интерактивное окно и увидели его выходные данные, можно нажать стрелку вверх, чтобы отобразить код снова, внести изменения и быстро проверить его, нажав CTRL+ВВОД. (При нажатии клавиши ВВОД в конце входных данных происходит их выполнение, однако при нажатии этой клавиши в середине ввода происходит вставка новой строки.) Внеся все необходимые изменения в код, можно легко скопировать его обратно в файл проекта.

Вы также можете щелкнуть нужный код правой кнопкой мыши и выбрать команду **Send to Defining Module** (Отправить в определяемый модуль), которая выполнит поиск модуля, соответствующего редактируемому файлу, в интерактивном процессе. Если команда находит правильный модуль, она использует метакоманду `$mod`, чтобы переключиться на этот модуль (который становится частью журнала сеансов в интерактивном окне) и вставляет выбранный модуль в интерактивное окно для анализа. Это ускоряет процесс копирования кода в редакторе, переключение областей в интерактивном окне и вставку вручную.

## <a name="intellisense-behavior"></a>Поведение IntelliSense

В интерактивном окне применяется технология IntelliSense на основе используемых объектов, в отличие от редактора кода, в котором IntelliSense основана только на анализе исходного кода. Благодаря этому предложения в интерактивном окне более точные, особенно при работе с динамически создаваемым кодом. Недостаток заключается в том, что функции с побочными эффектами (например, запись сообщений) могут повлиять на процесс разработки.

Если это проблема, измените параметры, выбрав **Инструменты > Параметры > Python Tools (Инструменты Python) > Интерактивное приложение Windows** в группе **Completion Mode** (Режим завершения):

- **Never evaluate expressions** (Никогда не оценивать выражения). Для предложений будет использоваться обычный обработчик IntelliSense.
- **Never evaluate expressions containing calls** (Никогда не оценивать выражения, содержащие вызовы). Будут оцениваться простые выражения, такие как `a.b`, но для выражений с вызовами, например `a().b`, будет использоваться обычный обработчик (по умолчанию).
- **Always evaluate expressions** (Всегда оценивать выражения). Выполняется полная оценка выражений для получения предложений, независимо от того, могут ли возникнуть побочные эффекты.
