---
title: C6262
ms.date: 11/04/2016
ms.topic: reference
f1_keywords:
- C6262
helpviewer_keywords:
- C6262
ms.assetid: 3eddc74e-2b05-4159-a093-fd469fdcebbb
author: mikeblome
ms.author: mblome
manager: wpickett
ms.workload:
- multiple
ms.openlocfilehash: dc6b48cf15eea03a769cdbe0c14e05d553041e11
ms.sourcegitcommit: d0425b6b7d4b99e17ca6ac0671282bc718f80910
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/21/2019
ms.locfileid: "56617643"
---
# <a name="c6262"></a>C6262
Предупреждение C6262: Функция использует \<константа > байт в стеке: превышает / analyze: stacksize\<константа 2 >. Попробуйте переместить некоторые данные в кучу

 Это предупреждение указывает, что стек, превышает заданный порог (`constant 2`) обнаружена в функции. Размер кадра стека по умолчанию для данного предупреждения составляет 16 КБ 1 КБ для режима ядра в режиме пользователя. Стек — даже в пользовательском режиме, ограничен, и ошибки фиксации страницу из стека причин исключение переполнения стека. В режиме ядра имеет ограничение размера стека 12 КБ, который не может быть увеличена; Таким образом код в режиме ядра агрессивно следует ограничить использование стека.

 Чтобы решить проблему за это предупреждение, можно либо переместить некоторые данные в кучу или других динамической памяти.  В пользовательском режиме, один кадр огромная стопка может не быть проблемой, и это предупреждение может быть отменено, но кадр стека крупных повышает риск переполнение стека. (Кадр стека крупных может произойти, если функция интенсивно использует стек или является рекурсивным.) Можно увеличить общий размер стека в пользовательском режиме, если фактически происходит переполнение стека, но только в пределах системы.  Можно использовать **/ analyze** параметр командной строки, чтобы изменить значение для `<constant 2>`, но его представляет риск, что ошибка не возникнет.

 Для кода режима ядра — например, в проектах драйвера, значение `<constant 2>` имеет значение 1 КБ. Правильно составленный драйверы должны иметь очень мало функции, которые подход это значение, а изменение вниз ограничения может быть желательным.  Те же общие методы, которые используются для кода пользовательского режима, чтобы уменьшить размер стека можно адаптировать для кода режима ядра.

## <a name="example"></a>Пример
 В следующем коде создается данное предупреждение, поскольку `char buffer` выделяет 16,382 байтов и локальная целочисленная переменная `i` выделяет еще 4 байта, которые вместе превысили максимальный размер стека по умолчанию 16 КБ.

```cpp
// cl.exe /c /analyze /EHsc /W4
#include <windows.h>
#define MAX_SIZE 16382

void f( )
{
    int i;
    char buffer[MAX_SIZE];

    i = 0;
    buffer[0]='\0';

    // code...
}
```

 В следующем коде исправлены это предупреждение, переместив некоторые данные в кучу.

```cpp
// cl.exe /c /analyze /EHsc /W4
#include <stdlib.h>
#include <malloc.h>
#define MAX_SIZE 16382

void f( )
{
    int i;
    char *buffer;

    i = 0;
    buffer = (char *) malloc( MAX_SIZE );
    if (buffer != NULL)
    {
        buffer[0] = '\0';
        // code...
        free(buffer);
    }
}
```

 Использование объекта malloc и free имеют множество ловушек с точки зрения утечки памяти и исключения. Чтобы избежать такого рода утечки и исключение проблемы, используйте механизмы, предоставляемые по C++ стандартной библиотеки шаблонов (STL). К ним относятся [shared_ptr](/cpp/standard-library/shared-ptr-class), [unique_ptr](/cpp/standard-library/unique-ptr-class), и [вектор](/cpp/standard-library/vector). Дополнительные сведения см. в разделе [интеллектуальные указатели](/cpp/cpp/smart-pointers-modern-cpp) и [стандартной библиотеки C++](/cpp/standard-library/cpp-standard-library-reference).

 **Чтобы устранить это предупреждение, корректируя размер стека**

1.  В строке меню выберите **Проект**, **Свойства**.

     Откроется диалоговое окно **Страницы свойств**.

2.  Разверните **свойства конфигурации**.

3.  Разверните **C/C++**.

4.  Выберите **командной строки** свойства.

5.  В **Дополнительные параметры**, добавьте **/ analyze: stacksize16388**.

## <a name="see-also"></a>См. также

- [/STACK (выделение памяти в стеке)](/cpp/build/reference/stack-stack-allocations)
- [_resetstkoflw](/cpp/c-runtime-library/reference/resetstkoflw)
- [Практическое руководство. Настройка проверок во время выполнения машинного кода](../debugger/how-to-use-native-run-time-checks.md)