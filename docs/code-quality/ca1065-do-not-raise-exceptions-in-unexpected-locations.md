---
title: "CA1065: не вызывайте исключения в непредвиденных местах | Microsoft Docs"
ms.custom: ""
ms.date: "11/04/2016"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-devops-test"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "CA1065"
  - "DoNotRaiseExceptionsInUnexpectedLocations"
helpviewer_keywords: 
  - "DoNotRaiseExceptionsInUnexpectedLocations"
  - "CA1065"
ms.assetid: 4e1bade4-4ca2-4219-abc3-c7b2d741e157
caps.latest.revision: 16
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
caps.handback.revision: 16
---
# CA1065: не вызывайте исключения в непредвиденных местах
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

|||  
|-|-|  
|TypeName|DoNotRaiseExceptionsInUnexpectedLocations|  
|CheckId|CA1065|  
|Категория|Microsoft.Design|  
|Критическое изменение|Не критическое|  
  
## Причина  
 Метод вызывает исключение, хотя не должен этого делать.  
  
## Описание правила  
 Методы, которые вызывают исключения, хотя и не должны этого делать, можно разделить на следующие категории.  
  
-   Методы Property Get  
  
-   Методы Event Accessor  
  
-   Методы Equals  
  
-   Методы GetHashCode  
  
-   Методы ToString  
  
-   Статические конструкторы  
  
-   Методы завершения  
  
-   Методы Dispose  
  
-   Операторы равенства  
  
-   Операторы неявного приведения  
  
 В следующих разделах эти типы методов рассматриваются подробно.  
  
### Методы Property Get  
 Свойства по сути являются "интеллектуальными" полями.  Поэтому их поведение должно в максимальной степени соответствовать поведению поля.  Поля, как и свойства, не вызывают исключения.  Если имеется свойство, вызывающее исключение, следует подумать о том, чтобы преобразовать его в метод.  
  
 Следующие исключения могут возникать из метода получения свойства.  
  
-   <xref:System.InvalidOperationException?displayProperty=fullName> и все производные \(включая <xref:System.ObjectDisposedException?displayProperty=fullName>\)  
  
-   <xref:System.NotSupportedException?displayProperty=fullName> и все производные  
  
-   <xref:System.ArgumentException?displayProperty=fullName> \(только из индексированного метода получения\)  
  
-   <xref:System.Collections.Generic.KeyNotFoundException> \(только из индексированного метода получения\)  
  
### Методы Event Accessor  
 Методы доступа к событиям должны быть простыми операторами, не вызывающими исключения.  Событие не должно вызывать исключение при попытке добавления или удаления обработчика событий.  
  
 Следующие исключения могут возникать из метода доступа к событию.  
  
-   <xref:System.InvalidOperationException?displayProperty=fullName> и все производные \(включая <xref:System.ObjectDisposedException?displayProperty=fullName>\)  
  
-   <xref:System.NotSupportedException?displayProperty=fullName> и все производные  
  
-   <xref:System.ArgumentException> и производные  
  
### Методы Equals  
 Следующие методы **Equals** не должны вызывать исключения.  
  
-   <xref:System.Object.Equals%2A?displayProperty=fullName>  
  
-   [M:IEquatable.Equals](http://go.microsoft.com/fwlink/?LinkId=113472)  
  
 Метод **Equals** должен возвращать `true` или `false`, а не вызывать исключение.  Например, если методу Equals передано два несовпадающих типа, он должен просто вернуть `false`, а не вызывать <xref:System.ArgumentException>.  
  
### Методы GetHashCode  
 Следующие методы **GetHashCode** обычно не должны вызывать исключения.  
  
-   <xref:System.Object.GetHashCode%2A>  
  
-   [M: IEqualityComparer.GetHashCode \(T\)](http://go.microsoft.com/fwlink/?LinkId=113477)  
  
 **GetHashCode** должен всегда возвращать значение.  В противном случае элементы могут быть потеряны в хэш\-таблице.  
  
 Версии **GetHashCode** , принимающие аргументы, могут вызывать <xref:System.ArgumentException>.  При этом **Object.GetHashCode** никогда не должен вызывать исключения.  
  
### Методы ToString  
 Отладчик использует <xref:System.Object.ToString%2A?displayProperty=fullName> для отображения сведений об объектах в строковом формате.  Таким образом, **ToString** не должен изменять состояние и объекта и не должен вызывать исключений.  
  
### Статические конструкторы  
 Исключения из статического конструктора приводят к непригодности типа для использования в текущем домене приложений.  Вызов исключения из статического конструктора должен быть обусловлен очень веской причиной \(такой как проблема безопасности\).  
  
### Методы завершения  
 Вызов исключения из метода завершения приводит к скорому сбою CLR, разрушая процесс.  Таким образом, следует всегда избегать вызова исключений в методе завершения.  
  
### Методы Dispose  
 Метод <xref:System.IDisposable.Dispose%2A?displayProperty=fullName> не должен вызывать исключения.  Метод Dispose часть вызывается как часть логики очистки в предложении `finally`.  Таким образом, явный вызов исключения из метода Dispose вынуждает пользователя добавлять обработку исключений в предложение `finally`.  
  
 Путь к коду **Dispose\(false\)** никогда не должен вызывать исключений, так как он практически всегда вызывается из метода завершения.  
  
### Операторы равенства \(\=\=, \!\=\)  
 Подобно методам Equals, операторы равенства должны возвращать `true` или `false`, и не должны вызывать исключения.  
  
### Операторы неявного приведения  
 Поскольку пользователю часто неизвестно когда вызывается оператор неявного приведения, вызов исключения операторов приведения является абсолютно непредвиденным.  Таким образом, операторы неявного приведения не должны вызывать исключений.  
  
## Устранение нарушений  
 Для методов получения свойств измените логику, так чтобы более не возникало исключение, или измените свойство на метод.  
  
 Для все других перечисленных типов методов измените логику так, чтобы исключение не возникало.  
  
## Отключение предупреждений  
 Отключение предупреждений о нарушении данного правила безопасно в том случае, если нарушение было вызвано объявлением исключения, а не возникшим исключением.  
  
## Связанные правила  
 [CA2219: не создавайте исключения в предложениях исключений](../Topic/CA2219:%20Do%20not%20raise%20exceptions%20in%20exception%20clauses.md)  
  
## См. также  
 [Предупреждения конструктора](../code-quality/design-warnings.md)