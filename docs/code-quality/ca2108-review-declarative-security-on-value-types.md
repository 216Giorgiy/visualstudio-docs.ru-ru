---
title: "CA2108: проверьте объявляемые параметры безопасности типов значений | Microsoft Docs"
ms.custom: ""
ms.date: "12/14/2016"
ms.prod: "visual-studio-dev14"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "vs-devops-test"
ms.tgt_pltfrm: ""
ms.topic: "article"
f1_keywords: 
  - "ReviewDeclarativeSecurityOnValueTypes"
  - "CA2108"
helpviewer_keywords: 
  - "CA2108"
  - "ReviewDeclarativeSecurityOnValueTypes"
ms.assetid: d62bffdd-3826-4d52-a708-1c646c5d48c2
caps.latest.revision: 16
caps.handback.revision: 16
author: "stevehoag"
ms.author: "shoag"
manager: "wpickett"
---
# CA2108: проверьте объявляемые параметры безопасности типов значений
[!INCLUDE[vs2017banner](../code-quality/includes/vs2017banner.md)]

|||  
|-|-|  
|TypeName|ReviewDeclarativeSecurityOnValueTypes|  
|CheckId|CA2108|  
|Категория|Microsoft.Security|  
|Критическое изменение|Не критическое|  
  
## Причина  
 Открытый или защищенный тип значения защищен проверкой [Данные и модели](../Topic/Data%20and%20Modeling%20in%20the%20.NET%20Framework.md) или [Link Demands](../Topic/Link%20Demands.md).  
  
## Описание правила  
 Выделение памяти для типов значения и их инициализация производится конструкторами этих типов до выполнения других конструкторов.  Если тип значения защищен проверкой Demand или LinkDemand и вызывающий объект не имеет разрешений, которые удовлетворяют проверке безопасности, возникает сбой любого конструктора, отличного от конструктора по умолчанию, и создается исключение безопасности.  Память, выделенная типу значения, не освобождается; этот тип остается в состоянии, установленном его конструктором по умолчанию.  Не следует предполагать, что вызывающий объект, который передает экземпляр типа значения, имеет разрешение на создание этого экземпляра или доступ к нему.  
  
## Устранение нарушений  
 Нарушение данного правила можно устранить только в том случае, если удалить проверку безопасности из типа и использовать вместо нее проверки безопасности на уровне методов.  Обратите внимание, что данный способ устранения нарушения не запрещает вызывающим объектам, не обладающим соответствующими разрешениями, получать экземпляры типа значения.  Необходимо убедиться, что экземпляр типа значения в своем состоянии по умолчанию не предоставляет доступ к конфиденциальной информации и его нельзя использовать в злонамеренных целях.  
  
## Отключение предупреждений  
 Предупреждения о нарушении данного правила можно отключать в том случае, если любой вызывающий объект может получать экземпляры типа значения в его состоянии по умолчанию без создания угроз безопасности.  
  
## Пример  
 В следующем примере показана библиотека, содержащая тип значения, который нарушает данное правило.  Обратите внимание на тип `StructureManager`, который предполагает, что вызывающий объект, передающий экземпляр типа значения, имеет разрешение на создание этого экземпляра или доступ к нему.  
  
 [!code-cs[FxCop.Security.DemandOnValueType#1](../code-quality/codesnippet/CSharp/ca2108-review-declarative-security-on-value-types_1.cs)]  
  
## Пример  
 В следующем приложении демонстрируется уязвимость библиотеки.  
  
 [!code-cs[FxCop.Security.TestDemandOnValueType#1](../code-quality/codesnippet/CSharp/ca2108-review-declarative-security-on-value-types_2.cs)]  
  
 В результате выполнения примера получается следующий результат:  
  
  **Пользовательский конструктор структуры: Сбой при запросе.**  
**Новые значения SecuredTypeStructure 100 100**  
**Новые значения SecuredTypeStructure 200 200**   
## См. также  
 [Link Demands](../Topic/Link%20Demands.md)   
 [Данные и модели](../Topic/Data%20and%20Modeling%20in%20the%20.NET%20Framework.md)