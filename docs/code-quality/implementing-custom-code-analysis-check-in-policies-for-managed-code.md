---
title: "Реализация пользовательских политик анализом кода возврата для управляемого кода | Документы Microsoft"
ms.custom: 
ms.date: 11/04/2016
ms.reviewer: 
ms.suite: 
ms.technology: vs-ide-code-analysis
ms.tgt_pltfrm: 
ms.topic: article
f1_keywords:
- vs.code.analysis.selecttfsrulesets
- vs.code.analysis.browsefortfsruleset
- vs.code.analysis.policyeditor
ms.assetid: fd029003-5671-4b24-8b6f-032e0a98b2e8
caps.latest.revision: "21"
author: gewarren
ms.author: gewarren
manager: ghogen
ms.workload: dotnet
ms.openlocfilehash: 1c940c10c85901e5da7425c33f4bdbd726be7627
ms.sourcegitcommit: 32f1a690fc445f9586d53698fc82c7debd784eeb
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/22/2017
---
# <a name="implementing-custom-code-analysis-check-in-policies-for-managed-code"></a>Реализация пользовательских политик возврата с анализом кода для управляемого кода
Анализ кода, политика возврата указывает набор правил, которые члены командного проекта необходимо выполнить в исходном коде, перед возвратом в систему управления версиями. Корпорация Майкрософт предоставляет набор стандартных *наборов правил* правила анализа кода группы сгруппированы по функциональным областям. *Наборы правил настраиваемой политики* указать набор правил анализа кода, которые относятся к командному проекту. Набор правил хранится в RuleSet-файле.  
  
 Политики возврата задаются на уровне командного проекта и определяются расположением RULESET-файла в дереве системы управления версиями. Существуют ограничения на расположение системы управления версиями team политики настраиваемый набор правил.  
  
 Анализ кода, настроенной для отдельных проектов кода в окне «Свойства» для каждого проекта. Настраиваемый набор правил для проекта кода определяется физическое расположение RULESET-файла на локальном компьютере. Если задан RULESET-файл, который расположен на том же диске, что и проект кода, Visual Studio использует относительный путь к файлу в конфигурации проекта.  
  
 Предлагаемые для создания командного проекта настраиваемый набор правил рекомендуется хранить RULESET-файла политики возврата в особой папке, которая не является частью любого кода проекта. Если файл хранится в соответствующей папке, можно применить разрешения, ограничивающие, которым разрешено редактировать файл правил и можно легко переместить структуру каталогов, содержащий проекта в другой каталог или компьютера.  
  
## <a name="creating-the-team-project-custom-check-in-rule-set"></a>Создание набора настраиваемых правил командного проекта  
 Чтобы создать настраиваемый набор правил для командного проекта, сначала создать особую папку для политики возврата набору правил в **обозревателя управления исходным кодом**. Затем можно создать файл набора правил и добавить файл в систему управления версиями. Наконец вы указываете набора правил, политика анализа кода возврата для командного проекта.  
  
> [!NOTE]
>  Чтобы создать папку в командном проекте, сначала необходимо сопоставить корнем командного проекта в расположение на локальном компьютере.  
  
#### <a name="to-create-the-version-control-folder-for-the-check-in-policy-rule-set"></a>Чтобы создать папку системы управления версиями для набора правил политики возврата  
  
1.  В [!INCLUDE[esprtfc](../code-quality/includes/esprtfc_md.md)], разверните узел командного проекта и нажмите кнопку **системы управления версиями**.  
  
2.  В **папки** щелкните правой кнопкой мыши командный проект и нажмите кнопку **новую папку**.  
  
3.  В основной области системы управления версиями, щелкните правой кнопкой мыши **новую папку**, нажмите кнопку **переименование**и введите имя для папки набора правил.  
  
#### <a name="to-create-the-check-in-policy-rule-set"></a>Создание набора правил политики возврата  
  
1.  На **файл** последовательно выберите пункты **New**, а затем нажмите кнопку **файл**.  
  
2.  В **категории** выберите **Общие**.  
  
3.  В **шаблоны** дважды щелкните **набор правил анализа кода**.  
  
4.  Укажите правила для включения в набор правил и сохраните папку набора правил, созданный файл набора правил.  
  
     Дополнительные сведения см. в разделе [Создание настраиваемых наборов правил](../code-quality/creating-custom-code-analysis-rule-sets.md)  
  
#### <a name="to-add-the-rule-set-file-to-version-control"></a>Чтобы добавить правило для файла набора системы управления версиями  
  
1.  В **обозревателя управления исходным кодом**, щелкните правой кнопкой мыши новую папку и нажмите кнопку **добавить элементы в папку**.  
  
     Дополнительные сведения см. в разделе [Git и VSTS](/vsts/git/overview).  
  
2.  Щелкните созданный файл набора правил, а затем щелкните **Готово**.  
  
     Файл добавляется в систему управления версиями и извлечен вами.  
  
3.  В **обозревателя управления исходным кодом** окно "Подробности", щелкните правой кнопкой мыши имя файла и нажмите кнопку **Возврат ожидающих изменений**.  
  
4.  В **возврат** диалоговое окно, вы можете добавить комментарий, а затем нажмите кнопку **вернуть**.  
  
    > [!NOTE]
    >  Если вы уже настроили политику возврата с анализом кода для командного проекта и выбора **включить возврат файлов, которые являются частью текущего решения**, будет активировано предупреждение о нарушении политики. В диалоговом окне ошибки политики выберите **переопределить сбой политики и продолжить возврат**. Добавьте необходимое примечание и нажмите кнопку **ОК**.  
  
#### <a name="to-specify-the-rule-set-file-as-the-check-in-policy"></a>Определение набора правил файл как политики возврата  
  
1.  На **команды** последовательно выберите пункты **параметры командного проекта**, а затем нажмите кнопку **системы управления версиями**.  
  
2.  Нажмите кнопку **политики возврата**, а затем нажмите кнопку **добавить**.  
  
3.  В **политики возврата** дважды щелкните **анализа кода**и убедитесь, что **включить анализ кода для управляемого кода** установлен флажок.  
  
4.  В **выполнить этот набор правил** выберите  **\<выбрать набор правил из системы управления версиями >**.  
  
5.  Введите путь к файлу набора правил политики возврата в систему управления версиями.  
  
     Путь должен соответствовать следующему синтаксису:  
  
     **$/** `TeamProjectName` **/** `VersionControlPath`  
  
    > [!NOTE]
    >  Путь можно скопировать с помощью одного из следующих процедур в **обозревателя управления исходным кодом**:  
  
    -   В **папки** области, щелкните папку, содержащую файл набора правил. Скопируйте путь папки, которая отображается в системе управления версиями **источника** и вручную введите имя файла набора правил.  
  
    -   В окне сведений щелкните правой кнопкой мыши файл набора правил и нажмите кнопку **свойства**. На **Общие** вкладки, скопируйте значение в **имя сервера**.  
  
## <a name="synchronizing-code-projects-to-the-check-in-policy-rule-set"></a>Синхронизация проектов кода в набор правил политики возврата  
 Можно указать, устанавливать набора правил политики возврата командного проекта как набор правил анализа кода кода конфигурации проекта в диалоговом окне свойств проекта кода. Если набор правил расположен на том же диске, что и проект кода, относительный путь используется для определения набора правил, когда путь, выбираются в диалоговом окне файла. Относительный путь позволяет переносить на другие компьютеры, использующие как локальная версия параметров свойств проекта управляющие структуры.  
  
#### <a name="to-specify-a-team-project-rule-set-as-the-rule-set-of-a-code-project"></a>Чтобы задать правило командного проекта необходимо задать набора правил для проекта кода  
  
1.  При необходимости получить папку набора правил политики возврата и файл из системы управления версиями.  
  
     На этом шаге можно выполнять **обозревателя управления исходным кодом** щелкните правой кнопкой мыши набора правил и выбрав команду **получить последнюю версию**.  
  
2.  В **обозревателе решений**, щелкните правой кнопкой мыши проект кода и нажмите кнопку **свойства**.  
  
3.  **Нажмите кнопку Анализ кода**.  
  
4.  При необходимости выберите необходимые параметры в **конфигурации** и **платформы** перечислены.  
  
5.  Чтобы запустить анализ кода при каждом построении проекта кода с помощью указанной конфигурации, выберите **включить анализ кода в построении (определяет константу CODE_ANALYSIS)** флажок.  
  
6.  Чтобы пропускать код в компонентах от других компаний, установите **исключить результаты из созданного кода** флажок.  
  
7.  В **выполнить этот набор правил** выберите  **\<Обзор... >**.  
  
8.  Укажите локальную версию файла набора правил политики возврата.