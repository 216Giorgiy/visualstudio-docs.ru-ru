---
title: Использование и настройка анализаторы Roslyn в Visual Studio
ms.date: 03/26/2018
ms.prod: visual-studio-dev15
ms.technology: vs-ide-code-analysis
ms.topic: conceptual
helpviewer_keywords:
- code analysis, managed code
- analyzers
- Roslyn analyzers
author: gewarren
ms.author: gewarren
manager: douge
ms.workload:
- dotnet
ms.openlocfilehash: 2e99a98f5ea4cca5891d416bdc13656b3173a40f
ms.sourcegitcommit: e13e61ddea6032a8282abe16131d9e136a927984
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/26/2018
ms.locfileid: "31925124"
---
# <a name="configure-and-use-roslyn-analyzer-rules"></a>Настроить и использовать правила анализатора Roslyn

Правила анализатора платформой компилятора .NET («Roslyn»), или *диагностики*, анализ кода C# или Visual Basic, при вводе. Каждого средства диагностики имеет состояние серьезность и подавления по умолчанию, которое может быть перезаписан для проекта. В этой статье описан параметр серьезность правило, использование наборов правил и подавление нарушений.

## <a name="analyzers-in-solution-explorer"></a>Анализаторы в обозревателе решений

Можно выполнять большую часть настройки анализатора диагностики из **обозревателе решений**. Если вы [установить анализаторы](../code-quality/install-roslyn-analyzers.md) как пакет NuGet, **анализаторы** узел отображается в узле **ссылки** или **зависимости** узел в  **Обозреватель решений**. Если развернуть **анализаторы**и разверните одну из сборок анализатора см. в разделе все средства диагностики в сборке.

![Анализаторы узел в обозревателе решений](media/analyzers-expanded-in-solution-explorer.png)

Можно просмотреть свойства диагностики, включая описание и уровень серьезности по умолчанию, в **свойства** окна. Чтобы просмотреть свойства, щелкните правой кнопкой мыши правило и выберите пункт **свойства**, или выберите правило и нажмите клавишу **Alt**+**ввод**.

![Свойств диагностики в окне "Свойства"](media/analyzer-diagnostic-properties.png)

Для просмотра документации для диагностики, щелкните правой кнопкой мыши на диагностику и выберите **Просмотр справки**.

Значков возле каждого средства диагностики в **обозревателе решений** соответствует значку, см в набор при открытии в редакторе правил:

- Указывает, «i» в кружке [серьезность](#rule-severity) из **сведения**
- «!» в треугольнике указывает [серьезность](#rule-severity) из **предупреждение**
- Указывает символ «x» в кружке [серьезность](#rule-severity) из **ошибки**
- Указывает, «i» в кружке на фоне светлый [серьезность](#rule-severity) из **Hidden**
- стрелку вниз в кружке показывает, что подавляется диагностики

![Диагностика значки в обозревателе решений](media/diagnostics-icons-solution-explorer.png)

## <a name="rule-sets"></a>Наборы правил

Объект [набор правил](../code-quality/using-rule-sets-to-group-code-analysis-rules.md) XML-файл, сохраняет состояние серьезности и подавлением для отдельных диагностики. Наборы правил применяются в отдельный проект и проект может иметь несколько наборов правил. Чтобы просмотреть активные набору правил в редакторе, щелкните правой кнопкой мыши **анализаторы** узел в **обозревателе решений** и выберите **открыть набор активных правил**. Если это при первом обращении к правило набор, в файл с именем  *\<имя_проекта > .ruleset* добавляется в проект и отображается в **обозревателе решений**.

> [!NOTE]
> Наборы правил включают анализа статического кода (двоичный) и правила анализатора Roslyn.

Можно изменить активный набор правил для проекта на **анализа кода** вкладку свойств проекта. Выберите набор правил в **выполнить этот набор правил** раскрывающегося списка. Можно также открыть из набора правил **анализа кода** страницу свойств, выбрав **откройте**.

## <a name="rule-severity"></a>Важность правила

Можно настроить уровень серьезности правила анализатора или *диагностики*, если вы [установить анализаторы](../code-quality/install-roslyn-analyzers.md) как пакет NuGet. В следующей таблице показаны параметры серьезности для диагностики:

|Серьезность|Поведение во время сборки|Поведение редактора|
|-|-|-|
|Error|Нарушений отображаются как *ошибки* в **список ошибок** и командной строки в выходные данные построения и вызвать сборки к сбою.|Неправильная кода — подчеркнутым с красной волнистой и помеченный атрибутом небольшой квадрат красного полосы прокрутки.|
|Предупреждение|Нарушений отображаются как *предупреждения* в **список ошибок** и командной строки в выходные данные сборки, но не вызывают сборки к сбою.|Неправильная кода — подчеркнутым с зеленой волнистой и помеченный атрибутом небольшой зеленой рамке полосы прокрутки.|
|Info|Нарушений отображаются как *сообщения* в **список ошибок**, а не полностью в выходных данных построения из командной строки.|Неправильная кода — подчеркнутым серым, волнистая и помеченный атрибутом небольшой квадрат серую полосу прокрутки.|
|Hidden|Невидимые для пользователя.|Невидимые для пользователя. Диагностические отмечается диагностики механизму интегрированной среды разработки, однако.|
|Нет|Подавлять полностью.|Подавлять полностью.|

Кроме того, вы можете «сбросить» серьезность правило присвоив ему значение **по умолчанию**. Каждого средства диагностики имеет уровень серьезности по умолчанию, можно увидеть в **свойства** окна.

На следующем рисунке показан три разных диагностики нарушений в редакторе кода с помощью трех различных уровнях серьезности. Обратите внимание, цвет волнистая, а также небольшой квадрат полосы прокрутки в правой части.

![Ошибки, предупреждения и сведения о нарушении в редакторе кода](media/diagnostics-severity-colors.png)

На следующем рисунке показан же три нарушений, появляющихся в **список ошибок**:

![Ошибки, предупреждения и сведения о нарушении в списке ошибок](media/diagnostics-severities-in-error-list.png)

Можно изменить уровень серьезности правила **обозревателе решений**, или в  *\<имя_проекта > .ruleset* файл, который добавляется в решение после изменения серьезность правила в  **Обозреватель решений**.

![В обозревателе решений файл набора правил](media/ruleset-in-solution-explorer.png)

### <a name="to-set-rule-severity-from-solution-explorer"></a>Чтобы задать важность правила из обозревателя решений

1. В **обозревателе решений**, разверните **ссылки** > **анализаторы** (**зависимости**  >  **Анализаторы** для проектов .NET Core).

1. Разверните сборку, которая содержит правило, которое вы хотите задать уровень серьезности для.

1. Щелкните правой кнопкой мыши правило и выберите пункт **задать важность задать правило**. В выпадающем меню выберите один из параметров серьезности.

   Важность правила сохраняются в файле набор активных правил.

### <a name="to-set-rule-severity-in-the-rule-set-file"></a>Задать правило файла набора серьезности в правиле

1. Откройте файл набора правил, дважды щелкнув его в **обозревателе решений**, выбрав **открыть набор активных правил** в меню щелкните правой кнопкой мыши **анализаторы** узла, или выбрав **Откройте** на **анализа кода** страницу свойств для проекта.

1. Выберите правило, развернув его содержащего сборки.

1. В **действия** столбец, выберите значение, чтобы открыть раскрывающегося списка и выберите в списке нужный уровень серьезности.

   ![Файл набора правил, открытые в редакторе](media/ruleset-file-in-editor.png)

## <a name="suppress-violations"></a>Отключение нарушений

Существует несколько способов для подавления нарушения правил:

- Чтобы подавить все нарушения текущей, выберите **анализ** > **выполнить анализ кода и подавить активные проблемы** в строке меню. Это иногда называется «базовых показателей».

- Отключение диагностику с **обозревателе решений**, равным его важность **нет**.

- Отключение диагностики в редакторе набора правил, снимите флажок рядом с именем или задать **действия** для **нет**.

- Чтобы подавить диагностики из редактора кода, поместите курсор в строку кода с нарушением и нажмите клавишу **Ctrl**+**.** Чтобы открыть **быстрых действий** меню. Выберите **отключение CAxxxx** > **в источнике** или **отключение CAxxxx** > **в файле блокируемых предупреждений**.

   ![Отключение диагностики меню быстрых действий](media/suppress-diagnostic-from-editor.png)

- Отключение диагностику с **список ошибок**, щелкните правой кнопкой мыши на ошибку, предупреждение или сообщение и выберите **подавлять** > **в исходном** или **Отключение** > **в файле блокируемых предупреждений**.

   - При выборе **в исходном**, **Просмотр изменений** диалоговое окно открывается и отображается предварительный просмотр C# [#pragma warning](/dotnet/csharp/language-reference/preprocessor-directives/preprocessor-pragma-warning) или Visual Basic [#Disable warning](/dotnet/visual-basic/language-reference/directives/directives) директиву, которая добавляется к исходному коду.

      ![Предварительный просмотр Добавление #pragma warning в файле кода](media/pragma-warning-preview.png)

   - При выборе **в файле блокируемых предупреждений**, **Просмотр изменений** диалоговое окно открывается и отображается предварительный просмотр <xref:System.Diagnostics.CodeAnalysis.SuppressMessageAttribute> атрибут, который будет добавлен файл глобального подавления.

      ![Добавление атрибута SuppressMessage файла подавления Предварительный просмотр](media/preview-changes-in-suppression-file.png)

   В **Просмотр изменений** диалогового окна выберите **применить**.

> [!NOTE]
> В проекте .NET Core Если добавить ссылку на проект, имеющий анализаторы NuGet эти анализаторы автоматически добавляются зависимый проект слишком. Чтобы отключить это поведение, например, если зависимый проект модульного теста пометить как закрытый в пакет NuGet *.csproj* или *.vbproj* файла проекта, на который указывает ссылка:
>
> ```xml
> <PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="2.6.0" PrivateAssets="all" />
> ```

## <a name="see-also"></a>См. также

- [Общие сведения о анализаторы Roslyn в Visual Studio](../code-quality/roslyn-analyzers-overview.md)
- [Отправка ошибки анализатора Roslyn](https://github.com/dotnet/roslyn-analyzers/issues)
- [Использование наборов правил](../code-quality/using-rule-sets-to-group-code-analysis-rules.md)
- [Отключение предупреждений анализа кода](../code-quality/in-source-suppression-overview.md)