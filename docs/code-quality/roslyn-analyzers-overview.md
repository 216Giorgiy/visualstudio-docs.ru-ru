---
title: Анализ кода с помощью анализаторов Roslyn
ms.date: 03/26/2018
ms.topic: overview
helpviewer_keywords:
- code analysis, managed code
- analyzers
- Roslyn analyzers
author: gewarren
ms.author: gewarren
manager: jillfra
ms.workload:
- dotnet
ms.openlocfilehash: c79f51d1bcc82bda9e7c3f21548eac445f36f925
ms.sourcegitcommit: 21d667104199c2493accec20c2388cf674b195c3
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 02/08/2019
ms.locfileid: "55948281"
---
# <a name="overview-of-net-compiler-platform-analyzers"></a>Обзор анализаторов на платформе .NET Compiler Platform

Visual Studio 2017 содержит встроенный набор анализаторов .NET Compiler Platform, которые анализируют код на C# или Visual Basic при его наборе. Анализаторы проверяют стиль кода, качество и удобство поддержки кода, структуру кода и другие аспекты. Вы можете установить дополнительные анализаторы в виде расширений Visual Studio или в виде пакетов NuGet для отдельных проектов.

Если анализатор обнаруживает нарушения правил, они помечаются как в редакторе кода (*волнистая линия* под соответствующим кодом), так и в **списке ошибок**.

Многие правила анализатора или *диагностические средства* имеют одно или несколько связанных *исправлений кода*, которые можно применить для устранения проблемы. Все диагностические средства анализатора, встроенные в Visual Studio, имеют соответствующие исправления кода. Исправления кода отображаются в меню со значком лампочки вместе с другими типами *быстрых действий*. Сведения об этих исправлениях кода см. в разделе [Распространенные быстрые действия](../ide/common-quick-actions.md).

![Нарушение анализа и исправление кода быстрого действия](../code-quality/media/built-in-analyzer-code-fix.png)

## <a name="roslyn-analyzers-vs-static-code-analysis"></a>Сравнение анализаторов Roslyn и статического анализа кода

В конечном счете анализаторы .NET Compiler Platform (Roslyn) заменят [статический анализ кода](../code-quality/code-analysis-for-managed-code-overview.md) для управляемого кода. Множество правил статического анализа кода уже были переписаны как диагностические средства анализатора Roslyn.

Как и нарушения правил статического анализа кода, нарушения анализаторов Roslyn отображаются в **списке ошибок**. Кроме того, нарушения анализаторов Roslyn выделяются в редакторе кода с помощью *волнистых линий* под соответствующим кодом. Цвет волнистой линии зависит [параметра серьезности](../code-quality/use-roslyn-analyzers.md#rule-severity) правила. На следующем снимке экрана показаны три нарушения&mdash;одно красное, одно зеленое и одно серое:

![Волнистые линии в редакторе кода](media/diagnostics-severity-colors.png)

Анализаторы Roslyn анализируют код не только во время сборки, как и статический анализ кода, когда он включен, но и в реальном времени по мере ввода. Кроме того, анализаторы Roslyn могут обеспечить анализ кода файлов, которые не открыты в редакторе, во время разработки, если включен [полный анализ решения](../code-quality/how-to-enable-and-disable-full-solution-analysis-for-managed-code.md#to-toggle-full-solution-analysis).

> [!NOTE]
> Ошибки и предупреждения времени сборки из анализаторов Roslyn отображаются только в том случае, если анализаторы установлены как пакет NuGet.

Анализаторы Roslyn не только сообщают о тех же типах проблем, что и статический анализ кода, но и упрощают исправление одного или всех экземпляров нарушений в файле или проекте. Эти действия называются *исправлениями кода*. Исправления кода зависят от конкретной интегрированной среды разработки; в Visual Studio они реализуются как [Быстрые действия](../ide/quick-actions.md). Не все диагностические средства анализатора имеют соответствующее исправление кода.

> [!NOTE]
> Пункт меню **Анализ** > **Запустить анализ кода** применяется только к статическому анализу кода. Кроме того, флажки **Включить анализ кода для сборки** и **Исключить результаты из созданного кода** на странице свойств **Анализ кода** проекта относятся только к статическому анализу кода. Они не влияют на анализаторы Roslyn.

Чтобы различить нарушения из анализаторов Roslyn и статического анализа кода в **списке ошибок**, используйте столбец **Средство**. Если его значение соответствует одной из сборок анализаторов в **обозревателе решений**, например, **Microsoft.CodeQuality.Analyzers**, нарушение поступает из анализатора Roslyn. В противном случае нарушение поступает из статического анализа кода.

![Столбец "Средство" в списке ошибок](media/code-analysis-tool-in-error-list.png)

## <a name="nuget-package-versus-vsix-extension"></a>Сравнение пакета NuGet и расширения VSIX

Анализаторы .NET Compiler Platform можно устанавливать для отдельных проектов с помощью пакета NuGet или в масштабе всей системы Visual Studio в виде расширения Visual Studio. Между этими двумя способами [установки анализаторов](../code-quality/install-roslyn-analyzers.md) существуют некоторые ключевые различия.

### <a name="scope"></a>Область

Если анализаторы устанавливаются как расширение Visual Studio, они применяются на уровне решения, то есть ко всем экземплярам Visual Studio. Если анализаторы устанавливаются в виде пакета NuGet, что является предпочтительным, они применяются только к проекту, где установлен данный пакет NuGet. В командных окружениях анализаторы, установленные как пакеты NuGet, входят в область для *всех разработчиков*, работающих над этим проектом.

### <a name="build-errors"></a>Ошибки сборки

Чтобы применить правила во время сборки, например с помощью командной строки или в составе сборки непрерывной интеграции (CI), установите анализаторы как пакет NuGet. Если установить анализатор как расширение, его предупреждения и ошибки не будут отображаться в отчете о сборке.

На следующем снимке экрана показаны выходные данные сборки из командной строки для создания проекта, содержащего нарушение правила анализа.

![Выходные данные MSBuild с нарушением правила](media/command-line-build-analyzers.png)

### <a name="rule-severity"></a>Важность правил

Вы не можете задать важность правил из анализаторов, которые были установлены как расширение Visual Studio. Чтобы настроить [важность правила](../code-quality/use-roslyn-analyzers.md#rule-severity), установите анализаторы как пакет NuGet.

## <a name="next-steps"></a>Следующие шаги

> [!div class="nextstepaction"]
> [Установка анализаторов Roslyn в Visual Studio](../code-quality/install-roslyn-analyzers.md)

> [!div class="nextstepaction"]
> [Использование анализаторов Roslyn в Visual Studio](../code-quality/use-roslyn-analyzers.md)

## <a name="see-also"></a>См. также

- [Быстрые действия в Visual Studio](../ide/quick-actions.md)
- [Написание собственного анализатора Roslyn](../extensibility/getting-started-with-roslyn-analyzers.md)
- [Пакет SDK для .NET Compiler Platform](/dotnet/csharp/roslyn-sdk/)